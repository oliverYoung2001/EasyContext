+ srun -p rag -N 1 --ntasks-per-node=2 --gres=gpu:2 --mem 256G -K -c 16 ./scripts/bench_ring_attn.sh python ./tests/pynccl_dist.py -s
srun: job 10214 queued and waiting for resources
srun: job 10214 has been allocated resources
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
[W kineto_shim.cpp:372] Profiler is not initialized: skipping step() invocation
rank0, a: 1.0, b: 2.0, c: 6.0, d: 12.0, e: 12.0
rank1, a: 2.0, b: 1.0, c: 9.0, d: 10.0, e: 10.0
rank1, a: 2.0, b: 1.0, c: 9.0, d: 10.0, e: 10.0
rank0, a: 1.0, b: 2.0, c: 6.0, d: 12.0, e: 12.0
STAGE:2024-07-17 16:24:43 3110614:3110614 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 16:24:43 3110613:3110613 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
rank0, a: 1.0, b: 2.0, c: 6.0, d: 12.0, e: 12.0
rank1, a: 2.0, b: 1.0, c: 9.0, d: 10.0, e: 10.0
rank1, a: 2.0, b: 1.0, c: 9.0, d: 10.0, e: 10.0
rank0, a: 1.0, b: 2.0, c: 6.0, d: 12.0, e: 12.0
rank1, a: 2.0, b: 1.0, c: 9.0, d: 10.0, e: 10.0
rank0, a: 1.0, b: 2.0, c: 6.0, d: 12.0, e: 12.0
STAGE:2024-07-17 16:24:44 3110614:3110614 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 16:24:44 3110613:3110613 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 16:24:44 3110614:3110614 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 16:24:44 3110613:3110613 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
+ set +x
