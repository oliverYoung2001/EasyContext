+ srun -p rag -N 1 --ntasks-per-node=4 --gres=gpu:4 --mem 256G -K -w g3017 -c 16 ./scripts/bench_ring_attn.sh python bench_ring_attn.py
srun: job 7987 queued and waiting for resources
srun: job 7987 has been allocated resources
torch distributed is already initialized, skipping initialization ...
************ Finish sequence pralell group Initialization. ***********
Nh=32, S=32768
# orchestrated_attn_func, fwd
rank0, Out !!!
rank0, cpu out !!!
rank0, sync out !!!
rank3, Out !!!
rank3, cpu out !!!
rank3, sync out !!!
rank1, Out !!!
rank1, cpu out !!!
rank2, Out !!!
rank1, sync out !!!
rank2, cpu out !!!
rank2, sync out !!!
rank1, real out !!!
rank3, real out !!!
rank0, real out !!!
rank2, real out !!!
rank3, Out !!!
rank3, cpu out !!!
rank1, Out !!!
rank2, Out !!!
rank1, cpu out !!!
rank2, cpu out !!!
rank0, Out !!!
rank0, cpu out !!!
rank3, sync out !!!
