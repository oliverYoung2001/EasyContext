+ srun -p hit -N 1 --ntasks-per-node=4 --gres=gpu:4 --mem 256G -K -c 16 ./scripts/bench_ring_attn.sh python bench_ring_attn.py --profiler-with-tensorboard --tb-dir ./tb
srun: job 10373 queued and waiting for resources
srun: job 10373 has been allocated resources
torch distributed is already initialized, skipping initialization ...
************ Finish sequence pralell group Initialization. ***********
Nh=32, S=4096
# orchestrated_attn_func, fwd
Warmup done !!!
STAGE:2024-07-17 21:31:52 1700166:1700166 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:52 1700166:1700166 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:52 1700166:1700166 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:54 1700167:1700167 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:54 1700167:1700167 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:54 1700167:1700167 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:56 1700170:1700170 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:56 1700170:1700170 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:56 1700170:1700170 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:56 1700169:1700169 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:56 1700169:1700169 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:56 1700169:1700169 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
Warmup cudagraph done !!!
STAGE:2024-07-17 21:31:57 1700167:1700167 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:57 1700169:1700169 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:57 1700170:1700170 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
STAGE:2024-07-17 21:31:57 1700166:1700166 ActivityProfilerController.cpp:312] Completed Stage: Warm Up
[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
STAGE:2024-07-17 21:31:57 1700170:1700170 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:57 1700167:1700167 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:57 1700169:1700169 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:57 1700170:1700170 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:57 1700166:1700166 ActivityProfilerController.cpp:318] Completed Stage: Collection
STAGE:2024-07-17 21:31:57 1700167:1700167 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:57 1700169:1700169 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
STAGE:2024-07-17 21:31:57 1700166:1700166 ActivityProfilerController.cpp:322] Completed Stage: Post Processing
mfu: 3.73 Tflops/s, hfu: 3.73 Tflops/s, 108.551 iter/s, (7.794, 0.000, 0.184) sec
+ set +x
