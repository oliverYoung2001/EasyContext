+ export CUDA_DEVICE_MAX_CONNECTIONS=32
+ CUDA_DEVICE_MAX_CONNECTIONS=32
+ srun -p arch -N 1 --ntasks-per-node=8 --gres=gpu:8 --mem 256G -K -w g3027 -c 16 ./scripts/bench_ring_attn.sh python bench_ring_attn.py
srun: job 15808 queued and waiting for resources
srun: job 15808 has been allocated resources
torch distributed is already initialized, skipping initialization ...
************ Finish sequence pralell group Initialization. ***********
Sqs: [256, 512, 768, 1024, 1280, 1536, 1792, 2048, 2560, 3072, 3584, 4096, 5120, 6144, 7168, 8192, 10240, 12288, 14336, 16384, 20480, 24576, 28672, 32768, 40960, 49152, 57344, 65536]
Skvs: [256, 512, 768, 1024, 1280, 1536, 1792, 2048, 2560, 3072, 3584, 4096, 5120, 6144, 7168, 8192, 10240, 12288, 14336, 16384, 20480, 24576, 28672, 32768, 40960, 49152, 57344, 65536]
fob=0, plan_paths: ['/home/zhaijidong/yhy/llm/EasyContext/search_algo/execution_plans/intra_SP8_fob=0/SP=8_fob=0_Y=1_X=8_dim=0.pkl', '/home/zhaijidong/yhy/llm/EasyContext/search_algo/execution_plans/intra_SP8_fob=0/SP=8_fob=0_Y=2_X=4_dim=0.pkl', '/home/zhaijidong/yhy/llm/EasyContext/search_algo/execution_plans/intra_SP8_fob=0/SP=8_fob=0_Y=4_X=2_dim=0.pkl', '/home/zhaijidong/yhy/llm/EasyContext/search_algo/execution_plans/intra_SP8_fob=0/SP=8_fob=0_Y=8_X=1_dim=0.pkl']
SP=(1,8),S=(2048,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.049 Tflops/s, hfu: 0.049 Tflops/s, 366.895 iter/s, 2.726e-03 s/iter, (2.442, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.091 Tflops/s, hfu: 0.091 Tflops/s, 675.602 iter/s, 1.480e-03 s/iter, (0.679, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.043 Tflops/s, hfu: 0.043 Tflops/s, 323.269 iter/s, 3.093e-03 s/iter, (0.053, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 0.799 Tflops/s, hfu: 0.799 Tflops/s, 2976.190 iter/s, 3.360e-04 s/iter, (26.297, 0.000, 0.001) sec
mfu: 1.303 Tflops/s, hfu: 1.303 Tflops/s, 4855.123 iter/s, 2.060e-04 s/iter, (0.091, 0.000, 0.001) sec
mfu: 1.377 Tflops/s, hfu: 1.377 Tflops/s, 5130.942 iter/s, 1.949e-04 s/iter, (0.095, 0.000, 0.001) sec
mfu: 1.417 Tflops/s, hfu: 1.417 Tflops/s, 5280.054 iter/s, 1.894e-04 s/iter, (0.094, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 3.307 Tflops/s, hfu: 3.307 Tflops/s, 12320.126 iter/s, 8.117e-05 s/iter, (2.774, 0.000, 0.000) sec
mfu: 2.561 Tflops/s, hfu: 2.561 Tflops/s, 9539.072 iter/s, 1.048e-04 s/iter, (1.979, 0.000, 0.000) sec
mfu: 2.518 Tflops/s, hfu: 2.518 Tflops/s, 9378.751 iter/s, 1.066e-04 s/iter, (1.990, 0.000, 0.000) sec
mfu: 3.978 Tflops/s, hfu: 3.978 Tflops/s, 14817.449 iter/s, 6.749e-05 s/iter, (0.071, 0.000, 0.000) sec
SP=(1,8),S=(2048,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.099 Tflops/s, hfu: 0.099 Tflops/s, 369.674 iter/s, 2.705e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.181 Tflops/s, hfu: 0.181 Tflops/s, 676.092 iter/s, 1.479e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.087 Tflops/s, hfu: 0.087 Tflops/s, 322.631 iter/s, 3.100e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 1.865 Tflops/s, hfu: 1.865 Tflops/s, 3473.766 iter/s, 2.879e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 2.571 Tflops/s, hfu: 2.571 Tflops/s, 4788.355 iter/s, 2.088e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 2.778 Tflops/s, hfu: 2.778 Tflops/s, 5174.483 iter/s, 1.933e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 2.811 Tflops/s, hfu: 2.811 Tflops/s, 5236.698 iter/s, 1.910e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 6.641 Tflops/s, hfu: 6.641 Tflops/s, 12370.114 iter/s, 8.084e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 5.855 Tflops/s, hfu: 5.855 Tflops/s, 10905.601 iter/s, 9.170e-05 s/iter, (0.073, 0.000, 0.000) sec
mfu: 5.798 Tflops/s, hfu: 5.798 Tflops/s, 10799.136 iter/s, 9.260e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 6.353 Tflops/s, hfu: 6.353 Tflops/s, 11832.639 iter/s, 8.451e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(2048,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.146 Tflops/s, hfu: 0.146 Tflops/s, 363.776 iter/s, 2.749e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.268 Tflops/s, hfu: 0.268 Tflops/s, 665.784 iter/s, 1.502e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.129 Tflops/s, hfu: 0.129 Tflops/s, 320.786 iter/s, 3.117e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 2.731 Tflops/s, hfu: 2.731 Tflops/s, 3391.394 iter/s, 2.949e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 3.771 Tflops/s, hfu: 3.771 Tflops/s, 4682.349 iter/s, 2.136e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 3.905 Tflops/s, hfu: 3.905 Tflops/s, 4848.908 iter/s, 2.062e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 4.181 Tflops/s, hfu: 4.181 Tflops/s, 5191.461 iter/s, 1.926e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 9.756 Tflops/s, hfu: 9.756 Tflops/s, 12114.751 iter/s, 8.254e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 8.728 Tflops/s, hfu: 8.728 Tflops/s, 10838.464 iter/s, 9.226e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 8.134 Tflops/s, hfu: 8.134 Tflops/s, 10101.010 iter/s, 9.900e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 8.31 Tflops/s, hfu: 8.31 Tflops/s, 10318.640 iter/s, 9.691e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(2048,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.195 Tflops/s, hfu: 0.195 Tflops/s, 363.321 iter/s, 2.752e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.36 Tflops/s, hfu: 0.36 Tflops/s, 670.166 iter/s, 1.492e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.171 Tflops/s, hfu: 0.171 Tflops/s, 319.212 iter/s, 3.133e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 3.737 Tflops/s, hfu: 3.737 Tflops/s, 3479.955 iter/s, 2.874e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 5.102 Tflops/s, hfu: 5.102 Tflops/s, 4751.587 iter/s, 2.105e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 5.186 Tflops/s, hfu: 5.186 Tflops/s, 4830.171 iter/s, 2.070e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 5.407 Tflops/s, hfu: 5.407 Tflops/s, 5035.449 iter/s, 1.986e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 12.385 Tflops/s, hfu: 12.385 Tflops/s, 11534.558 iter/s, 8.670e-05 s/iter, (0.073, 0.000, 0.000) sec
mfu: 10.851 Tflops/s, hfu: 10.851 Tflops/s, 10105.909 iter/s, 9.895e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 8.103 Tflops/s, hfu: 8.103 Tflops/s, 7546.486 iter/s, 1.325e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 9.278 Tflops/s, hfu: 9.278 Tflops/s, 8640.354 iter/s, 1.157e-04 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(2048,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.25 Tflops/s, hfu: 0.25 Tflops/s, 372.015 iter/s, 2.688e-03 s/iter, (0.031, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.443 Tflops/s, hfu: 0.443 Tflops/s, 660.375 iter/s, 1.514e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.213 Tflops/s, hfu: 0.213 Tflops/s, 317.473 iter/s, 3.150e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 4.642 Tflops/s, hfu: 4.642 Tflops/s, 3458.676 iter/s, 2.891e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 6.171 Tflops/s, hfu: 6.171 Tflops/s, 4598.124 iter/s, 2.175e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 6.387 Tflops/s, hfu: 6.387 Tflops/s, 4758.823 iter/s, 2.101e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 6.386 Tflops/s, hfu: 6.386 Tflops/s, 4757.736 iter/s, 2.102e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 14.584 Tflops/s, hfu: 14.584 Tflops/s, 10865.786 iter/s, 9.203e-05 s/iter, (0.073, 0.000, 0.000) sec
mfu: 11.437 Tflops/s, hfu: 11.437 Tflops/s, 8521.372 iter/s, 1.174e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 9.768 Tflops/s, hfu: 9.768 Tflops/s, 7278.020 iter/s, 1.374e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 11.299 Tflops/s, hfu: 11.299 Tflops/s, 8418.642 iter/s, 1.188e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(2048,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.296 Tflops/s, hfu: 0.296 Tflops/s, 367.683 iter/s, 2.720e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.53 Tflops/s, hfu: 0.53 Tflops/s, 658.514 iter/s, 1.519e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.255 Tflops/s, hfu: 0.255 Tflops/s, 316.197 iter/s, 3.163e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 5.657 Tflops/s, hfu: 5.657 Tflops/s, 3512.322 iter/s, 2.847e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 7.449 Tflops/s, hfu: 7.449 Tflops/s, 4625.005 iter/s, 2.162e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.728 Tflops/s, hfu: 7.728 Tflops/s, 4798.280 iter/s, 2.084e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.468 Tflops/s, hfu: 7.468 Tflops/s, 4637.015 iter/s, 2.157e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 18.591 Tflops/s, hfu: 18.591 Tflops/s, 11543.079 iter/s, 8.663e-05 s/iter, (0.072, 0.000, 0.000) sec
mfu: 13.99 Tflops/s, hfu: 13.99 Tflops/s, 8685.984 iter/s, 1.151e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 11.253 Tflops/s, hfu: 11.253 Tflops/s, 6986.753 iter/s, 1.431e-04 s/iter, (0.069, 0.001, 0.001) sec
mfu: 12.457 Tflops/s, hfu: 12.457 Tflops/s, 7734.191 iter/s, 1.293e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(2048,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.346 Tflops/s, hfu: 0.346 Tflops/s, 368.109 iter/s, 2.717e-03 s/iter, (0.038, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.617 Tflops/s, hfu: 0.617 Tflops/s, 657.126 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.296 Tflops/s, hfu: 0.296 Tflops/s, 315.578 iter/s, 3.169e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 6.37 Tflops/s, hfu: 6.37 Tflops/s, 3390.106 iter/s, 2.950e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.174 Tflops/s, hfu: 8.174 Tflops/s, 4350.247 iter/s, 2.299e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.341 Tflops/s, hfu: 8.341 Tflops/s, 4438.763 iter/s, 2.253e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.471 Tflops/s, hfu: 8.471 Tflops/s, 4507.916 iter/s, 2.218e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 20.884 Tflops/s, hfu: 20.884 Tflops/s, 11114.075 iter/s, 8.998e-05 s/iter, (0.072, 0.000, 0.000) sec
mfu: 15.504 Tflops/s, hfu: 15.504 Tflops/s, 8250.825 iter/s, 1.212e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 12.711 Tflops/s, hfu: 12.711 Tflops/s, 6764.435 iter/s, 1.478e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.443 Tflops/s, hfu: 13.443 Tflops/s, 7154.304 iter/s, 1.398e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(2048,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.391 Tflops/s, hfu: 0.391 Tflops/s, 363.934 iter/s, 2.748e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.702 Tflops/s, hfu: 0.702 Tflops/s, 653.609 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.338 Tflops/s, hfu: 0.338 Tflops/s, 314.874 iter/s, 3.176e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 7.288 Tflops/s, hfu: 7.288 Tflops/s, 3393.512 iter/s, 2.947e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 9.33 Tflops/s, hfu: 9.33 Tflops/s, 4344.502 iter/s, 2.302e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 9.682 Tflops/s, hfu: 9.682 Tflops/s, 4508.729 iter/s, 2.218e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 9.287 Tflops/s, hfu: 9.287 Tflops/s, 4324.811 iter/s, 2.312e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 22.373 Tflops/s, hfu: 22.373 Tflops/s, 10418.403 iter/s, 9.598e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 16.171 Tflops/s, hfu: 16.171 Tflops/s, 7530.121 iter/s, 1.328e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 14.278 Tflops/s, hfu: 14.278 Tflops/s, 6648.936 iter/s, 1.504e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 14.108 Tflops/s, hfu: 14.108 Tflops/s, 6569.612 iter/s, 1.522e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(2048,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.486 Tflops/s, hfu: 0.486 Tflops/s, 361.938 iter/s, 2.763e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.888 Tflops/s, hfu: 0.888 Tflops/s, 661.327 iter/s, 1.512e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.42 Tflops/s, hfu: 0.42 Tflops/s, 312.870 iter/s, 3.196e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 9.113 Tflops/s, hfu: 9.113 Tflops/s, 3394.710 iter/s, 2.946e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 11.328 Tflops/s, hfu: 11.328 Tflops/s, 4220.122 iter/s, 2.370e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 11.412 Tflops/s, hfu: 11.412 Tflops/s, 4251.411 iter/s, 2.352e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 11.099 Tflops/s, hfu: 11.099 Tflops/s, 4134.692 iter/s, 2.419e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 22.846 Tflops/s, hfu: 22.846 Tflops/s, 8510.928 iter/s, 1.175e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 16.797 Tflops/s, hfu: 16.797 Tflops/s, 6257.196 iter/s, 1.598e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 16.784 Tflops/s, hfu: 16.784 Tflops/s, 6252.501 iter/s, 1.599e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 16.269 Tflops/s, hfu: 16.269 Tflops/s, 6060.606 iter/s, 1.650e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.586 Tflops/s, hfu: 0.586 Tflops/s, 363.557 iter/s, 2.751e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.059 Tflops/s, hfu: 1.059 Tflops/s, 657.450 iter/s, 1.521e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.503 Tflops/s, hfu: 0.503 Tflops/s, 312.545 iter/s, 3.200e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 10.69 Tflops/s, hfu: 10.69 Tflops/s, 3318.731 iter/s, 3.013e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 12.68 Tflops/s, hfu: 12.68 Tflops/s, 3936.512 iter/s, 2.540e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 12.668 Tflops/s, hfu: 12.668 Tflops/s, 3932.796 iter/s, 2.543e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 12.407 Tflops/s, hfu: 12.407 Tflops/s, 3851.486 iter/s, 2.596e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 32.854 Tflops/s, hfu: 32.854 Tflops/s, 10199.086 iter/s, 9.805e-05 s/iter, (0.073, 0.000, 0.000) sec
mfu: 23.952 Tflops/s, hfu: 23.952 Tflops/s, 7435.608 iter/s, 1.345e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 19.238 Tflops/s, hfu: 19.238 Tflops/s, 5972.289 iter/s, 1.674e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 17.277 Tflops/s, hfu: 17.277 Tflops/s, 5363.426 iter/s, 1.864e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.679 Tflops/s, hfu: 0.679 Tflops/s, 361.360 iter/s, 2.767e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.232 Tflops/s, hfu: 1.232 Tflops/s, 655.447 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.584 Tflops/s, hfu: 0.584 Tflops/s, 310.744 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 12.207 Tflops/s, hfu: 12.207 Tflops/s, 3248.187 iter/s, 3.079e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 13.709 Tflops/s, hfu: 13.709 Tflops/s, 3647.931 iter/s, 2.741e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.715 Tflops/s, hfu: 13.715 Tflops/s, 3649.422 iter/s, 2.740e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 13.031 Tflops/s, hfu: 13.031 Tflops/s, 3467.502 iter/s, 2.884e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 39.429 Tflops/s, hfu: 39.429 Tflops/s, 10491.859 iter/s, 9.531e-05 s/iter, (0.071, 0.000, 0.000) sec
mfu: 26.332 Tflops/s, hfu: 26.332 Tflops/s, 7006.726 iter/s, 1.427e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 20.993 Tflops/s, hfu: 20.993 Tflops/s, 5586.093 iter/s, 1.790e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.459 Tflops/s, hfu: 18.459 Tflops/s, 4911.784 iter/s, 2.036e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.777 Tflops/s, hfu: 0.777 Tflops/s, 361.999 iter/s, 2.762e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.408 Tflops/s, hfu: 1.408 Tflops/s, 655.580 iter/s, 1.525e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.67 Tflops/s, hfu: 0.67 Tflops/s, 312.160 iter/s, 3.203e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 13.856 Tflops/s, hfu: 13.856 Tflops/s, 3226.140 iter/s, 3.100e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 15.412 Tflops/s, hfu: 15.412 Tflops/s, 3588.345 iter/s, 2.787e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 15.076 Tflops/s, hfu: 15.076 Tflops/s, 3510.053 iter/s, 2.849e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 14.361 Tflops/s, hfu: 14.361 Tflops/s, 3343.676 iter/s, 2.991e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 40.29 Tflops/s, hfu: 40.29 Tflops/s, 9380.863 iter/s, 1.066e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 27.652 Tflops/s, hfu: 27.652 Tflops/s, 6438.321 iter/s, 1.553e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.974 Tflops/s, hfu: 22.974 Tflops/s, 5348.967 iter/s, 1.870e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 17.151 Tflops/s, hfu: 17.151 Tflops/s, 3993.228 iter/s, 2.504e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.979 Tflops/s, hfu: 0.979 Tflops/s, 364.803 iter/s, 2.741e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.752 Tflops/s, hfu: 1.752 Tflops/s, 652.846 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.845 Tflops/s, hfu: 0.845 Tflops/s, 314.715 iter/s, 3.177e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 17.175 Tflops/s, hfu: 17.175 Tflops/s, 3199.140 iter/s, 3.126e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 17.989 Tflops/s, hfu: 17.989 Tflops/s, 3350.668 iter/s, 2.984e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 17.748 Tflops/s, hfu: 17.748 Tflops/s, 3305.829 iter/s, 3.025e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 16.687 Tflops/s, hfu: 16.687 Tflops/s, 3108.216 iter/s, 3.217e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 47.666 Tflops/s, hfu: 47.666 Tflops/s, 8878.472 iter/s, 1.126e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 31.514 Tflops/s, hfu: 31.514 Tflops/s, 5869.923 iter/s, 1.704e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.738 Tflops/s, hfu: 25.738 Tflops/s, 4794.048 iter/s, 2.086e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.67 Tflops/s, hfu: 18.67 Tflops/s, 3477.632 iter/s, 2.876e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.17 Tflops/s, hfu: 1.17 Tflops/s, 363.140 iter/s, 2.754e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.098 Tflops/s, hfu: 2.098 Tflops/s, 651.335 iter/s, 1.535e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.01 Tflops/s, hfu: 1.01 Tflops/s, 313.528 iter/s, 3.190e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 19.16 Tflops/s, hfu: 19.16 Tflops/s, 2974.066 iter/s, 3.362e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.019 Tflops/s, hfu: 20.019 Tflops/s, 3107.288 iter/s, 3.218e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 19.027 Tflops/s, hfu: 19.027 Tflops/s, 2953.407 iter/s, 3.386e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 17.935 Tflops/s, hfu: 17.935 Tflops/s, 2783.903 iter/s, 3.592e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 53.935 Tflops/s, hfu: 53.935 Tflops/s, 8371.844 iter/s, 1.194e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 36.372 Tflops/s, hfu: 36.372 Tflops/s, 5645.635 iter/s, 1.771e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 27.943 Tflops/s, hfu: 27.943 Tflops/s, 4337.266 iter/s, 2.306e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 20.629 Tflops/s, hfu: 20.629 Tflops/s, 3202.090 iter/s, 3.123e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.36 Tflops/s, hfu: 1.36 Tflops/s, 361.857 iter/s, 2.764e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.46 Tflops/s, hfu: 2.46 Tflops/s, 654.695 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.167 Tflops/s, hfu: 1.167 Tflops/s, 310.506 iter/s, 3.221e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 23.564 Tflops/s, hfu: 23.564 Tflops/s, 3135.032 iter/s, 3.190e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 24.504 Tflops/s, hfu: 24.504 Tflops/s, 3260.217 iter/s, 3.067e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.551 Tflops/s, hfu: 23.551 Tflops/s, 3133.382 iter/s, 3.191e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.45 Tflops/s, hfu: 21.45 Tflops/s, 2853.881 iter/s, 3.504e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 57.211 Tflops/s, hfu: 57.211 Tflops/s, 7611.740 iter/s, 1.314e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.964 Tflops/s, hfu: 39.964 Tflops/s, 5317.113 iter/s, 1.881e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 29.734 Tflops/s, hfu: 29.734 Tflops/s, 3955.946 iter/s, 2.528e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.414 Tflops/s, hfu: 21.414 Tflops/s, 2849.068 iter/s, 3.510e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(2048,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.527 Tflops/s, hfu: 1.527 Tflops/s, 355.600 iter/s, 2.812e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.801 Tflops/s, hfu: 2.801 Tflops/s, 652.272 iter/s, 1.533e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.328 Tflops/s, hfu: 1.328 Tflops/s, 309.314 iter/s, 3.233e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 26.268 Tflops/s, hfu: 26.268 Tflops/s, 3057.954 iter/s, 3.270e-04 s/iter, (0.071, 0.001, 0.001) sec
mfu: 26.848 Tflops/s, hfu: 26.848 Tflops/s, 3125.547 iter/s, 3.199e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 25.955 Tflops/s, hfu: 25.955 Tflops/s, 3021.586 iter/s, 3.310e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.545 Tflops/s, hfu: 22.545 Tflops/s, 2624.617 iter/s, 3.810e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 62.576 Tflops/s, hfu: 62.576 Tflops/s, 7284.807 iter/s, 1.373e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 42.223 Tflops/s, hfu: 42.223 Tflops/s, 4915.454 iter/s, 2.034e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.746 Tflops/s, hfu: 31.746 Tflops/s, 3695.710 iter/s, 2.706e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.402 Tflops/s, hfu: 22.402 Tflops/s, 2607.970 iter/s, 3.834e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(2048,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.909 Tflops/s, hfu: 1.909 Tflops/s, 355.555 iter/s, 2.813e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.474 Tflops/s, hfu: 3.474 Tflops/s, 647.099 iter/s, 1.545e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.67 Tflops/s, hfu: 1.67 Tflops/s, 311.152 iter/s, 3.214e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 31.878 Tflops/s, hfu: 31.878 Tflops/s, 2968.909 iter/s, 3.368e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.535 Tflops/s, hfu: 31.535 Tflops/s, 2936.892 iter/s, 3.405e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 28.724 Tflops/s, hfu: 28.724 Tflops/s, 2675.170 iter/s, 3.738e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.377 Tflops/s, hfu: 23.377 Tflops/s, 2177.169 iter/s, 4.593e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 72.452 Tflops/s, hfu: 72.452 Tflops/s, 6747.638 iter/s, 1.482e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 47.326 Tflops/s, hfu: 47.326 Tflops/s, 4407.616 iter/s, 2.269e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 34.963 Tflops/s, hfu: 34.963 Tflops/s, 3256.226 iter/s, 3.071e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 24.677 Tflops/s, hfu: 24.677 Tflops/s, 2298.217 iter/s, 4.351e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(2048,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.291 Tflops/s, hfu: 2.291 Tflops/s, 355.544 iter/s, 2.813e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.175 Tflops/s, hfu: 4.175 Tflops/s, 647.999 iter/s, 1.543e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.994 Tflops/s, hfu: 1.994 Tflops/s, 309.543 iter/s, 3.231e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 34.955 Tflops/s, hfu: 34.955 Tflops/s, 2712.850 iter/s, 3.686e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.446 Tflops/s, hfu: 35.446 Tflops/s, 2750.941 iter/s, 3.635e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 31.844 Tflops/s, hfu: 31.844 Tflops/s, 2471.381 iter/s, 4.046e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 24.253 Tflops/s, hfu: 24.253 Tflops/s, 1882.303 iter/s, 5.313e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 80.732 Tflops/s, hfu: 80.732 Tflops/s, 6265.664 iter/s, 1.596e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 51.541 Tflops/s, hfu: 51.541 Tflops/s, 4000.128 iter/s, 2.500e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.096 Tflops/s, hfu: 38.096 Tflops/s, 2956.621 iter/s, 3.382e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 25.594 Tflops/s, hfu: 25.594 Tflops/s, 1986.366 iter/s, 5.034e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(2048,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.697 Tflops/s, hfu: 2.697 Tflops/s, 358.831 iter/s, 2.787e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.933 Tflops/s, hfu: 4.933 Tflops/s, 656.370 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.373 Tflops/s, hfu: 2.373 Tflops/s, 315.720 iter/s, 3.167e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 40.789 Tflops/s, hfu: 40.789 Tflops/s, 2713.380 iter/s, 3.685e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 40.623 Tflops/s, hfu: 40.623 Tflops/s, 2702.352 iter/s, 3.700e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.646 Tflops/s, hfu: 36.646 Tflops/s, 2437.835 iter/s, 4.102e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 29.709 Tflops/s, hfu: 29.709 Tflops/s, 1976.347 iter/s, 5.060e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 88.802 Tflops/s, hfu: 88.802 Tflops/s, 5907.372 iter/s, 1.693e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 54.253 Tflops/s, hfu: 54.253 Tflops/s, 3609.066 iter/s, 2.771e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.808 Tflops/s, hfu: 38.808 Tflops/s, 2581.631 iter/s, 3.874e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 26.293 Tflops/s, hfu: 26.293 Tflops/s, 1749.108 iter/s, 5.717e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(2048,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.039 Tflops/s, hfu: 3.039 Tflops/s, 353.814 iter/s, 2.826e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.637 Tflops/s, hfu: 5.637 Tflops/s, 656.190 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.702 Tflops/s, hfu: 2.702 Tflops/s, 314.536 iter/s, 3.179e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 44.478 Tflops/s, hfu: 44.478 Tflops/s, 2588.957 iter/s, 3.863e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 44.747 Tflops/s, hfu: 44.747 Tflops/s, 2604.601 iter/s, 3.839e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 38.51 Tflops/s, hfu: 38.51 Tflops/s, 2241.589 iter/s, 4.461e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 27.672 Tflops/s, hfu: 27.672 Tflops/s, 1610.742 iter/s, 6.208e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 91.522 Tflops/s, hfu: 91.522 Tflops/s, 5327.310 iter/s, 1.877e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 56.735 Tflops/s, hfu: 56.735 Tflops/s, 3302.423 iter/s, 3.028e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 40.64 Tflops/s, hfu: 40.64 Tflops/s, 2365.587 iter/s, 4.227e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 27.259 Tflops/s, hfu: 27.259 Tflops/s, 1586.697 iter/s, 6.302e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(2048,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.8 Tflops/s, hfu: 3.8 Tflops/s, 353.912 iter/s, 2.826e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.02 Tflops/s, hfu: 7.02 Tflops/s, 653.817 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.375 Tflops/s, hfu: 3.375 Tflops/s, 314.306 iter/s, 3.182e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 48.469 Tflops/s, hfu: 48.469 Tflops/s, 2257.010 iter/s, 4.431e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 47.087 Tflops/s, hfu: 47.087 Tflops/s, 2192.636 iter/s, 4.561e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 41.546 Tflops/s, hfu: 41.546 Tflops/s, 1934.655 iter/s, 5.169e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 29.934 Tflops/s, hfu: 29.934 Tflops/s, 1393.907 iter/s, 7.174e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 100.76 Tflops/s, hfu: 100.76 Tflops/s, 4692.016 iter/s, 2.131e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 61.52 Tflops/s, hfu: 61.52 Tflops/s, 2864.738 iter/s, 3.491e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.032 Tflops/s, hfu: 43.032 Tflops/s, 2003.847 iter/s, 4.990e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 27.856 Tflops/s, hfu: 27.856 Tflops/s, 1297.165 iter/s, 7.709e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(2048,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.59 Tflops/s, hfu: 4.59 Tflops/s, 356.239 iter/s, 2.807e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.409 Tflops/s, hfu: 8.409 Tflops/s, 652.627 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.046 Tflops/s, hfu: 4.046 Tflops/s, 314.035 iter/s, 3.184e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 59.948 Tflops/s, hfu: 59.948 Tflops/s, 2326.274 iter/s, 4.299e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 56.78 Tflops/s, hfu: 56.78 Tflops/s, 2203.342 iter/s, 4.539e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 46.244 Tflops/s, hfu: 46.244 Tflops/s, 1794.507 iter/s, 5.573e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 27.875 Tflops/s, hfu: 27.875 Tflops/s, 1081.699 iter/s, 9.245e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 110.486 Tflops/s, hfu: 110.486 Tflops/s, 4287.429 iter/s, 2.332e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 65.864 Tflops/s, hfu: 65.864 Tflops/s, 2555.871 iter/s, 3.913e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 44.869 Tflops/s, hfu: 44.869 Tflops/s, 1741.165 iter/s, 5.743e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 29.15 Tflops/s, hfu: 29.15 Tflops/s, 1131.171 iter/s, 8.840e-04 s/iter, (0.076, 0.000, 0.004) sec
SP=(1,8),S=(2048,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.368 Tflops/s, hfu: 5.368 Tflops/s, 357.071 iter/s, 2.801e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.84 Tflops/s, hfu: 9.84 Tflops/s, 654.583 iter/s, 1.528e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.727 Tflops/s, hfu: 4.727 Tflops/s, 314.453 iter/s, 3.180e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 64.689 Tflops/s, hfu: 64.689 Tflops/s, 2151.648 iter/s, 4.648e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 62.223 Tflops/s, hfu: 62.223 Tflops/s, 2069.639 iter/s, 4.832e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 49.645 Tflops/s, hfu: 49.645 Tflops/s, 1651.255 iter/s, 6.056e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 29.955 Tflops/s, hfu: 29.955 Tflops/s, 996.365 iter/s, 1.004e-03 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 116.148 Tflops/s, hfu: 116.148 Tflops/s, 3863.271 iter/s, 2.588e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 68.287 Tflops/s, hfu: 68.287 Tflops/s, 2271.323 iter/s, 4.403e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 46.406 Tflops/s, hfu: 46.406 Tflops/s, 1543.534 iter/s, 6.479e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 29.468 Tflops/s, hfu: 29.468 Tflops/s, 980.154 iter/s, 1.020e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(2048,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.131 Tflops/s, hfu: 6.131 Tflops/s, 356.895 iter/s, 2.802e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.213 Tflops/s, hfu: 11.213 Tflops/s, 652.683 iter/s, 1.532e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.346 Tflops/s, hfu: 5.346 Tflops/s, 311.174 iter/s, 3.214e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 70.247 Tflops/s, hfu: 70.247 Tflops/s, 2044.455 iter/s, 4.891e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.636 Tflops/s, hfu: 64.636 Tflops/s, 1881.142 iter/s, 5.316e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 53.169 Tflops/s, hfu: 53.169 Tflops/s, 1547.432 iter/s, 6.462e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 31.427 Tflops/s, hfu: 31.427 Tflops/s, 914.659 iter/s, 1.093e-03 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 119.106 Tflops/s, hfu: 119.106 Tflops/s, 3466.445 iter/s, 2.885e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 70.172 Tflops/s, hfu: 70.172 Tflops/s, 2042.283 iter/s, 4.896e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 47.043 Tflops/s, hfu: 47.043 Tflops/s, 1369.128 iter/s, 7.304e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 29.166 Tflops/s, hfu: 29.166 Tflops/s, 848.845 iter/s, 1.178e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(2048,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.524 Tflops/s, hfu: 7.524 Tflops/s, 350.356 iter/s, 2.854e-03 s/iter, (0.040, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.043 Tflops/s, hfu: 14.043 Tflops/s, 653.930 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.718 Tflops/s, hfu: 6.718 Tflops/s, 312.825 iter/s, 3.197e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 77.46 Tflops/s, hfu: 77.46 Tflops/s, 1803.517 iter/s, 5.545e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 72.395 Tflops/s, hfu: 72.395 Tflops/s, 1685.568 iter/s, 5.933e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 52.396 Tflops/s, hfu: 52.396 Tflops/s, 1219.929 iter/s, 8.197e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 30.556 Tflops/s, hfu: 30.556 Tflops/s, 711.436 iter/s, 1.406e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 124.897 Tflops/s, hfu: 124.897 Tflops/s, 2907.991 iter/s, 3.439e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 73.099 Tflops/s, hfu: 73.099 Tflops/s, 1701.977 iter/s, 5.876e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 48.563 Tflops/s, hfu: 48.563 Tflops/s, 1130.700 iter/s, 8.844e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 30.177 Tflops/s, hfu: 30.177 Tflops/s, 702.614 iter/s, 1.423e-03 s/iter, (0.078, 0.000, 0.006) sec
SP=(1,8),S=(2048,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.073 Tflops/s, hfu: 9.073 Tflops/s, 352.085 iter/s, 2.840e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.056 Tflops/s, hfu: 17.056 Tflops/s, 661.854 iter/s, 1.511e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.12 Tflops/s, hfu: 8.12 Tflops/s, 315.080 iter/s, 3.174e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 83.834 Tflops/s, hfu: 83.834 Tflops/s, 1626.588 iter/s, 6.148e-04 s/iter, (0.161, 0.001, 0.002) sec
mfu: 77.446 Tflops/s, hfu: 77.446 Tflops/s, 1502.657 iter/s, 6.655e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 57.947 Tflops/s, hfu: 57.947 Tflops/s, 1124.323 iter/s, 8.894e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 30.782 Tflops/s, hfu: 30.782 Tflops/s, 597.249 iter/s, 1.674e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 129.927 Tflops/s, hfu: 129.927 Tflops/s, 2520.924 iter/s, 3.967e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 76.589 Tflops/s, hfu: 76.589 Tflops/s, 1486.025 iter/s, 6.729e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 50.01 Tflops/s, hfu: 50.01 Tflops/s, 970.331 iter/s, 1.031e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 30.772 Tflops/s, hfu: 30.772 Tflops/s, 597.063 iter/s, 1.675e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(2048,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.571 Tflops/s, hfu: 10.571 Tflops/s, 351.623 iter/s, 2.844e-03 s/iter, (0.036, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.843 Tflops/s, hfu: 19.843 Tflops/s, 659.995 iter/s, 1.515e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 9.493 Tflops/s, hfu: 9.493 Tflops/s, 315.737 iter/s, 3.167e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 91.089 Tflops/s, hfu: 91.089 Tflops/s, 1514.876 iter/s, 6.601e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 82.676 Tflops/s, hfu: 82.676 Tflops/s, 1374.971 iter/s, 7.273e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 60.776 Tflops/s, hfu: 60.776 Tflops/s, 1010.755 iter/s, 9.894e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 33.768 Tflops/s, hfu: 33.768 Tflops/s, 561.588 iter/s, 1.781e-03 s/iter, (0.080, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 137.518 Tflops/s, hfu: 137.518 Tflops/s, 2287.032 iter/s, 4.372e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 77.146 Tflops/s, hfu: 77.146 Tflops/s, 1282.999 iter/s, 7.794e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 50.542 Tflops/s, hfu: 50.542 Tflops/s, 840.545 iter/s, 1.190e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 30.559 Tflops/s, hfu: 30.559 Tflops/s, 508.219 iter/s, 1.968e-03 s/iter, (0.079, 0.000, 0.008) sec
SP=(1,8),S=(2048,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.149 Tflops/s, hfu: 12.149 Tflops/s, 353.578 iter/s, 2.828e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.459 Tflops/s, hfu: 22.459 Tflops/s, 653.629 iter/s, 1.530e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.726 Tflops/s, hfu: 10.726 Tflops/s, 312.181 iter/s, 3.203e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 97.211 Tflops/s, hfu: 97.211 Tflops/s, 1414.603 iter/s, 7.069e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 86.163 Tflops/s, hfu: 86.163 Tflops/s, 1253.837 iter/s, 7.976e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 63.138 Tflops/s, hfu: 63.138 Tflops/s, 918.773 iter/s, 1.088e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 33.561 Tflops/s, hfu: 33.561 Tflops/s, 488.379 iter/s, 2.048e-03 s/iter, (0.079, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 137.178 Tflops/s, hfu: 137.178 Tflops/s, 1996.199 iter/s, 5.010e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 79.064 Tflops/s, hfu: 79.064 Tflops/s, 1150.536 iter/s, 8.692e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 51.326 Tflops/s, hfu: 51.326 Tflops/s, 746.897 iter/s, 1.339e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 31.07 Tflops/s, hfu: 31.07 Tflops/s, 452.134 iter/s, 2.212e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(4096,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.1 Tflops/s, hfu: 0.1 Tflops/s, 371.172 iter/s, 2.694e-03 s/iter, (0.031, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.183 Tflops/s, hfu: 0.183 Tflops/s, 681.929 iter/s, 1.466e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 0.087 Tflops/s, hfu: 0.087 Tflops/s, 324.775 iter/s, 3.079e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 1.686 Tflops/s, hfu: 1.686 Tflops/s, 3140.151 iter/s, 3.185e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 2.443 Tflops/s, hfu: 2.443 Tflops/s, 4550.419 iter/s, 2.198e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 2.677 Tflops/s, hfu: 2.677 Tflops/s, 4986.238 iter/s, 2.006e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 2.731 Tflops/s, hfu: 2.731 Tflops/s, 5087.505 iter/s, 1.966e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 6.073 Tflops/s, hfu: 6.073 Tflops/s, 11312.218 iter/s, 8.840e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 5.977 Tflops/s, hfu: 5.977 Tflops/s, 11133.874 iter/s, 8.982e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 5.974 Tflops/s, hfu: 5.974 Tflops/s, 11126.936 iter/s, 8.987e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 7.644 Tflops/s, hfu: 7.644 Tflops/s, 14238.525 iter/s, 7.023e-05 s/iter, (0.071, 0.000, 0.000) sec
SP=(1,8),S=(4096,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.199 Tflops/s, hfu: 0.199 Tflops/s, 370.074 iter/s, 2.702e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.364 Tflops/s, hfu: 0.364 Tflops/s, 677.621 iter/s, 1.476e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.174 Tflops/s, hfu: 0.174 Tflops/s, 323.252 iter/s, 3.094e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 3.349 Tflops/s, hfu: 3.349 Tflops/s, 3118.607 iter/s, 3.207e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 4.779 Tflops/s, hfu: 4.779 Tflops/s, 4450.616 iter/s, 2.247e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 5.309 Tflops/s, hfu: 5.309 Tflops/s, 4944.425 iter/s, 2.022e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 5.48 Tflops/s, hfu: 5.48 Tflops/s, 5103.707 iter/s, 1.959e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 10.795 Tflops/s, hfu: 10.795 Tflops/s, 10053.889 iter/s, 9.946e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 11.107 Tflops/s, hfu: 11.107 Tflops/s, 10344.257 iter/s, 9.667e-05 s/iter, (0.069, 0.000, 0.000) sec
mfu: 10.526 Tflops/s, hfu: 10.526 Tflops/s, 9803.153 iter/s, 1.020e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 12.036 Tflops/s, hfu: 12.036 Tflops/s, 11209.757 iter/s, 8.921e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(4096,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.296 Tflops/s, hfu: 0.296 Tflops/s, 367.357 iter/s, 2.722e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.544 Tflops/s, hfu: 0.544 Tflops/s, 675.259 iter/s, 1.481e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.26 Tflops/s, hfu: 0.26 Tflops/s, 322.634 iter/s, 3.099e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 4.996 Tflops/s, hfu: 4.996 Tflops/s, 3101.968 iter/s, 3.224e-04 s/iter, (0.118, 0.000, 0.001) sec
mfu: 7.087 Tflops/s, hfu: 7.087 Tflops/s, 4400.169 iter/s, 2.273e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.68 Tflops/s, hfu: 7.68 Tflops/s, 4768.262 iter/s, 2.097e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.87 Tflops/s, hfu: 7.87 Tflops/s, 4886.439 iter/s, 2.046e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 15.665 Tflops/s, hfu: 15.665 Tflops/s, 9726.112 iter/s, 1.028e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 15.59 Tflops/s, hfu: 15.59 Tflops/s, 9679.418 iter/s, 1.033e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 15.555 Tflops/s, hfu: 15.555 Tflops/s, 9657.730 iter/s, 1.035e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 16.273 Tflops/s, hfu: 16.273 Tflops/s, 10103.459 iter/s, 9.898e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(4096,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.394 Tflops/s, hfu: 0.394 Tflops/s, 367.274 iter/s, 2.723e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.718 Tflops/s, hfu: 0.718 Tflops/s, 668.783 iter/s, 1.495e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.345 Tflops/s, hfu: 0.345 Tflops/s, 321.174 iter/s, 3.114e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 6.639 Tflops/s, hfu: 6.639 Tflops/s, 3091.611 iter/s, 3.235e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 9.166 Tflops/s, hfu: 9.166 Tflops/s, 4268.397 iter/s, 2.343e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 9.843 Tflops/s, hfu: 9.843 Tflops/s, 4583.455 iter/s, 2.182e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 10.464 Tflops/s, hfu: 10.464 Tflops/s, 4872.724 iter/s, 2.052e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 20.87 Tflops/s, hfu: 20.87 Tflops/s, 9718.551 iter/s, 1.029e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 20.799 Tflops/s, hfu: 20.799 Tflops/s, 9685.418 iter/s, 1.032e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 15.15 Tflops/s, hfu: 15.15 Tflops/s, 7054.574 iter/s, 1.418e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.001 Tflops/s, hfu: 18.001 Tflops/s, 8382.511 iter/s, 1.193e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(4096,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.498 Tflops/s, hfu: 0.498 Tflops/s, 371.213 iter/s, 2.694e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.897 Tflops/s, hfu: 0.897 Tflops/s, 668.346 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.431 Tflops/s, hfu: 0.431 Tflops/s, 321.236 iter/s, 3.113e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 8.13 Tflops/s, hfu: 8.13 Tflops/s, 3028.614 iter/s, 3.302e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 11.218 Tflops/s, hfu: 11.218 Tflops/s, 4178.925 iter/s, 2.393e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 11.862 Tflops/s, hfu: 11.862 Tflops/s, 4418.991 iter/s, 2.263e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 12.108 Tflops/s, hfu: 12.108 Tflops/s, 4510.518 iter/s, 2.217e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 24.7 Tflops/s, hfu: 24.7 Tflops/s, 9201.325 iter/s, 1.087e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 17.222 Tflops/s, hfu: 17.222 Tflops/s, 6415.521 iter/s, 1.559e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 15.724 Tflops/s, hfu: 15.724 Tflops/s, 5857.819 iter/s, 1.707e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.315 Tflops/s, hfu: 22.315 Tflops/s, 8312.828 iter/s, 1.203e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(4096,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.593 Tflops/s, hfu: 0.593 Tflops/s, 368.443 iter/s, 2.714e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.068 Tflops/s, hfu: 1.068 Tflops/s, 662.948 iter/s, 1.508e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.518 Tflops/s, hfu: 0.518 Tflops/s, 321.891 iter/s, 3.107e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 9.836 Tflops/s, hfu: 9.836 Tflops/s, 3053.547 iter/s, 3.275e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 13.041 Tflops/s, hfu: 13.041 Tflops/s, 4048.452 iter/s, 2.470e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.468 Tflops/s, hfu: 13.468 Tflops/s, 4180.881 iter/s, 2.392e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 14.049 Tflops/s, hfu: 14.049 Tflops/s, 4361.480 iter/s, 2.293e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 30.467 Tflops/s, hfu: 30.467 Tflops/s, 9458.232 iter/s, 1.057e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 23.557 Tflops/s, hfu: 23.557 Tflops/s, 7312.935 iter/s, 1.367e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 20.814 Tflops/s, hfu: 20.814 Tflops/s, 6461.618 iter/s, 1.548e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 23.61 Tflops/s, hfu: 23.61 Tflops/s, 7329.658 iter/s, 1.364e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(4096,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.689 Tflops/s, hfu: 0.689 Tflops/s, 366.807 iter/s, 2.726e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.242 Tflops/s, hfu: 1.242 Tflops/s, 661.041 iter/s, 1.513e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.6 Tflops/s, hfu: 0.6 Tflops/s, 319.181 iter/s, 3.133e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 11.486 Tflops/s, hfu: 11.486 Tflops/s, 3056.459 iter/s, 3.272e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.948 Tflops/s, hfu: 13.948 Tflops/s, 3711.401 iter/s, 2.694e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 14.457 Tflops/s, hfu: 14.457 Tflops/s, 3846.864 iter/s, 2.600e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 15.034 Tflops/s, hfu: 15.034 Tflops/s, 4000.512 iter/s, 2.500e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 31.946 Tflops/s, hfu: 31.946 Tflops/s, 8500.510 iter/s, 1.176e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 26.995 Tflops/s, hfu: 26.995 Tflops/s, 7183.082 iter/s, 1.392e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.089 Tflops/s, hfu: 23.089 Tflops/s, 6143.714 iter/s, 1.628e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 26.206 Tflops/s, hfu: 26.206 Tflops/s, 6973.111 iter/s, 1.434e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(4096,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.784 Tflops/s, hfu: 0.784 Tflops/s, 364.873 iter/s, 2.741e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.409 Tflops/s, hfu: 1.409 Tflops/s, 656.170 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.685 Tflops/s, hfu: 0.685 Tflops/s, 319.108 iter/s, 3.134e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 12.744 Tflops/s, hfu: 12.744 Tflops/s, 2967.148 iter/s, 3.370e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 16.065 Tflops/s, hfu: 16.065 Tflops/s, 3740.387 iter/s, 2.674e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.233 Tflops/s, hfu: 16.233 Tflops/s, 3779.632 iter/s, 2.646e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.802 Tflops/s, hfu: 16.802 Tflops/s, 3912.118 iter/s, 2.556e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 35.818 Tflops/s, hfu: 35.818 Tflops/s, 8339.449 iter/s, 1.199e-04 s/iter, (0.071, 0.000, 0.000) sec
mfu: 29.398 Tflops/s, hfu: 29.398 Tflops/s, 6844.814 iter/s, 1.461e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.973 Tflops/s, hfu: 25.973 Tflops/s, 6047.412 iter/s, 1.654e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 28.048 Tflops/s, hfu: 28.048 Tflops/s, 6530.484 iter/s, 1.531e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(4096,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.975 Tflops/s, hfu: 0.975 Tflops/s, 363.346 iter/s, 2.752e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.787 Tflops/s, hfu: 1.787 Tflops/s, 665.868 iter/s, 1.502e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.821 Tflops/s, hfu: 0.821 Tflops/s, 305.673 iter/s, 3.271e-03 s/iter, (0.036, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 15.867 Tflops/s, hfu: 15.867 Tflops/s, 2955.502 iter/s, 3.384e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 19.172 Tflops/s, hfu: 19.172 Tflops/s, 3571.123 iter/s, 2.800e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 19.652 Tflops/s, hfu: 19.652 Tflops/s, 3660.536 iter/s, 2.732e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.186 Tflops/s, hfu: 20.186 Tflops/s, 3759.964 iter/s, 2.660e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 44.461 Tflops/s, hfu: 44.461 Tflops/s, 8281.437 iter/s, 1.208e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 34.728 Tflops/s, hfu: 34.728 Tflops/s, 6468.640 iter/s, 1.546e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 30.02 Tflops/s, hfu: 30.02 Tflops/s, 5591.590 iter/s, 1.788e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 29.951 Tflops/s, hfu: 29.951 Tflops/s, 5578.863 iter/s, 1.792e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(4096,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.164 Tflops/s, hfu: 1.164 Tflops/s, 361.332 iter/s, 2.768e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.135 Tflops/s, hfu: 2.135 Tflops/s, 662.785 iter/s, 1.509e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.019 Tflops/s, hfu: 1.019 Tflops/s, 316.420 iter/s, 3.160e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 18.822 Tflops/s, hfu: 18.822 Tflops/s, 2921.516 iter/s, 3.423e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.223 Tflops/s, hfu: 22.223 Tflops/s, 3449.513 iter/s, 2.899e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.983 Tflops/s, hfu: 21.983 Tflops/s, 3412.224 iter/s, 2.931e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.524 Tflops/s, hfu: 22.524 Tflops/s, 3496.210 iter/s, 2.860e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 49.339 Tflops/s, hfu: 49.339 Tflops/s, 7658.376 iter/s, 1.306e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.778 Tflops/s, hfu: 38.778 Tflops/s, 6019.165 iter/s, 1.661e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.72 Tflops/s, hfu: 32.72 Tflops/s, 5078.823 iter/s, 1.969e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.852 Tflops/s, hfu: 31.852 Tflops/s, 4944.034 iter/s, 2.023e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(4096,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.321 Tflops/s, hfu: 1.321 Tflops/s, 351.407 iter/s, 2.846e-03 s/iter, (0.041, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.454 Tflops/s, hfu: 2.454 Tflops/s, 652.891 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.172 Tflops/s, hfu: 1.172 Tflops/s, 311.800 iter/s, 3.207e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 22.88 Tflops/s, hfu: 22.88 Tflops/s, 3044.029 iter/s, 3.285e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 25.578 Tflops/s, hfu: 25.578 Tflops/s, 3403.027 iter/s, 2.939e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 25.224 Tflops/s, hfu: 25.224 Tflops/s, 3355.975 iter/s, 2.980e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.929 Tflops/s, hfu: 25.929 Tflops/s, 3449.703 iter/s, 2.899e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 53.9 Tflops/s, hfu: 53.9 Tflops/s, 7171.132 iter/s, 1.394e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.539 Tflops/s, hfu: 43.539 Tflops/s, 5792.669 iter/s, 1.726e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 36.165 Tflops/s, hfu: 36.165 Tflops/s, 4811.579 iter/s, 2.078e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 34.105 Tflops/s, hfu: 34.105 Tflops/s, 4537.535 iter/s, 2.204e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(4096,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.556 Tflops/s, hfu: 1.556 Tflops/s, 362.375 iter/s, 2.760e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.824 Tflops/s, hfu: 2.824 Tflops/s, 657.481 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.344 Tflops/s, hfu: 1.344 Tflops/s, 312.934 iter/s, 3.196e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 25.198 Tflops/s, hfu: 25.198 Tflops/s, 2933.377 iter/s, 3.409e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 28.574 Tflops/s, hfu: 28.574 Tflops/s, 3326.414 iter/s, 3.006e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 28.095 Tflops/s, hfu: 28.095 Tflops/s, 3270.710 iter/s, 3.057e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 27.947 Tflops/s, hfu: 27.947 Tflops/s, 3253.429 iter/s, 3.074e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 57.768 Tflops/s, hfu: 57.768 Tflops/s, 6725.130 iter/s, 1.487e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 46.143 Tflops/s, hfu: 46.143 Tflops/s, 5371.723 iter/s, 1.862e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.727 Tflops/s, hfu: 39.727 Tflops/s, 4624.834 iter/s, 2.162e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.094 Tflops/s, hfu: 32.094 Tflops/s, 3736.250 iter/s, 2.676e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(4096,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.946 Tflops/s, hfu: 1.946 Tflops/s, 362.428 iter/s, 2.759e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.504 Tflops/s, hfu: 3.504 Tflops/s, 652.668 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.682 Tflops/s, hfu: 1.682 Tflops/s, 313.220 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 31.487 Tflops/s, hfu: 31.487 Tflops/s, 2932.482 iter/s, 3.410e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.646 Tflops/s, hfu: 33.646 Tflops/s, 3133.539 iter/s, 3.191e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.125 Tflops/s, hfu: 34.125 Tflops/s, 3178.155 iter/s, 3.146e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 32.671 Tflops/s, hfu: 32.671 Tflops/s, 3042.769 iter/s, 3.286e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 67.422 Tflops/s, hfu: 67.422 Tflops/s, 6279.198 iter/s, 1.593e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 53.048 Tflops/s, hfu: 53.048 Tflops/s, 4940.516 iter/s, 2.024e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.436 Tflops/s, hfu: 43.436 Tflops/s, 4045.308 iter/s, 2.472e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.59 Tflops/s, hfu: 34.59 Tflops/s, 3221.401 iter/s, 3.104e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(4096,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.306 Tflops/s, hfu: 2.306 Tflops/s, 357.932 iter/s, 2.794e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.168 Tflops/s, hfu: 4.168 Tflops/s, 646.890 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.999 Tflops/s, hfu: 1.999 Tflops/s, 310.262 iter/s, 3.223e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 36.616 Tflops/s, hfu: 36.616 Tflops/s, 2841.813 iter/s, 3.519e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 38.912 Tflops/s, hfu: 38.912 Tflops/s, 3019.980 iter/s, 3.311e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.522 Tflops/s, hfu: 37.522 Tflops/s, 2912.124 iter/s, 3.434e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.061 Tflops/s, hfu: 37.061 Tflops/s, 2876.274 iter/s, 3.477e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 74.961 Tflops/s, hfu: 74.961 Tflops/s, 5817.742 iter/s, 1.719e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 57.378 Tflops/s, hfu: 57.378 Tflops/s, 4453.153 iter/s, 2.246e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 48.399 Tflops/s, hfu: 48.399 Tflops/s, 3756.235 iter/s, 2.662e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.37 Tflops/s, hfu: 37.37 Tflops/s, 2900.299 iter/s, 3.448e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(4096,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.711 Tflops/s, hfu: 2.711 Tflops/s, 360.743 iter/s, 2.772e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.872 Tflops/s, hfu: 4.872 Tflops/s, 648.245 iter/s, 1.543e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.324 Tflops/s, hfu: 2.324 Tflops/s, 309.241 iter/s, 3.234e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 41.504 Tflops/s, hfu: 41.504 Tflops/s, 2760.966 iter/s, 3.622e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.131 Tflops/s, hfu: 43.131 Tflops/s, 2869.210 iter/s, 3.485e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 40.74 Tflops/s, hfu: 40.74 Tflops/s, 2710.145 iter/s, 3.690e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 40.731 Tflops/s, hfu: 40.731 Tflops/s, 2709.557 iter/s, 3.691e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 83.273 Tflops/s, hfu: 83.273 Tflops/s, 5539.552 iter/s, 1.805e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 63.889 Tflops/s, hfu: 63.889 Tflops/s, 4250.111 iter/s, 2.353e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 51.357 Tflops/s, hfu: 51.357 Tflops/s, 3416.421 iter/s, 2.927e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 37.868 Tflops/s, hfu: 37.868 Tflops/s, 2519.095 iter/s, 3.970e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(4096,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.05 Tflops/s, hfu: 3.05 Tflops/s, 355.112 iter/s, 2.816e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.556 Tflops/s, hfu: 5.556 Tflops/s, 646.775 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.649 Tflops/s, hfu: 2.649 Tflops/s, 308.442 iter/s, 3.242e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 47.29 Tflops/s, hfu: 47.29 Tflops/s, 2752.637 iter/s, 3.633e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 47.916 Tflops/s, hfu: 47.916 Tflops/s, 2789.058 iter/s, 3.585e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.01 Tflops/s, hfu: 45.01 Tflops/s, 2619.941 iter/s, 3.817e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 41.41 Tflops/s, hfu: 41.41 Tflops/s, 2410.382 iter/s, 4.149e-04 s/iter, (0.070, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 89.118 Tflops/s, hfu: 89.118 Tflops/s, 5187.368 iter/s, 1.928e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 66.434 Tflops/s, hfu: 66.434 Tflops/s, 3866.976 iter/s, 2.586e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 53.306 Tflops/s, hfu: 53.306 Tflops/s, 3102.815 iter/s, 3.223e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.753 Tflops/s, hfu: 39.753 Tflops/s, 2313.915 iter/s, 4.322e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(4096,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.833 Tflops/s, hfu: 3.833 Tflops/s, 356.964 iter/s, 2.801e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.948 Tflops/s, hfu: 6.948 Tflops/s, 647.069 iter/s, 1.545e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.319 Tflops/s, hfu: 3.319 Tflops/s, 309.061 iter/s, 3.236e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 50.692 Tflops/s, hfu: 50.692 Tflops/s, 2360.539 iter/s, 4.236e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 50.025 Tflops/s, hfu: 50.025 Tflops/s, 2329.482 iter/s, 4.293e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 48.999 Tflops/s, hfu: 48.999 Tflops/s, 2281.688 iter/s, 4.383e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 42.243 Tflops/s, hfu: 42.243 Tflops/s, 1967.079 iter/s, 5.084e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 95.58 Tflops/s, hfu: 95.58 Tflops/s, 4450.774 iter/s, 2.247e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 72.203 Tflops/s, hfu: 72.203 Tflops/s, 3362.204 iter/s, 2.974e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.501 Tflops/s, hfu: 58.501 Tflops/s, 2724.143 iter/s, 3.671e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 42.528 Tflops/s, hfu: 42.528 Tflops/s, 1980.355 iter/s, 5.050e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(4096,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.569 Tflops/s, hfu: 4.569 Tflops/s, 354.601 iter/s, 2.820e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.321 Tflops/s, hfu: 8.321 Tflops/s, 645.784 iter/s, 1.549e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.978 Tflops/s, hfu: 3.978 Tflops/s, 308.735 iter/s, 3.239e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 63.161 Tflops/s, hfu: 63.161 Tflops/s, 2450.980 iter/s, 4.080e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 63.069 Tflops/s, hfu: 63.069 Tflops/s, 2447.381 iter/s, 4.086e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.675 Tflops/s, hfu: 58.675 Tflops/s, 2276.909 iter/s, 4.392e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 43.532 Tflops/s, hfu: 43.532 Tflops/s, 1689.258 iter/s, 5.920e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 105.039 Tflops/s, hfu: 105.039 Tflops/s, 4076.043 iter/s, 2.453e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 77.584 Tflops/s, hfu: 77.584 Tflops/s, 3010.670 iter/s, 3.322e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 61.812 Tflops/s, hfu: 61.812 Tflops/s, 2398.634 iter/s, 4.169e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 44.555 Tflops/s, hfu: 44.555 Tflops/s, 1728.979 iter/s, 5.784e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(4096,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.383 Tflops/s, hfu: 5.383 Tflops/s, 358.117 iter/s, 2.792e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.776 Tflops/s, hfu: 9.776 Tflops/s, 650.355 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.738 Tflops/s, hfu: 4.738 Tflops/s, 315.178 iter/s, 3.173e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 68.205 Tflops/s, hfu: 68.205 Tflops/s, 2268.602 iter/s, 4.408e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 67.097 Tflops/s, hfu: 67.097 Tflops/s, 2231.744 iter/s, 4.481e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 62.131 Tflops/s, hfu: 62.131 Tflops/s, 2066.560 iter/s, 4.839e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 45.573 Tflops/s, hfu: 45.573 Tflops/s, 1515.831 iter/s, 6.597e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 107.145 Tflops/s, hfu: 107.145 Tflops/s, 3563.792 iter/s, 2.806e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 81.533 Tflops/s, hfu: 81.533 Tflops/s, 2711.909 iter/s, 3.687e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 64.275 Tflops/s, hfu: 64.275 Tflops/s, 2137.885 iter/s, 4.678e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 45.198 Tflops/s, hfu: 45.198 Tflops/s, 1503.362 iter/s, 6.652e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(4096,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.134 Tflops/s, hfu: 6.134 Tflops/s, 357.038 iter/s, 2.801e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.244 Tflops/s, hfu: 11.244 Tflops/s, 654.501 iter/s, 1.528e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.409 Tflops/s, hfu: 5.409 Tflops/s, 314.871 iter/s, 3.176e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 76.325 Tflops/s, hfu: 76.325 Tflops/s, 2221.353 iter/s, 4.502e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 73.732 Tflops/s, hfu: 73.732 Tflops/s, 2145.886 iter/s, 4.660e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 67.106 Tflops/s, hfu: 67.106 Tflops/s, 1953.034 iter/s, 5.120e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 52.465 Tflops/s, hfu: 52.465 Tflops/s, 1526.941 iter/s, 6.549e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 113.008 Tflops/s, hfu: 113.008 Tflops/s, 3288.954 iter/s, 3.040e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 83.86 Tflops/s, hfu: 83.86 Tflops/s, 2440.644 iter/s, 4.097e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 65.957 Tflops/s, hfu: 65.957 Tflops/s, 1919.592 iter/s, 5.209e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 46.948 Tflops/s, hfu: 46.948 Tflops/s, 1366.359 iter/s, 7.319e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(4096,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.623 Tflops/s, hfu: 7.623 Tflops/s, 354.988 iter/s, 2.817e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.032 Tflops/s, hfu: 14.032 Tflops/s, 653.410 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.712 Tflops/s, hfu: 6.712 Tflops/s, 312.530 iter/s, 3.200e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 84.247 Tflops/s, hfu: 84.247 Tflops/s, 1961.523 iter/s, 5.098e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.806 Tflops/s, hfu: 79.806 Tflops/s, 1858.128 iter/s, 5.382e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.825 Tflops/s, hfu: 71.825 Tflops/s, 1672.308 iter/s, 5.980e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 54.096 Tflops/s, hfu: 54.096 Tflops/s, 1259.509 iter/s, 7.940e-04 s/iter, (0.077, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 119.387 Tflops/s, hfu: 119.387 Tflops/s, 2779.693 iter/s, 3.598e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 88.159 Tflops/s, hfu: 88.159 Tflops/s, 2052.613 iter/s, 4.872e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 68.813 Tflops/s, hfu: 68.813 Tflops/s, 1602.174 iter/s, 6.242e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 47.475 Tflops/s, hfu: 47.475 Tflops/s, 1105.353 iter/s, 9.047e-04 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(4096,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.165 Tflops/s, hfu: 9.165 Tflops/s, 355.654 iter/s, 2.812e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.743 Tflops/s, hfu: 16.743 Tflops/s, 649.711 iter/s, 1.539e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.987 Tflops/s, hfu: 7.987 Tflops/s, 309.949 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 87.707 Tflops/s, hfu: 87.707 Tflops/s, 1701.745 iter/s, 5.876e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.872 Tflops/s, hfu: 84.872 Tflops/s, 1646.730 iter/s, 6.073e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 75.196 Tflops/s, hfu: 75.196 Tflops/s, 1458.985 iter/s, 6.854e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 57.286 Tflops/s, hfu: 57.286 Tflops/s, 1111.496 iter/s, 8.997e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 126.135 Tflops/s, hfu: 126.135 Tflops/s, 2447.333 iter/s, 4.086e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 93.624 Tflops/s, hfu: 93.624 Tflops/s, 1816.544 iter/s, 5.505e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 71.755 Tflops/s, hfu: 71.755 Tflops/s, 1392.230 iter/s, 7.183e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 49.829 Tflops/s, hfu: 49.829 Tflops/s, 966.819 iter/s, 1.034e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(4096,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.652 Tflops/s, hfu: 10.652 Tflops/s, 354.294 iter/s, 2.823e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.478 Tflops/s, hfu: 19.478 Tflops/s, 647.869 iter/s, 1.544e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.328 Tflops/s, hfu: 9.328 Tflops/s, 310.273 iter/s, 3.223e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 95.598 Tflops/s, hfu: 95.598 Tflops/s, 1589.866 iter/s, 6.290e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.057 Tflops/s, hfu: 93.057 Tflops/s, 1547.604 iter/s, 6.462e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 80.192 Tflops/s, hfu: 80.192 Tflops/s, 1333.646 iter/s, 7.498e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 57.527 Tflops/s, hfu: 57.527 Tflops/s, 956.725 iter/s, 1.045e-03 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 130.623 Tflops/s, hfu: 130.623 Tflops/s, 2172.364 iter/s, 4.603e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 95.77 Tflops/s, hfu: 95.77 Tflops/s, 1592.722 iter/s, 6.279e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 73.374 Tflops/s, hfu: 73.374 Tflops/s, 1220.262 iter/s, 8.195e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 49.868 Tflops/s, hfu: 49.868 Tflops/s, 829.347 iter/s, 1.206e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(4096,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.188 Tflops/s, hfu: 12.188 Tflops/s, 354.730 iter/s, 2.819e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.627 Tflops/s, hfu: 22.627 Tflops/s, 658.519 iter/s, 1.519e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 10.844 Tflops/s, hfu: 10.844 Tflops/s, 315.594 iter/s, 3.169e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 101.636 Tflops/s, hfu: 101.636 Tflops/s, 1478.992 iter/s, 6.761e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 96.145 Tflops/s, hfu: 96.145 Tflops/s, 1399.087 iter/s, 7.148e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 81.46 Tflops/s, hfu: 81.46 Tflops/s, 1185.396 iter/s, 8.436e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 63.837 Tflops/s, hfu: 63.837 Tflops/s, 928.947 iter/s, 1.076e-03 s/iter, (0.075, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 133.124 Tflops/s, hfu: 133.124 Tflops/s, 1937.204 iter/s, 5.162e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 97.767 Tflops/s, hfu: 97.767 Tflops/s, 1422.702 iter/s, 7.029e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 73.675 Tflops/s, hfu: 73.675 Tflops/s, 1072.106 iter/s, 9.327e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 49.288 Tflops/s, hfu: 49.288 Tflops/s, 717.237 iter/s, 1.394e-03 s/iter, (0.079, 0.000, 0.006) sec
SP=(1,8),S=(4096,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.351 Tflops/s, hfu: 15.351 Tflops/s, 357.415 iter/s, 2.798e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.268 Tflops/s, hfu: 27.268 Tflops/s, 634.890 iter/s, 1.575e-03 s/iter, (0.019, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 12.976 Tflops/s, hfu: 12.976 Tflops/s, 302.125 iter/s, 3.310e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 109.563 Tflops/s, hfu: 109.563 Tflops/s, 1275.484 iter/s, 7.840e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.668 Tflops/s, hfu: 101.668 Tflops/s, 1183.566 iter/s, 8.449e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 87.875 Tflops/s, hfu: 87.875 Tflops/s, 1023.005 iter/s, 9.775e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 57.36 Tflops/s, hfu: 57.36 Tflops/s, 667.760 iter/s, 1.498e-03 s/iter, (0.078, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 139.465 Tflops/s, hfu: 139.465 Tflops/s, 1623.587 iter/s, 6.159e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.809 Tflops/s, hfu: 100.809 Tflops/s, 1173.566 iter/s, 8.521e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 76.182 Tflops/s, hfu: 76.182 Tflops/s, 886.877 iter/s, 1.128e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 50.785 Tflops/s, hfu: 50.785 Tflops/s, 591.221 iter/s, 1.691e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(4096,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.468 Tflops/s, hfu: 18.468 Tflops/s, 358.327 iter/s, 2.791e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 32.735 Tflops/s, hfu: 32.735 Tflops/s, 635.135 iter/s, 1.574e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 15.695 Tflops/s, hfu: 15.695 Tflops/s, 304.519 iter/s, 3.284e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 114.244 Tflops/s, hfu: 114.244 Tflops/s, 1108.313 iter/s, 9.023e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 106.026 Tflops/s, hfu: 106.026 Tflops/s, 1028.586 iter/s, 9.722e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 91.473 Tflops/s, hfu: 91.473 Tflops/s, 887.406 iter/s, 1.127e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 58.97 Tflops/s, hfu: 58.97 Tflops/s, 572.082 iter/s, 1.748e-03 s/iter, (0.078, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 143.676 Tflops/s, hfu: 143.676 Tflops/s, 1393.845 iter/s, 7.174e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.929 Tflops/s, hfu: 103.929 Tflops/s, 1008.243 iter/s, 9.918e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 77.488 Tflops/s, hfu: 77.488 Tflops/s, 751.735 iter/s, 1.330e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 51.541 Tflops/s, hfu: 51.541 Tflops/s, 500.012 iter/s, 2.000e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(4096,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.367 Tflops/s, hfu: 21.367 Tflops/s, 355.355 iter/s, 2.814e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.261 Tflops/s, hfu: 38.261 Tflops/s, 636.310 iter/s, 1.572e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.209 Tflops/s, hfu: 18.209 Tflops/s, 302.826 iter/s, 3.302e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 115.805 Tflops/s, hfu: 115.805 Tflops/s, 962.961 iter/s, 1.038e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.98 Tflops/s, hfu: 110.98 Tflops/s, 922.843 iter/s, 1.084e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 91.568 Tflops/s, hfu: 91.568 Tflops/s, 761.424 iter/s, 1.313e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 58.237 Tflops/s, hfu: 58.237 Tflops/s, 484.265 iter/s, 2.065e-03 s/iter, (0.081, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 147.045 Tflops/s, hfu: 147.045 Tflops/s, 1222.733 iter/s, 8.178e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 105.354 Tflops/s, hfu: 105.354 Tflops/s, 876.056 iter/s, 1.141e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 78.049 Tflops/s, hfu: 78.049 Tflops/s, 649.003 iter/s, 1.541e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 51.306 Tflops/s, hfu: 51.306 Tflops/s, 426.631 iter/s, 2.344e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(4096,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.428 Tflops/s, hfu: 24.428 Tflops/s, 355.474 iter/s, 2.813e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.331 Tflops/s, hfu: 43.331 Tflops/s, 630.542 iter/s, 1.586e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 20.777 Tflops/s, hfu: 20.777 Tflops/s, 302.344 iter/s, 3.307e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 120.613 Tflops/s, hfu: 120.613 Tflops/s, 877.575 iter/s, 1.140e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 114.487 Tflops/s, hfu: 114.487 Tflops/s, 833.006 iter/s, 1.200e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 96.068 Tflops/s, hfu: 96.068 Tflops/s, 698.988 iter/s, 1.431e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 59.18 Tflops/s, hfu: 59.18 Tflops/s, 430.593 iter/s, 2.322e-03 s/iter, (0.083, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 149.473 Tflops/s, hfu: 149.473 Tflops/s, 1087.562 iter/s, 9.195e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 106.716 Tflops/s, hfu: 106.716 Tflops/s, 776.460 iter/s, 1.288e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 79.436 Tflops/s, hfu: 79.436 Tflops/s, 577.973 iter/s, 1.730e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 52.062 Tflops/s, hfu: 52.062 Tflops/s, 378.798 iter/s, 2.640e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(6144,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.148 Tflops/s, hfu: 0.148 Tflops/s, 368.586 iter/s, 2.713e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.265 Tflops/s, hfu: 0.265 Tflops/s, 657.450 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.126 Tflops/s, hfu: 0.126 Tflops/s, 311.939 iter/s, 3.206e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 2.484 Tflops/s, hfu: 2.484 Tflops/s, 3084.363 iter/s, 3.242e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 3.495 Tflops/s, hfu: 3.495 Tflops/s, 4339.976 iter/s, 2.304e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 3.966 Tflops/s, hfu: 3.966 Tflops/s, 4924.556 iter/s, 2.031e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 4.23 Tflops/s, hfu: 4.23 Tflops/s, 5253.205 iter/s, 1.904e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 8.221 Tflops/s, hfu: 8.221 Tflops/s, 10209.082 iter/s, 9.795e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 8.078 Tflops/s, hfu: 8.078 Tflops/s, 10030.493 iter/s, 9.970e-05 s/iter, (0.072, 0.000, 0.000) sec
mfu: 8.64 Tflops/s, hfu: 8.64 Tflops/s, 10728.693 iter/s, 9.321e-05 s/iter, (0.069, 0.000, 0.000) sec
mfu: 10.053 Tflops/s, hfu: 10.053 Tflops/s, 12483.771 iter/s, 8.010e-05 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(6144,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.297 Tflops/s, hfu: 0.297 Tflops/s, 368.688 iter/s, 2.712e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.528 Tflops/s, hfu: 0.528 Tflops/s, 655.596 iter/s, 1.525e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.249 Tflops/s, hfu: 0.249 Tflops/s, 309.011 iter/s, 3.236e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 4.993 Tflops/s, hfu: 4.993 Tflops/s, 3100.352 iter/s, 3.225e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 7.124 Tflops/s, hfu: 7.124 Tflops/s, 4423.370 iter/s, 2.261e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.924 Tflops/s, hfu: 7.924 Tflops/s, 4919.710 iter/s, 2.033e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.243 Tflops/s, hfu: 8.243 Tflops/s, 5118.126 iter/s, 1.954e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 16.125 Tflops/s, hfu: 16.125 Tflops/s, 10012.014 iter/s, 9.988e-05 s/iter, (0.074, 0.000, 0.000) sec
mfu: 14.819 Tflops/s, hfu: 14.819 Tflops/s, 9200.648 iter/s, 1.087e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 16.202 Tflops/s, hfu: 16.202 Tflops/s, 10059.552 iter/s, 9.941e-05 s/iter, (0.070, 0.000, 0.000) sec
mfu: 19.004 Tflops/s, hfu: 19.004 Tflops/s, 11799.132 iter/s, 8.475e-05 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(6144,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.437 Tflops/s, hfu: 0.437 Tflops/s, 362.037 iter/s, 2.762e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.787 Tflops/s, hfu: 0.787 Tflops/s, 651.563 iter/s, 1.535e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.377 Tflops/s, hfu: 0.377 Tflops/s, 311.691 iter/s, 3.208e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 7.402 Tflops/s, hfu: 7.402 Tflops/s, 3063.951 iter/s, 3.264e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 10.039 Tflops/s, hfu: 10.039 Tflops/s, 4155.170 iter/s, 2.407e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 11.167 Tflops/s, hfu: 11.167 Tflops/s, 4622.097 iter/s, 2.164e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 11.583 Tflops/s, hfu: 11.583 Tflops/s, 4794.416 iter/s, 2.086e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 21.612 Tflops/s, hfu: 21.612 Tflops/s, 8945.824 iter/s, 1.118e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 20.928 Tflops/s, hfu: 20.928 Tflops/s, 8662.509 iter/s, 1.154e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 21.941 Tflops/s, hfu: 21.941 Tflops/s, 9081.662 iter/s, 1.101e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 21.833 Tflops/s, hfu: 21.833 Tflops/s, 9037.016 iter/s, 1.107e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(6144,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.597 Tflops/s, hfu: 0.597 Tflops/s, 370.463 iter/s, 2.699e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.054 Tflops/s, hfu: 1.054 Tflops/s, 654.190 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.499 Tflops/s, hfu: 0.499 Tflops/s, 309.625 iter/s, 3.230e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 9.826 Tflops/s, hfu: 9.826 Tflops/s, 3050.343 iter/s, 3.278e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.397 Tflops/s, hfu: 13.397 Tflops/s, 4158.903 iter/s, 2.404e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.979 Tflops/s, hfu: 13.979 Tflops/s, 4339.675 iter/s, 2.304e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 14.692 Tflops/s, hfu: 14.692 Tflops/s, 4560.878 iter/s, 2.193e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 28.396 Tflops/s, hfu: 28.396 Tflops/s, 8815.233 iter/s, 1.134e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 26.964 Tflops/s, hfu: 26.964 Tflops/s, 8370.723 iter/s, 1.195e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 20.957 Tflops/s, hfu: 20.957 Tflops/s, 6506.011 iter/s, 1.537e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 26.177 Tflops/s, hfu: 26.177 Tflops/s, 8126.381 iter/s, 1.231e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(6144,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.72 Tflops/s, hfu: 0.72 Tflops/s, 357.691 iter/s, 2.796e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.304 Tflops/s, hfu: 1.304 Tflops/s, 647.624 iter/s, 1.544e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.627 Tflops/s, hfu: 0.627 Tflops/s, 311.492 iter/s, 3.210e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 11.967 Tflops/s, hfu: 11.967 Tflops/s, 2972.015 iter/s, 3.365e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 14.72 Tflops/s, hfu: 14.72 Tflops/s, 3655.719 iter/s, 2.735e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 15.856 Tflops/s, hfu: 15.856 Tflops/s, 3937.876 iter/s, 2.539e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.836 Tflops/s, hfu: 16.836 Tflops/s, 4181.161 iter/s, 2.392e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 33.293 Tflops/s, hfu: 33.293 Tflops/s, 8268.289 iter/s, 1.209e-04 s/iter, (0.073, 0.000, 0.000) sec
mfu: 29.742 Tflops/s, hfu: 29.742 Tflops/s, 7386.398 iter/s, 1.354e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 25.158 Tflops/s, hfu: 25.158 Tflops/s, 6248.126 iter/s, 1.600e-04 s/iter, (0.070, 0.001, 0.001) sec
mfu: 31.689 Tflops/s, hfu: 31.689 Tflops/s, 7870.049 iter/s, 1.271e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(6144,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.882 Tflops/s, hfu: 0.882 Tflops/s, 365.260 iter/s, 2.738e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.552 Tflops/s, hfu: 1.552 Tflops/s, 642.426 iter/s, 1.557e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.752 Tflops/s, hfu: 0.752 Tflops/s, 311.087 iter/s, 3.215e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 14.054 Tflops/s, hfu: 14.054 Tflops/s, 2908.668 iter/s, 3.438e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.339 Tflops/s, hfu: 18.339 Tflops/s, 3795.470 iter/s, 2.635e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 18.464 Tflops/s, hfu: 18.464 Tflops/s, 3821.345 iter/s, 2.617e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 19.461 Tflops/s, hfu: 19.461 Tflops/s, 4027.581 iter/s, 2.483e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 38.331 Tflops/s, hfu: 38.331 Tflops/s, 7932.982 iter/s, 1.261e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.26 Tflops/s, hfu: 32.26 Tflops/s, 6676.637 iter/s, 1.498e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 28.561 Tflops/s, hfu: 28.561 Tflops/s, 5911.004 iter/s, 1.692e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.298 Tflops/s, hfu: 32.298 Tflops/s, 6684.492 iter/s, 1.496e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(6144,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.029 Tflops/s, hfu: 1.029 Tflops/s, 364.922 iter/s, 2.740e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.803 Tflops/s, hfu: 1.803 Tflops/s, 639.707 iter/s, 1.563e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.869 Tflops/s, hfu: 0.869 Tflops/s, 308.243 iter/s, 3.244e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 17.025 Tflops/s, hfu: 17.025 Tflops/s, 3020.126 iter/s, 3.311e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 20.227 Tflops/s, hfu: 20.227 Tflops/s, 3588.242 iter/s, 2.787e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.467 Tflops/s, hfu: 21.467 Tflops/s, 3808.073 iter/s, 2.626e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.948 Tflops/s, hfu: 21.948 Tflops/s, 3893.475 iter/s, 2.568e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 42.945 Tflops/s, hfu: 42.945 Tflops/s, 7618.235 iter/s, 1.313e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 37.97 Tflops/s, hfu: 37.97 Tflops/s, 6735.640 iter/s, 1.485e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 31.649 Tflops/s, hfu: 31.649 Tflops/s, 5614.445 iter/s, 1.781e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 35.495 Tflops/s, hfu: 35.495 Tflops/s, 6296.595 iter/s, 1.588e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(6144,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.174 Tflops/s, hfu: 1.174 Tflops/s, 364.336 iter/s, 2.745e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.06 Tflops/s, hfu: 2.06 Tflops/s, 639.376 iter/s, 1.564e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.996 Tflops/s, hfu: 0.996 Tflops/s, 309.302 iter/s, 3.233e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 18.894 Tflops/s, hfu: 18.894 Tflops/s, 2932.758 iter/s, 3.410e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.646 Tflops/s, hfu: 22.646 Tflops/s, 3515.185 iter/s, 2.845e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 23.263 Tflops/s, hfu: 23.263 Tflops/s, 3610.943 iter/s, 2.769e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 24.109 Tflops/s, hfu: 24.109 Tflops/s, 3742.179 iter/s, 2.672e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 47.892 Tflops/s, hfu: 47.892 Tflops/s, 7433.839 iter/s, 1.345e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 40.439 Tflops/s, hfu: 40.439 Tflops/s, 6276.991 iter/s, 1.593e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.698 Tflops/s, hfu: 33.698 Tflops/s, 5230.563 iter/s, 1.912e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 37.79 Tflops/s, hfu: 37.79 Tflops/s, 5865.791 iter/s, 1.705e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(6144,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.449 Tflops/s, hfu: 1.449 Tflops/s, 359.828 iter/s, 2.779e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.598 Tflops/s, hfu: 2.598 Tflops/s, 645.104 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.228 Tflops/s, hfu: 1.228 Tflops/s, 305.099 iter/s, 3.278e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 23.765 Tflops/s, hfu: 23.765 Tflops/s, 2951.106 iter/s, 3.389e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.674 Tflops/s, hfu: 26.674 Tflops/s, 3312.223 iter/s, 3.019e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 27.424 Tflops/s, hfu: 27.424 Tflops/s, 3405.438 iter/s, 2.936e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 29.256 Tflops/s, hfu: 29.256 Tflops/s, 3632.876 iter/s, 2.753e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 56.457 Tflops/s, hfu: 56.457 Tflops/s, 7010.656 iter/s, 1.426e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 46.636 Tflops/s, hfu: 46.636 Tflops/s, 5791.058 iter/s, 1.727e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 41.094 Tflops/s, hfu: 41.094 Tflops/s, 5102.874 iter/s, 1.960e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 41.579 Tflops/s, hfu: 41.579 Tflops/s, 5163.156 iter/s, 1.937e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(6144,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.745 Tflops/s, hfu: 1.745 Tflops/s, 361.237 iter/s, 2.768e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.096 Tflops/s, hfu: 3.096 Tflops/s, 640.748 iter/s, 1.561e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.474 Tflops/s, hfu: 1.474 Tflops/s, 305.029 iter/s, 3.278e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 27.957 Tflops/s, hfu: 27.957 Tflops/s, 2892.983 iter/s, 3.457e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 32.496 Tflops/s, hfu: 32.496 Tflops/s, 3362.656 iter/s, 2.974e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.911 Tflops/s, hfu: 32.911 Tflops/s, 3405.623 iter/s, 2.936e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.002 Tflops/s, hfu: 33.002 Tflops/s, 3415.021 iter/s, 2.928e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 65.973 Tflops/s, hfu: 65.973 Tflops/s, 6826.871 iter/s, 1.465e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 51.25 Tflops/s, hfu: 51.25 Tflops/s, 5303.352 iter/s, 1.886e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 46.724 Tflops/s, hfu: 46.724 Tflops/s, 4835.029 iter/s, 2.068e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 44.238 Tflops/s, hfu: 44.238 Tflops/s, 4577.749 iter/s, 2.184e-04 s/iter, (0.080, 0.000, 0.001) sec
SP=(1,8),S=(6144,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.041 Tflops/s, hfu: 2.041 Tflops/s, 362.071 iter/s, 2.762e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.694 Tflops/s, hfu: 3.694 Tflops/s, 655.278 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.756 Tflops/s, hfu: 1.756 Tflops/s, 311.446 iter/s, 3.211e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 33.406 Tflops/s, hfu: 33.406 Tflops/s, 2962.998 iter/s, 3.375e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.509 Tflops/s, hfu: 35.509 Tflops/s, 3149.567 iter/s, 3.175e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.702 Tflops/s, hfu: 35.702 Tflops/s, 3166.641 iter/s, 3.158e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.053 Tflops/s, hfu: 36.053 Tflops/s, 3197.830 iter/s, 3.127e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 68.907 Tflops/s, hfu: 68.907 Tflops/s, 6111.872 iter/s, 1.636e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.069 Tflops/s, hfu: 58.069 Tflops/s, 5150.604 iter/s, 1.942e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 49.759 Tflops/s, hfu: 49.759 Tflops/s, 4413.530 iter/s, 2.266e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 47.904 Tflops/s, hfu: 47.904 Tflops/s, 4248.955 iter/s, 2.354e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(6144,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.317 Tflops/s, hfu: 2.317 Tflops/s, 359.596 iter/s, 2.781e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.214 Tflops/s, hfu: 4.214 Tflops/s, 654.169 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.025 Tflops/s, hfu: 2.025 Tflops/s, 314.398 iter/s, 3.181e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 37.842 Tflops/s, hfu: 37.842 Tflops/s, 2936.961 iter/s, 3.405e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.361 Tflops/s, hfu: 39.361 Tflops/s, 3054.816 iter/s, 3.274e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.718 Tflops/s, hfu: 39.718 Tflops/s, 3082.538 iter/s, 3.244e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.888 Tflops/s, hfu: 38.888 Tflops/s, 3018.084 iter/s, 3.313e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 74.965 Tflops/s, hfu: 74.965 Tflops/s, 5818.012 iter/s, 1.719e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 61.352 Tflops/s, hfu: 61.352 Tflops/s, 4761.542 iter/s, 2.100e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 54.97 Tflops/s, hfu: 54.97 Tflops/s, 4266.211 iter/s, 2.344e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.45 Tflops/s, hfu: 43.45 Tflops/s, 3372.181 iter/s, 2.965e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(6144,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.915 Tflops/s, hfu: 2.915 Tflops/s, 361.985 iter/s, 2.763e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.273 Tflops/s, hfu: 5.273 Tflops/s, 654.792 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.549 Tflops/s, hfu: 2.549 Tflops/s, 316.555 iter/s, 3.159e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 44.901 Tflops/s, hfu: 44.901 Tflops/s, 2787.814 iter/s, 3.587e-04 s/iter, (0.071, 0.001, 0.001) sec
mfu: 47.506 Tflops/s, hfu: 47.506 Tflops/s, 2949.574 iter/s, 3.390e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 47.348 Tflops/s, hfu: 47.348 Tflops/s, 2939.724 iter/s, 3.402e-04 s/iter, (0.071, 0.001, 0.001) sec
mfu: 45.905 Tflops/s, hfu: 45.905 Tflops/s, 2850.172 iter/s, 3.509e-04 s/iter, (0.153, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 83.227 Tflops/s, hfu: 83.227 Tflops/s, 5167.425 iter/s, 1.935e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 66.995 Tflops/s, hfu: 66.995 Tflops/s, 4159.595 iter/s, 2.404e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 58.29 Tflops/s, hfu: 58.29 Tflops/s, 3619.097 iter/s, 2.763e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 46.31 Tflops/s, hfu: 46.31 Tflops/s, 2875.282 iter/s, 3.478e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(6144,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.443 Tflops/s, hfu: 3.443 Tflops/s, 356.240 iter/s, 2.807e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.285 Tflops/s, hfu: 6.285 Tflops/s, 650.375 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.036 Tflops/s, hfu: 3.036 Tflops/s, 314.174 iter/s, 3.183e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 52.706 Tflops/s, hfu: 52.706 Tflops/s, 2726.995 iter/s, 3.667e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 54.076 Tflops/s, hfu: 54.076 Tflops/s, 2797.923 iter/s, 3.574e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 52.27 Tflops/s, hfu: 52.27 Tflops/s, 2704.457 iter/s, 3.698e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 49.612 Tflops/s, hfu: 49.612 Tflops/s, 2566.946 iter/s, 3.896e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 90.698 Tflops/s, hfu: 90.698 Tflops/s, 4692.721 iter/s, 2.131e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 74.815 Tflops/s, hfu: 74.815 Tflops/s, 3870.928 iter/s, 2.583e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 63.028 Tflops/s, hfu: 63.028 Tflops/s, 3261.068 iter/s, 3.066e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.173 Tflops/s, hfu: 50.173 Tflops/s, 2595.946 iter/s, 3.852e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(6144,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.977 Tflops/s, hfu: 3.977 Tflops/s, 352.784 iter/s, 2.835e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.383 Tflops/s, hfu: 7.383 Tflops/s, 654.823 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.522 Tflops/s, hfu: 3.522 Tflops/s, 312.389 iter/s, 3.201e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 54.3 Tflops/s, hfu: 54.3 Tflops/s, 2408.153 iter/s, 4.153e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 55.976 Tflops/s, hfu: 55.976 Tflops/s, 2482.474 iter/s, 4.028e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 55.42 Tflops/s, hfu: 55.42 Tflops/s, 2457.824 iter/s, 4.069e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 51.101 Tflops/s, hfu: 51.101 Tflops/s, 2266.258 iter/s, 4.413e-04 s/iter, (0.112, 0.001, 0.002) sec
# orchestrated_attn_func fused
mfu: 98.995 Tflops/s, hfu: 98.995 Tflops/s, 4390.278 iter/s, 2.278e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 80.196 Tflops/s, hfu: 80.196 Tflops/s, 3556.592 iter/s, 2.812e-04 s/iter, (0.079, 0.000, 0.001) sec
mfu: 65.975 Tflops/s, hfu: 65.975 Tflops/s, 2925.893 iter/s, 3.418e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 51.551 Tflops/s, hfu: 51.551 Tflops/s, 2286.237 iter/s, 4.374e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(6144,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.654 Tflops/s, hfu: 4.654 Tflops/s, 361.193 iter/s, 2.769e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.349 Tflops/s, hfu: 8.349 Tflops/s, 647.944 iter/s, 1.543e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.004 Tflops/s, hfu: 4.004 Tflops/s, 310.743 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 65.2 Tflops/s, hfu: 65.2 Tflops/s, 2530.108 iter/s, 3.952e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 65.876 Tflops/s, hfu: 65.876 Tflops/s, 2556.342 iter/s, 3.912e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 62.961 Tflops/s, hfu: 62.961 Tflops/s, 2443.219 iter/s, 4.093e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 53.256 Tflops/s, hfu: 53.256 Tflops/s, 2066.594 iter/s, 4.839e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 103.407 Tflops/s, hfu: 103.407 Tflops/s, 4012.712 iter/s, 2.492e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 82.126 Tflops/s, hfu: 82.126 Tflops/s, 3186.906 iter/s, 3.138e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 68.772 Tflops/s, hfu: 68.772 Tflops/s, 2668.716 iter/s, 3.747e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 54.884 Tflops/s, hfu: 54.884 Tflops/s, 2129.798 iter/s, 4.695e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(6144,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.831 Tflops/s, hfu: 5.831 Tflops/s, 362.043 iter/s, 2.762e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.42 Tflops/s, hfu: 10.42 Tflops/s, 646.950 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.028 Tflops/s, hfu: 5.028 Tflops/s, 312.153 iter/s, 3.204e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 70.393 Tflops/s, hfu: 70.393 Tflops/s, 2185.276 iter/s, 4.576e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.124 Tflops/s, hfu: 72.124 Tflops/s, 2239.020 iter/s, 4.466e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 67.241 Tflops/s, hfu: 67.241 Tflops/s, 2087.439 iter/s, 4.791e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 59.402 Tflops/s, hfu: 59.402 Tflops/s, 1844.093 iter/s, 5.423e-04 s/iter, (0.104, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 110.295 Tflops/s, hfu: 110.295 Tflops/s, 3424.001 iter/s, 2.921e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 88.056 Tflops/s, hfu: 88.056 Tflops/s, 2733.615 iter/s, 3.658e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 74.286 Tflops/s, hfu: 74.286 Tflops/s, 2306.145 iter/s, 4.336e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 57.813 Tflops/s, hfu: 57.813 Tflops/s, 1794.739 iter/s, 5.572e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(6144,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.981 Tflops/s, hfu: 6.981 Tflops/s, 361.184 iter/s, 2.769e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.531 Tflops/s, hfu: 12.531 Tflops/s, 648.350 iter/s, 1.542e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.984 Tflops/s, hfu: 5.984 Tflops/s, 309.611 iter/s, 3.230e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 77.947 Tflops/s, hfu: 77.947 Tflops/s, 2016.487 iter/s, 4.959e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 80.165 Tflops/s, hfu: 80.165 Tflops/s, 2073.863 iter/s, 4.822e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 72.516 Tflops/s, hfu: 72.516 Tflops/s, 1876.004 iter/s, 5.330e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 58.774 Tflops/s, hfu: 58.774 Tflops/s, 1520.496 iter/s, 6.577e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 117.614 Tflops/s, hfu: 117.614 Tflops/s, 3042.695 iter/s, 3.287e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 95.209 Tflops/s, hfu: 95.209 Tflops/s, 2463.054 iter/s, 4.060e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 78.003 Tflops/s, hfu: 78.003 Tflops/s, 2017.952 iter/s, 4.956e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 59.694 Tflops/s, hfu: 59.694 Tflops/s, 1544.296 iter/s, 6.475e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(6144,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.064 Tflops/s, hfu: 8.064 Tflops/s, 357.633 iter/s, 2.796e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.642 Tflops/s, hfu: 14.642 Tflops/s, 649.333 iter/s, 1.540e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.075 Tflops/s, hfu: 7.075 Tflops/s, 313.757 iter/s, 3.187e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 84.727 Tflops/s, hfu: 84.727 Tflops/s, 1878.767 iter/s, 5.323e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 84.329 Tflops/s, hfu: 84.329 Tflops/s, 1869.942 iter/s, 5.348e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 77.395 Tflops/s, hfu: 77.395 Tflops/s, 1716.184 iter/s, 5.827e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.456 Tflops/s, hfu: 70.456 Tflops/s, 1562.305 iter/s, 6.401e-04 s/iter, (0.100, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 122.589 Tflops/s, hfu: 122.589 Tflops/s, 2718.337 iter/s, 3.679e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 97.579 Tflops/s, hfu: 97.579 Tflops/s, 2163.753 iter/s, 4.622e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 79.512 Tflops/s, hfu: 79.512 Tflops/s, 1763.121 iter/s, 5.672e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 59.872 Tflops/s, hfu: 59.872 Tflops/s, 1327.626 iter/s, 7.532e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(6144,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.157 Tflops/s, hfu: 9.157 Tflops/s, 355.328 iter/s, 2.814e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.846 Tflops/s, hfu: 16.846 Tflops/s, 653.705 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.065 Tflops/s, hfu: 8.065 Tflops/s, 312.960 iter/s, 3.195e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 90.828 Tflops/s, hfu: 90.828 Tflops/s, 1762.301 iter/s, 5.674e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 91.197 Tflops/s, hfu: 91.197 Tflops/s, 1769.461 iter/s, 5.651e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 80.343 Tflops/s, hfu: 80.343 Tflops/s, 1558.856 iter/s, 6.415e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 73.947 Tflops/s, hfu: 73.947 Tflops/s, 1434.753 iter/s, 6.970e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 125.515 Tflops/s, hfu: 125.515 Tflops/s, 2435.318 iter/s, 4.106e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.545 Tflops/s, hfu: 101.545 Tflops/s, 1970.241 iter/s, 5.076e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.085 Tflops/s, hfu: 84.085 Tflops/s, 1631.470 iter/s, 6.129e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 62.37 Tflops/s, hfu: 62.37 Tflops/s, 1210.138 iter/s, 8.264e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(6144,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.418 Tflops/s, hfu: 11.418 Tflops/s, 354.460 iter/s, 2.821e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.702 Tflops/s, hfu: 20.702 Tflops/s, 642.667 iter/s, 1.556e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.08 Tflops/s, hfu: 10.08 Tflops/s, 312.938 iter/s, 3.196e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 104.05 Tflops/s, hfu: 104.05 Tflops/s, 1615.071 iter/s, 6.192e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.525 Tflops/s, hfu: 101.525 Tflops/s, 1575.875 iter/s, 6.346e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 92.069 Tflops/s, hfu: 92.069 Tflops/s, 1429.094 iter/s, 6.997e-04 s/iter, (0.072, 0.001, 0.003) sec
mfu: 74.173 Tflops/s, hfu: 74.173 Tflops/s, 1151.320 iter/s, 8.686e-04 s/iter, (0.103, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 134.052 Tflops/s, hfu: 134.052 Tflops/s, 2080.767 iter/s, 4.806e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 104.333 Tflops/s, hfu: 104.333 Tflops/s, 1619.465 iter/s, 6.175e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 85.712 Tflops/s, hfu: 85.712 Tflops/s, 1330.424 iter/s, 7.516e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 62.876 Tflops/s, hfu: 62.876 Tflops/s, 975.968 iter/s, 1.025e-03 s/iter, (0.078, 0.000, 0.004) sec
SP=(1,8),S=(6144,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.705 Tflops/s, hfu: 13.705 Tflops/s, 354.544 iter/s, 2.821e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.106 Tflops/s, hfu: 25.106 Tflops/s, 649.489 iter/s, 1.540e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 11.981 Tflops/s, hfu: 11.981 Tflops/s, 309.956 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 111.905 Tflops/s, hfu: 111.905 Tflops/s, 1447.496 iter/s, 6.908e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 106.205 Tflops/s, hfu: 106.205 Tflops/s, 1373.762 iter/s, 7.279e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 96.621 Tflops/s, hfu: 96.621 Tflops/s, 1249.800 iter/s, 8.001e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 77.924 Tflops/s, hfu: 77.924 Tflops/s, 1007.951 iter/s, 9.921e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 136.753 Tflops/s, hfu: 136.753 Tflops/s, 1768.910 iter/s, 5.653e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 109.944 Tflops/s, hfu: 109.944 Tflops/s, 1422.135 iter/s, 7.032e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 88.308 Tflops/s, hfu: 88.308 Tflops/s, 1142.262 iter/s, 8.755e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 65.585 Tflops/s, hfu: 65.585 Tflops/s, 848.343 iter/s, 1.179e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(6144,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.962 Tflops/s, hfu: 15.962 Tflops/s, 353.942 iter/s, 2.825e-03 s/iter, (0.033, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.374 Tflops/s, hfu: 29.374 Tflops/s, 651.360 iter/s, 1.535e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 14.027 Tflops/s, hfu: 14.027 Tflops/s, 311.030 iter/s, 3.215e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 116.844 Tflops/s, hfu: 116.844 Tflops/s, 1295.471 iter/s, 7.719e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 110.09 Tflops/s, hfu: 110.09 Tflops/s, 1220.584 iter/s, 8.193e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 101.967 Tflops/s, hfu: 101.967 Tflops/s, 1130.526 iter/s, 8.845e-04 s/iter, (0.072, 0.000, 0.004) sec
mfu: 83.241 Tflops/s, hfu: 83.241 Tflops/s, 922.911 iter/s, 1.084e-03 s/iter, (0.076, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 140.441 Tflops/s, hfu: 140.441 Tflops/s, 1557.089 iter/s, 6.422e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 111.8 Tflops/s, hfu: 111.8 Tflops/s, 1239.551 iter/s, 8.067e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 89.578 Tflops/s, hfu: 89.578 Tflops/s, 993.167 iter/s, 1.007e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 65.824 Tflops/s, hfu: 65.824 Tflops/s, 729.808 iter/s, 1.370e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(6144,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.296 Tflops/s, hfu: 18.296 Tflops/s, 354.980 iter/s, 2.817e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 31.92 Tflops/s, hfu: 31.92 Tflops/s, 619.332 iter/s, 1.615e-03 s/iter, (0.019, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 15.862 Tflops/s, hfu: 15.862 Tflops/s, 307.754 iter/s, 3.249e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 122.015 Tflops/s, hfu: 122.015 Tflops/s, 1183.701 iter/s, 8.448e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 113.523 Tflops/s, hfu: 113.523 Tflops/s, 1101.322 iter/s, 9.080e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 103.392 Tflops/s, hfu: 103.392 Tflops/s, 1003.033 iter/s, 9.970e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 83.201 Tflops/s, hfu: 83.201 Tflops/s, 807.155 iter/s, 1.239e-03 s/iter, (0.074, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 142.826 Tflops/s, hfu: 142.826 Tflops/s, 1385.594 iter/s, 7.217e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 113.217 Tflops/s, hfu: 113.217 Tflops/s, 1098.351 iter/s, 9.105e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 90.827 Tflops/s, hfu: 90.827 Tflops/s, 881.138 iter/s, 1.135e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 65.585 Tflops/s, hfu: 65.585 Tflops/s, 636.262 iter/s, 1.572e-03 s/iter, (0.079, 0.000, 0.006) sec
SP=(1,8),S=(6144,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.13 Tflops/s, hfu: 23.13 Tflops/s, 359.020 iter/s, 2.785e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.593 Tflops/s, hfu: 41.593 Tflops/s, 645.610 iter/s, 1.549e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 19.948 Tflops/s, hfu: 19.948 Tflops/s, 309.628 iter/s, 3.230e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 128.223 Tflops/s, hfu: 128.223 Tflops/s, 995.144 iter/s, 1.005e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 118.333 Tflops/s, hfu: 118.333 Tflops/s, 918.388 iter/s, 1.089e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 107.507 Tflops/s, hfu: 107.507 Tflops/s, 834.368 iter/s, 1.199e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 82.252 Tflops/s, hfu: 82.252 Tflops/s, 638.358 iter/s, 1.567e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 146.168 Tflops/s, hfu: 146.168 Tflops/s, 1134.414 iter/s, 8.815e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 115.469 Tflops/s, hfu: 115.469 Tflops/s, 896.154 iter/s, 1.116e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 92.523 Tflops/s, hfu: 92.523 Tflops/s, 718.073 iter/s, 1.393e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 66.686 Tflops/s, hfu: 66.686 Tflops/s, 517.553 iter/s, 1.932e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(6144,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.862 Tflops/s, hfu: 27.862 Tflops/s, 360.402 iter/s, 2.775e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.254 Tflops/s, hfu: 50.254 Tflops/s, 650.038 iter/s, 1.538e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 24.061 Tflops/s, hfu: 24.061 Tflops/s, 311.234 iter/s, 3.213e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 132.444 Tflops/s, hfu: 132.444 Tflops/s, 856.581 iter/s, 1.167e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 124.423 Tflops/s, hfu: 124.423 Tflops/s, 804.707 iter/s, 1.243e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 114.512 Tflops/s, hfu: 114.512 Tflops/s, 740.609 iter/s, 1.350e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 79.217 Tflops/s, hfu: 79.217 Tflops/s, 512.339 iter/s, 1.952e-03 s/iter, (0.084, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 149.769 Tflops/s, hfu: 149.769 Tflops/s, 968.632 iter/s, 1.032e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 118.38 Tflops/s, hfu: 118.38 Tflops/s, 765.626 iter/s, 1.306e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 94.307 Tflops/s, hfu: 94.307 Tflops/s, 609.932 iter/s, 1.640e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 67.991 Tflops/s, hfu: 67.991 Tflops/s, 439.735 iter/s, 2.274e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(6144,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.365 Tflops/s, hfu: 32.365 Tflops/s, 358.839 iter/s, 2.787e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.834 Tflops/s, hfu: 58.834 Tflops/s, 652.297 iter/s, 1.533e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 28.1 Tflops/s, hfu: 28.1 Tflops/s, 311.548 iter/s, 3.210e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 136.531 Tflops/s, hfu: 136.531 Tflops/s, 756.874 iter/s, 1.321e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 127.868 Tflops/s, hfu: 127.868 Tflops/s, 708.846 iter/s, 1.411e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 112.901 Tflops/s, hfu: 112.901 Tflops/s, 625.876 iter/s, 1.598e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 77.321 Tflops/s, hfu: 77.321 Tflops/s, 428.636 iter/s, 2.333e-03 s/iter, (0.083, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 151.674 Tflops/s, hfu: 151.674 Tflops/s, 840.817 iter/s, 1.189e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 119.798 Tflops/s, hfu: 119.798 Tflops/s, 664.113 iter/s, 1.506e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 94.641 Tflops/s, hfu: 94.641 Tflops/s, 524.652 iter/s, 1.906e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 67.421 Tflops/s, hfu: 67.421 Tflops/s, 373.755 iter/s, 2.676e-03 s/iter, (0.084, 0.000, 0.011) sec
SP=(1,8),S=(6144,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.958 Tflops/s, hfu: 36.958 Tflops/s, 358.540 iter/s, 2.789e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 62.602 Tflops/s, hfu: 62.602 Tflops/s, 607.316 iter/s, 1.647e-03 s/iter, (0.023, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 31.766 Tflops/s, hfu: 31.766 Tflops/s, 308.167 iter/s, 3.245e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 140.027 Tflops/s, hfu: 140.027 Tflops/s, 679.222 iter/s, 1.472e-03 s/iter, (0.082, 0.000, 0.006) sec
mfu: 129.813 Tflops/s, hfu: 129.813 Tflops/s, 629.675 iter/s, 1.588e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 116.981 Tflops/s, hfu: 116.981 Tflops/s, 567.434 iter/s, 1.762e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 94.56 Tflops/s, hfu: 94.56 Tflops/s, 458.677 iter/s, 2.180e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 153.72 Tflops/s, hfu: 153.72 Tflops/s, 745.641 iter/s, 1.341e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 121.092 Tflops/s, hfu: 121.092 Tflops/s, 587.376 iter/s, 1.702e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 95.86 Tflops/s, hfu: 95.86 Tflops/s, 464.983 iter/s, 2.151e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 68.483 Tflops/s, hfu: 68.483 Tflops/s, 332.187 iter/s, 3.010e-03 s/iter, (0.083, 0.000, 0.012) sec
SP=(1,8),S=(8192,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.199 Tflops/s, hfu: 0.199 Tflops/s, 370.577 iter/s, 2.698e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.366 Tflops/s, hfu: 0.366 Tflops/s, 681.341 iter/s, 1.468e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 0.174 Tflops/s, hfu: 0.174 Tflops/s, 323.727 iter/s, 3.089e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 3.288 Tflops/s, hfu: 3.288 Tflops/s, 3061.774 iter/s, 3.266e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 4.65 Tflops/s, hfu: 4.65 Tflops/s, 4330.204 iter/s, 2.309e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 5.289 Tflops/s, hfu: 5.289 Tflops/s, 4925.914 iter/s, 2.030e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 5.717 Tflops/s, hfu: 5.717 Tflops/s, 5324.587 iter/s, 1.878e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 10.333 Tflops/s, hfu: 10.333 Tflops/s, 9623.527 iter/s, 1.039e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 10.38 Tflops/s, hfu: 10.38 Tflops/s, 9666.692 iter/s, 1.034e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 11.093 Tflops/s, hfu: 11.093 Tflops/s, 10331.432 iter/s, 9.679e-05 s/iter, (0.072, 0.000, 0.000) sec
mfu: 14.9 Tflops/s, hfu: 14.9 Tflops/s, 13876.555 iter/s, 7.206e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(8192,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.396 Tflops/s, hfu: 0.396 Tflops/s, 368.464 iter/s, 2.714e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.726 Tflops/s, hfu: 0.726 Tflops/s, 676.141 iter/s, 1.479e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.346 Tflops/s, hfu: 0.346 Tflops/s, 322.104 iter/s, 3.105e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 6.537 Tflops/s, hfu: 6.537 Tflops/s, 3044.029 iter/s, 3.285e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.9 Tflops/s, hfu: 8.9 Tflops/s, 4144.425 iter/s, 2.413e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 10.298 Tflops/s, hfu: 10.298 Tflops/s, 4795.519 iter/s, 2.085e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 10.757 Tflops/s, hfu: 10.757 Tflops/s, 5009.217 iter/s, 1.996e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 16.266 Tflops/s, hfu: 16.266 Tflops/s, 7574.380 iter/s, 1.320e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 17.774 Tflops/s, hfu: 17.774 Tflops/s, 8276.501 iter/s, 1.208e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 19.656 Tflops/s, hfu: 19.656 Tflops/s, 9152.816 iter/s, 1.093e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 24.166 Tflops/s, hfu: 24.166 Tflops/s, 11253.151 iter/s, 8.886e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(8192,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.591 Tflops/s, hfu: 0.591 Tflops/s, 366.985 iter/s, 2.725e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.051 Tflops/s, hfu: 1.051 Tflops/s, 652.693 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 0.499 Tflops/s, hfu: 0.499 Tflops/s, 310.007 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 9.705 Tflops/s, hfu: 9.705 Tflops/s, 3012.847 iter/s, 3.319e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.173 Tflops/s, hfu: 13.173 Tflops/s, 4089.377 iter/s, 2.445e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 14.23 Tflops/s, hfu: 14.23 Tflops/s, 4417.586 iter/s, 2.264e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 14.806 Tflops/s, hfu: 14.806 Tflops/s, 4596.433 iter/s, 2.176e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 24.036 Tflops/s, hfu: 24.036 Tflops/s, 7461.795 iter/s, 1.340e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 26.962 Tflops/s, hfu: 26.962 Tflops/s, 8370.162 iter/s, 1.195e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 27.038 Tflops/s, hfu: 27.038 Tflops/s, 8393.769 iter/s, 1.191e-04 s/iter, (0.071, 0.000, 0.000) sec
mfu: 29.773 Tflops/s, hfu: 29.773 Tflops/s, 9242.828 iter/s, 1.082e-04 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(8192,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.788 Tflops/s, hfu: 0.788 Tflops/s, 366.750 iter/s, 2.727e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.411 Tflops/s, hfu: 1.411 Tflops/s, 656.894 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.676 Tflops/s, hfu: 0.676 Tflops/s, 314.562 iter/s, 3.179e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 12.59 Tflops/s, hfu: 12.59 Tflops/s, 2931.245 iter/s, 3.412e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 16.454 Tflops/s, hfu: 16.454 Tflops/s, 3831.065 iter/s, 2.610e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 17.387 Tflops/s, hfu: 17.387 Tflops/s, 4048.190 iter/s, 2.470e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 18.301 Tflops/s, hfu: 18.301 Tflops/s, 4261.121 iter/s, 2.347e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 31.505 Tflops/s, hfu: 31.505 Tflops/s, 7335.250 iter/s, 1.363e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 30.626 Tflops/s, hfu: 30.626 Tflops/s, 7130.634 iter/s, 1.402e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 26.932 Tflops/s, hfu: 26.932 Tflops/s, 6270.693 iter/s, 1.595e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 36.121 Tflops/s, hfu: 36.121 Tflops/s, 8410.146 iter/s, 1.189e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(8192,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.99 Tflops/s, hfu: 0.99 Tflops/s, 368.681 iter/s, 2.712e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.774 Tflops/s, hfu: 1.774 Tflops/s, 661.036 iter/s, 1.513e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.85 Tflops/s, hfu: 0.85 Tflops/s, 316.593 iter/s, 3.159e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 16.266 Tflops/s, hfu: 16.266 Tflops/s, 3029.715 iter/s, 3.301e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.138 Tflops/s, hfu: 20.138 Tflops/s, 3751.050 iter/s, 2.666e-04 s/iter, (0.093, 0.000, 0.001) sec
mfu: 20.757 Tflops/s, hfu: 20.757 Tflops/s, 3866.378 iter/s, 2.586e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.885 Tflops/s, hfu: 21.885 Tflops/s, 4076.441 iter/s, 2.453e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 35.337 Tflops/s, hfu: 35.337 Tflops/s, 6582.066 iter/s, 1.519e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 33.059 Tflops/s, hfu: 33.059 Tflops/s, 6157.635 iter/s, 1.624e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.736 Tflops/s, hfu: 31.736 Tflops/s, 5911.284 iter/s, 1.692e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 37.68 Tflops/s, hfu: 37.68 Tflops/s, 7018.529 iter/s, 1.425e-04 s/iter, (0.069, 0.000, 0.001) sec
SP=(1,8),S=(8192,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.183 Tflops/s, hfu: 1.183 Tflops/s, 367.357 iter/s, 2.722e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.102 Tflops/s, hfu: 2.102 Tflops/s, 652.576 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.015 Tflops/s, hfu: 1.015 Tflops/s, 315.082 iter/s, 3.174e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 18.543 Tflops/s, hfu: 18.543 Tflops/s, 2878.327 iter/s, 3.474e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.644 Tflops/s, hfu: 22.644 Tflops/s, 3514.790 iter/s, 2.845e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.776 Tflops/s, hfu: 23.776 Tflops/s, 3690.582 iter/s, 2.710e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.0 Tflops/s, hfu: 25.0 Tflops/s, 3880.541 iter/s, 2.577e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 42.97 Tflops/s, hfu: 42.97 Tflops/s, 6669.868 iter/s, 1.499e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.331 Tflops/s, hfu: 38.331 Tflops/s, 5949.831 iter/s, 1.681e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 35.66 Tflops/s, hfu: 35.66 Tflops/s, 5535.137 iter/s, 1.807e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 40.995 Tflops/s, hfu: 40.995 Tflops/s, 6363.266 iter/s, 1.572e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(8192,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.372 Tflops/s, hfu: 1.372 Tflops/s, 365.138 iter/s, 2.739e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.443 Tflops/s, hfu: 2.443 Tflops/s, 650.164 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.18 Tflops/s, hfu: 1.18 Tflops/s, 313.897 iter/s, 3.186e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 22.025 Tflops/s, hfu: 22.025 Tflops/s, 2930.283 iter/s, 3.413e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 25.904 Tflops/s, hfu: 25.904 Tflops/s, 3446.469 iter/s, 2.902e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.795 Tflops/s, hfu: 26.795 Tflops/s, 3565.012 iter/s, 2.805e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 27.451 Tflops/s, hfu: 27.451 Tflops/s, 3652.301 iter/s, 2.738e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 46.852 Tflops/s, hfu: 46.852 Tflops/s, 6233.481 iter/s, 1.604e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 42.576 Tflops/s, hfu: 42.576 Tflops/s, 5664.567 iter/s, 1.765e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.501 Tflops/s, hfu: 39.501 Tflops/s, 5255.413 iter/s, 1.903e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.685 Tflops/s, hfu: 43.685 Tflops/s, 5812.061 iter/s, 1.721e-04 s/iter, (0.077, 0.000, 0.001) sec
SP=(1,8),S=(8192,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.564 Tflops/s, hfu: 1.564 Tflops/s, 364.261 iter/s, 2.745e-03 s/iter, (0.040, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.784 Tflops/s, hfu: 2.784 Tflops/s, 648.285 iter/s, 1.543e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.345 Tflops/s, hfu: 1.345 Tflops/s, 313.202 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 25.295 Tflops/s, hfu: 25.295 Tflops/s, 2944.780 iter/s, 3.396e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 28.63 Tflops/s, hfu: 28.63 Tflops/s, 3332.978 iter/s, 3.000e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 30.028 Tflops/s, hfu: 30.028 Tflops/s, 3495.721 iter/s, 2.861e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 30.702 Tflops/s, hfu: 30.702 Tflops/s, 3574.186 iter/s, 2.798e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 51.014 Tflops/s, hfu: 51.014 Tflops/s, 5938.807 iter/s, 1.684e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 47.817 Tflops/s, hfu: 47.817 Tflops/s, 5566.689 iter/s, 1.796e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.032 Tflops/s, hfu: 43.032 Tflops/s, 5009.618 iter/s, 1.996e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 46.474 Tflops/s, hfu: 46.474 Tflops/s, 5410.318 iter/s, 1.848e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(8192,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.926 Tflops/s, hfu: 1.926 Tflops/s, 358.776 iter/s, 2.787e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.303 Tflops/s, hfu: 3.303 Tflops/s, 615.199 iter/s, 1.625e-03 s/iter, (0.018, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 1.673 Tflops/s, hfu: 1.673 Tflops/s, 311.601 iter/s, 3.209e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 31.352 Tflops/s, hfu: 31.352 Tflops/s, 2919.879 iter/s, 3.425e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.343 Tflops/s, hfu: 34.343 Tflops/s, 3198.485 iter/s, 3.126e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 36.268 Tflops/s, hfu: 36.268 Tflops/s, 3377.739 iter/s, 2.961e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.694 Tflops/s, hfu: 35.694 Tflops/s, 3324.291 iter/s, 3.008e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 60.061 Tflops/s, hfu: 60.061 Tflops/s, 5593.592 iter/s, 1.788e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 55.386 Tflops/s, hfu: 55.386 Tflops/s, 5158.255 iter/s, 1.939e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 49.734 Tflops/s, hfu: 49.734 Tflops/s, 4631.860 iter/s, 2.159e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 50.627 Tflops/s, hfu: 50.627 Tflops/s, 4715.024 iter/s, 2.121e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(8192,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.287 Tflops/s, hfu: 2.287 Tflops/s, 355.027 iter/s, 2.817e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.244 Tflops/s, hfu: 4.244 Tflops/s, 658.808 iter/s, 1.518e-03 s/iter, (0.021, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.029 Tflops/s, hfu: 2.029 Tflops/s, 314.883 iter/s, 3.176e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 36.471 Tflops/s, hfu: 36.471 Tflops/s, 2830.552 iter/s, 3.533e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 40.361 Tflops/s, hfu: 40.361 Tflops/s, 3132.440 iter/s, 3.192e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 40.808 Tflops/s, hfu: 40.808 Tflops/s, 3167.123 iter/s, 3.157e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 41.133 Tflops/s, hfu: 41.133 Tflops/s, 3192.359 iter/s, 3.132e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 65.678 Tflops/s, hfu: 65.678 Tflops/s, 5097.256 iter/s, 1.962e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 60.131 Tflops/s, hfu: 60.131 Tflops/s, 4666.791 iter/s, 2.143e-04 s/iter, (0.073, 0.001, 0.001) sec
mfu: 55.395 Tflops/s, hfu: 55.395 Tflops/s, 4299.226 iter/s, 2.326e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 54.383 Tflops/s, hfu: 54.383 Tflops/s, 4220.692 iter/s, 2.369e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(8192,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.686 Tflops/s, hfu: 2.686 Tflops/s, 357.392 iter/s, 2.798e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.933 Tflops/s, hfu: 4.933 Tflops/s, 656.262 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.338 Tflops/s, hfu: 2.338 Tflops/s, 311.019 iter/s, 3.215e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 42.109 Tflops/s, hfu: 42.109 Tflops/s, 2801.246 iter/s, 3.570e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 45.536 Tflops/s, hfu: 45.536 Tflops/s, 3029.201 iter/s, 3.301e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.35 Tflops/s, hfu: 45.35 Tflops/s, 3016.846 iter/s, 3.315e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 45.457 Tflops/s, hfu: 45.457 Tflops/s, 3023.925 iter/s, 3.307e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 75.479 Tflops/s, hfu: 75.479 Tflops/s, 5021.089 iter/s, 1.992e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 67.181 Tflops/s, hfu: 67.181 Tflops/s, 4469.074 iter/s, 2.238e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 59.664 Tflops/s, hfu: 59.664 Tflops/s, 3969.010 iter/s, 2.520e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 56.251 Tflops/s, hfu: 56.251 Tflops/s, 3741.955 iter/s, 2.672e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(8192,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.037 Tflops/s, hfu: 3.037 Tflops/s, 353.504 iter/s, 2.829e-03 s/iter, (0.041, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.621 Tflops/s, hfu: 5.621 Tflops/s, 654.394 iter/s, 1.528e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.682 Tflops/s, hfu: 2.682 Tflops/s, 312.221 iter/s, 3.203e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 47.397 Tflops/s, hfu: 47.397 Tflops/s, 2758.895 iter/s, 3.625e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 51.757 Tflops/s, hfu: 51.757 Tflops/s, 3012.629 iter/s, 3.319e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.391 Tflops/s, hfu: 48.391 Tflops/s, 2816.711 iter/s, 3.550e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.642 Tflops/s, hfu: 48.642 Tflops/s, 2831.321 iter/s, 3.532e-04 s/iter, (0.080, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 78.144 Tflops/s, hfu: 78.144 Tflops/s, 4548.597 iter/s, 2.198e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 70.933 Tflops/s, hfu: 70.933 Tflops/s, 4128.819 iter/s, 2.422e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 62.915 Tflops/s, hfu: 62.915 Tflops/s, 3662.145 iter/s, 2.731e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 53.299 Tflops/s, hfu: 53.299 Tflops/s, 3102.430 iter/s, 3.223e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(8192,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.887 Tflops/s, hfu: 3.887 Tflops/s, 361.966 iter/s, 2.763e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.093 Tflops/s, hfu: 7.093 Tflops/s, 660.557 iter/s, 1.514e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.416 Tflops/s, hfu: 3.416 Tflops/s, 318.176 iter/s, 3.143e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 40.174 Tflops/s, hfu: 40.174 Tflops/s, 1870.753 iter/s, 5.345e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 40.523 Tflops/s, hfu: 40.523 Tflops/s, 1887.020 iter/s, 5.299e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 40.058 Tflops/s, hfu: 40.058 Tflops/s, 1865.338 iter/s, 5.361e-04 s/iter, (0.106, 0.000, 0.002) sec
mfu: 40.527 Tflops/s, hfu: 40.527 Tflops/s, 1887.191 iter/s, 5.299e-04 s/iter, (0.073, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 87.63 Tflops/s, hfu: 87.63 Tflops/s, 4080.567 iter/s, 2.451e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.503 Tflops/s, hfu: 79.503 Tflops/s, 3702.168 iter/s, 2.701e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 68.299 Tflops/s, hfu: 68.299 Tflops/s, 3180.419 iter/s, 3.144e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 56.894 Tflops/s, hfu: 56.894 Tflops/s, 2649.315 iter/s, 3.775e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(8192,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.575 Tflops/s, hfu: 4.575 Tflops/s, 355.073 iter/s, 2.816e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.506 Tflops/s, hfu: 8.506 Tflops/s, 660.125 iter/s, 1.515e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.085 Tflops/s, hfu: 4.085 Tflops/s, 317.017 iter/s, 3.154e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 64.752 Tflops/s, hfu: 64.752 Tflops/s, 2512.714 iter/s, 3.980e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 65.575 Tflops/s, hfu: 65.575 Tflops/s, 2544.633 iter/s, 3.930e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 63.619 Tflops/s, hfu: 63.619 Tflops/s, 2468.746 iter/s, 4.051e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 60.698 Tflops/s, hfu: 60.698 Tflops/s, 2355.380 iter/s, 4.246e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 94.72 Tflops/s, hfu: 94.72 Tflops/s, 3675.606 iter/s, 2.721e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 84.903 Tflops/s, hfu: 84.903 Tflops/s, 3294.676 iter/s, 3.035e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 76.862 Tflops/s, hfu: 76.862 Tflops/s, 2982.653 iter/s, 3.353e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 60.766 Tflops/s, hfu: 60.766 Tflops/s, 2358.046 iter/s, 4.241e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(8192,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.446 Tflops/s, hfu: 5.446 Tflops/s, 362.282 iter/s, 2.760e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.924 Tflops/s, hfu: 9.924 Tflops/s, 660.156 iter/s, 1.515e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.761 Tflops/s, hfu: 4.761 Tflops/s, 316.697 iter/s, 3.158e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 69.792 Tflops/s, hfu: 69.792 Tflops/s, 2321.392 iter/s, 4.308e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.085 Tflops/s, hfu: 71.085 Tflops/s, 2364.379 iter/s, 4.229e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 66.864 Tflops/s, hfu: 66.864 Tflops/s, 2224.001 iter/s, 4.496e-04 s/iter, (0.142, 0.000, 0.002) sec
mfu: 62.052 Tflops/s, hfu: 62.052 Tflops/s, 2063.932 iter/s, 4.845e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 102.308 Tflops/s, hfu: 102.308 Tflops/s, 3402.934 iter/s, 2.939e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 87.942 Tflops/s, hfu: 87.942 Tflops/s, 2925.071 iter/s, 3.419e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 78.29 Tflops/s, hfu: 78.29 Tflops/s, 2604.058 iter/s, 3.840e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 63.114 Tflops/s, hfu: 63.114 Tflops/s, 2099.253 iter/s, 4.764e-04 s/iter, (0.075, 0.000, 0.002) sec
SP=(1,8),S=(8192,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.217 Tflops/s, hfu: 6.217 Tflops/s, 361.854 iter/s, 2.764e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.316 Tflops/s, hfu: 11.316 Tflops/s, 658.658 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.396 Tflops/s, hfu: 5.396 Tflops/s, 314.077 iter/s, 3.184e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 72.647 Tflops/s, hfu: 72.647 Tflops/s, 2114.308 iter/s, 4.730e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.201 Tflops/s, hfu: 71.201 Tflops/s, 2072.212 iter/s, 4.826e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 68.647 Tflops/s, hfu: 68.647 Tflops/s, 1997.890 iter/s, 5.005e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 68.385 Tflops/s, hfu: 68.385 Tflops/s, 1990.256 iter/s, 5.024e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 107.149 Tflops/s, hfu: 107.149 Tflops/s, 3118.451 iter/s, 3.207e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 92.506 Tflops/s, hfu: 92.506 Tflops/s, 2692.283 iter/s, 3.714e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 80.108 Tflops/s, hfu: 80.108 Tflops/s, 2331.437 iter/s, 4.289e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 64.989 Tflops/s, hfu: 64.989 Tflops/s, 1891.418 iter/s, 5.287e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(8192,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.752 Tflops/s, hfu: 7.752 Tflops/s, 360.968 iter/s, 2.770e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.086 Tflops/s, hfu: 14.086 Tflops/s, 655.908 iter/s, 1.525e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 6.804 Tflops/s, hfu: 6.804 Tflops/s, 316.848 iter/s, 3.156e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 87.156 Tflops/s, hfu: 87.156 Tflops/s, 2029.254 iter/s, 4.928e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 86.142 Tflops/s, hfu: 86.142 Tflops/s, 2005.648 iter/s, 4.986e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 80.996 Tflops/s, hfu: 80.996 Tflops/s, 1885.825 iter/s, 5.303e-04 s/iter, (0.092, 0.000, 0.002) sec
mfu: 75.458 Tflops/s, hfu: 75.458 Tflops/s, 1756.901 iter/s, 5.692e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 113.741 Tflops/s, hfu: 113.741 Tflops/s, 2648.249 iter/s, 3.776e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 99.083 Tflops/s, hfu: 99.083 Tflops/s, 2306.954 iter/s, 4.335e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.94 Tflops/s, hfu: 84.94 Tflops/s, 1977.660 iter/s, 5.056e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 68.146 Tflops/s, hfu: 68.146 Tflops/s, 1586.657 iter/s, 6.303e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(8192,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.279 Tflops/s, hfu: 9.279 Tflops/s, 360.091 iter/s, 2.777e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.976 Tflops/s, hfu: 16.976 Tflops/s, 658.767 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.112 Tflops/s, hfu: 8.112 Tflops/s, 314.806 iter/s, 3.177e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 91.885 Tflops/s, hfu: 91.885 Tflops/s, 1782.811 iter/s, 5.609e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.651 Tflops/s, hfu: 90.651 Tflops/s, 1758.854 iter/s, 5.686e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 86.197 Tflops/s, hfu: 86.197 Tflops/s, 1672.442 iter/s, 5.979e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 78.64 Tflops/s, hfu: 78.64 Tflops/s, 1525.823 iter/s, 6.554e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 121.951 Tflops/s, hfu: 121.951 Tflops/s, 2366.169 iter/s, 4.226e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 104.646 Tflops/s, hfu: 104.646 Tflops/s, 2030.407 iter/s, 4.925e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 88.458 Tflops/s, hfu: 88.458 Tflops/s, 1716.302 iter/s, 5.826e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 71.623 Tflops/s, hfu: 71.623 Tflops/s, 1389.676 iter/s, 7.196e-04 s/iter, (0.193, 0.000, 0.003) sec
SP=(1,8),S=(8192,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.076 Tflops/s, hfu: 11.076 Tflops/s, 368.401 iter/s, 2.714e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.399 Tflops/s, hfu: 19.399 Tflops/s, 645.233 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.256 Tflops/s, hfu: 9.256 Tflops/s, 307.868 iter/s, 3.248e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 97.77 Tflops/s, hfu: 97.77 Tflops/s, 1625.995 iter/s, 6.150e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 96.808 Tflops/s, hfu: 96.808 Tflops/s, 1609.995 iter/s, 6.211e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 91.256 Tflops/s, hfu: 91.256 Tflops/s, 1517.653 iter/s, 6.589e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 79.824 Tflops/s, hfu: 79.824 Tflops/s, 1327.542 iter/s, 7.533e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 127.092 Tflops/s, hfu: 127.092 Tflops/s, 2113.629 iter/s, 4.731e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 106.719 Tflops/s, hfu: 106.719 Tflops/s, 1774.812 iter/s, 5.634e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.829 Tflops/s, hfu: 90.829 Tflops/s, 1510.556 iter/s, 6.620e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 71.982 Tflops/s, hfu: 71.982 Tflops/s, 1197.123 iter/s, 8.353e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(8192,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.564 Tflops/s, hfu: 12.564 Tflops/s, 365.665 iter/s, 2.735e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.101 Tflops/s, hfu: 22.101 Tflops/s, 643.214 iter/s, 1.555e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.526 Tflops/s, hfu: 10.526 Tflops/s, 306.344 iter/s, 3.264e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 106.405 Tflops/s, hfu: 106.405 Tflops/s, 1548.390 iter/s, 6.458e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 105.145 Tflops/s, hfu: 105.145 Tflops/s, 1530.063 iter/s, 6.536e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 97.124 Tflops/s, hfu: 97.124 Tflops/s, 1413.340 iter/s, 7.075e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 75.02 Tflops/s, hfu: 75.02 Tflops/s, 1091.684 iter/s, 9.160e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 130.384 Tflops/s, hfu: 130.384 Tflops/s, 1897.332 iter/s, 5.271e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 109.486 Tflops/s, hfu: 109.486 Tflops/s, 1593.229 iter/s, 6.277e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 93.348 Tflops/s, hfu: 93.348 Tflops/s, 1358.386 iter/s, 7.362e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 73.598 Tflops/s, hfu: 73.598 Tflops/s, 1070.994 iter/s, 9.337e-04 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(8192,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.486 Tflops/s, hfu: 15.486 Tflops/s, 360.558 iter/s, 2.773e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.046 Tflops/s, hfu: 28.046 Tflops/s, 653.003 iter/s, 1.531e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.411 Tflops/s, hfu: 13.411 Tflops/s, 312.256 iter/s, 3.202e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 113.801 Tflops/s, hfu: 113.801 Tflops/s, 1324.812 iter/s, 7.548e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 110.742 Tflops/s, hfu: 110.742 Tflops/s, 1289.205 iter/s, 7.757e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 101.694 Tflops/s, hfu: 101.694 Tflops/s, 1183.869 iter/s, 8.447e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 89.232 Tflops/s, hfu: 89.232 Tflops/s, 1038.801 iter/s, 9.626e-04 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 135.532 Tflops/s, hfu: 135.532 Tflops/s, 1577.805 iter/s, 6.338e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 113.961 Tflops/s, hfu: 113.961 Tflops/s, 1326.682 iter/s, 7.538e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 97.097 Tflops/s, hfu: 97.097 Tflops/s, 1130.352 iter/s, 8.847e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 74.565 Tflops/s, hfu: 74.565 Tflops/s, 868.056 iter/s, 1.152e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(8192,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.479 Tflops/s, hfu: 18.479 Tflops/s, 358.540 iter/s, 2.789e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.602 Tflops/s, hfu: 33.602 Tflops/s, 651.968 iter/s, 1.534e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.031 Tflops/s, hfu: 16.031 Tflops/s, 311.042 iter/s, 3.215e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 119.13 Tflops/s, hfu: 119.13 Tflops/s, 1155.717 iter/s, 8.653e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 116.779 Tflops/s, hfu: 116.779 Tflops/s, 1132.903 iter/s, 8.827e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.861 Tflops/s, hfu: 109.861 Tflops/s, 1065.789 iter/s, 9.383e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 85.666 Tflops/s, hfu: 85.666 Tflops/s, 831.073 iter/s, 1.203e-03 s/iter, (0.074, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 139.807 Tflops/s, hfu: 139.807 Tflops/s, 1356.307 iter/s, 7.373e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 118.749 Tflops/s, hfu: 118.749 Tflops/s, 1152.021 iter/s, 8.680e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 99.583 Tflops/s, hfu: 99.583 Tflops/s, 966.079 iter/s, 1.035e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 77.122 Tflops/s, hfu: 77.122 Tflops/s, 748.180 iter/s, 1.337e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(8192,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.579 Tflops/s, hfu: 21.579 Tflops/s, 358.869 iter/s, 2.787e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.301 Tflops/s, hfu: 39.301 Tflops/s, 653.609 iter/s, 1.530e-03 s/iter, (0.022, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.691 Tflops/s, hfu: 18.691 Tflops/s, 310.846 iter/s, 3.217e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.709 Tflops/s, hfu: 125.709 Tflops/s, 1045.317 iter/s, 9.566e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 122.658 Tflops/s, hfu: 122.658 Tflops/s, 1019.950 iter/s, 9.804e-04 s/iter, (0.130, 0.000, 0.004) sec
mfu: 113.185 Tflops/s, hfu: 113.185 Tflops/s, 941.180 iter/s, 1.062e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 97.255 Tflops/s, hfu: 97.255 Tflops/s, 808.711 iter/s, 1.237e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 143.34 Tflops/s, hfu: 143.34 Tflops/s, 1191.929 iter/s, 8.390e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 119.901 Tflops/s, hfu: 119.901 Tflops/s, 997.025 iter/s, 1.003e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 100.808 Tflops/s, hfu: 100.808 Tflops/s, 838.257 iter/s, 1.193e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 77.509 Tflops/s, hfu: 77.509 Tflops/s, 644.516 iter/s, 1.552e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(8192,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.509 Tflops/s, hfu: 24.509 Tflops/s, 356.646 iter/s, 2.804e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.864 Tflops/s, hfu: 44.864 Tflops/s, 652.861 iter/s, 1.532e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.408 Tflops/s, hfu: 21.408 Tflops/s, 311.528 iter/s, 3.210e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 127.688 Tflops/s, hfu: 127.688 Tflops/s, 929.050 iter/s, 1.076e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 124.117 Tflops/s, hfu: 124.117 Tflops/s, 903.068 iter/s, 1.107e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 113.809 Tflops/s, hfu: 113.809 Tflops/s, 828.067 iter/s, 1.208e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 85.128 Tflops/s, hfu: 85.128 Tflops/s, 619.385 iter/s, 1.615e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 145.013 Tflops/s, hfu: 145.013 Tflops/s, 1055.111 iter/s, 9.478e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.443 Tflops/s, hfu: 121.443 Tflops/s, 883.617 iter/s, 1.132e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 102.109 Tflops/s, hfu: 102.109 Tflops/s, 742.938 iter/s, 1.346e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 76.994 Tflops/s, hfu: 76.994 Tflops/s, 560.204 iter/s, 1.785e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(8192,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.655 Tflops/s, hfu: 30.655 Tflops/s, 356.868 iter/s, 2.802e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.854 Tflops/s, hfu: 55.854 Tflops/s, 650.224 iter/s, 1.538e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.691 Tflops/s, hfu: 26.691 Tflops/s, 310.726 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 134.069 Tflops/s, hfu: 134.069 Tflops/s, 780.382 iter/s, 1.281e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 128.924 Tflops/s, hfu: 128.924 Tflops/s, 750.435 iter/s, 1.333e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 122.65 Tflops/s, hfu: 122.65 Tflops/s, 713.919 iter/s, 1.401e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 94.718 Tflops/s, hfu: 94.718 Tflops/s, 551.334 iter/s, 1.814e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 148.742 Tflops/s, hfu: 148.742 Tflops/s, 865.795 iter/s, 1.155e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 124.376 Tflops/s, hfu: 124.376 Tflops/s, 723.962 iter/s, 1.381e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 103.518 Tflops/s, hfu: 103.518 Tflops/s, 602.555 iter/s, 1.660e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 78.414 Tflops/s, hfu: 78.414 Tflops/s, 456.429 iter/s, 2.191e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(8192,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.032 Tflops/s, hfu: 37.032 Tflops/s, 359.261 iter/s, 2.783e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 66.783 Tflops/s, hfu: 66.783 Tflops/s, 647.879 iter/s, 1.543e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 31.951 Tflops/s, hfu: 31.951 Tflops/s, 309.962 iter/s, 3.226e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 136.632 Tflops/s, hfu: 136.632 Tflops/s, 662.750 iter/s, 1.509e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 130.473 Tflops/s, hfu: 130.473 Tflops/s, 632.879 iter/s, 1.580e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 126.59 Tflops/s, hfu: 126.59 Tflops/s, 614.042 iter/s, 1.629e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 98.967 Tflops/s, hfu: 98.967 Tflops/s, 480.051 iter/s, 2.083e-03 s/iter, (0.077, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 151.092 Tflops/s, hfu: 151.092 Tflops/s, 732.893 iter/s, 1.364e-03 s/iter, (0.079, 0.000, 0.005) sec
mfu: 126.909 Tflops/s, hfu: 126.909 Tflops/s, 615.588 iter/s, 1.624e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 105.222 Tflops/s, hfu: 105.222 Tflops/s, 510.394 iter/s, 1.959e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 79.513 Tflops/s, hfu: 79.513 Tflops/s, 385.691 iter/s, 2.593e-03 s/iter, (0.081, 0.000, 0.010) sec
SP=(1,8),S=(8192,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.026 Tflops/s, hfu: 43.026 Tflops/s, 357.778 iter/s, 2.795e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 74.722 Tflops/s, hfu: 74.722 Tflops/s, 621.342 iter/s, 1.609e-03 s/iter, (0.021, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 36.601 Tflops/s, hfu: 36.601 Tflops/s, 304.350 iter/s, 3.286e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 141.875 Tflops/s, hfu: 141.875 Tflops/s, 589.873 iter/s, 1.695e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 137.358 Tflops/s, hfu: 137.358 Tflops/s, 571.092 iter/s, 1.751e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 127.047 Tflops/s, hfu: 127.047 Tflops/s, 528.224 iter/s, 1.893e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 107.169 Tflops/s, hfu: 107.169 Tflops/s, 445.577 iter/s, 2.244e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 153.289 Tflops/s, hfu: 153.289 Tflops/s, 637.329 iter/s, 1.569e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 127.477 Tflops/s, hfu: 127.477 Tflops/s, 530.009 iter/s, 1.887e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 105.862 Tflops/s, hfu: 105.862 Tflops/s, 440.142 iter/s, 2.272e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 79.073 Tflops/s, hfu: 79.073 Tflops/s, 328.763 iter/s, 3.042e-03 s/iter, (0.086, 0.000, 0.012) sec
SP=(1,8),S=(8192,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.799 Tflops/s, hfu: 48.799 Tflops/s, 355.057 iter/s, 2.816e-03 s/iter, (0.046, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.587 Tflops/s, hfu: 76.587 Tflops/s, 557.246 iter/s, 1.795e-03 s/iter, (0.023, 0.000, 0.036) sec
# stripe_flash_attn_func, fwd
mfu: 40.808 Tflops/s, hfu: 40.808 Tflops/s, 296.915 iter/s, 3.368e-03 s/iter, (0.039, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 145.116 Tflops/s, hfu: 145.116 Tflops/s, 527.927 iter/s, 1.894e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 138.896 Tflops/s, hfu: 138.896 Tflops/s, 505.302 iter/s, 1.979e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 129.276 Tflops/s, hfu: 129.276 Tflops/s, 470.305 iter/s, 2.126e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 107.251 Tflops/s, hfu: 107.251 Tflops/s, 390.175 iter/s, 2.563e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 154.909 Tflops/s, hfu: 154.909 Tflops/s, 563.556 iter/s, 1.774e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 128.878 Tflops/s, hfu: 128.878 Tflops/s, 468.857 iter/s, 2.133e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 106.75 Tflops/s, hfu: 106.75 Tflops/s, 388.356 iter/s, 2.575e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 80.025 Tflops/s, hfu: 80.025 Tflops/s, 291.128 iter/s, 3.435e-03 s/iter, (0.085, 0.000, 0.014) sec
SP=(1,8),S=(10240,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.25 Tflops/s, hfu: 0.25 Tflops/s, 372.298 iter/s, 2.686e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.452 Tflops/s, hfu: 0.452 Tflops/s, 673.649 iter/s, 1.484e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.213 Tflops/s, hfu: 0.213 Tflops/s, 317.053 iter/s, 3.154e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 4.203 Tflops/s, hfu: 4.203 Tflops/s, 3131.263 iter/s, 3.194e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 5.97 Tflops/s, hfu: 5.97 Tflops/s, 4448.240 iter/s, 2.248e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 6.39 Tflops/s, hfu: 6.39 Tflops/s, 4760.635 iter/s, 2.101e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 7.143 Tflops/s, hfu: 7.143 Tflops/s, 5321.640 iter/s, 1.879e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 11.709 Tflops/s, hfu: 11.709 Tflops/s, 8724.176 iter/s, 1.146e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 12.184 Tflops/s, hfu: 12.184 Tflops/s, 9077.705 iter/s, 1.102e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 14.242 Tflops/s, hfu: 14.242 Tflops/s, 10611.205 iter/s, 9.424e-05 s/iter, (0.069, 0.000, 0.000) sec
mfu: 16.233 Tflops/s, hfu: 16.233 Tflops/s, 12094.823 iter/s, 8.268e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(10240,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.496 Tflops/s, hfu: 0.496 Tflops/s, 369.513 iter/s, 2.706e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.896 Tflops/s, hfu: 0.896 Tflops/s, 667.362 iter/s, 1.498e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.426 Tflops/s, hfu: 0.426 Tflops/s, 317.465 iter/s, 3.150e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 8.026 Tflops/s, hfu: 8.026 Tflops/s, 2989.930 iter/s, 3.345e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 11.496 Tflops/s, hfu: 11.496 Tflops/s, 4282.582 iter/s, 2.335e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 12.529 Tflops/s, hfu: 12.529 Tflops/s, 4667.488 iter/s, 2.142e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 13.399 Tflops/s, hfu: 13.399 Tflops/s, 4991.415 iter/s, 2.003e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 17.37 Tflops/s, hfu: 17.37 Tflops/s, 6470.649 iter/s, 1.545e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 19.645 Tflops/s, hfu: 19.645 Tflops/s, 7318.501 iter/s, 1.366e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.154 Tflops/s, hfu: 20.154 Tflops/s, 7507.958 iter/s, 1.332e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 23.818 Tflops/s, hfu: 23.818 Tflops/s, 8872.799 iter/s, 1.127e-04 s/iter, (0.095, 0.000, 0.000) sec
SP=(1,8),S=(10240,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.741 Tflops/s, hfu: 0.741 Tflops/s, 368.282 iter/s, 2.715e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.326 Tflops/s, hfu: 1.326 Tflops/s, 658.767 iter/s, 1.518e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.632 Tflops/s, hfu: 0.632 Tflops/s, 313.709 iter/s, 3.188e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 11.864 Tflops/s, hfu: 11.864 Tflops/s, 2946.376 iter/s, 3.394e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 14.993 Tflops/s, hfu: 14.993 Tflops/s, 3723.673 iter/s, 2.686e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.344 Tflops/s, hfu: 16.344 Tflops/s, 4059.101 iter/s, 2.464e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 17.026 Tflops/s, hfu: 17.026 Tflops/s, 4228.401 iter/s, 2.365e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 23.788 Tflops/s, hfu: 23.788 Tflops/s, 5907.931 iter/s, 1.693e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 24.557 Tflops/s, hfu: 24.557 Tflops/s, 6098.751 iter/s, 1.640e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.233 Tflops/s, hfu: 33.233 Tflops/s, 8253.549 iter/s, 1.212e-04 s/iter, (0.072, 0.000, 0.000) sec
mfu: 35.869 Tflops/s, hfu: 35.869 Tflops/s, 8908.210 iter/s, 1.123e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(10240,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.989 Tflops/s, hfu: 0.989 Tflops/s, 368.383 iter/s, 2.715e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.77 Tflops/s, hfu: 1.77 Tflops/s, 659.295 iter/s, 1.517e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.847 Tflops/s, hfu: 0.847 Tflops/s, 315.375 iter/s, 3.171e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 15.716 Tflops/s, hfu: 15.716 Tflops/s, 2927.263 iter/s, 3.416e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 19.79 Tflops/s, hfu: 19.79 Tflops/s, 3686.119 iter/s, 2.713e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.385 Tflops/s, hfu: 21.385 Tflops/s, 3983.175 iter/s, 2.511e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.387 Tflops/s, hfu: 22.387 Tflops/s, 4169.864 iter/s, 2.398e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 32.094 Tflops/s, hfu: 32.094 Tflops/s, 5978.001 iter/s, 1.673e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 33.457 Tflops/s, hfu: 33.457 Tflops/s, 6231.927 iter/s, 1.605e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 32.905 Tflops/s, hfu: 32.905 Tflops/s, 6128.953 iter/s, 1.632e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 39.989 Tflops/s, hfu: 39.989 Tflops/s, 7448.457 iter/s, 1.343e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(10240,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.239 Tflops/s, hfu: 1.239 Tflops/s, 369.293 iter/s, 2.708e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.05 Tflops/s, hfu: 2.05 Tflops/s, 611.085 iter/s, 1.636e-03 s/iter, (0.018, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 1.053 Tflops/s, hfu: 1.053 Tflops/s, 313.725 iter/s, 3.188e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 19.437 Tflops/s, hfu: 19.437 Tflops/s, 2896.401 iter/s, 3.453e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.652 Tflops/s, hfu: 22.652 Tflops/s, 3375.368 iter/s, 2.963e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 23.773 Tflops/s, hfu: 23.773 Tflops/s, 3542.381 iter/s, 2.823e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 25.627 Tflops/s, hfu: 25.627 Tflops/s, 3818.660 iter/s, 2.619e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 38.977 Tflops/s, hfu: 38.977 Tflops/s, 5808.010 iter/s, 1.722e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 36.678 Tflops/s, hfu: 36.678 Tflops/s, 5465.436 iter/s, 1.830e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 37.309 Tflops/s, hfu: 37.309 Tflops/s, 5559.509 iter/s, 1.799e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 45.173 Tflops/s, hfu: 45.173 Tflops/s, 6731.287 iter/s, 1.486e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(10240,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.452 Tflops/s, hfu: 1.452 Tflops/s, 360.686 iter/s, 2.772e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.619 Tflops/s, hfu: 2.619 Tflops/s, 650.360 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.259 Tflops/s, hfu: 1.259 Tflops/s, 312.714 iter/s, 3.198e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 22.924 Tflops/s, hfu: 22.924 Tflops/s, 2846.602 iter/s, 3.513e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 27.702 Tflops/s, hfu: 27.702 Tflops/s, 3439.925 iter/s, 2.907e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 28.58 Tflops/s, hfu: 28.58 Tflops/s, 3549.019 iter/s, 2.818e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.616 Tflops/s, hfu: 29.616 Tflops/s, 3677.552 iter/s, 2.719e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 45.875 Tflops/s, hfu: 45.875 Tflops/s, 5696.578 iter/s, 1.755e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.02 Tflops/s, hfu: 43.02 Tflops/s, 5342.109 iter/s, 1.872e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 42.249 Tflops/s, hfu: 42.249 Tflops/s, 5246.370 iter/s, 1.906e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 49.35 Tflops/s, hfu: 49.35 Tflops/s, 6128.052 iter/s, 1.632e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(10240,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.716 Tflops/s, hfu: 1.716 Tflops/s, 365.276 iter/s, 2.738e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.046 Tflops/s, hfu: 3.046 Tflops/s, 648.390 iter/s, 1.542e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.468 Tflops/s, hfu: 1.468 Tflops/s, 312.464 iter/s, 3.200e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 27.359 Tflops/s, hfu: 27.359 Tflops/s, 2912.056 iter/s, 3.434e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 32.258 Tflops/s, hfu: 32.258 Tflops/s, 3433.406 iter/s, 2.913e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 33.115 Tflops/s, hfu: 33.115 Tflops/s, 3524.701 iter/s, 2.837e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.562 Tflops/s, hfu: 33.562 Tflops/s, 3572.245 iter/s, 2.799e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 49.93 Tflops/s, hfu: 49.93 Tflops/s, 5314.400 iter/s, 1.882e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 48.751 Tflops/s, hfu: 48.751 Tflops/s, 5188.875 iter/s, 1.927e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 46.572 Tflops/s, hfu: 46.572 Tflops/s, 4956.973 iter/s, 2.017e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 51.387 Tflops/s, hfu: 51.387 Tflops/s, 5469.502 iter/s, 1.828e-04 s/iter, (0.069, 0.000, 0.001) sec
SP=(1,8),S=(10240,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.912 Tflops/s, hfu: 1.912 Tflops/s, 356.219 iter/s, 2.807e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.472 Tflops/s, hfu: 3.472 Tflops/s, 646.745 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.675 Tflops/s, hfu: 1.675 Tflops/s, 312.081 iter/s, 3.204e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 30.606 Tflops/s, hfu: 30.606 Tflops/s, 2850.432 iter/s, 3.508e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.164 Tflops/s, hfu: 36.164 Tflops/s, 3368.001 iter/s, 2.969e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.568 Tflops/s, hfu: 36.568 Tflops/s, 3405.623 iter/s, 2.936e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 35.738 Tflops/s, hfu: 35.738 Tflops/s, 3328.363 iter/s, 3.004e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 56.558 Tflops/s, hfu: 56.558 Tflops/s, 5267.371 iter/s, 1.898e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 53.166 Tflops/s, hfu: 53.166 Tflops/s, 4951.476 iter/s, 2.020e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.239 Tflops/s, hfu: 50.239 Tflops/s, 4678.844 iter/s, 2.137e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 55.586 Tflops/s, hfu: 55.586 Tflops/s, 5176.841 iter/s, 1.932e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(10240,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.445 Tflops/s, hfu: 2.445 Tflops/s, 364.291 iter/s, 2.745e-03 s/iter, (0.044, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.397 Tflops/s, hfu: 4.397 Tflops/s, 655.150 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.083 Tflops/s, hfu: 2.083 Tflops/s, 310.354 iter/s, 3.222e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 36.145 Tflops/s, hfu: 36.145 Tflops/s, 2693.037 iter/s, 3.713e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.23 Tflops/s, hfu: 38.23 Tflops/s, 2848.354 iter/s, 3.511e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 38.198 Tflops/s, hfu: 38.198 Tflops/s, 2845.954 iter/s, 3.514e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 42.143 Tflops/s, hfu: 42.143 Tflops/s, 3139.914 iter/s, 3.185e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 64.483 Tflops/s, hfu: 64.483 Tflops/s, 4804.366 iter/s, 2.081e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.049 Tflops/s, hfu: 58.049 Tflops/s, 4324.960 iter/s, 2.312e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.099 Tflops/s, hfu: 58.099 Tflops/s, 4328.705 iter/s, 2.310e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 61.075 Tflops/s, hfu: 61.075 Tflops/s, 4550.419 iter/s, 2.198e-04 s/iter, (0.078, 0.000, 0.001) sec
SP=(1,8),S=(10240,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.927 Tflops/s, hfu: 2.927 Tflops/s, 363.491 iter/s, 2.751e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.242 Tflops/s, hfu: 5.242 Tflops/s, 650.961 iter/s, 1.536e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.485 Tflops/s, hfu: 2.485 Tflops/s, 308.599 iter/s, 3.240e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 43.647 Tflops/s, hfu: 43.647 Tflops/s, 2709.968 iter/s, 3.690e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 47.436 Tflops/s, hfu: 47.436 Tflops/s, 2945.196 iter/s, 3.395e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 49.059 Tflops/s, hfu: 49.059 Tflops/s, 3045.958 iter/s, 3.283e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.955 Tflops/s, hfu: 48.955 Tflops/s, 3039.514 iter/s, 3.290e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 73.306 Tflops/s, hfu: 73.306 Tflops/s, 4551.413 iter/s, 2.197e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 67.372 Tflops/s, hfu: 67.372 Tflops/s, 4182.980 iter/s, 2.391e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 63.322 Tflops/s, hfu: 63.322 Tflops/s, 3931.559 iter/s, 2.544e-04 s/iter, (0.070, 0.001, 0.001) sec
mfu: 61.983 Tflops/s, hfu: 61.983 Tflops/s, 3848.404 iter/s, 2.598e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(10240,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.398 Tflops/s, hfu: 3.398 Tflops/s, 361.665 iter/s, 2.765e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.053 Tflops/s, hfu: 6.053 Tflops/s, 644.232 iter/s, 1.552e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.884 Tflops/s, hfu: 2.884 Tflops/s, 306.937 iter/s, 3.258e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 51.554 Tflops/s, hfu: 51.554 Tflops/s, 2743.635 iter/s, 3.645e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 53.628 Tflops/s, hfu: 53.628 Tflops/s, 2854.012 iter/s, 3.504e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 52.939 Tflops/s, hfu: 52.939 Tflops/s, 2817.346 iter/s, 3.549e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 51.719 Tflops/s, hfu: 51.719 Tflops/s, 2752.395 iter/s, 3.633e-04 s/iter, (0.077, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 78.582 Tflops/s, hfu: 78.582 Tflops/s, 4182.000 iter/s, 2.391e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 73.19 Tflops/s, hfu: 73.19 Tflops/s, 3895.052 iter/s, 2.567e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 68.411 Tflops/s, hfu: 68.411 Tflops/s, 3640.706 iter/s, 2.747e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 66.491 Tflops/s, hfu: 66.491 Tflops/s, 3538.570 iter/s, 2.826e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(10240,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.818 Tflops/s, hfu: 3.818 Tflops/s, 355.541 iter/s, 2.813e-03 s/iter, (0.045, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.005 Tflops/s, hfu: 7.005 Tflops/s, 652.429 iter/s, 1.533e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.297 Tflops/s, hfu: 3.297 Tflops/s, 307.038 iter/s, 3.257e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 40.618 Tflops/s, hfu: 40.618 Tflops/s, 1891.418 iter/s, 5.287e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 41.794 Tflops/s, hfu: 41.794 Tflops/s, 1946.162 iter/s, 5.138e-04 s/iter, (0.072, 0.001, 0.002) sec
mfu: 41.853 Tflops/s, hfu: 41.853 Tflops/s, 1948.953 iter/s, 5.131e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 42.769 Tflops/s, hfu: 42.769 Tflops/s, 1991.588 iter/s, 5.021e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 84.886 Tflops/s, hfu: 84.886 Tflops/s, 3952.819 iter/s, 2.530e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 78.653 Tflops/s, hfu: 78.653 Tflops/s, 3662.574 iter/s, 2.730e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 73.518 Tflops/s, hfu: 73.518 Tflops/s, 3423.438 iter/s, 2.921e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 63.999 Tflops/s, hfu: 63.999 Tflops/s, 2980.164 iter/s, 3.356e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(10240,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.825 Tflops/s, hfu: 4.825 Tflops/s, 359.489 iter/s, 2.782e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.753 Tflops/s, hfu: 8.753 Tflops/s, 652.145 iter/s, 1.533e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.194 Tflops/s, hfu: 4.194 Tflops/s, 312.485 iter/s, 3.200e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 59.989 Tflops/s, hfu: 59.989 Tflops/s, 2234.777 iter/s, 4.475e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 59.017 Tflops/s, hfu: 59.017 Tflops/s, 2198.537 iter/s, 4.548e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.52 Tflops/s, hfu: 58.52 Tflops/s, 2180.055 iter/s, 4.587e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.936 Tflops/s, hfu: 64.936 Tflops/s, 2419.058 iter/s, 4.134e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 94.8 Tflops/s, hfu: 94.8 Tflops/s, 3531.572 iter/s, 2.832e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 85.679 Tflops/s, hfu: 85.679 Tflops/s, 3191.788 iter/s, 3.133e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.892 Tflops/s, hfu: 79.892 Tflops/s, 2976.190 iter/s, 3.360e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 67.264 Tflops/s, hfu: 67.264 Tflops/s, 2505.763 iter/s, 3.991e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(10240,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.874 Tflops/s, hfu: 5.874 Tflops/s, 364.692 iter/s, 2.742e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.432 Tflops/s, hfu: 10.432 Tflops/s, 647.699 iter/s, 1.544e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.996 Tflops/s, hfu: 4.996 Tflops/s, 310.181 iter/s, 3.224e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 73.352 Tflops/s, hfu: 73.352 Tflops/s, 2277.158 iter/s, 4.391e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.782 Tflops/s, hfu: 71.782 Tflops/s, 2228.402 iter/s, 4.488e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.185 Tflops/s, hfu: 70.185 Tflops/s, 2178.839 iter/s, 4.590e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.715 Tflops/s, hfu: 70.715 Tflops/s, 2195.293 iter/s, 4.555e-04 s/iter, (0.070, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 103.297 Tflops/s, hfu: 103.297 Tflops/s, 3206.773 iter/s, 3.118e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 92.598 Tflops/s, hfu: 92.598 Tflops/s, 2874.621 iter/s, 3.479e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 83.719 Tflops/s, hfu: 83.719 Tflops/s, 2598.969 iter/s, 3.848e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 70.836 Tflops/s, hfu: 70.836 Tflops/s, 2199.039 iter/s, 4.547e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(10240,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.805 Tflops/s, hfu: 6.805 Tflops/s, 362.166 iter/s, 2.761e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.28 Tflops/s, hfu: 12.28 Tflops/s, 653.542 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.825 Tflops/s, hfu: 5.825 Tflops/s, 309.988 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 80.268 Tflops/s, hfu: 80.268 Tflops/s, 2135.876 iter/s, 4.682e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 80.37 Tflops/s, hfu: 80.37 Tflops/s, 2138.580 iter/s, 4.676e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.586 Tflops/s, hfu: 79.586 Tflops/s, 2117.711 iter/s, 4.722e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 74.919 Tflops/s, hfu: 74.919 Tflops/s, 1993.525 iter/s, 5.016e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 111.392 Tflops/s, hfu: 111.392 Tflops/s, 2964.052 iter/s, 3.374e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 98.16 Tflops/s, hfu: 98.16 Tflops/s, 2611.948 iter/s, 3.829e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 87.342 Tflops/s, hfu: 87.342 Tflops/s, 2324.111 iter/s, 4.303e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 72.534 Tflops/s, hfu: 72.534 Tflops/s, 1930.085 iter/s, 5.181e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(10240,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.718 Tflops/s, hfu: 7.718 Tflops/s, 359.394 iter/s, 2.782e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.88 Tflops/s, hfu: 13.88 Tflops/s, 646.342 iter/s, 1.547e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.652 Tflops/s, hfu: 6.652 Tflops/s, 309.780 iter/s, 3.228e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 84.619 Tflops/s, hfu: 84.619 Tflops/s, 1970.179 iter/s, 5.076e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 85.402 Tflops/s, hfu: 85.402 Tflops/s, 1988.420 iter/s, 5.029e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 83.112 Tflops/s, hfu: 83.112 Tflops/s, 1935.104 iter/s, 5.168e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 77.252 Tflops/s, hfu: 77.252 Tflops/s, 1798.665 iter/s, 5.560e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 117.825 Tflops/s, hfu: 117.825 Tflops/s, 2743.334 iter/s, 3.645e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 102.589 Tflops/s, hfu: 102.589 Tflops/s, 2388.596 iter/s, 4.187e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 90.775 Tflops/s, hfu: 90.775 Tflops/s, 2113.521 iter/s, 4.731e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 74.875 Tflops/s, hfu: 74.875 Tflops/s, 1743.327 iter/s, 5.736e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(10240,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.57 Tflops/s, hfu: 9.57 Tflops/s, 356.499 iter/s, 2.805e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.365 Tflops/s, hfu: 17.365 Tflops/s, 646.915 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.326 Tflops/s, hfu: 8.326 Tflops/s, 310.164 iter/s, 3.224e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 94.645 Tflops/s, hfu: 94.645 Tflops/s, 1762.897 iter/s, 5.672e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 95.567 Tflops/s, hfu: 95.567 Tflops/s, 1780.069 iter/s, 5.618e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.683 Tflops/s, hfu: 90.683 Tflops/s, 1689.098 iter/s, 5.920e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.83 Tflops/s, hfu: 84.83 Tflops/s, 1580.078 iter/s, 6.329e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 126.377 Tflops/s, hfu: 126.377 Tflops/s, 2353.960 iter/s, 4.248e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 107.941 Tflops/s, hfu: 107.941 Tflops/s, 2010.551 iter/s, 4.974e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 96.792 Tflops/s, hfu: 96.792 Tflops/s, 1802.893 iter/s, 5.547e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 79.526 Tflops/s, hfu: 79.526 Tflops/s, 1481.288 iter/s, 6.751e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(10240,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.569 Tflops/s, hfu: 11.569 Tflops/s, 359.163 iter/s, 2.784e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.82 Tflops/s, hfu: 20.82 Tflops/s, 646.342 iter/s, 1.547e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.962 Tflops/s, hfu: 9.962 Tflops/s, 309.270 iter/s, 3.233e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 101.847 Tflops/s, hfu: 101.847 Tflops/s, 1580.878 iter/s, 6.326e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 99.643 Tflops/s, hfu: 99.643 Tflops/s, 1546.666 iter/s, 6.466e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 96.444 Tflops/s, hfu: 96.444 Tflops/s, 1497.006 iter/s, 6.680e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 89.923 Tflops/s, hfu: 89.923 Tflops/s, 1395.790 iter/s, 7.164e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 131.26 Tflops/s, hfu: 131.26 Tflops/s, 2037.423 iter/s, 4.908e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.311 Tflops/s, hfu: 114.311 Tflops/s, 1774.333 iter/s, 5.636e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 100.356 Tflops/s, hfu: 100.356 Tflops/s, 1557.729 iter/s, 6.420e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 82.273 Tflops/s, hfu: 82.273 Tflops/s, 1277.048 iter/s, 7.831e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(10240,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.453 Tflops/s, hfu: 13.453 Tflops/s, 357.969 iter/s, 2.794e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.751 Tflops/s, hfu: 24.751 Tflops/s, 658.602 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 11.9 Tflops/s, hfu: 11.9 Tflops/s, 316.643 iter/s, 3.158e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 106.075 Tflops/s, hfu: 106.075 Tflops/s, 1411.281 iter/s, 7.086e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 104.238 Tflops/s, hfu: 104.238 Tflops/s, 1386.839 iter/s, 7.211e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 99.021 Tflops/s, hfu: 99.021 Tflops/s, 1317.440 iter/s, 7.590e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 94.388 Tflops/s, hfu: 94.388 Tflops/s, 1255.789 iter/s, 7.963e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 138.056 Tflops/s, hfu: 138.056 Tflops/s, 1836.777 iter/s, 5.444e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 117.347 Tflops/s, hfu: 117.347 Tflops/s, 1561.251 iter/s, 6.405e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 102.121 Tflops/s, hfu: 102.121 Tflops/s, 1358.681 iter/s, 7.360e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 81.743 Tflops/s, hfu: 81.743 Tflops/s, 1087.552 iter/s, 9.195e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(10240,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.309 Tflops/s, hfu: 15.309 Tflops/s, 356.439 iter/s, 2.806e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.116 Tflops/s, hfu: 28.116 Tflops/s, 654.624 iter/s, 1.528e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.454 Tflops/s, hfu: 13.454 Tflops/s, 313.254 iter/s, 3.192e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 109.763 Tflops/s, hfu: 109.763 Tflops/s, 1277.805 iter/s, 7.826e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 104.306 Tflops/s, hfu: 104.306 Tflops/s, 1214.276 iter/s, 8.235e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 100.816 Tflops/s, hfu: 100.816 Tflops/s, 1173.654 iter/s, 8.520e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 96.133 Tflops/s, hfu: 96.133 Tflops/s, 1119.139 iter/s, 8.935e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 141.091 Tflops/s, hfu: 141.091 Tflops/s, 1642.511 iter/s, 6.088e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 120.206 Tflops/s, hfu: 120.206 Tflops/s, 1399.384 iter/s, 7.146e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.585 Tflops/s, hfu: 104.585 Tflops/s, 1217.529 iter/s, 8.213e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 84.496 Tflops/s, hfu: 84.496 Tflops/s, 983.663 iter/s, 1.017e-03 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(10240,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.049 Tflops/s, hfu: 19.049 Tflops/s, 354.824 iter/s, 2.818e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.168 Tflops/s, hfu: 35.168 Tflops/s, 655.063 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.814 Tflops/s, hfu: 16.814 Tflops/s, 313.187 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 104.057 Tflops/s, hfu: 104.057 Tflops/s, 969.105 iter/s, 1.032e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 107.479 Tflops/s, hfu: 107.479 Tflops/s, 1000.977 iter/s, 9.990e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 99.079 Tflops/s, hfu: 99.079 Tflops/s, 922.741 iter/s, 1.084e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 104.817 Tflops/s, hfu: 104.817 Tflops/s, 976.189 iter/s, 1.024e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 147.996 Tflops/s, hfu: 147.996 Tflops/s, 1378.322 iter/s, 7.255e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 123.158 Tflops/s, hfu: 123.158 Tflops/s, 1146.999 iter/s, 8.718e-04 s/iter, (0.077, 0.000, 0.003) sec
mfu: 108.155 Tflops/s, hfu: 108.155 Tflops/s, 1007.268 iter/s, 9.928e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 86.094 Tflops/s, hfu: 86.094 Tflops/s, 801.811 iter/s, 1.247e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(10240,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.804 Tflops/s, hfu: 22.804 Tflops/s, 353.963 iter/s, 2.825e-03 s/iter, (0.035, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.118 Tflops/s, hfu: 42.118 Tflops/s, 653.756 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 20.183 Tflops/s, hfu: 20.183 Tflops/s, 313.279 iter/s, 3.192e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 124.843 Tflops/s, hfu: 124.843 Tflops/s, 968.910 iter/s, 1.032e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 122.534 Tflops/s, hfu: 122.534 Tflops/s, 950.990 iter/s, 1.052e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 117.814 Tflops/s, hfu: 117.814 Tflops/s, 914.358 iter/s, 1.094e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 102.932 Tflops/s, hfu: 102.932 Tflops/s, 798.855 iter/s, 1.252e-03 s/iter, (0.078, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 153.319 Tflops/s, hfu: 153.319 Tflops/s, 1189.910 iter/s, 8.404e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 128.05 Tflops/s, hfu: 128.05 Tflops/s, 993.799 iter/s, 1.006e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.561 Tflops/s, hfu: 110.561 Tflops/s, 858.063 iter/s, 1.165e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 88.254 Tflops/s, hfu: 88.254 Tflops/s, 684.943 iter/s, 1.460e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(10240,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 26.36 Tflops/s, hfu: 26.36 Tflops/s, 350.706 iter/s, 2.851e-03 s/iter, (0.034, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.382 Tflops/s, hfu: 49.382 Tflops/s, 657.013 iter/s, 1.522e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 23.502 Tflops/s, hfu: 23.502 Tflops/s, 312.685 iter/s, 3.198e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 126.217 Tflops/s, hfu: 126.217 Tflops/s, 839.636 iter/s, 1.191e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 114.634 Tflops/s, hfu: 114.634 Tflops/s, 762.581 iter/s, 1.311e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 113.031 Tflops/s, hfu: 113.031 Tflops/s, 751.916 iter/s, 1.330e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 107.949 Tflops/s, hfu: 107.949 Tflops/s, 718.110 iter/s, 1.393e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 158.6 Tflops/s, hfu: 158.6 Tflops/s, 1055.057 iter/s, 9.478e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 129.698 Tflops/s, hfu: 129.698 Tflops/s, 862.789 iter/s, 1.159e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 111.853 Tflops/s, hfu: 111.853 Tflops/s, 744.083 iter/s, 1.344e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 88.462 Tflops/s, hfu: 88.462 Tflops/s, 588.479 iter/s, 1.699e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(10240,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.754 Tflops/s, hfu: 30.754 Tflops/s, 358.022 iter/s, 2.793e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 54.938 Tflops/s, hfu: 54.938 Tflops/s, 639.566 iter/s, 1.564e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.849 Tflops/s, hfu: 26.849 Tflops/s, 312.563 iter/s, 3.199e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 135.445 Tflops/s, hfu: 135.445 Tflops/s, 788.395 iter/s, 1.268e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 120.637 Tflops/s, hfu: 120.637 Tflops/s, 702.200 iter/s, 1.424e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 110.967 Tflops/s, hfu: 110.967 Tflops/s, 645.911 iter/s, 1.548e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 115.934 Tflops/s, hfu: 115.934 Tflops/s, 674.826 iter/s, 1.482e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 160.07 Tflops/s, hfu: 160.07 Tflops/s, 931.730 iter/s, 1.073e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 132.033 Tflops/s, hfu: 132.033 Tflops/s, 768.531 iter/s, 1.301e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 113.148 Tflops/s, hfu: 113.148 Tflops/s, 658.609 iter/s, 1.518e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 88.302 Tflops/s, hfu: 88.302 Tflops/s, 513.982 iter/s, 1.946e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(10240,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.022 Tflops/s, hfu: 38.022 Tflops/s, 354.105 iter/s, 2.824e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.089 Tflops/s, hfu: 69.089 Tflops/s, 643.441 iter/s, 1.554e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 33.129 Tflops/s, hfu: 33.129 Tflops/s, 308.541 iter/s, 3.241e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 135.218 Tflops/s, hfu: 135.218 Tflops/s, 629.659 iter/s, 1.588e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 118.576 Tflops/s, hfu: 118.576 Tflops/s, 552.162 iter/s, 1.811e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 128.109 Tflops/s, hfu: 128.109 Tflops/s, 596.553 iter/s, 1.676e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 107.445 Tflops/s, hfu: 107.445 Tflops/s, 500.328 iter/s, 1.999e-03 s/iter, (0.087, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 163.845 Tflops/s, hfu: 163.845 Tflops/s, 762.963 iter/s, 1.311e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 134.711 Tflops/s, hfu: 134.711 Tflops/s, 627.299 iter/s, 1.594e-03 s/iter, (0.080, 0.000, 0.006) sec
mfu: 115.565 Tflops/s, hfu: 115.565 Tflops/s, 538.144 iter/s, 1.858e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 89.584 Tflops/s, hfu: 89.584 Tflops/s, 417.159 iter/s, 2.397e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(10240,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.581 Tflops/s, hfu: 45.581 Tflops/s, 353.753 iter/s, 2.827e-03 s/iter, (0.036, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 84.153 Tflops/s, hfu: 84.153 Tflops/s, 653.115 iter/s, 1.531e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 40.837 Tflops/s, hfu: 40.837 Tflops/s, 316.936 iter/s, 3.155e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 136.325 Tflops/s, hfu: 136.325 Tflops/s, 529.009 iter/s, 1.890e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 123.581 Tflops/s, hfu: 123.581 Tflops/s, 479.559 iter/s, 2.085e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 113.997 Tflops/s, hfu: 113.997 Tflops/s, 442.365 iter/s, 2.261e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 113.952 Tflops/s, hfu: 113.952 Tflops/s, 442.193 iter/s, 2.261e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 166.987 Tflops/s, hfu: 166.987 Tflops/s, 647.994 iter/s, 1.543e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 137.134 Tflops/s, hfu: 137.134 Tflops/s, 532.148 iter/s, 1.879e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 116.891 Tflops/s, hfu: 116.891 Tflops/s, 453.595 iter/s, 2.205e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 90.66 Tflops/s, hfu: 90.66 Tflops/s, 351.806 iter/s, 2.842e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(10240,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.517 Tflops/s, hfu: 53.517 Tflops/s, 356.009 iter/s, 2.809e-03 s/iter, (0.038, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 84.975 Tflops/s, hfu: 84.975 Tflops/s, 565.282 iter/s, 1.769e-03 s/iter, (0.022, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 44.448 Tflops/s, hfu: 44.448 Tflops/s, 295.682 iter/s, 3.382e-03 s/iter, (0.038, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 139.371 Tflops/s, hfu: 139.371 Tflops/s, 463.569 iter/s, 2.157e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 120.505 Tflops/s, hfu: 120.505 Tflops/s, 400.818 iter/s, 2.495e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 129.264 Tflops/s, hfu: 129.264 Tflops/s, 429.951 iter/s, 2.326e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 118.061 Tflops/s, hfu: 118.061 Tflops/s, 392.688 iter/s, 2.547e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 169.274 Tflops/s, hfu: 169.274 Tflops/s, 563.033 iter/s, 1.776e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 138.736 Tflops/s, hfu: 138.736 Tflops/s, 461.457 iter/s, 2.167e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 116.737 Tflops/s, hfu: 116.737 Tflops/s, 388.286 iter/s, 2.575e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 90.12 Tflops/s, hfu: 90.12 Tflops/s, 299.754 iter/s, 3.336e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(10240,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.109 Tflops/s, hfu: 55.109 Tflops/s, 320.778 iter/s, 3.117e-03 s/iter, (0.040, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 82.356 Tflops/s, hfu: 82.356 Tflops/s, 479.376 iter/s, 2.086e-03 s/iter, (0.025, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 46.568 Tflops/s, hfu: 46.568 Tflops/s, 271.062 iter/s, 3.689e-03 s/iter, (0.040, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 141.132 Tflops/s, hfu: 141.132 Tflops/s, 410.749 iter/s, 2.435e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 134.456 Tflops/s, hfu: 134.456 Tflops/s, 391.320 iter/s, 2.555e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 126.862 Tflops/s, hfu: 126.862 Tflops/s, 369.217 iter/s, 2.708e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 126.363 Tflops/s, hfu: 126.363 Tflops/s, 367.766 iter/s, 2.719e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 170.845 Tflops/s, hfu: 170.845 Tflops/s, 497.223 iter/s, 2.011e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 139.565 Tflops/s, hfu: 139.565 Tflops/s, 406.187 iter/s, 2.462e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 118.119 Tflops/s, hfu: 118.119 Tflops/s, 343.770 iter/s, 2.909e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 91.135 Tflops/s, hfu: 91.135 Tflops/s, 265.238 iter/s, 3.770e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(12288,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.3 Tflops/s, hfu: 0.3 Tflops/s, 372.291 iter/s, 2.686e-03 s/iter, (0.038, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.549 Tflops/s, hfu: 0.549 Tflops/s, 681.840 iter/s, 1.467e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 0.261 Tflops/s, hfu: 0.261 Tflops/s, 324.159 iter/s, 3.085e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 4.985 Tflops/s, hfu: 4.985 Tflops/s, 3094.979 iter/s, 3.231e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 7.084 Tflops/s, hfu: 7.084 Tflops/s, 4398.311 iter/s, 2.274e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 7.992 Tflops/s, hfu: 7.992 Tflops/s, 4962.090 iter/s, 2.015e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 8.358 Tflops/s, hfu: 8.358 Tflops/s, 5189.521 iter/s, 1.927e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 12.405 Tflops/s, hfu: 12.405 Tflops/s, 7702.261 iter/s, 1.298e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 12.998 Tflops/s, hfu: 12.998 Tflops/s, 8070.243 iter/s, 1.239e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 15.478 Tflops/s, hfu: 15.478 Tflops/s, 9610.210 iter/s, 1.041e-04 s/iter, (0.069, 0.000, 0.000) sec
mfu: 21.532 Tflops/s, hfu: 21.532 Tflops/s, 13368.984 iter/s, 7.480e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(12288,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.595 Tflops/s, hfu: 0.595 Tflops/s, 369.132 iter/s, 2.709e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.072 Tflops/s, hfu: 1.072 Tflops/s, 665.409 iter/s, 1.503e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.512 Tflops/s, hfu: 0.512 Tflops/s, 318.099 iter/s, 3.144e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 9.566 Tflops/s, hfu: 9.566 Tflops/s, 2969.827 iter/s, 3.367e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.135 Tflops/s, hfu: 13.135 Tflops/s, 4077.771 iter/s, 2.452e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 14.352 Tflops/s, hfu: 14.352 Tflops/s, 4455.534 iter/s, 2.244e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 15.329 Tflops/s, hfu: 15.329 Tflops/s, 4758.823 iter/s, 2.101e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 22.382 Tflops/s, hfu: 22.382 Tflops/s, 6948.305 iter/s, 1.439e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.942 Tflops/s, hfu: 23.942 Tflops/s, 7432.513 iter/s, 1.345e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 26.806 Tflops/s, hfu: 26.806 Tflops/s, 8321.683 iter/s, 1.202e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 31.625 Tflops/s, hfu: 31.625 Tflops/s, 9817.782 iter/s, 1.019e-04 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(12288,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.885 Tflops/s, hfu: 0.885 Tflops/s, 366.117 iter/s, 2.731e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.603 Tflops/s, hfu: 1.603 Tflops/s, 663.414 iter/s, 1.507e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.768 Tflops/s, hfu: 0.768 Tflops/s, 317.868 iter/s, 3.146e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 13.672 Tflops/s, hfu: 13.672 Tflops/s, 2829.591 iter/s, 3.534e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 18.696 Tflops/s, hfu: 18.696 Tflops/s, 3869.370 iter/s, 2.584e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.132 Tflops/s, hfu: 20.132 Tflops/s, 4166.528 iter/s, 2.400e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.64 Tflops/s, hfu: 20.64 Tflops/s, 4271.752 iter/s, 2.341e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 32.247 Tflops/s, hfu: 32.247 Tflops/s, 6673.786 iter/s, 1.498e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 34.6 Tflops/s, hfu: 34.6 Tflops/s, 7160.861 iter/s, 1.396e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 36.828 Tflops/s, hfu: 36.828 Tflops/s, 7621.952 iter/s, 1.312e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 37.787 Tflops/s, hfu: 37.787 Tflops/s, 7820.320 iter/s, 1.279e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(12288,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.179 Tflops/s, hfu: 1.179 Tflops/s, 366.017 iter/s, 2.732e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.118 Tflops/s, hfu: 2.118 Tflops/s, 657.543 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.014 Tflops/s, hfu: 1.014 Tflops/s, 314.856 iter/s, 3.176e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 18.171 Tflops/s, hfu: 18.171 Tflops/s, 2820.461 iter/s, 3.546e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.773 Tflops/s, hfu: 22.773 Tflops/s, 3534.868 iter/s, 2.829e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 24.944 Tflops/s, hfu: 24.944 Tflops/s, 3871.767 iter/s, 2.583e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.187 Tflops/s, hfu: 25.187 Tflops/s, 3909.549 iter/s, 2.558e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 40.455 Tflops/s, hfu: 40.455 Tflops/s, 6279.514 iter/s, 1.592e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 41.198 Tflops/s, hfu: 41.198 Tflops/s, 6394.843 iter/s, 1.564e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 37.726 Tflops/s, hfu: 37.726 Tflops/s, 5855.898 iter/s, 1.708e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 42.688 Tflops/s, hfu: 42.688 Tflops/s, 6626.027 iter/s, 1.509e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(12288,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.464 Tflops/s, hfu: 1.464 Tflops/s, 363.530 iter/s, 2.751e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.648 Tflops/s, hfu: 2.648 Tflops/s, 657.590 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.271 Tflops/s, hfu: 1.271 Tflops/s, 315.539 iter/s, 3.169e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 22.777 Tflops/s, hfu: 22.777 Tflops/s, 2828.374 iter/s, 3.536e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 27.142 Tflops/s, hfu: 27.142 Tflops/s, 3370.362 iter/s, 2.967e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.525 Tflops/s, hfu: 29.525 Tflops/s, 3666.334 iter/s, 2.728e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 30.787 Tflops/s, hfu: 30.787 Tflops/s, 3822.981 iter/s, 2.616e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 47.862 Tflops/s, hfu: 47.862 Tflops/s, 5943.325 iter/s, 1.683e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 43.094 Tflops/s, hfu: 43.094 Tflops/s, 5351.256 iter/s, 1.869e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 42.612 Tflops/s, hfu: 42.612 Tflops/s, 5291.453 iter/s, 1.890e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 52.402 Tflops/s, hfu: 52.402 Tflops/s, 6507.028 iter/s, 1.537e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(12288,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.752 Tflops/s, hfu: 1.752 Tflops/s, 362.613 iter/s, 2.758e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.173 Tflops/s, hfu: 3.173 Tflops/s, 656.653 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.528 Tflops/s, hfu: 1.528 Tflops/s, 316.236 iter/s, 3.162e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 26.929 Tflops/s, hfu: 26.929 Tflops/s, 2786.571 iter/s, 3.589e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 33.925 Tflops/s, hfu: 33.925 Tflops/s, 3510.546 iter/s, 2.849e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.78 Tflops/s, hfu: 33.78 Tflops/s, 3495.526 iter/s, 2.861e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.485 Tflops/s, hfu: 35.485 Tflops/s, 3672.043 iter/s, 2.723e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 53.407 Tflops/s, hfu: 53.407 Tflops/s, 5526.572 iter/s, 1.809e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.793 Tflops/s, hfu: 48.793 Tflops/s, 5049.077 iter/s, 1.981e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 47.798 Tflops/s, hfu: 47.798 Tflops/s, 4946.185 iter/s, 2.022e-04 s/iter, (0.070, 0.001, 0.001) sec
mfu: 57.252 Tflops/s, hfu: 57.252 Tflops/s, 5924.451 iter/s, 1.688e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(12288,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.051 Tflops/s, hfu: 2.051 Tflops/s, 363.888 iter/s, 2.748e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.709 Tflops/s, hfu: 3.709 Tflops/s, 657.956 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.776 Tflops/s, hfu: 1.776 Tflops/s, 315.014 iter/s, 3.174e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 31.507 Tflops/s, hfu: 31.507 Tflops/s, 2794.608 iter/s, 3.578e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.162 Tflops/s, hfu: 37.162 Tflops/s, 3296.153 iter/s, 3.034e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.469 Tflops/s, hfu: 37.469 Tflops/s, 3323.408 iter/s, 3.009e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 37.286 Tflops/s, hfu: 37.286 Tflops/s, 3307.141 iter/s, 3.024e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 59.71 Tflops/s, hfu: 59.71 Tflops/s, 5296.162 iter/s, 1.888e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 53.658 Tflops/s, hfu: 53.658 Tflops/s, 4759.366 iter/s, 2.101e-04 s/iter, (0.094, 0.000, 0.001) sec
mfu: 55.089 Tflops/s, hfu: 55.089 Tflops/s, 4886.248 iter/s, 2.047e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 59.549 Tflops/s, hfu: 59.549 Tflops/s, 5281.839 iter/s, 1.893e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(12288,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.34 Tflops/s, hfu: 2.34 Tflops/s, 363.176 iter/s, 2.753e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.191 Tflops/s, hfu: 4.191 Tflops/s, 650.481 iter/s, 1.537e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.006 Tflops/s, hfu: 2.006 Tflops/s, 311.309 iter/s, 3.212e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 35.276 Tflops/s, hfu: 35.276 Tflops/s, 2737.806 iter/s, 3.653e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.93 Tflops/s, hfu: 39.93 Tflops/s, 3098.968 iter/s, 3.227e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 41.86 Tflops/s, hfu: 41.86 Tflops/s, 3248.778 iter/s, 3.078e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 41.785 Tflops/s, hfu: 41.785 Tflops/s, 3242.963 iter/s, 3.084e-04 s/iter, (0.079, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 65.02 Tflops/s, hfu: 65.02 Tflops/s, 5046.224 iter/s, 1.982e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 59.602 Tflops/s, hfu: 59.602 Tflops/s, 4625.689 iter/s, 2.162e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 56.351 Tflops/s, hfu: 56.351 Tflops/s, 4373.382 iter/s, 2.287e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 63.45 Tflops/s, hfu: 63.45 Tflops/s, 4924.362 iter/s, 2.031e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(12288,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.899 Tflops/s, hfu: 2.899 Tflops/s, 359.955 iter/s, 2.778e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.309 Tflops/s, hfu: 5.309 Tflops/s, 659.259 iter/s, 1.517e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.515 Tflops/s, hfu: 2.515 Tflops/s, 312.336 iter/s, 3.202e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 44.663 Tflops/s, hfu: 44.663 Tflops/s, 2773.033 iter/s, 3.606e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.687 Tflops/s, hfu: 48.687 Tflops/s, 3022.901 iter/s, 3.308e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 49.884 Tflops/s, hfu: 49.884 Tflops/s, 3097.202 iter/s, 3.229e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 49.648 Tflops/s, hfu: 49.648 Tflops/s, 3082.538 iter/s, 3.244e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 75.032 Tflops/s, hfu: 75.032 Tflops/s, 4658.617 iter/s, 2.147e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 65.287 Tflops/s, hfu: 65.287 Tflops/s, 4053.572 iter/s, 2.467e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 64.225 Tflops/s, hfu: 64.225 Tflops/s, 3987.622 iter/s, 2.508e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 66.757 Tflops/s, hfu: 66.757 Tflops/s, 4144.837 iter/s, 2.413e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(12288,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.479 Tflops/s, hfu: 3.479 Tflops/s, 359.964 iter/s, 2.778e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.329 Tflops/s, hfu: 6.329 Tflops/s, 654.976 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.014 Tflops/s, hfu: 3.014 Tflops/s, 311.882 iter/s, 3.206e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 51.138 Tflops/s, hfu: 51.138 Tflops/s, 2645.895 iter/s, 3.779e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 53.524 Tflops/s, hfu: 53.524 Tflops/s, 2769.347 iter/s, 3.611e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 56.633 Tflops/s, hfu: 56.633 Tflops/s, 2930.214 iter/s, 3.413e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 57.136 Tflops/s, hfu: 57.136 Tflops/s, 2956.201 iter/s, 3.383e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 85.866 Tflops/s, hfu: 85.866 Tflops/s, 4442.707 iter/s, 2.251e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 72.694 Tflops/s, hfu: 72.694 Tflops/s, 3761.209 iter/s, 2.659e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 69.939 Tflops/s, hfu: 69.939 Tflops/s, 3618.678 iter/s, 2.763e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 70.134 Tflops/s, hfu: 70.134 Tflops/s, 3628.763 iter/s, 2.756e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(12288,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.004 Tflops/s, hfu: 4.004 Tflops/s, 355.168 iter/s, 2.816e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.336 Tflops/s, hfu: 7.336 Tflops/s, 650.653 iter/s, 1.537e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.482 Tflops/s, hfu: 3.482 Tflops/s, 308.803 iter/s, 3.238e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 54.778 Tflops/s, hfu: 54.778 Tflops/s, 2429.354 iter/s, 4.116e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 57.608 Tflops/s, hfu: 57.608 Tflops/s, 2554.826 iter/s, 3.914e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.265 Tflops/s, hfu: 58.265 Tflops/s, 2583.979 iter/s, 3.870e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 57.134 Tflops/s, hfu: 57.134 Tflops/s, 2533.801 iter/s, 3.947e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 92.216 Tflops/s, hfu: 92.216 Tflops/s, 4089.645 iter/s, 2.445e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.648 Tflops/s, hfu: 79.648 Tflops/s, 3532.271 iter/s, 2.831e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 74.998 Tflops/s, hfu: 74.998 Tflops/s, 3326.061 iter/s, 3.007e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 72.147 Tflops/s, hfu: 72.147 Tflops/s, 3199.631 iter/s, 3.125e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(12288,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.597 Tflops/s, hfu: 4.597 Tflops/s, 356.756 iter/s, 2.803e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.35 Tflops/s, hfu: 8.35 Tflops/s, 648.049 iter/s, 1.543e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.986 Tflops/s, hfu: 3.986 Tflops/s, 309.332 iter/s, 3.233e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 61.7 Tflops/s, hfu: 61.7 Tflops/s, 2394.269 iter/s, 4.177e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.409 Tflops/s, hfu: 64.409 Tflops/s, 2499.400 iter/s, 4.001e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 63.941 Tflops/s, hfu: 63.941 Tflops/s, 2481.242 iter/s, 4.030e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 65.353 Tflops/s, hfu: 65.353 Tflops/s, 2536.011 iter/s, 3.943e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 95.804 Tflops/s, hfu: 95.804 Tflops/s, 3717.693 iter/s, 2.690e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 83.939 Tflops/s, hfu: 83.939 Tflops/s, 3257.244 iter/s, 3.070e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 78.586 Tflops/s, hfu: 78.586 Tflops/s, 3049.524 iter/s, 3.279e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 69.222 Tflops/s, hfu: 69.222 Tflops/s, 2686.150 iter/s, 3.723e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(12288,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.803 Tflops/s, hfu: 5.803 Tflops/s, 360.277 iter/s, 2.776e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.549 Tflops/s, hfu: 10.549 Tflops/s, 654.997 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.054 Tflops/s, hfu: 5.054 Tflops/s, 313.797 iter/s, 3.187e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 69.48 Tflops/s, hfu: 69.48 Tflops/s, 2156.957 iter/s, 4.636e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 73.769 Tflops/s, hfu: 73.769 Tflops/s, 2290.090 iter/s, 4.367e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.91 Tflops/s, hfu: 72.91 Tflops/s, 2263.427 iter/s, 4.418e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.189 Tflops/s, hfu: 72.189 Tflops/s, 2241.027 iter/s, 4.462e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 109.277 Tflops/s, hfu: 109.277 Tflops/s, 3392.407 iter/s, 2.948e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 90.226 Tflops/s, hfu: 90.226 Tflops/s, 2800.995 iter/s, 3.570e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 84.917 Tflops/s, hfu: 84.917 Tflops/s, 2636.185 iter/s, 3.793e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 73.674 Tflops/s, hfu: 73.674 Tflops/s, 2287.157 iter/s, 4.372e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(12288,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.913 Tflops/s, hfu: 6.913 Tflops/s, 357.703 iter/s, 2.796e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.502 Tflops/s, hfu: 12.502 Tflops/s, 646.845 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.998 Tflops/s, hfu: 5.998 Tflops/s, 310.343 iter/s, 3.222e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 78.247 Tflops/s, hfu: 78.247 Tflops/s, 2024.259 iter/s, 4.940e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 81.84 Tflops/s, hfu: 81.84 Tflops/s, 2117.209 iter/s, 4.723e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 80.286 Tflops/s, hfu: 80.286 Tflops/s, 2076.998 iter/s, 4.815e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 78.461 Tflops/s, hfu: 78.461 Tflops/s, 2029.781 iter/s, 4.927e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 115.464 Tflops/s, hfu: 115.464 Tflops/s, 2987.072 iter/s, 3.348e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 96.959 Tflops/s, hfu: 96.959 Tflops/s, 2508.328 iter/s, 3.987e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 91.172 Tflops/s, hfu: 91.172 Tflops/s, 2358.624 iter/s, 4.240e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 78.084 Tflops/s, hfu: 78.084 Tflops/s, 2020.039 iter/s, 4.950e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(12288,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.144 Tflops/s, hfu: 8.144 Tflops/s, 361.192 iter/s, 2.769e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.852 Tflops/s, hfu: 14.852 Tflops/s, 658.669 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 7.069 Tflops/s, hfu: 7.069 Tflops/s, 313.500 iter/s, 3.190e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 86.514 Tflops/s, hfu: 86.514 Tflops/s, 1918.384 iter/s, 5.213e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 88.307 Tflops/s, hfu: 88.307 Tflops/s, 1958.143 iter/s, 5.107e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 83.444 Tflops/s, hfu: 83.444 Tflops/s, 1850.317 iter/s, 5.404e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 82.247 Tflops/s, hfu: 82.247 Tflops/s, 1823.779 iter/s, 5.483e-04 s/iter, (0.073, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 120.449 Tflops/s, hfu: 120.449 Tflops/s, 2670.883 iter/s, 3.744e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 104.029 Tflops/s, hfu: 104.029 Tflops/s, 2306.784 iter/s, 4.335e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 93.573 Tflops/s, hfu: 93.573 Tflops/s, 2074.930 iter/s, 4.819e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 79.197 Tflops/s, hfu: 79.197 Tflops/s, 1756.136 iter/s, 5.694e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(12288,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.242 Tflops/s, hfu: 9.242 Tflops/s, 358.622 iter/s, 2.788e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.773 Tflops/s, hfu: 16.773 Tflops/s, 650.885 iter/s, 1.536e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.039 Tflops/s, hfu: 8.039 Tflops/s, 311.965 iter/s, 3.205e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 86.639 Tflops/s, hfu: 86.639 Tflops/s, 1681.011 iter/s, 5.949e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 87.629 Tflops/s, hfu: 87.629 Tflops/s, 1700.218 iter/s, 5.882e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 85.954 Tflops/s, hfu: 85.954 Tflops/s, 1667.734 iter/s, 5.996e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 82.227 Tflops/s, hfu: 82.227 Tflops/s, 1595.405 iter/s, 6.268e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 127.776 Tflops/s, hfu: 127.776 Tflops/s, 2479.175 iter/s, 4.034e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 106.697 Tflops/s, hfu: 106.697 Tflops/s, 2070.188 iter/s, 4.830e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 96.149 Tflops/s, hfu: 96.149 Tflops/s, 1865.532 iter/s, 5.360e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 82.561 Tflops/s, hfu: 82.561 Tflops/s, 1601.886 iter/s, 6.243e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(12288,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.582 Tflops/s, hfu: 11.582 Tflops/s, 359.555 iter/s, 2.781e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.087 Tflops/s, hfu: 21.087 Tflops/s, 654.639 iter/s, 1.528e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.101 Tflops/s, hfu: 10.101 Tflops/s, 313.585 iter/s, 3.189e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 99.362 Tflops/s, hfu: 99.362 Tflops/s, 1542.296 iter/s, 6.484e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 102.357 Tflops/s, hfu: 102.357 Tflops/s, 1588.795 iter/s, 6.294e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 97.76 Tflops/s, hfu: 97.76 Tflops/s, 1517.432 iter/s, 6.590e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.717 Tflops/s, hfu: 93.717 Tflops/s, 1454.672 iter/s, 6.874e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 135.114 Tflops/s, hfu: 135.114 Tflops/s, 2097.245 iter/s, 4.768e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 113.577 Tflops/s, hfu: 113.577 Tflops/s, 1762.947 iter/s, 5.672e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 101.228 Tflops/s, hfu: 101.228 Tflops/s, 1571.260 iter/s, 6.364e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 85.26 Tflops/s, hfu: 85.26 Tflops/s, 1323.410 iter/s, 7.556e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(12288,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.862 Tflops/s, hfu: 13.862 Tflops/s, 358.602 iter/s, 2.789e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.318 Tflops/s, hfu: 25.318 Tflops/s, 654.986 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 12.014 Tflops/s, hfu: 12.014 Tflops/s, 310.793 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 106.603 Tflops/s, hfu: 106.603 Tflops/s, 1378.915 iter/s, 7.252e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 109.536 Tflops/s, hfu: 109.536 Tflops/s, 1416.848 iter/s, 7.058e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 105.619 Tflops/s, hfu: 105.619 Tflops/s, 1366.180 iter/s, 7.320e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 98.281 Tflops/s, hfu: 98.281 Tflops/s, 1271.268 iter/s, 7.866e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 140.045 Tflops/s, hfu: 140.045 Tflops/s, 1811.489 iter/s, 5.520e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 117.824 Tflops/s, hfu: 117.824 Tflops/s, 1524.056 iter/s, 6.561e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 105.194 Tflops/s, hfu: 105.194 Tflops/s, 1360.692 iter/s, 7.349e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 87.738 Tflops/s, hfu: 87.738 Tflops/s, 1134.888 iter/s, 8.811e-04 s/iter, (0.073, 0.000, 0.004) sec
SP=(1,8),S=(12288,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.319 Tflops/s, hfu: 16.319 Tflops/s, 361.862 iter/s, 2.763e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.518 Tflops/s, hfu: 29.518 Tflops/s, 654.532 iter/s, 1.528e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 14.106 Tflops/s, hfu: 14.106 Tflops/s, 312.801 iter/s, 3.197e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 113.031 Tflops/s, hfu: 113.031 Tflops/s, 1253.196 iter/s, 7.980e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 116.106 Tflops/s, hfu: 116.106 Tflops/s, 1287.293 iter/s, 7.768e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 111.307 Tflops/s, hfu: 111.307 Tflops/s, 1234.080 iter/s, 8.103e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.456 Tflops/s, hfu: 103.456 Tflops/s, 1147.031 iter/s, 8.718e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 146.774 Tflops/s, hfu: 146.774 Tflops/s, 1627.307 iter/s, 6.145e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 120.305 Tflops/s, hfu: 120.305 Tflops/s, 1333.846 iter/s, 7.497e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 107.206 Tflops/s, hfu: 107.206 Tflops/s, 1188.608 iter/s, 8.413e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 88.428 Tflops/s, hfu: 88.428 Tflops/s, 980.415 iter/s, 1.020e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(12288,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.449 Tflops/s, hfu: 18.449 Tflops/s, 357.960 iter/s, 2.794e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.436 Tflops/s, hfu: 33.436 Tflops/s, 648.736 iter/s, 1.541e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 15.938 Tflops/s, hfu: 15.938 Tflops/s, 309.243 iter/s, 3.234e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 119.067 Tflops/s, hfu: 119.067 Tflops/s, 1155.097 iter/s, 8.657e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 113.481 Tflops/s, hfu: 113.481 Tflops/s, 1100.914 iter/s, 9.083e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 114.395 Tflops/s, hfu: 114.395 Tflops/s, 1109.779 iter/s, 9.011e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 105.851 Tflops/s, hfu: 105.851 Tflops/s, 1026.888 iter/s, 9.738e-04 s/iter, (0.078, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 148.948 Tflops/s, hfu: 148.948 Tflops/s, 1444.986 iter/s, 6.920e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 122.44 Tflops/s, hfu: 122.44 Tflops/s, 1187.829 iter/s, 8.419e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 109.641 Tflops/s, hfu: 109.641 Tflops/s, 1063.658 iter/s, 9.402e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 90.891 Tflops/s, hfu: 90.891 Tflops/s, 881.760 iter/s, 1.134e-03 s/iter, (0.077, 0.000, 0.005) sec
SP=(1,8),S=(12288,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.984 Tflops/s, hfu: 22.984 Tflops/s, 356.765 iter/s, 2.803e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.314 Tflops/s, hfu: 42.314 Tflops/s, 656.797 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 20.194 Tflops/s, hfu: 20.194 Tflops/s, 313.448 iter/s, 3.190e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 122.881 Tflops/s, hfu: 122.881 Tflops/s, 953.682 iter/s, 1.049e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 124.847 Tflops/s, hfu: 124.847 Tflops/s, 968.940 iter/s, 1.032e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 117.807 Tflops/s, hfu: 117.807 Tflops/s, 914.304 iter/s, 1.094e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.514 Tflops/s, hfu: 110.514 Tflops/s, 857.704 iter/s, 1.166e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 154.204 Tflops/s, hfu: 154.204 Tflops/s, 1196.779 iter/s, 8.356e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 126.01 Tflops/s, hfu: 126.01 Tflops/s, 977.968 iter/s, 1.023e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 112.542 Tflops/s, hfu: 112.542 Tflops/s, 873.442 iter/s, 1.145e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 91.548 Tflops/s, hfu: 91.548 Tflops/s, 710.506 iter/s, 1.407e-03 s/iter, (0.077, 0.000, 0.006) sec
SP=(1,8),S=(12288,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.686 Tflops/s, hfu: 27.686 Tflops/s, 358.116 iter/s, 2.792e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.99 Tflops/s, hfu: 50.99 Tflops/s, 659.554 iter/s, 1.516e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.233 Tflops/s, hfu: 24.233 Tflops/s, 313.455 iter/s, 3.190e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 129.87 Tflops/s, hfu: 129.87 Tflops/s, 839.935 iter/s, 1.191e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 127.847 Tflops/s, hfu: 127.847 Tflops/s, 826.851 iter/s, 1.209e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 125.482 Tflops/s, hfu: 125.482 Tflops/s, 811.557 iter/s, 1.232e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 108.439 Tflops/s, hfu: 108.439 Tflops/s, 701.333 iter/s, 1.426e-03 s/iter, (0.082, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 157.432 Tflops/s, hfu: 157.432 Tflops/s, 1018.197 iter/s, 9.821e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 129.019 Tflops/s, hfu: 129.019 Tflops/s, 834.435 iter/s, 1.198e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 115.162 Tflops/s, hfu: 115.162 Tflops/s, 744.815 iter/s, 1.343e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 94.145 Tflops/s, hfu: 94.145 Tflops/s, 608.883 iter/s, 1.642e-03 s/iter, (0.079, 0.000, 0.007) sec
SP=(1,8),S=(12288,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.07 Tflops/s, hfu: 32.07 Tflops/s, 355.570 iter/s, 2.812e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.023 Tflops/s, hfu: 57.023 Tflops/s, 632.220 iter/s, 1.582e-03 s/iter, (0.019, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 27.27 Tflops/s, hfu: 27.27 Tflops/s, 302.346 iter/s, 3.307e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 133.23 Tflops/s, hfu: 133.23 Tflops/s, 738.574 iter/s, 1.354e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 133.664 Tflops/s, hfu: 133.664 Tflops/s, 740.978 iter/s, 1.350e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 127.251 Tflops/s, hfu: 127.251 Tflops/s, 705.426 iter/s, 1.418e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 119.865 Tflops/s, hfu: 119.865 Tflops/s, 664.480 iter/s, 1.505e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 160.486 Tflops/s, hfu: 160.486 Tflops/s, 889.667 iter/s, 1.124e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 131.691 Tflops/s, hfu: 131.691 Tflops/s, 730.038 iter/s, 1.370e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 115.717 Tflops/s, hfu: 115.717 Tflops/s, 641.490 iter/s, 1.559e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 94.223 Tflops/s, hfu: 94.223 Tflops/s, 522.335 iter/s, 1.914e-03 s/iter, (0.081, 0.000, 0.008) sec
SP=(1,8),S=(12288,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.696 Tflops/s, hfu: 36.696 Tflops/s, 356.000 iter/s, 2.809e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 65.377 Tflops/s, hfu: 65.377 Tflops/s, 634.242 iter/s, 1.577e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 31.022 Tflops/s, hfu: 31.022 Tflops/s, 300.951 iter/s, 3.323e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 137.489 Tflops/s, hfu: 137.489 Tflops/s, 666.909 iter/s, 1.499e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 136.828 Tflops/s, hfu: 136.828 Tflops/s, 663.704 iter/s, 1.507e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 126.446 Tflops/s, hfu: 126.446 Tflops/s, 613.343 iter/s, 1.630e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 118.731 Tflops/s, hfu: 118.731 Tflops/s, 575.920 iter/s, 1.736e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 163.494 Tflops/s, hfu: 163.494 Tflops/s, 793.052 iter/s, 1.261e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 132.479 Tflops/s, hfu: 132.479 Tflops/s, 642.607 iter/s, 1.556e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 116.465 Tflops/s, hfu: 116.465 Tflops/s, 564.928 iter/s, 1.770e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 93.857 Tflops/s, hfu: 93.857 Tflops/s, 455.266 iter/s, 2.197e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(12288,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.754 Tflops/s, hfu: 45.754 Tflops/s, 355.094 iter/s, 2.816e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 83.134 Tflops/s, hfu: 83.134 Tflops/s, 645.208 iter/s, 1.550e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 39.906 Tflops/s, hfu: 39.906 Tflops/s, 309.711 iter/s, 3.229e-03 s/iter, (0.041, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 142.477 Tflops/s, hfu: 142.477 Tflops/s, 552.884 iter/s, 1.809e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 137.384 Tflops/s, hfu: 137.384 Tflops/s, 533.120 iter/s, 1.876e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 135.529 Tflops/s, hfu: 135.529 Tflops/s, 525.922 iter/s, 1.901e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 128.703 Tflops/s, hfu: 128.703 Tflops/s, 499.433 iter/s, 2.002e-03 s/iter, (0.081, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 166.716 Tflops/s, hfu: 166.716 Tflops/s, 646.944 iter/s, 1.546e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 134.851 Tflops/s, hfu: 134.851 Tflops/s, 523.291 iter/s, 1.911e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 118.745 Tflops/s, hfu: 118.745 Tflops/s, 460.790 iter/s, 2.170e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 95.084 Tflops/s, hfu: 95.084 Tflops/s, 368.975 iter/s, 2.710e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(12288,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.402 Tflops/s, hfu: 54.402 Tflops/s, 351.846 iter/s, 2.842e-03 s/iter, (0.040, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.009 Tflops/s, hfu: 88.009 Tflops/s, 569.198 iter/s, 1.757e-03 s/iter, (0.021, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 45.114 Tflops/s, hfu: 45.114 Tflops/s, 291.775 iter/s, 3.427e-03 s/iter, (0.039, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 144.978 Tflops/s, hfu: 144.978 Tflops/s, 468.823 iter/s, 2.133e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 143.576 Tflops/s, hfu: 143.576 Tflops/s, 464.290 iter/s, 2.154e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 135.91 Tflops/s, hfu: 135.91 Tflops/s, 439.499 iter/s, 2.275e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 124.012 Tflops/s, hfu: 124.012 Tflops/s, 401.024 iter/s, 2.494e-03 s/iter, (0.081, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 168.229 Tflops/s, hfu: 168.229 Tflops/s, 544.010 iter/s, 1.838e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 136.227 Tflops/s, hfu: 136.227 Tflops/s, 440.524 iter/s, 2.270e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 119.658 Tflops/s, hfu: 119.658 Tflops/s, 386.944 iter/s, 2.584e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 96.251 Tflops/s, hfu: 96.251 Tflops/s, 311.253 iter/s, 3.213e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(12288,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.875 Tflops/s, hfu: 56.875 Tflops/s, 315.294 iter/s, 3.172e-03 s/iter, (0.044, 0.000, 0.063) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.236 Tflops/s, hfu: 91.236 Tflops/s, 505.777 iter/s, 1.977e-03 s/iter, (0.024, 0.000, 0.040) sec
# stripe_flash_attn_func, fwd
mfu: 48.706 Tflops/s, hfu: 48.706 Tflops/s, 270.007 iter/s, 3.704e-03 s/iter, (0.041, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 148.116 Tflops/s, hfu: 148.116 Tflops/s, 410.547 iter/s, 2.436e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 142.549 Tflops/s, hfu: 142.549 Tflops/s, 395.117 iter/s, 2.531e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 137.707 Tflops/s, hfu: 137.707 Tflops/s, 381.695 iter/s, 2.620e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 122.915 Tflops/s, hfu: 122.915 Tflops/s, 340.696 iter/s, 2.935e-03 s/iter, (0.081, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 170.658 Tflops/s, hfu: 170.658 Tflops/s, 473.028 iter/s, 2.114e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 137.685 Tflops/s, hfu: 137.685 Tflops/s, 381.634 iter/s, 2.620e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 120.267 Tflops/s, hfu: 120.267 Tflops/s, 333.356 iter/s, 3.000e-03 s/iter, (0.088, 0.000, 0.012) sec
mfu: 95.699 Tflops/s, hfu: 95.699 Tflops/s, 265.257 iter/s, 3.770e-03 s/iter, (0.090, 0.000, 0.015) sec
SP=(1,8),S=(12288,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.525 Tflops/s, hfu: 58.525 Tflops/s, 283.885 iter/s, 3.523e-03 s/iter, (0.045, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 89.453 Tflops/s, hfu: 89.453 Tflops/s, 433.905 iter/s, 2.305e-03 s/iter, (0.027, 0.000, 0.046) sec
# stripe_flash_attn_func, fwd
mfu: 51.29 Tflops/s, hfu: 51.29 Tflops/s, 248.790 iter/s, 4.019e-03 s/iter, (0.044, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 149.924 Tflops/s, hfu: 149.924 Tflops/s, 363.613 iter/s, 2.750e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 145.308 Tflops/s, hfu: 145.308 Tflops/s, 352.418 iter/s, 2.838e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 138.773 Tflops/s, hfu: 138.773 Tflops/s, 336.570 iter/s, 2.971e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 124.981 Tflops/s, hfu: 124.981 Tflops/s, 303.119 iter/s, 3.299e-03 s/iter, (0.082, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 171.933 Tflops/s, hfu: 171.933 Tflops/s, 416.992 iter/s, 2.398e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 138.179 Tflops/s, hfu: 138.179 Tflops/s, 335.128 iter/s, 2.984e-03 s/iter, (0.084, 0.000, 0.012) sec
mfu: 120.845 Tflops/s, hfu: 120.845 Tflops/s, 293.087 iter/s, 3.412e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 96.701 Tflops/s, hfu: 96.701 Tflops/s, 234.531 iter/s, 4.264e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(14336,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.342 Tflops/s, hfu: 0.342 Tflops/s, 364.065 iter/s, 2.747e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.629 Tflops/s, hfu: 0.629 Tflops/s, 669.177 iter/s, 1.494e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.298 Tflops/s, hfu: 0.298 Tflops/s, 316.984 iter/s, 3.155e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 5.713 Tflops/s, hfu: 5.713 Tflops/s, 3040.253 iter/s, 3.289e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 7.687 Tflops/s, hfu: 7.687 Tflops/s, 4090.983 iter/s, 2.444e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 8.737 Tflops/s, hfu: 8.737 Tflops/s, 4649.779 iter/s, 2.151e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 9.757 Tflops/s, hfu: 9.757 Tflops/s, 5192.324 iter/s, 1.926e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 13.466 Tflops/s, hfu: 13.466 Tflops/s, 7166.199 iter/s, 1.395e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.234 Tflops/s, hfu: 13.234 Tflops/s, 7043.047 iter/s, 1.420e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.618 Tflops/s, hfu: 16.618 Tflops/s, 8843.923 iter/s, 1.131e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 22.661 Tflops/s, hfu: 22.661 Tflops/s, 12059.817 iter/s, 8.292e-05 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(14336,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.685 Tflops/s, hfu: 0.685 Tflops/s, 364.385 iter/s, 2.744e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.243 Tflops/s, hfu: 1.243 Tflops/s, 661.698 iter/s, 1.511e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.593 Tflops/s, hfu: 0.593 Tflops/s, 315.418 iter/s, 3.170e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 10.754 Tflops/s, hfu: 10.754 Tflops/s, 2861.460 iter/s, 3.495e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.78 Tflops/s, hfu: 13.78 Tflops/s, 3666.872 iter/s, 2.727e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 15.567 Tflops/s, hfu: 15.567 Tflops/s, 4142.227 iter/s, 2.414e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.576 Tflops/s, hfu: 16.576 Tflops/s, 4410.727 iter/s, 2.267e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 24.411 Tflops/s, hfu: 24.411 Tflops/s, 6495.531 iter/s, 1.540e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 24.971 Tflops/s, hfu: 24.971 Tflops/s, 6644.694 iter/s, 1.505e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 29.223 Tflops/s, hfu: 29.223 Tflops/s, 7776.050 iter/s, 1.286e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 36.461 Tflops/s, hfu: 36.461 Tflops/s, 9701.956 iter/s, 1.031e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(14336,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.021 Tflops/s, hfu: 1.021 Tflops/s, 362.343 iter/s, 2.760e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.852 Tflops/s, hfu: 1.852 Tflops/s, 656.910 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.89 Tflops/s, hfu: 0.89 Tflops/s, 315.741 iter/s, 3.167e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 15.568 Tflops/s, hfu: 15.568 Tflops/s, 2761.760 iter/s, 3.621e-04 s/iter, (0.121, 0.000, 0.001) sec
mfu: 20.592 Tflops/s, hfu: 20.592 Tflops/s, 3652.835 iter/s, 2.738e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.79 Tflops/s, hfu: 21.79 Tflops/s, 3865.421 iter/s, 2.587e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 23.785 Tflops/s, hfu: 23.785 Tflops/s, 4219.409 iter/s, 2.370e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 32.898 Tflops/s, hfu: 32.898 Tflops/s, 5835.940 iter/s, 1.714e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 34.63 Tflops/s, hfu: 34.63 Tflops/s, 6143.110 iter/s, 1.628e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.344 Tflops/s, hfu: 39.344 Tflops/s, 6979.341 iter/s, 1.433e-04 s/iter, (0.072, 0.001, 0.001) sec
mfu: 42.906 Tflops/s, hfu: 42.906 Tflops/s, 7611.277 iter/s, 1.314e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(14336,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.365 Tflops/s, hfu: 1.365 Tflops/s, 363.263 iter/s, 2.753e-03 s/iter, (0.042, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.49 Tflops/s, hfu: 2.49 Tflops/s, 662.466 iter/s, 1.510e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.195 Tflops/s, hfu: 1.195 Tflops/s, 318.107 iter/s, 3.144e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 21.312 Tflops/s, hfu: 21.312 Tflops/s, 2835.496 iter/s, 3.527e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 25.608 Tflops/s, hfu: 25.608 Tflops/s, 3407.108 iter/s, 2.935e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 27.415 Tflops/s, hfu: 27.415 Tflops/s, 3647.399 iter/s, 2.742e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 28.03 Tflops/s, hfu: 28.03 Tflops/s, 3729.228 iter/s, 2.682e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 40.539 Tflops/s, hfu: 40.539 Tflops/s, 5393.511 iter/s, 1.854e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.502 Tflops/s, hfu: 38.502 Tflops/s, 5122.531 iter/s, 1.952e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.579 Tflops/s, hfu: 38.579 Tflops/s, 5132.838 iter/s, 1.948e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.865 Tflops/s, hfu: 50.865 Tflops/s, 6767.365 iter/s, 1.478e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(14336,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.706 Tflops/s, hfu: 1.706 Tflops/s, 363.060 iter/s, 2.754e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.109 Tflops/s, hfu: 3.109 Tflops/s, 661.860 iter/s, 1.511e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.498 Tflops/s, hfu: 1.498 Tflops/s, 318.951 iter/s, 3.135e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 26.109 Tflops/s, hfu: 26.109 Tflops/s, 2778.951 iter/s, 3.598e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.267 Tflops/s, hfu: 32.267 Tflops/s, 3434.349 iter/s, 2.912e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.591 Tflops/s, hfu: 33.591 Tflops/s, 3575.310 iter/s, 2.797e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.731 Tflops/s, hfu: 34.731 Tflops/s, 3696.693 iter/s, 2.705e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 46.64 Tflops/s, hfu: 46.64 Tflops/s, 4964.257 iter/s, 2.014e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 42.83 Tflops/s, hfu: 42.83 Tflops/s, 4558.716 iter/s, 2.194e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 46.227 Tflops/s, hfu: 46.227 Tflops/s, 4920.291 iter/s, 2.032e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 57.235 Tflops/s, hfu: 57.235 Tflops/s, 6091.915 iter/s, 1.642e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(14336,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.048 Tflops/s, hfu: 2.048 Tflops/s, 363.242 iter/s, 2.753e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.713 Tflops/s, hfu: 3.713 Tflops/s, 658.612 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.795 Tflops/s, hfu: 1.795 Tflops/s, 318.376 iter/s, 3.141e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 30.665 Tflops/s, hfu: 30.665 Tflops/s, 2719.875 iter/s, 3.677e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.699 Tflops/s, hfu: 35.699 Tflops/s, 3166.401 iter/s, 3.158e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.453 Tflops/s, hfu: 39.453 Tflops/s, 3499.342 iter/s, 2.858e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 40.909 Tflops/s, hfu: 40.909 Tflops/s, 3628.552 iter/s, 2.756e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 51.804 Tflops/s, hfu: 51.804 Tflops/s, 4594.913 iter/s, 2.176e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 50.683 Tflops/s, hfu: 50.683 Tflops/s, 4495.432 iter/s, 2.224e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 51.951 Tflops/s, hfu: 51.951 Tflops/s, 4607.955 iter/s, 2.170e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 63.582 Tflops/s, hfu: 63.582 Tflops/s, 5639.522 iter/s, 1.773e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(14336,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.401 Tflops/s, hfu: 2.401 Tflops/s, 365.016 iter/s, 2.740e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.339 Tflops/s, hfu: 4.339 Tflops/s, 659.684 iter/s, 1.516e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.095 Tflops/s, hfu: 2.095 Tflops/s, 318.617 iter/s, 3.139e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 33.484 Tflops/s, hfu: 33.484 Tflops/s, 2545.669 iter/s, 3.928e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 37.871 Tflops/s, hfu: 37.871 Tflops/s, 2879.189 iter/s, 3.473e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.581 Tflops/s, hfu: 38.581 Tflops/s, 2933.171 iter/s, 3.409e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 42.912 Tflops/s, hfu: 42.912 Tflops/s, 3262.430 iter/s, 3.065e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 55.638 Tflops/s, hfu: 55.638 Tflops/s, 4229.975 iter/s, 2.364e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 55.488 Tflops/s, hfu: 55.488 Tflops/s, 4218.555 iter/s, 2.370e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 56.149 Tflops/s, hfu: 56.149 Tflops/s, 4268.834 iter/s, 2.343e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 67.804 Tflops/s, hfu: 67.804 Tflops/s, 5154.852 iter/s, 1.940e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(14336,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.732 Tflops/s, hfu: 2.732 Tflops/s, 363.472 iter/s, 2.751e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.937 Tflops/s, hfu: 4.937 Tflops/s, 656.843 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.399 Tflops/s, hfu: 2.399 Tflops/s, 319.150 iter/s, 3.133e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 41.299 Tflops/s, hfu: 41.299 Tflops/s, 2747.313 iter/s, 3.640e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.73 Tflops/s, hfu: 45.73 Tflops/s, 3042.103 iter/s, 3.287e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 46.588 Tflops/s, hfu: 46.588 Tflops/s, 3099.199 iter/s, 3.227e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.0 Tflops/s, hfu: 48.0 Tflops/s, 3193.093 iter/s, 3.132e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 59.265 Tflops/s, hfu: 59.265 Tflops/s, 3942.471 iter/s, 2.536e-04 s/iter, (0.192, 0.000, 0.001) sec
mfu: 60.301 Tflops/s, hfu: 60.301 Tflops/s, 4011.425 iter/s, 2.493e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 59.153 Tflops/s, hfu: 59.153 Tflops/s, 3935.025 iter/s, 2.541e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 67.726 Tflops/s, hfu: 67.726 Tflops/s, 4505.316 iter/s, 2.220e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(14336,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.428 Tflops/s, hfu: 3.428 Tflops/s, 364.866 iter/s, 2.741e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.947 Tflops/s, hfu: 5.947 Tflops/s, 633.016 iter/s, 1.580e-03 s/iter, (0.018, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 2.965 Tflops/s, hfu: 2.965 Tflops/s, 315.597 iter/s, 3.169e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 47.695 Tflops/s, hfu: 47.695 Tflops/s, 2538.277 iter/s, 3.940e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 50.87 Tflops/s, hfu: 50.87 Tflops/s, 2707.210 iter/s, 3.694e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 52.896 Tflops/s, hfu: 52.896 Tflops/s, 2815.062 iter/s, 3.552e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 55.907 Tflops/s, hfu: 55.907 Tflops/s, 2975.269 iter/s, 3.361e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 67.088 Tflops/s, hfu: 67.088 Tflops/s, 3570.306 iter/s, 2.801e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 67.017 Tflops/s, hfu: 67.017 Tflops/s, 3566.537 iter/s, 2.804e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 67.847 Tflops/s, hfu: 67.847 Tflops/s, 3610.734 iter/s, 2.770e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 73.481 Tflops/s, hfu: 73.481 Tflops/s, 3910.527 iter/s, 2.557e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(14336,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.072 Tflops/s, hfu: 4.072 Tflops/s, 361.170 iter/s, 2.769e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.418 Tflops/s, hfu: 7.418 Tflops/s, 657.971 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.356 Tflops/s, hfu: 3.356 Tflops/s, 297.663 iter/s, 3.360e-03 s/iter, (0.036, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 56.294 Tflops/s, hfu: 56.294 Tflops/s, 2496.555 iter/s, 4.006e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 59.007 Tflops/s, hfu: 59.007 Tflops/s, 2616.869 iter/s, 3.821e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 62.065 Tflops/s, hfu: 62.065 Tflops/s, 2752.516 iter/s, 3.633e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 64.457 Tflops/s, hfu: 64.457 Tflops/s, 2858.580 iter/s, 3.498e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 70.94 Tflops/s, hfu: 70.94 Tflops/s, 3146.079 iter/s, 3.179e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 76.807 Tflops/s, hfu: 76.807 Tflops/s, 3406.273 iter/s, 2.936e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 75.343 Tflops/s, hfu: 75.343 Tflops/s, 3341.353 iter/s, 2.993e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 77.01 Tflops/s, hfu: 77.01 Tflops/s, 3415.300 iter/s, 2.928e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(14336,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.732 Tflops/s, hfu: 4.732 Tflops/s, 359.774 iter/s, 2.780e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.661 Tflops/s, hfu: 8.661 Tflops/s, 658.457 iter/s, 1.519e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.114 Tflops/s, hfu: 4.114 Tflops/s, 312.781 iter/s, 3.197e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 62.357 Tflops/s, hfu: 62.357 Tflops/s, 2370.387 iter/s, 4.219e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 65.352 Tflops/s, hfu: 65.352 Tflops/s, 2484.250 iter/s, 4.025e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 66.292 Tflops/s, hfu: 66.292 Tflops/s, 2519.958 iter/s, 3.968e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 67.166 Tflops/s, hfu: 67.166 Tflops/s, 2553.209 iter/s, 3.917e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 76.791 Tflops/s, hfu: 76.791 Tflops/s, 2919.060 iter/s, 3.426e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.655 Tflops/s, hfu: 79.655 Tflops/s, 3027.954 iter/s, 3.303e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 79.833 Tflops/s, hfu: 79.833 Tflops/s, 3034.717 iter/s, 3.295e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 79.942 Tflops/s, hfu: 79.942 Tflops/s, 3038.849 iter/s, 3.291e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(14336,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.433 Tflops/s, hfu: 5.433 Tflops/s, 361.411 iter/s, 2.767e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.478 Tflops/s, hfu: 9.478 Tflops/s, 630.481 iter/s, 1.586e-03 s/iter, (0.018, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 4.668 Tflops/s, hfu: 4.668 Tflops/s, 310.551 iter/s, 3.220e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 67.106 Tflops/s, hfu: 67.106 Tflops/s, 2232.063 iter/s, 4.480e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.368 Tflops/s, hfu: 70.368 Tflops/s, 2340.561 iter/s, 4.272e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 69.497 Tflops/s, hfu: 69.497 Tflops/s, 2311.561 iter/s, 4.326e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.183 Tflops/s, hfu: 71.183 Tflops/s, 2367.648 iter/s, 4.224e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 79.849 Tflops/s, hfu: 79.849 Tflops/s, 2655.901 iter/s, 3.765e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 85.717 Tflops/s, hfu: 85.717 Tflops/s, 2851.082 iter/s, 3.507e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 82.781 Tflops/s, hfu: 82.781 Tflops/s, 2753.425 iter/s, 3.632e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 75.776 Tflops/s, hfu: 75.776 Tflops/s, 2520.416 iter/s, 3.968e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(14336,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.841 Tflops/s, hfu: 6.841 Tflops/s, 364.094 iter/s, 2.747e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.322 Tflops/s, hfu: 12.322 Tflops/s, 655.765 iter/s, 1.525e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.918 Tflops/s, hfu: 5.918 Tflops/s, 314.926 iter/s, 3.175e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 77.794 Tflops/s, hfu: 77.794 Tflops/s, 2070.051 iter/s, 4.831e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.486 Tflops/s, hfu: 79.486 Tflops/s, 2115.059 iter/s, 4.728e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 79.482 Tflops/s, hfu: 79.482 Tflops/s, 2114.952 iter/s, 4.728e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.983 Tflops/s, hfu: 79.983 Tflops/s, 2128.275 iter/s, 4.699e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 84.544 Tflops/s, hfu: 84.544 Tflops/s, 2249.658 iter/s, 4.445e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 92.706 Tflops/s, hfu: 92.706 Tflops/s, 2466.846 iter/s, 4.054e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 90.447 Tflops/s, hfu: 90.447 Tflops/s, 2406.716 iter/s, 4.155e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.479 Tflops/s, hfu: 79.479 Tflops/s, 2114.880 iter/s, 4.728e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(14336,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.139 Tflops/s, hfu: 8.139 Tflops/s, 360.957 iter/s, 2.770e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.78 Tflops/s, hfu: 14.78 Tflops/s, 655.457 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.094 Tflops/s, hfu: 7.094 Tflops/s, 314.622 iter/s, 3.178e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 83.264 Tflops/s, hfu: 83.264 Tflops/s, 1846.327 iter/s, 5.416e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 85.229 Tflops/s, hfu: 85.229 Tflops/s, 1889.902 iter/s, 5.291e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 83.78 Tflops/s, hfu: 83.78 Tflops/s, 1857.769 iter/s, 5.383e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 83.503 Tflops/s, hfu: 83.503 Tflops/s, 1851.633 iter/s, 5.401e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 90.246 Tflops/s, hfu: 90.246 Tflops/s, 2001.153 iter/s, 4.997e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 99.482 Tflops/s, hfu: 99.482 Tflops/s, 2205.947 iter/s, 4.533e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 96.066 Tflops/s, hfu: 96.066 Tflops/s, 2130.198 iter/s, 4.694e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.401 Tflops/s, hfu: 84.401 Tflops/s, 1871.538 iter/s, 5.343e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(14336,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.499 Tflops/s, hfu: 9.499 Tflops/s, 361.088 iter/s, 2.769e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.319 Tflops/s, hfu: 17.319 Tflops/s, 658.333 iter/s, 1.519e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.237 Tflops/s, hfu: 8.237 Tflops/s, 313.112 iter/s, 3.194e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 86.609 Tflops/s, hfu: 86.609 Tflops/s, 1646.145 iter/s, 6.075e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 88.45 Tflops/s, hfu: 88.45 Tflops/s, 1681.124 iter/s, 5.948e-04 s/iter, (0.162, 0.000, 0.002) sec
mfu: 88.583 Tflops/s, hfu: 88.583 Tflops/s, 1683.660 iter/s, 5.939e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 87.557 Tflops/s, hfu: 87.557 Tflops/s, 1664.159 iter/s, 6.009e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 92.285 Tflops/s, hfu: 92.285 Tflops/s, 1754.017 iter/s, 5.701e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 103.275 Tflops/s, hfu: 103.275 Tflops/s, 1962.909 iter/s, 5.094e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 98.7 Tflops/s, hfu: 98.7 Tflops/s, 1875.947 iter/s, 5.331e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 86.973 Tflops/s, hfu: 86.973 Tflops/s, 1653.067 iter/s, 6.049e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(14336,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.783 Tflops/s, hfu: 10.783 Tflops/s, 358.652 iter/s, 2.788e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.524 Tflops/s, hfu: 19.524 Tflops/s, 649.414 iter/s, 1.540e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.361 Tflops/s, hfu: 9.361 Tflops/s, 311.345 iter/s, 3.212e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 94.132 Tflops/s, hfu: 94.132 Tflops/s, 1565.494 iter/s, 6.388e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 98.766 Tflops/s, hfu: 98.766 Tflops/s, 1642.554 iter/s, 6.088e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 96.658 Tflops/s, hfu: 96.658 Tflops/s, 1607.490 iter/s, 6.221e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 93.949 Tflops/s, hfu: 93.949 Tflops/s, 1562.441 iter/s, 6.400e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 96.154 Tflops/s, hfu: 96.154 Tflops/s, 1599.120 iter/s, 6.253e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 106.807 Tflops/s, hfu: 106.807 Tflops/s, 1776.275 iter/s, 5.630e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.959 Tflops/s, hfu: 101.959 Tflops/s, 1695.651 iter/s, 5.897e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 87.777 Tflops/s, hfu: 87.777 Tflops/s, 1459.803 iter/s, 6.850e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(14336,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.565 Tflops/s, hfu: 13.565 Tflops/s, 360.963 iter/s, 2.770e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.561 Tflops/s, hfu: 24.561 Tflops/s, 653.558 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 11.751 Tflops/s, hfu: 11.751 Tflops/s, 312.680 iter/s, 3.198e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 104.016 Tflops/s, hfu: 104.016 Tflops/s, 1383.892 iter/s, 7.226e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 107.825 Tflops/s, hfu: 107.825 Tflops/s, 1434.572 iter/s, 6.971e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 100.278 Tflops/s, hfu: 100.278 Tflops/s, 1334.159 iter/s, 7.495e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.203 Tflops/s, hfu: 101.203 Tflops/s, 1346.460 iter/s, 7.427e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 99.323 Tflops/s, hfu: 99.323 Tflops/s, 1321.451 iter/s, 7.567e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 113.375 Tflops/s, hfu: 113.375 Tflops/s, 1508.405 iter/s, 6.630e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 107.856 Tflops/s, hfu: 107.856 Tflops/s, 1434.984 iter/s, 6.969e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 92.519 Tflops/s, hfu: 92.519 Tflops/s, 1230.933 iter/s, 8.124e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(14336,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.157 Tflops/s, hfu: 16.157 Tflops/s, 358.264 iter/s, 2.791e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.624 Tflops/s, hfu: 29.624 Tflops/s, 656.889 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.074 Tflops/s, hfu: 14.074 Tflops/s, 312.084 iter/s, 3.204e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 106.122 Tflops/s, hfu: 106.122 Tflops/s, 1176.592 iter/s, 8.499e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 98.297 Tflops/s, hfu: 98.297 Tflops/s, 1089.837 iter/s, 9.176e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 101.154 Tflops/s, hfu: 101.154 Tflops/s, 1121.509 iter/s, 8.917e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.145 Tflops/s, hfu: 109.145 Tflops/s, 1210.115 iter/s, 8.264e-04 s/iter, (0.077, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 101.973 Tflops/s, hfu: 101.973 Tflops/s, 1130.587 iter/s, 8.845e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 118.008 Tflops/s, hfu: 118.008 Tflops/s, 1308.380 iter/s, 7.643e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 111.563 Tflops/s, hfu: 111.563 Tflops/s, 1236.913 iter/s, 8.085e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 95.024 Tflops/s, hfu: 95.024 Tflops/s, 1053.545 iter/s, 9.492e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(14336,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.716 Tflops/s, hfu: 18.716 Tflops/s, 355.725 iter/s, 2.811e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.521 Tflops/s, hfu: 34.521 Tflops/s, 656.119 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.513 Tflops/s, hfu: 16.513 Tflops/s, 313.862 iter/s, 3.186e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 106.119 Tflops/s, hfu: 106.119 Tflops/s, 1008.479 iter/s, 9.916e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 100.308 Tflops/s, hfu: 100.308 Tflops/s, 953.260 iter/s, 1.049e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 103.622 Tflops/s, hfu: 103.622 Tflops/s, 984.748 iter/s, 1.015e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 109.79 Tflops/s, hfu: 109.79 Tflops/s, 1043.371 iter/s, 9.584e-04 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 104.272 Tflops/s, hfu: 104.272 Tflops/s, 990.931 iter/s, 1.009e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.134 Tflops/s, hfu: 121.134 Tflops/s, 1151.172 iter/s, 8.687e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 112.976 Tflops/s, hfu: 112.976 Tflops/s, 1073.643 iter/s, 9.314e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 95.953 Tflops/s, hfu: 95.953 Tflops/s, 911.870 iter/s, 1.097e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(14336,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.298 Tflops/s, hfu: 21.298 Tflops/s, 354.207 iter/s, 2.823e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.925 Tflops/s, hfu: 38.925 Tflops/s, 647.359 iter/s, 1.545e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.483 Tflops/s, hfu: 18.483 Tflops/s, 307.386 iter/s, 3.253e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 116.549 Tflops/s, hfu: 116.549 Tflops/s, 969.150 iter/s, 1.032e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 117.275 Tflops/s, hfu: 117.275 Tflops/s, 975.184 iter/s, 1.025e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 107.378 Tflops/s, hfu: 107.378 Tflops/s, 892.889 iter/s, 1.120e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 113.956 Tflops/s, hfu: 113.956 Tflops/s, 947.587 iter/s, 1.055e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 105.946 Tflops/s, hfu: 105.946 Tflops/s, 880.983 iter/s, 1.135e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 124.558 Tflops/s, hfu: 124.558 Tflops/s, 1035.746 iter/s, 9.655e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 115.286 Tflops/s, hfu: 115.286 Tflops/s, 958.648 iter/s, 1.043e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 97.446 Tflops/s, hfu: 97.446 Tflops/s, 810.304 iter/s, 1.234e-03 s/iter, (0.080, 0.000, 0.005) sec
SP=(1,8),S=(14336,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.08 Tflops/s, hfu: 27.08 Tflops/s, 360.291 iter/s, 2.776e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 48.396 Tflops/s, hfu: 48.396 Tflops/s, 643.886 iter/s, 1.553e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 22.994 Tflops/s, hfu: 22.994 Tflops/s, 305.921 iter/s, 3.269e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 114.323 Tflops/s, hfu: 114.323 Tflops/s, 760.512 iter/s, 1.315e-03 s/iter, (0.161, 0.000, 0.005) sec
mfu: 110.167 Tflops/s, hfu: 110.167 Tflops/s, 732.867 iter/s, 1.365e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 103.101 Tflops/s, hfu: 103.101 Tflops/s, 685.860 iter/s, 1.458e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 120.565 Tflops/s, hfu: 120.565 Tflops/s, 802.038 iter/s, 1.247e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 107.812 Tflops/s, hfu: 107.812 Tflops/s, 717.195 iter/s, 1.394e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 126.2 Tflops/s, hfu: 126.2 Tflops/s, 839.523 iter/s, 1.191e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 118.203 Tflops/s, hfu: 118.203 Tflops/s, 786.322 iter/s, 1.272e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 99.378 Tflops/s, hfu: 99.378 Tflops/s, 661.096 iter/s, 1.513e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(14336,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.353 Tflops/s, hfu: 32.353 Tflops/s, 358.704 iter/s, 2.788e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.918 Tflops/s, hfu: 58.918 Tflops/s, 653.237 iter/s, 1.531e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 28.251 Tflops/s, hfu: 28.251 Tflops/s, 313.225 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.893 Tflops/s, hfu: 125.893 Tflops/s, 697.899 iter/s, 1.433e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 125.443 Tflops/s, hfu: 125.443 Tflops/s, 695.403 iter/s, 1.438e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 109.093 Tflops/s, hfu: 109.093 Tflops/s, 604.768 iter/s, 1.654e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 118.292 Tflops/s, hfu: 118.292 Tflops/s, 655.762 iter/s, 1.525e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 109.677 Tflops/s, hfu: 109.677 Tflops/s, 608.003 iter/s, 1.645e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 129.569 Tflops/s, hfu: 129.569 Tflops/s, 718.275 iter/s, 1.392e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 121.031 Tflops/s, hfu: 121.031 Tflops/s, 670.946 iter/s, 1.490e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 101.12 Tflops/s, hfu: 101.12 Tflops/s, 560.566 iter/s, 1.784e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(14336,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.226 Tflops/s, hfu: 37.226 Tflops/s, 353.769 iter/s, 2.827e-03 s/iter, (0.037, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.782 Tflops/s, hfu: 68.782 Tflops/s, 653.654 iter/s, 1.530e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.953 Tflops/s, hfu: 32.953 Tflops/s, 313.166 iter/s, 3.193e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 124.394 Tflops/s, hfu: 124.394 Tflops/s, 591.075 iter/s, 1.692e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 109.36 Tflops/s, hfu: 109.36 Tflops/s, 519.638 iter/s, 1.924e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 113.194 Tflops/s, hfu: 113.194 Tflops/s, 537.859 iter/s, 1.859e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 122.283 Tflops/s, hfu: 122.283 Tflops/s, 581.047 iter/s, 1.721e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 111.059 Tflops/s, hfu: 111.059 Tflops/s, 527.711 iter/s, 1.895e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 131.258 Tflops/s, hfu: 131.258 Tflops/s, 623.693 iter/s, 1.603e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 122.387 Tflops/s, hfu: 122.387 Tflops/s, 581.541 iter/s, 1.720e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 101.442 Tflops/s, hfu: 101.442 Tflops/s, 482.019 iter/s, 2.075e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(14336,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 41.854 Tflops/s, hfu: 41.854 Tflops/s, 348.032 iter/s, 2.873e-03 s/iter, (0.036, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.266 Tflops/s, hfu: 78.266 Tflops/s, 650.809 iter/s, 1.537e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 37.273 Tflops/s, hfu: 37.273 Tflops/s, 309.942 iter/s, 3.226e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 130.975 Tflops/s, hfu: 130.975 Tflops/s, 544.553 iter/s, 1.836e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 123.423 Tflops/s, hfu: 123.423 Tflops/s, 513.153 iter/s, 1.949e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 112.955 Tflops/s, hfu: 112.955 Tflops/s, 469.634 iter/s, 2.129e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 129.119 Tflops/s, hfu: 129.119 Tflops/s, 536.838 iter/s, 1.863e-03 s/iter, (0.078, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 112.057 Tflops/s, hfu: 112.057 Tflops/s, 465.896 iter/s, 2.146e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 133.2 Tflops/s, hfu: 133.2 Tflops/s, 553.806 iter/s, 1.806e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 123.109 Tflops/s, hfu: 123.109 Tflops/s, 511.850 iter/s, 1.954e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 101.325 Tflops/s, hfu: 101.325 Tflops/s, 421.278 iter/s, 2.374e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(14336,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.315 Tflops/s, hfu: 53.315 Tflops/s, 354.665 iter/s, 2.820e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.621 Tflops/s, hfu: 91.621 Tflops/s, 609.491 iter/s, 1.641e-03 s/iter, (0.021, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 44.618 Tflops/s, hfu: 44.618 Tflops/s, 296.816 iter/s, 3.369e-03 s/iter, (0.038, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 127.779 Tflops/s, hfu: 127.779 Tflops/s, 425.014 iter/s, 2.353e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 107.693 Tflops/s, hfu: 107.693 Tflops/s, 358.202 iter/s, 2.792e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 110.946 Tflops/s, hfu: 110.946 Tflops/s, 369.024 iter/s, 2.710e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 132.122 Tflops/s, hfu: 132.122 Tflops/s, 439.458 iter/s, 2.276e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 112.333 Tflops/s, hfu: 112.333 Tflops/s, 373.635 iter/s, 2.676e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 134.747 Tflops/s, hfu: 134.747 Tflops/s, 448.188 iter/s, 2.231e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 125.347 Tflops/s, hfu: 125.347 Tflops/s, 416.922 iter/s, 2.399e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 102.288 Tflops/s, hfu: 102.288 Tflops/s, 340.226 iter/s, 2.939e-03 s/iter, (0.082, 0.000, 0.012) sec
SP=(1,8),S=(14336,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.18 Tflops/s, hfu: 58.18 Tflops/s, 322.527 iter/s, 3.101e-03 s/iter, (0.041, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.526 Tflops/s, hfu: 98.526 Tflops/s, 546.187 iter/s, 1.831e-03 s/iter, (0.022, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 49.634 Tflops/s, hfu: 49.634 Tflops/s, 275.153 iter/s, 3.634e-03 s/iter, (0.041, 0.000, 0.073) sec
# orchestrated_attn_func
mfu: 142.915 Tflops/s, hfu: 142.915 Tflops/s, 396.130 iter/s, 2.524e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 128.325 Tflops/s, hfu: 128.325 Tflops/s, 355.692 iter/s, 2.811e-03 s/iter, (0.089, 0.000, 0.011) sec
mfu: 121.8 Tflops/s, hfu: 121.8 Tflops/s, 337.605 iter/s, 2.962e-03 s/iter, (0.083, 0.000, 0.012) sec
mfu: 127.394 Tflops/s, hfu: 127.394 Tflops/s, 353.109 iter/s, 2.832e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 113.368 Tflops/s, hfu: 113.368 Tflops/s, 314.233 iter/s, 3.182e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 137.058 Tflops/s, hfu: 137.058 Tflops/s, 379.898 iter/s, 2.632e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 126.467 Tflops/s, hfu: 126.467 Tflops/s, 350.542 iter/s, 2.853e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 103.626 Tflops/s, hfu: 103.626 Tflops/s, 287.230 iter/s, 3.482e-03 s/iter, (0.084, 0.000, 0.014) sec
SP=(1,8),S=(14336,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.493 Tflops/s, hfu: 60.493 Tflops/s, 287.441 iter/s, 3.479e-03 s/iter, (0.044, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 94.264 Tflops/s, hfu: 94.264 Tflops/s, 447.908 iter/s, 2.233e-03 s/iter, (0.026, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 52.558 Tflops/s, hfu: 52.558 Tflops/s, 249.738 iter/s, 4.004e-03 s/iter, (0.044, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 135.515 Tflops/s, hfu: 135.515 Tflops/s, 321.961 iter/s, 3.106e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 121.09 Tflops/s, hfu: 121.09 Tflops/s, 287.689 iter/s, 3.476e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 119.701 Tflops/s, hfu: 119.701 Tflops/s, 284.390 iter/s, 3.516e-03 s/iter, (0.086, 0.000, 0.014) sec
mfu: 127.211 Tflops/s, hfu: 127.211 Tflops/s, 302.230 iter/s, 3.309e-03 s/iter, (0.086, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 114.335 Tflops/s, hfu: 114.335 Tflops/s, 271.639 iter/s, 3.681e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 137.316 Tflops/s, hfu: 137.316 Tflops/s, 326.239 iter/s, 3.065e-03 s/iter, (0.085, 0.000, 0.012) sec
mfu: 126.438 Tflops/s, hfu: 126.438 Tflops/s, 300.395 iter/s, 3.329e-03 s/iter, (0.087, 0.000, 0.013) sec
mfu: 103.114 Tflops/s, hfu: 103.114 Tflops/s, 244.982 iter/s, 4.082e-03 s/iter, (0.087, 0.000, 0.016) sec
SP=(1,8),S=(14336,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.083 Tflops/s, hfu: 62.083 Tflops/s, 258.123 iter/s, 3.874e-03 s/iter, (0.050, 0.000, 0.077) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 95.701 Tflops/s, hfu: 95.701 Tflops/s, 397.894 iter/s, 2.513e-03 s/iter, (0.031, 0.000, 0.050) sec
# stripe_flash_attn_func, fwd
mfu: 55.879 Tflops/s, hfu: 55.879 Tflops/s, 232.328 iter/s, 4.304e-03 s/iter, (0.049, 0.000, 0.086) sec
# orchestrated_attn_func
mfu: 138.933 Tflops/s, hfu: 138.933 Tflops/s, 288.820 iter/s, 3.462e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 143.105 Tflops/s, hfu: 143.105 Tflops/s, 297.492 iter/s, 3.361e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 115.674 Tflops/s, hfu: 115.674 Tflops/s, 240.468 iter/s, 4.159e-03 s/iter, (0.147, 0.000, 0.017) sec
mfu: 139.101 Tflops/s, hfu: 139.101 Tflops/s, 289.170 iter/s, 3.458e-03 s/iter, (0.084, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 114.707 Tflops/s, hfu: 114.707 Tflops/s, 238.459 iter/s, 4.194e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 138.012 Tflops/s, hfu: 138.012 Tflops/s, 286.905 iter/s, 3.485e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 127.635 Tflops/s, hfu: 127.635 Tflops/s, 265.334 iter/s, 3.769e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 103.953 Tflops/s, hfu: 103.953 Tflops/s, 216.103 iter/s, 4.627e-03 s/iter, (0.092, 0.000, 0.019) sec
SP=(1,8),S=(16384,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.396 Tflops/s, hfu: 0.396 Tflops/s, 368.724 iter/s, 2.712e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.725 Tflops/s, hfu: 0.725 Tflops/s, 674.814 iter/s, 1.482e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.345 Tflops/s, hfu: 0.345 Tflops/s, 320.962 iter/s, 3.116e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 6.554 Tflops/s, hfu: 6.554 Tflops/s, 3052.056 iter/s, 3.276e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 8.854 Tflops/s, hfu: 8.854 Tflops/s, 4123.099 iter/s, 2.425e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 10.098 Tflops/s, hfu: 10.098 Tflops/s, 4702.077 iter/s, 2.127e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 11.054 Tflops/s, hfu: 11.054 Tflops/s, 5147.210 iter/s, 1.943e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 14.333 Tflops/s, hfu: 14.333 Tflops/s, 6674.499 iter/s, 1.498e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 10.794 Tflops/s, hfu: 10.794 Tflops/s, 5026.136 iter/s, 1.990e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 19.39 Tflops/s, hfu: 19.39 Tflops/s, 9029.182 iter/s, 1.108e-04 s/iter, (0.070, 0.000, 0.000) sec
mfu: 29.187 Tflops/s, hfu: 29.187 Tflops/s, 13591.388 iter/s, 7.358e-05 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(16384,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.782 Tflops/s, hfu: 0.782 Tflops/s, 364.337 iter/s, 2.745e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.442 Tflops/s, hfu: 1.442 Tflops/s, 671.529 iter/s, 1.489e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.686 Tflops/s, hfu: 0.686 Tflops/s, 319.222 iter/s, 3.133e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 11.798 Tflops/s, hfu: 11.798 Tflops/s, 2747.011 iter/s, 3.640e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 16.676 Tflops/s, hfu: 16.676 Tflops/s, 3882.711 iter/s, 2.576e-04 s/iter, (0.096, 0.000, 0.001) sec
mfu: 17.359 Tflops/s, hfu: 17.359 Tflops/s, 4041.645 iter/s, 2.474e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 18.955 Tflops/s, hfu: 18.955 Tflops/s, 4413.374 iter/s, 2.266e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 25.721 Tflops/s, hfu: 25.721 Tflops/s, 5988.597 iter/s, 1.670e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.444 Tflops/s, hfu: 21.444 Tflops/s, 4992.811 iter/s, 2.003e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 32.874 Tflops/s, hfu: 32.874 Tflops/s, 7654.155 iter/s, 1.306e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 41.291 Tflops/s, hfu: 41.291 Tflops/s, 9613.906 iter/s, 1.040e-04 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(16384,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.184 Tflops/s, hfu: 1.184 Tflops/s, 367.419 iter/s, 2.722e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.165 Tflops/s, hfu: 2.165 Tflops/s, 672.062 iter/s, 1.488e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.037 Tflops/s, hfu: 1.037 Tflops/s, 321.895 iter/s, 3.107e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 17.842 Tflops/s, hfu: 17.842 Tflops/s, 2769.469 iter/s, 3.611e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.268 Tflops/s, hfu: 21.268 Tflops/s, 3301.202 iter/s, 3.029e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.388 Tflops/s, hfu: 23.388 Tflops/s, 3630.344 iter/s, 2.755e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 25.747 Tflops/s, hfu: 25.747 Tflops/s, 3996.419 iter/s, 2.502e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 35.426 Tflops/s, hfu: 35.426 Tflops/s, 5498.856 iter/s, 1.819e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.035 Tflops/s, hfu: 29.035 Tflops/s, 4506.778 iter/s, 2.219e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 45.323 Tflops/s, hfu: 45.323 Tflops/s, 7035.120 iter/s, 1.421e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 50.493 Tflops/s, hfu: 50.493 Tflops/s, 7837.482 iter/s, 1.276e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(16384,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.582 Tflops/s, hfu: 1.582 Tflops/s, 368.379 iter/s, 2.715e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.858 Tflops/s, hfu: 2.858 Tflops/s, 665.409 iter/s, 1.503e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.376 Tflops/s, hfu: 1.376 Tflops/s, 320.467 iter/s, 3.120e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 23.164 Tflops/s, hfu: 23.164 Tflops/s, 2696.697 iter/s, 3.708e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.338 Tflops/s, hfu: 29.338 Tflops/s, 3415.394 iter/s, 2.928e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 31.092 Tflops/s, hfu: 31.092 Tflops/s, 3619.621 iter/s, 2.763e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 32.636 Tflops/s, hfu: 32.636 Tflops/s, 3799.277 iter/s, 2.632e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 43.503 Tflops/s, hfu: 43.503 Tflops/s, 5064.419 iter/s, 1.975e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.63 Tflops/s, hfu: 36.63 Tflops/s, 4264.320 iter/s, 2.345e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 45.486 Tflops/s, hfu: 45.486 Tflops/s, 5295.264 iter/s, 1.888e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 55.875 Tflops/s, hfu: 55.875 Tflops/s, 6504.658 iter/s, 1.537e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(16384,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.954 Tflops/s, hfu: 1.954 Tflops/s, 363.942 iter/s, 2.748e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.489 Tflops/s, hfu: 3.489 Tflops/s, 649.907 iter/s, 1.539e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.661 Tflops/s, hfu: 1.661 Tflops/s, 309.370 iter/s, 3.232e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 29.792 Tflops/s, hfu: 29.792 Tflops/s, 2774.633 iter/s, 3.604e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.264 Tflops/s, hfu: 34.264 Tflops/s, 3191.055 iter/s, 3.134e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.638 Tflops/s, hfu: 37.638 Tflops/s, 3505.328 iter/s, 2.853e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.242 Tflops/s, hfu: 38.242 Tflops/s, 3561.558 iter/s, 2.808e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 49.27 Tflops/s, hfu: 49.27 Tflops/s, 4588.671 iter/s, 2.179e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 40.979 Tflops/s, hfu: 40.979 Tflops/s, 3816.444 iter/s, 2.620e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 50.29 Tflops/s, hfu: 50.29 Tflops/s, 4683.577 iter/s, 2.135e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 61.385 Tflops/s, hfu: 61.385 Tflops/s, 5716.900 iter/s, 1.749e-04 s/iter, (0.072, 0.001, 0.001) sec
SP=(1,8),S=(16384,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.326 Tflops/s, hfu: 2.326 Tflops/s, 360.971 iter/s, 2.770e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.152 Tflops/s, hfu: 4.152 Tflops/s, 644.474 iter/s, 1.552e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.996 Tflops/s, hfu: 1.996 Tflops/s, 309.890 iter/s, 3.227e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 32.999 Tflops/s, hfu: 32.999 Tflops/s, 2561.056 iter/s, 3.905e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 36.113 Tflops/s, hfu: 36.113 Tflops/s, 2802.753 iter/s, 3.568e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.163 Tflops/s, hfu: 38.163 Tflops/s, 2961.875 iter/s, 3.376e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.287 Tflops/s, hfu: 43.287 Tflops/s, 3359.493 iter/s, 2.977e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 55.289 Tflops/s, hfu: 55.289 Tflops/s, 4290.961 iter/s, 2.330e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 44.914 Tflops/s, hfu: 44.914 Tflops/s, 3485.778 iter/s, 2.869e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 57.857 Tflops/s, hfu: 57.857 Tflops/s, 4490.265 iter/s, 2.227e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 67.787 Tflops/s, hfu: 67.787 Tflops/s, 5260.943 iter/s, 1.901e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(16384,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.756 Tflops/s, hfu: 2.756 Tflops/s, 366.741 iter/s, 2.727e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.777 Tflops/s, hfu: 4.777 Tflops/s, 635.626 iter/s, 1.573e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.313 Tflops/s, hfu: 2.313 Tflops/s, 307.700 iter/s, 3.250e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 40.948 Tflops/s, hfu: 40.948 Tflops/s, 2723.964 iter/s, 3.671e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.459 Tflops/s, hfu: 45.459 Tflops/s, 3024.071 iter/s, 3.307e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 46.533 Tflops/s, hfu: 46.533 Tflops/s, 3095.515 iter/s, 3.230e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 48.932 Tflops/s, hfu: 48.932 Tflops/s, 3255.123 iter/s, 3.072e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 62.47 Tflops/s, hfu: 62.47 Tflops/s, 4155.723 iter/s, 2.406e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 52.112 Tflops/s, hfu: 52.112 Tflops/s, 3466.637 iter/s, 2.885e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 61.353 Tflops/s, hfu: 61.353 Tflops/s, 4081.366 iter/s, 2.450e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 71.317 Tflops/s, hfu: 71.317 Tflops/s, 4744.193 iter/s, 2.108e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(16384,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.162 Tflops/s, hfu: 3.162 Tflops/s, 368.120 iter/s, 2.717e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.455 Tflops/s, hfu: 5.455 Tflops/s, 635.039 iter/s, 1.575e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.642 Tflops/s, hfu: 2.642 Tflops/s, 307.531 iter/s, 3.252e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 44.936 Tflops/s, hfu: 44.936 Tflops/s, 2615.610 iter/s, 3.823e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 49.073 Tflops/s, hfu: 49.073 Tflops/s, 2856.425 iter/s, 3.501e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.904 Tflops/s, hfu: 50.904 Tflops/s, 2962.998 iter/s, 3.375e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 51.51 Tflops/s, hfu: 51.51 Tflops/s, 2998.249 iter/s, 3.335e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 64.796 Tflops/s, hfu: 64.796 Tflops/s, 3771.649 iter/s, 2.651e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 54.954 Tflops/s, hfu: 54.954 Tflops/s, 3198.731 iter/s, 3.126e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 66.009 Tflops/s, hfu: 66.009 Tflops/s, 3842.252 iter/s, 2.603e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 72.764 Tflops/s, hfu: 72.764 Tflops/s, 4235.422 iter/s, 2.361e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(16384,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.886 Tflops/s, hfu: 3.886 Tflops/s, 361.879 iter/s, 2.763e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.915 Tflops/s, hfu: 6.915 Tflops/s, 644.034 iter/s, 1.553e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.28 Tflops/s, hfu: 3.28 Tflops/s, 305.445 iter/s, 3.274e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 38.751 Tflops/s, hfu: 38.751 Tflops/s, 1804.481 iter/s, 5.542e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 42.92 Tflops/s, hfu: 42.92 Tflops/s, 1998.625 iter/s, 5.003e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 43.398 Tflops/s, hfu: 43.398 Tflops/s, 2020.888 iter/s, 4.948e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 45.587 Tflops/s, hfu: 45.587 Tflops/s, 2122.818 iter/s, 4.711e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 72.644 Tflops/s, hfu: 72.644 Tflops/s, 3382.767 iter/s, 2.956e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 62.726 Tflops/s, hfu: 62.726 Tflops/s, 2920.902 iter/s, 3.424e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 73.407 Tflops/s, hfu: 73.407 Tflops/s, 3418.289 iter/s, 2.925e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 77.228 Tflops/s, hfu: 77.228 Tflops/s, 3596.191 iter/s, 2.781e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(16384,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.635 Tflops/s, hfu: 4.635 Tflops/s, 359.705 iter/s, 2.780e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.297 Tflops/s, hfu: 8.297 Tflops/s, 643.960 iter/s, 1.553e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.935 Tflops/s, hfu: 3.935 Tflops/s, 305.409 iter/s, 3.274e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 56.565 Tflops/s, hfu: 56.565 Tflops/s, 2195.023 iter/s, 4.556e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.927 Tflops/s, hfu: 58.927 Tflops/s, 2286.655 iter/s, 4.373e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 59.208 Tflops/s, hfu: 59.208 Tflops/s, 2297.583 iter/s, 4.352e-04 s/iter, (0.142, 0.000, 0.002) sec
mfu: 67.073 Tflops/s, hfu: 67.073 Tflops/s, 2602.757 iter/s, 3.842e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 80.432 Tflops/s, hfu: 80.432 Tflops/s, 3121.176 iter/s, 3.204e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 68.849 Tflops/s, hfu: 68.849 Tflops/s, 2671.682 iter/s, 3.743e-04 s/iter, (0.080, 0.000, 0.001) sec
mfu: 80.761 Tflops/s, hfu: 80.761 Tflops/s, 3133.931 iter/s, 3.191e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 82.966 Tflops/s, hfu: 82.966 Tflops/s, 3219.492 iter/s, 3.106e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(16384,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.391 Tflops/s, hfu: 5.391 Tflops/s, 358.639 iter/s, 2.788e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.723 Tflops/s, hfu: 9.723 Tflops/s, 646.780 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.621 Tflops/s, hfu: 4.621 Tflops/s, 307.401 iter/s, 3.253e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 69.504 Tflops/s, hfu: 69.504 Tflops/s, 2311.818 iter/s, 4.326e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 66.828 Tflops/s, hfu: 66.828 Tflops/s, 2222.815 iter/s, 4.499e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 70.437 Tflops/s, hfu: 70.437 Tflops/s, 2342.842 iter/s, 4.268e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.655 Tflops/s, hfu: 72.655 Tflops/s, 2416.626 iter/s, 4.138e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.471 Tflops/s, hfu: 83.471 Tflops/s, 2776.359 iter/s, 3.602e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 76.738 Tflops/s, hfu: 76.738 Tflops/s, 2552.427 iter/s, 3.918e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 84.636 Tflops/s, hfu: 84.636 Tflops/s, 2815.125 iter/s, 3.552e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 84.732 Tflops/s, hfu: 84.732 Tflops/s, 2818.299 iter/s, 3.548e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(16384,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.15 Tflops/s, hfu: 6.15 Tflops/s, 357.992 iter/s, 2.793e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.773 Tflops/s, hfu: 8.773 Tflops/s, 510.641 iter/s, 1.958e-03 s/iter, (0.019, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 5.276 Tflops/s, hfu: 5.276 Tflops/s, 307.086 iter/s, 3.256e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 71.736 Tflops/s, hfu: 71.736 Tflops/s, 2087.787 iter/s, 4.790e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 75.927 Tflops/s, hfu: 75.927 Tflops/s, 2209.769 iter/s, 4.525e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 75.146 Tflops/s, hfu: 75.146 Tflops/s, 2187.035 iter/s, 4.572e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 76.022 Tflops/s, hfu: 76.022 Tflops/s, 2212.546 iter/s, 4.520e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 88.613 Tflops/s, hfu: 88.613 Tflops/s, 2578.968 iter/s, 3.878e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 80.974 Tflops/s, hfu: 80.974 Tflops/s, 2356.667 iter/s, 4.243e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 89.874 Tflops/s, hfu: 89.874 Tflops/s, 2615.665 iter/s, 3.823e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 81.158 Tflops/s, hfu: 81.158 Tflops/s, 2362.011 iter/s, 4.234e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(16384,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.792 Tflops/s, hfu: 7.792 Tflops/s, 362.865 iter/s, 2.756e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.826 Tflops/s, hfu: 13.826 Tflops/s, 643.817 iter/s, 1.553e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.659 Tflops/s, hfu: 6.659 Tflops/s, 310.101 iter/s, 3.225e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 81.308 Tflops/s, hfu: 81.308 Tflops/s, 1893.108 iter/s, 5.282e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 82.003 Tflops/s, hfu: 82.003 Tflops/s, 1909.271 iter/s, 5.238e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.686 Tflops/s, hfu: 79.686 Tflops/s, 1855.343 iter/s, 5.390e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 85.687 Tflops/s, hfu: 85.687 Tflops/s, 1995.052 iter/s, 5.012e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 94.646 Tflops/s, hfu: 94.646 Tflops/s, 2203.653 iter/s, 4.538e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 89.632 Tflops/s, hfu: 89.632 Tflops/s, 2086.916 iter/s, 4.792e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 94.608 Tflops/s, hfu: 94.608 Tflops/s, 2202.760 iter/s, 4.540e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 84.435 Tflops/s, hfu: 84.435 Tflops/s, 1965.903 iter/s, 5.087e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(16384,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.302 Tflops/s, hfu: 9.302 Tflops/s, 360.960 iter/s, 2.770e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.573 Tflops/s, hfu: 16.573 Tflops/s, 643.116 iter/s, 1.555e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.988 Tflops/s, hfu: 7.988 Tflops/s, 309.964 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 82.419 Tflops/s, hfu: 82.419 Tflops/s, 1599.140 iter/s, 6.253e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 77.806 Tflops/s, hfu: 77.806 Tflops/s, 1509.625 iter/s, 6.624e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 75.142 Tflops/s, hfu: 75.142 Tflops/s, 1457.947 iter/s, 6.859e-04 s/iter, (0.136, 0.000, 0.003) sec
mfu: 89.418 Tflops/s, hfu: 89.418 Tflops/s, 1734.930 iter/s, 5.764e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 99.714 Tflops/s, hfu: 99.714 Tflops/s, 1934.715 iter/s, 5.169e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 95.668 Tflops/s, hfu: 95.668 Tflops/s, 1856.197 iter/s, 5.387e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.69 Tflops/s, hfu: 101.69 Tflops/s, 1973.040 iter/s, 5.068e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 89.004 Tflops/s, hfu: 89.004 Tflops/s, 1726.901 iter/s, 5.791e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(16384,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.776 Tflops/s, hfu: 10.776 Tflops/s, 358.420 iter/s, 2.790e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.476 Tflops/s, hfu: 19.476 Tflops/s, 647.804 iter/s, 1.544e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.284 Tflops/s, hfu: 9.284 Tflops/s, 308.815 iter/s, 3.238e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 93.754 Tflops/s, hfu: 93.754 Tflops/s, 1559.206 iter/s, 6.414e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 95.784 Tflops/s, hfu: 95.784 Tflops/s, 1592.965 iter/s, 6.278e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.656 Tflops/s, hfu: 93.656 Tflops/s, 1557.574 iter/s, 6.420e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 97.852 Tflops/s, hfu: 97.852 Tflops/s, 1627.350 iter/s, 6.145e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 104.396 Tflops/s, hfu: 104.396 Tflops/s, 1736.183 iter/s, 5.760e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.855 Tflops/s, hfu: 100.855 Tflops/s, 1677.290 iter/s, 5.962e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 104.37 Tflops/s, hfu: 104.37 Tflops/s, 1735.749 iter/s, 5.761e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.781 Tflops/s, hfu: 90.781 Tflops/s, 1509.753 iter/s, 6.624e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(16384,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.242 Tflops/s, hfu: 12.242 Tflops/s, 356.301 iter/s, 2.807e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.187 Tflops/s, hfu: 22.187 Tflops/s, 645.725 iter/s, 1.549e-03 s/iter, (0.021, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.425 Tflops/s, hfu: 10.425 Tflops/s, 303.416 iter/s, 3.296e-03 s/iter, (0.037, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 98.303 Tflops/s, hfu: 98.303 Tflops/s, 1430.501 iter/s, 6.991e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 95.472 Tflops/s, hfu: 95.472 Tflops/s, 1389.306 iter/s, 7.198e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 89.344 Tflops/s, hfu: 89.344 Tflops/s, 1300.120 iter/s, 7.692e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 98.893 Tflops/s, hfu: 98.893 Tflops/s, 1439.081 iter/s, 6.949e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 106.543 Tflops/s, hfu: 106.543 Tflops/s, 1550.407 iter/s, 6.450e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.381 Tflops/s, hfu: 104.381 Tflops/s, 1518.944 iter/s, 6.584e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 106.645 Tflops/s, hfu: 106.645 Tflops/s, 1551.889 iter/s, 6.444e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 92.77 Tflops/s, hfu: 92.77 Tflops/s, 1349.980 iter/s, 7.408e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(16384,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.43 Tflops/s, hfu: 15.43 Tflops/s, 359.266 iter/s, 2.783e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.621 Tflops/s, hfu: 27.621 Tflops/s, 643.091 iter/s, 1.555e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.259 Tflops/s, hfu: 13.259 Tflops/s, 308.702 iter/s, 3.239e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 103.069 Tflops/s, hfu: 103.069 Tflops/s, 1199.881 iter/s, 8.334e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 105.323 Tflops/s, hfu: 105.323 Tflops/s, 1226.115 iter/s, 8.156e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 101.23 Tflops/s, hfu: 101.23 Tflops/s, 1178.467 iter/s, 8.486e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.773 Tflops/s, hfu: 104.773 Tflops/s, 1219.715 iter/s, 8.199e-04 s/iter, (0.077, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 111.629 Tflops/s, hfu: 111.629 Tflops/s, 1299.538 iter/s, 7.695e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 112.008 Tflops/s, hfu: 112.008 Tflops/s, 1303.944 iter/s, 7.669e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 111.919 Tflops/s, hfu: 111.919 Tflops/s, 1302.911 iter/s, 7.675e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 96.857 Tflops/s, hfu: 96.857 Tflops/s, 1127.569 iter/s, 8.869e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(16384,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.541 Tflops/s, hfu: 18.541 Tflops/s, 359.737 iter/s, 2.780e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.576 Tflops/s, hfu: 33.576 Tflops/s, 651.456 iter/s, 1.535e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.041 Tflops/s, hfu: 16.041 Tflops/s, 311.233 iter/s, 3.213e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 105.368 Tflops/s, hfu: 105.368 Tflops/s, 1022.202 iter/s, 9.783e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.489 Tflops/s, hfu: 109.489 Tflops/s, 1062.185 iter/s, 9.415e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 97.335 Tflops/s, hfu: 97.335 Tflops/s, 944.273 iter/s, 1.059e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 113.964 Tflops/s, hfu: 113.964 Tflops/s, 1105.598 iter/s, 9.045e-04 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 115.6 Tflops/s, hfu: 115.6 Tflops/s, 1121.469 iter/s, 8.917e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 115.909 Tflops/s, hfu: 115.909 Tflops/s, 1124.465 iter/s, 8.893e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 114.456 Tflops/s, hfu: 114.456 Tflops/s, 1110.371 iter/s, 9.006e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 99.593 Tflops/s, hfu: 99.593 Tflops/s, 966.176 iter/s, 1.035e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(16384,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.62 Tflops/s, hfu: 21.62 Tflops/s, 359.562 iter/s, 2.781e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.557 Tflops/s, hfu: 39.557 Tflops/s, 657.868 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 18.906 Tflops/s, hfu: 18.906 Tflops/s, 314.427 iter/s, 3.180e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 110.093 Tflops/s, hfu: 110.093 Tflops/s, 915.462 iter/s, 1.092e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 106.595 Tflops/s, hfu: 106.595 Tflops/s, 886.374 iter/s, 1.128e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 102.823 Tflops/s, hfu: 102.823 Tflops/s, 855.011 iter/s, 1.170e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 117.099 Tflops/s, hfu: 117.099 Tflops/s, 973.725 iter/s, 1.027e-03 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 117.14 Tflops/s, hfu: 117.14 Tflops/s, 974.066 iter/s, 1.027e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 120.418 Tflops/s, hfu: 120.418 Tflops/s, 1001.322 iter/s, 9.987e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 117.266 Tflops/s, hfu: 117.266 Tflops/s, 975.115 iter/s, 1.026e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 99.59 Tflops/s, hfu: 99.59 Tflops/s, 828.133 iter/s, 1.208e-03 s/iter, (0.083, 0.000, 0.005) sec
SP=(1,8),S=(16384,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.783 Tflops/s, hfu: 24.783 Tflops/s, 360.644 iter/s, 2.773e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 45.016 Tflops/s, hfu: 45.016 Tflops/s, 655.063 iter/s, 1.527e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.511 Tflops/s, hfu: 21.511 Tflops/s, 313.025 iter/s, 3.195e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 111.417 Tflops/s, hfu: 111.417 Tflops/s, 810.662 iter/s, 1.234e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 112.349 Tflops/s, hfu: 112.349 Tflops/s, 817.448 iter/s, 1.223e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 102.225 Tflops/s, hfu: 102.225 Tflops/s, 743.786 iter/s, 1.344e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 116.82 Tflops/s, hfu: 116.82 Tflops/s, 849.976 iter/s, 1.177e-03 s/iter, (0.074, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 119.034 Tflops/s, hfu: 119.034 Tflops/s, 866.083 iter/s, 1.155e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 123.132 Tflops/s, hfu: 123.132 Tflops/s, 895.903 iter/s, 1.116e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 119.047 Tflops/s, hfu: 119.047 Tflops/s, 866.179 iter/s, 1.154e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 101.645 Tflops/s, hfu: 101.645 Tflops/s, 739.562 iter/s, 1.352e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(16384,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.552 Tflops/s, hfu: 30.552 Tflops/s, 355.671 iter/s, 2.812e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.779 Tflops/s, hfu: 55.779 Tflops/s, 649.353 iter/s, 1.540e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.704 Tflops/s, hfu: 26.704 Tflops/s, 310.870 iter/s, 3.217e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 123.154 Tflops/s, hfu: 123.154 Tflops/s, 716.850 iter/s, 1.395e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 109.786 Tflops/s, hfu: 109.786 Tflops/s, 639.036 iter/s, 1.565e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 107.682 Tflops/s, hfu: 107.682 Tflops/s, 626.793 iter/s, 1.595e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 123.57 Tflops/s, hfu: 123.57 Tflops/s, 719.271 iter/s, 1.390e-03 s/iter, (0.079, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 121.681 Tflops/s, hfu: 121.681 Tflops/s, 708.275 iter/s, 1.412e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 126.922 Tflops/s, hfu: 126.922 Tflops/s, 738.784 iter/s, 1.354e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 121.208 Tflops/s, hfu: 121.208 Tflops/s, 705.521 iter/s, 1.417e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 102.903 Tflops/s, hfu: 102.903 Tflops/s, 598.975 iter/s, 1.670e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(16384,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.709 Tflops/s, hfu: 36.709 Tflops/s, 356.129 iter/s, 2.808e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 67.28 Tflops/s, hfu: 67.28 Tflops/s, 652.698 iter/s, 1.532e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.116 Tflops/s, hfu: 32.116 Tflops/s, 311.570 iter/s, 3.210e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 119.634 Tflops/s, hfu: 119.634 Tflops/s, 580.300 iter/s, 1.723e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 117.959 Tflops/s, hfu: 117.959 Tflops/s, 572.177 iter/s, 1.748e-03 s/iter, (0.077, 0.001, 0.007) sec
mfu: 115.578 Tflops/s, hfu: 115.578 Tflops/s, 560.629 iter/s, 1.784e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 125.371 Tflops/s, hfu: 125.371 Tflops/s, 608.127 iter/s, 1.644e-03 s/iter, (0.079, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 124.211 Tflops/s, hfu: 124.211 Tflops/s, 602.503 iter/s, 1.660e-03 s/iter, (0.077, 0.001, 0.007) sec
mfu: 130.634 Tflops/s, hfu: 130.634 Tflops/s, 633.659 iter/s, 1.578e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 123.597 Tflops/s, hfu: 123.597 Tflops/s, 599.523 iter/s, 1.668e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 105.246 Tflops/s, hfu: 105.246 Tflops/s, 510.508 iter/s, 1.959e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(16384,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.257 Tflops/s, hfu: 42.257 Tflops/s, 351.383 iter/s, 2.846e-03 s/iter, (0.037, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.051 Tflops/s, hfu: 76.051 Tflops/s, 632.391 iter/s, 1.581e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 36.411 Tflops/s, hfu: 36.411 Tflops/s, 302.770 iter/s, 3.303e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 130.677 Tflops/s, hfu: 130.677 Tflops/s, 543.313 iter/s, 1.841e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 130.83 Tflops/s, hfu: 130.83 Tflops/s, 543.951 iter/s, 1.838e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.131 Tflops/s, hfu: 131.131 Tflops/s, 545.202 iter/s, 1.834e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 127.476 Tflops/s, hfu: 127.476 Tflops/s, 530.007 iter/s, 1.887e-03 s/iter, (0.081, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 125.551 Tflops/s, hfu: 125.551 Tflops/s, 522.003 iter/s, 1.916e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 133.154 Tflops/s, hfu: 133.154 Tflops/s, 553.612 iter/s, 1.806e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 125.137 Tflops/s, hfu: 125.137 Tflops/s, 520.281 iter/s, 1.922e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 105.46 Tflops/s, hfu: 105.46 Tflops/s, 438.469 iter/s, 2.281e-03 s/iter, (0.083, 0.000, 0.009) sec
SP=(1,8),S=(16384,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 49.111 Tflops/s, hfu: 49.111 Tflops/s, 357.333 iter/s, 2.799e-03 s/iter, (0.047, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 86.532 Tflops/s, hfu: 86.532 Tflops/s, 629.605 iter/s, 1.588e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 41.665 Tflops/s, hfu: 41.665 Tflops/s, 303.155 iter/s, 3.299e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 120.953 Tflops/s, hfu: 120.953 Tflops/s, 440.023 iter/s, 2.273e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 120.327 Tflops/s, hfu: 120.327 Tflops/s, 437.749 iter/s, 2.284e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 133.291 Tflops/s, hfu: 133.291 Tflops/s, 484.911 iter/s, 2.062e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 131.346 Tflops/s, hfu: 131.346 Tflops/s, 477.832 iter/s, 2.093e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 126.794 Tflops/s, hfu: 126.794 Tflops/s, 461.273 iter/s, 2.168e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 134.994 Tflops/s, hfu: 134.994 Tflops/s, 491.107 iter/s, 2.036e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 125.21 Tflops/s, hfu: 125.21 Tflops/s, 455.511 iter/s, 2.195e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 105.038 Tflops/s, hfu: 105.038 Tflops/s, 382.125 iter/s, 2.617e-03 s/iter, (0.081, 0.000, 0.010) sec
SP=(1,8),S=(16384,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.169 Tflops/s, hfu: 58.169 Tflops/s, 338.590 iter/s, 2.953e-03 s/iter, (0.040, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.645 Tflops/s, hfu: 100.645 Tflops/s, 585.833 iter/s, 1.707e-03 s/iter, (0.023, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 48.115 Tflops/s, hfu: 48.115 Tflops/s, 280.065 iter/s, 3.571e-03 s/iter, (0.039, 0.000, 0.071) sec
# orchestrated_attn_func
mfu: 135.543 Tflops/s, hfu: 135.543 Tflops/s, 394.481 iter/s, 2.535e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 121.21 Tflops/s, hfu: 121.21 Tflops/s, 352.768 iter/s, 2.835e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 117.968 Tflops/s, hfu: 117.968 Tflops/s, 343.333 iter/s, 2.913e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 131.72 Tflops/s, hfu: 131.72 Tflops/s, 383.354 iter/s, 2.609e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 127.861 Tflops/s, hfu: 127.861 Tflops/s, 372.125 iter/s, 2.687e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 137.576 Tflops/s, hfu: 137.576 Tflops/s, 400.400 iter/s, 2.498e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 127.072 Tflops/s, hfu: 127.072 Tflops/s, 369.828 iter/s, 2.704e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 106.264 Tflops/s, hfu: 106.264 Tflops/s, 309.268 iter/s, 3.233e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(16384,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.249 Tflops/s, hfu: 61.249 Tflops/s, 297.096 iter/s, 3.366e-03 s/iter, (0.044, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.367 Tflops/s, hfu: 102.367 Tflops/s, 496.544 iter/s, 2.014e-03 s/iter, (0.025, 0.000, 0.040) sec
# stripe_flash_attn_func, fwd
mfu: 51.841 Tflops/s, hfu: 51.841 Tflops/s, 251.462 iter/s, 3.977e-03 s/iter, (0.044, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 131.182 Tflops/s, hfu: 131.182 Tflops/s, 318.159 iter/s, 3.143e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 123.656 Tflops/s, hfu: 123.656 Tflops/s, 299.905 iter/s, 3.334e-03 s/iter, (0.088, 0.000, 0.013) sec
mfu: 123.881 Tflops/s, hfu: 123.881 Tflops/s, 300.450 iter/s, 3.328e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 132.772 Tflops/s, hfu: 132.772 Tflops/s, 322.015 iter/s, 3.105e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 128.996 Tflops/s, hfu: 128.996 Tflops/s, 312.856 iter/s, 3.196e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 139.603 Tflops/s, hfu: 139.603 Tflops/s, 338.581 iter/s, 2.954e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 128.112 Tflops/s, hfu: 128.112 Tflops/s, 310.712 iter/s, 3.218e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 107.266 Tflops/s, hfu: 107.266 Tflops/s, 260.154 iter/s, 3.844e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(16384,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.82 Tflops/s, hfu: 62.82 Tflops/s, 261.184 iter/s, 3.829e-03 s/iter, (0.049, 0.000, 0.077) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.951 Tflops/s, hfu: 100.951 Tflops/s, 419.724 iter/s, 2.383e-03 s/iter, (0.028, 0.000, 0.048) sec
# stripe_flash_attn_func, fwd
mfu: 54.219 Tflops/s, hfu: 54.219 Tflops/s, 225.425 iter/s, 4.436e-03 s/iter, (0.055, 0.000, 0.089) sec
# orchestrated_attn_func
mfu: 133.69 Tflops/s, hfu: 133.69 Tflops/s, 277.921 iter/s, 3.598e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 149.711 Tflops/s, hfu: 149.711 Tflops/s, 311.226 iter/s, 3.213e-03 s/iter, (0.085, 0.000, 0.013) sec
mfu: 129.131 Tflops/s, hfu: 129.131 Tflops/s, 268.443 iter/s, 3.725e-03 s/iter, (0.094, 0.000, 0.015) sec
mfu: 136.964 Tflops/s, hfu: 136.964 Tflops/s, 284.727 iter/s, 3.512e-03 s/iter, (0.084, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 130.162 Tflops/s, hfu: 130.162 Tflops/s, 270.586 iter/s, 3.696e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 140.729 Tflops/s, hfu: 140.729 Tflops/s, 292.554 iter/s, 3.418e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 128.432 Tflops/s, hfu: 128.432 Tflops/s, 266.990 iter/s, 3.745e-03 s/iter, (0.090, 0.000, 0.015) sec
mfu: 106.88 Tflops/s, hfu: 106.88 Tflops/s, 222.187 iter/s, 4.501e-03 s/iter, (0.089, 0.000, 0.018) sec
SP=(1,8),S=(16384,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.663 Tflops/s, hfu: 64.663 Tflops/s, 235.243 iter/s, 4.251e-03 s/iter, (0.054, 0.000, 0.085) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.434 Tflops/s, hfu: 102.434 Tflops/s, 372.651 iter/s, 2.683e-03 s/iter, (0.032, 0.000, 0.054) sec
# stripe_flash_attn_func, fwd
mfu: 55.693 Tflops/s, hfu: 55.693 Tflops/s, 202.611 iter/s, 4.936e-03 s/iter, (0.054, 0.000, 0.099) sec
# orchestrated_attn_func
mfu: 139.275 Tflops/s, hfu: 139.275 Tflops/s, 253.340 iter/s, 3.947e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 133.049 Tflops/s, hfu: 133.049 Tflops/s, 242.015 iter/s, 4.132e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 148.45 Tflops/s, hfu: 148.45 Tflops/s, 270.029 iter/s, 3.703e-03 s/iter, (0.089, 0.000, 0.015) sec
mfu: 137.441 Tflops/s, hfu: 137.441 Tflops/s, 250.003 iter/s, 4.000e-03 s/iter, (0.086, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 130.531 Tflops/s, hfu: 130.531 Tflops/s, 237.435 iter/s, 4.212e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 141.88 Tflops/s, hfu: 141.88 Tflops/s, 258.078 iter/s, 3.875e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 129.231 Tflops/s, hfu: 129.231 Tflops/s, 235.069 iter/s, 4.254e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 107.455 Tflops/s, hfu: 107.455 Tflops/s, 195.460 iter/s, 5.116e-03 s/iter, (0.091, 0.000, 0.020) sec
SP=(1,8),S=(20480,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.501 Tflops/s, hfu: 0.501 Tflops/s, 372.991 iter/s, 2.681e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 0.903 Tflops/s, hfu: 0.903 Tflops/s, 673.076 iter/s, 1.486e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.43 Tflops/s, hfu: 0.43 Tflops/s, 320.128 iter/s, 3.124e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 7.996 Tflops/s, hfu: 7.996 Tflops/s, 2978.744 iter/s, 3.357e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 11.202 Tflops/s, hfu: 11.202 Tflops/s, 4173.066 iter/s, 2.396e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 12.239 Tflops/s, hfu: 12.239 Tflops/s, 4559.382 iter/s, 2.193e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 13.573 Tflops/s, hfu: 13.573 Tflops/s, 5056.225 iter/s, 1.978e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 17.387 Tflops/s, hfu: 17.387 Tflops/s, 6477.019 iter/s, 1.544e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 12.481 Tflops/s, hfu: 12.481 Tflops/s, 4649.433 iter/s, 2.151e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 15.791 Tflops/s, hfu: 15.791 Tflops/s, 5882.630 iter/s, 1.700e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.146 Tflops/s, hfu: 25.146 Tflops/s, 9367.506 iter/s, 1.068e-04 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(20480,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.999 Tflops/s, hfu: 0.999 Tflops/s, 372.058 iter/s, 2.688e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.808 Tflops/s, hfu: 1.808 Tflops/s, 673.465 iter/s, 1.485e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.862 Tflops/s, hfu: 0.862 Tflops/s, 320.965 iter/s, 3.116e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 14.797 Tflops/s, hfu: 14.797 Tflops/s, 2756.218 iter/s, 3.628e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 18.908 Tflops/s, hfu: 18.908 Tflops/s, 3521.921 iter/s, 2.839e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.145 Tflops/s, hfu: 21.145 Tflops/s, 3938.621 iter/s, 2.539e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 22.896 Tflops/s, hfu: 22.896 Tflops/s, 4264.756 iter/s, 2.345e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 30.366 Tflops/s, hfu: 30.366 Tflops/s, 5656.109 iter/s, 1.768e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 24.048 Tflops/s, hfu: 24.048 Tflops/s, 4479.323 iter/s, 2.232e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 28.613 Tflops/s, hfu: 28.613 Tflops/s, 5329.582 iter/s, 1.876e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 47.203 Tflops/s, hfu: 47.203 Tflops/s, 8792.291 iter/s, 1.137e-04 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(20480,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.497 Tflops/s, hfu: 1.497 Tflops/s, 371.750 iter/s, 2.690e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.672 Tflops/s, hfu: 2.672 Tflops/s, 663.692 iter/s, 1.507e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.294 Tflops/s, hfu: 1.294 Tflops/s, 321.412 iter/s, 3.111e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 21.95 Tflops/s, hfu: 21.95 Tflops/s, 2725.628 iter/s, 3.669e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.654 Tflops/s, hfu: 26.654 Tflops/s, 3309.768 iter/s, 3.021e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 28.579 Tflops/s, hfu: 28.579 Tflops/s, 3548.818 iter/s, 2.818e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.867 Tflops/s, hfu: 31.867 Tflops/s, 3957.073 iter/s, 2.527e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 42.564 Tflops/s, hfu: 42.564 Tflops/s, 5285.412 iter/s, 1.892e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.116 Tflops/s, hfu: 33.116 Tflops/s, 4112.248 iter/s, 2.432e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 41.731 Tflops/s, hfu: 41.731 Tflops/s, 5181.991 iter/s, 1.930e-04 s/iter, (0.069, 0.000, 0.001) sec
mfu: 56.486 Tflops/s, hfu: 56.486 Tflops/s, 7014.196 iter/s, 1.426e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(20480,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.979 Tflops/s, hfu: 1.979 Tflops/s, 368.540 iter/s, 2.713e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.578 Tflops/s, hfu: 3.578 Tflops/s, 666.381 iter/s, 1.501e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.711 Tflops/s, hfu: 1.711 Tflops/s, 318.758 iter/s, 3.137e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 28.878 Tflops/s, hfu: 28.878 Tflops/s, 2689.502 iter/s, 3.718e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 33.858 Tflops/s, hfu: 33.858 Tflops/s, 3153.301 iter/s, 3.171e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.21 Tflops/s, hfu: 38.21 Tflops/s, 3558.617 iter/s, 2.810e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.011 Tflops/s, hfu: 39.011 Tflops/s, 3633.193 iter/s, 2.752e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 51.48 Tflops/s, hfu: 51.48 Tflops/s, 4794.416 iter/s, 2.086e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 41.879 Tflops/s, hfu: 41.879 Tflops/s, 3900.278 iter/s, 2.564e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.103 Tflops/s, hfu: 43.103 Tflops/s, 4014.259 iter/s, 2.491e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 67.072 Tflops/s, hfu: 67.072 Tflops/s, 6246.564 iter/s, 1.601e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(20480,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.474 Tflops/s, hfu: 2.474 Tflops/s, 368.636 iter/s, 2.713e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.464 Tflops/s, hfu: 4.464 Tflops/s, 665.182 iter/s, 1.503e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.146 Tflops/s, hfu: 2.146 Tflops/s, 319.780 iter/s, 3.127e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 33.473 Tflops/s, hfu: 33.473 Tflops/s, 2493.915 iter/s, 4.010e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 37.387 Tflops/s, hfu: 37.387 Tflops/s, 2785.515 iter/s, 3.590e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.076 Tflops/s, hfu: 39.076 Tflops/s, 2911.378 iter/s, 3.435e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.57 Tflops/s, hfu: 45.57 Tflops/s, 3395.263 iter/s, 2.945e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 60.988 Tflops/s, hfu: 60.988 Tflops/s, 4543.967 iter/s, 2.201e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 45.312 Tflops/s, hfu: 45.312 Tflops/s, 3376.006 iter/s, 2.962e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 49.868 Tflops/s, hfu: 49.868 Tflops/s, 3715.483 iter/s, 2.691e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 74.622 Tflops/s, hfu: 74.622 Tflops/s, 5559.756 iter/s, 1.799e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(20480,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.983 Tflops/s, hfu: 2.983 Tflops/s, 370.409 iter/s, 2.700e-03 s/iter, (0.036, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.332 Tflops/s, hfu: 5.332 Tflops/s, 662.090 iter/s, 1.510e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.559 Tflops/s, hfu: 2.559 Tflops/s, 317.741 iter/s, 3.147e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 41.29 Tflops/s, hfu: 41.29 Tflops/s, 2563.629 iter/s, 3.901e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 46.146 Tflops/s, hfu: 46.146 Tflops/s, 2865.133 iter/s, 3.490e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.159 Tflops/s, hfu: 50.159 Tflops/s, 3114.256 iter/s, 3.211e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 52.076 Tflops/s, hfu: 52.076 Tflops/s, 3233.316 iter/s, 3.093e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 69.007 Tflops/s, hfu: 69.007 Tflops/s, 4284.490 iter/s, 2.334e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 52.373 Tflops/s, hfu: 52.373 Tflops/s, 3251.737 iter/s, 3.075e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 56.23 Tflops/s, hfu: 56.23 Tflops/s, 3491.230 iter/s, 2.864e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 76.199 Tflops/s, hfu: 76.199 Tflops/s, 4731.085 iter/s, 2.114e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(20480,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.436 Tflops/s, hfu: 3.436 Tflops/s, 365.716 iter/s, 2.734e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.389 Tflops/s, hfu: 5.389 Tflops/s, 573.604 iter/s, 1.743e-03 s/iter, (0.023, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 2.979 Tflops/s, hfu: 2.979 Tflops/s, 317.073 iter/s, 3.154e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 42.946 Tflops/s, hfu: 42.946 Tflops/s, 2285.526 iter/s, 4.375e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 49.762 Tflops/s, hfu: 49.762 Tflops/s, 2648.249 iter/s, 3.776e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 50.805 Tflops/s, hfu: 50.805 Tflops/s, 2703.755 iter/s, 3.699e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 56.024 Tflops/s, hfu: 56.024 Tflops/s, 2981.515 iter/s, 3.354e-04 s/iter, (0.075, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 74.831 Tflops/s, hfu: 74.831 Tflops/s, 3982.414 iter/s, 2.511e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 58.66 Tflops/s, hfu: 58.66 Tflops/s, 3121.800 iter/s, 3.203e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 62.555 Tflops/s, hfu: 62.555 Tflops/s, 3329.072 iter/s, 3.004e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 82.533 Tflops/s, hfu: 82.533 Tflops/s, 4392.284 iter/s, 2.277e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(20480,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.916 Tflops/s, hfu: 3.916 Tflops/s, 364.678 iter/s, 2.742e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.945 Tflops/s, hfu: 6.945 Tflops/s, 646.840 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.341 Tflops/s, hfu: 3.341 Tflops/s, 311.132 iter/s, 3.214e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 38.357 Tflops/s, hfu: 38.357 Tflops/s, 1786.148 iter/s, 5.599e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 43.052 Tflops/s, hfu: 43.052 Tflops/s, 2004.747 iter/s, 4.988e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 43.55 Tflops/s, hfu: 43.55 Tflops/s, 2027.937 iter/s, 4.931e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 45.99 Tflops/s, hfu: 45.99 Tflops/s, 2141.584 iter/s, 4.669e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 80.517 Tflops/s, hfu: 80.517 Tflops/s, 3749.362 iter/s, 2.667e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 62.983 Tflops/s, hfu: 62.983 Tflops/s, 2932.895 iter/s, 3.410e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 67.502 Tflops/s, hfu: 67.502 Tflops/s, 3143.310 iter/s, 3.181e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 85.93 Tflops/s, hfu: 85.93 Tflops/s, 4001.408 iter/s, 2.499e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(20480,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.9 Tflops/s, hfu: 4.9 Tflops/s, 365.078 iter/s, 2.739e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.77 Tflops/s, hfu: 8.77 Tflops/s, 653.446 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.168 Tflops/s, hfu: 4.168 Tflops/s, 310.545 iter/s, 3.220e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 56.181 Tflops/s, hfu: 56.181 Tflops/s, 2092.891 iter/s, 4.778e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 58.203 Tflops/s, hfu: 58.203 Tflops/s, 2168.219 iter/s, 4.612e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 58.961 Tflops/s, hfu: 58.961 Tflops/s, 2196.450 iter/s, 4.553e-04 s/iter, (0.142, 0.000, 0.002) sec
mfu: 68.473 Tflops/s, hfu: 68.473 Tflops/s, 2550.812 iter/s, 3.920e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 89.879 Tflops/s, hfu: 89.879 Tflops/s, 3348.244 iter/s, 2.987e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 71.626 Tflops/s, hfu: 71.626 Tflops/s, 2668.260 iter/s, 3.748e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 74.766 Tflops/s, hfu: 74.766 Tflops/s, 2785.267 iter/s, 3.590e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 90.921 Tflops/s, hfu: 90.921 Tflops/s, 3387.075 iter/s, 2.952e-04 s/iter, (0.075, 0.000, 0.001) sec
SP=(1,8),S=(20480,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.785 Tflops/s, hfu: 5.785 Tflops/s, 359.195 iter/s, 2.784e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.594 Tflops/s, hfu: 10.594 Tflops/s, 657.765 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.025 Tflops/s, hfu: 5.025 Tflops/s, 312.023 iter/s, 3.205e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 65.537 Tflops/s, hfu: 65.537 Tflops/s, 2034.538 iter/s, 4.915e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 67.02 Tflops/s, hfu: 67.02 Tflops/s, 2080.559 iter/s, 4.806e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 66.573 Tflops/s, hfu: 66.573 Tflops/s, 2066.696 iter/s, 4.839e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 76.798 Tflops/s, hfu: 76.798 Tflops/s, 2384.131 iter/s, 4.194e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 97.957 Tflops/s, hfu: 97.957 Tflops/s, 3040.993 iter/s, 3.288e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.625 Tflops/s, hfu: 79.625 Tflops/s, 2471.870 iter/s, 4.046e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 83.305 Tflops/s, hfu: 83.305 Tflops/s, 2586.118 iter/s, 3.867e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 92.286 Tflops/s, hfu: 92.286 Tflops/s, 2864.935 iter/s, 3.490e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(20480,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.776 Tflops/s, hfu: 6.776 Tflops/s, 360.624 iter/s, 2.773e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.276 Tflops/s, hfu: 12.276 Tflops/s, 653.308 iter/s, 1.531e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.839 Tflops/s, hfu: 5.839 Tflops/s, 310.726 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 74.589 Tflops/s, hfu: 74.589 Tflops/s, 1984.757 iter/s, 5.038e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.454 Tflops/s, hfu: 72.454 Tflops/s, 1927.941 iter/s, 5.187e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 74.124 Tflops/s, hfu: 74.124 Tflops/s, 1972.387 iter/s, 5.070e-04 s/iter, (0.098, 0.000, 0.002) sec
mfu: 82.341 Tflops/s, hfu: 82.341 Tflops/s, 2191.022 iter/s, 4.564e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 102.685 Tflops/s, hfu: 102.685 Tflops/s, 2732.360 iter/s, 3.660e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 86.752 Tflops/s, hfu: 86.752 Tflops/s, 2308.403 iter/s, 4.332e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 89.168 Tflops/s, hfu: 89.168 Tflops/s, 2372.682 iter/s, 4.215e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 95.492 Tflops/s, hfu: 95.492 Tflops/s, 2540.960 iter/s, 3.936e-04 s/iter, (0.075, 0.000, 0.002) sec
SP=(1,8),S=(20480,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.066 Tflops/s, hfu: 7.066 Tflops/s, 329.035 iter/s, 3.039e-03 s/iter, (0.034, 0.000, 0.061) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.799 Tflops/s, hfu: 13.799 Tflops/s, 642.579 iter/s, 1.556e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.606 Tflops/s, hfu: 6.606 Tflops/s, 307.622 iter/s, 3.251e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 79.666 Tflops/s, hfu: 79.666 Tflops/s, 1854.875 iter/s, 5.391e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 78.419 Tflops/s, hfu: 78.419 Tflops/s, 1825.830 iter/s, 5.477e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 76.688 Tflops/s, hfu: 76.688 Tflops/s, 1785.536 iter/s, 5.601e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 86.614 Tflops/s, hfu: 86.614 Tflops/s, 2016.649 iter/s, 4.959e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 107.452 Tflops/s, hfu: 107.452 Tflops/s, 2501.801 iter/s, 3.997e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 91.898 Tflops/s, hfu: 91.898 Tflops/s, 2139.678 iter/s, 4.674e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 92.387 Tflops/s, hfu: 92.387 Tflops/s, 2151.056 iter/s, 4.649e-04 s/iter, (0.070, 0.000, 0.002) sec
mfu: 92.336 Tflops/s, hfu: 92.336 Tflops/s, 2149.872 iter/s, 4.651e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(20480,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.729 Tflops/s, hfu: 9.729 Tflops/s, 362.429 iter/s, 2.759e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.412 Tflops/s, hfu: 17.412 Tflops/s, 648.656 iter/s, 1.542e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.371 Tflops/s, hfu: 8.371 Tflops/s, 311.828 iter/s, 3.207e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 81.295 Tflops/s, hfu: 81.295 Tflops/s, 1514.234 iter/s, 6.604e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 75.97 Tflops/s, hfu: 75.97 Tflops/s, 1415.052 iter/s, 7.067e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 75.39 Tflops/s, hfu: 75.39 Tflops/s, 1404.242 iter/s, 7.121e-04 s/iter, (0.091, 0.000, 0.003) sec
mfu: 96.12 Tflops/s, hfu: 96.12 Tflops/s, 1790.369 iter/s, 5.585e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 115.709 Tflops/s, hfu: 115.709 Tflops/s, 2155.247 iter/s, 4.640e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 99.581 Tflops/s, hfu: 99.581 Tflops/s, 1854.847 iter/s, 5.391e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 98.309 Tflops/s, hfu: 98.309 Tflops/s, 1831.153 iter/s, 5.461e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 95.564 Tflops/s, hfu: 95.564 Tflops/s, 1780.018 iter/s, 5.618e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(20480,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.719 Tflops/s, hfu: 11.719 Tflops/s, 363.819 iter/s, 2.749e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.879 Tflops/s, hfu: 20.879 Tflops/s, 648.159 iter/s, 1.543e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.993 Tflops/s, hfu: 9.993 Tflops/s, 310.228 iter/s, 3.223e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 92.552 Tflops/s, hfu: 92.552 Tflops/s, 1436.600 iter/s, 6.961e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 87.08 Tflops/s, hfu: 87.08 Tflops/s, 1351.658 iter/s, 7.398e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 84.099 Tflops/s, hfu: 84.099 Tflops/s, 1305.388 iter/s, 7.661e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 98.459 Tflops/s, hfu: 98.459 Tflops/s, 1528.286 iter/s, 6.543e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 124.161 Tflops/s, hfu: 124.161 Tflops/s, 1927.228 iter/s, 5.189e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 109.867 Tflops/s, hfu: 109.867 Tflops/s, 1705.367 iter/s, 5.864e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 105.758 Tflops/s, hfu: 105.758 Tflops/s, 1641.583 iter/s, 6.092e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.46 Tflops/s, hfu: 100.46 Tflops/s, 1559.342 iter/s, 6.413e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(20480,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.562 Tflops/s, hfu: 13.562 Tflops/s, 360.862 iter/s, 2.771e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.442 Tflops/s, hfu: 24.442 Tflops/s, 650.375 iter/s, 1.538e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 11.289 Tflops/s, hfu: 11.289 Tflops/s, 300.401 iter/s, 3.329e-03 s/iter, (0.038, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 96.243 Tflops/s, hfu: 96.243 Tflops/s, 1280.475 iter/s, 7.810e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 93.322 Tflops/s, hfu: 93.322 Tflops/s, 1241.619 iter/s, 8.054e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.984 Tflops/s, hfu: 93.984 Tflops/s, 1250.425 iter/s, 7.997e-04 s/iter, (0.092, 0.000, 0.003) sec
mfu: 109.47 Tflops/s, hfu: 109.47 Tflops/s, 1456.452 iter/s, 6.866e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 126.655 Tflops/s, hfu: 126.655 Tflops/s, 1685.090 iter/s, 5.934e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.005 Tflops/s, hfu: 114.005 Tflops/s, 1516.788 iter/s, 6.593e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.23 Tflops/s, hfu: 108.23 Tflops/s, 1439.959 iter/s, 6.945e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 101.998 Tflops/s, hfu: 101.998 Tflops/s, 1357.044 iter/s, 7.369e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(20480,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.353 Tflops/s, hfu: 15.353 Tflops/s, 357.472 iter/s, 2.797e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.877 Tflops/s, hfu: 27.877 Tflops/s, 649.062 iter/s, 1.541e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.292 Tflops/s, hfu: 13.292 Tflops/s, 309.487 iter/s, 3.231e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 96.905 Tflops/s, hfu: 96.905 Tflops/s, 1128.128 iter/s, 8.864e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 91.459 Tflops/s, hfu: 91.459 Tflops/s, 1064.718 iter/s, 9.392e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 86.614 Tflops/s, hfu: 86.614 Tflops/s, 1008.317 iter/s, 9.918e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 108.138 Tflops/s, hfu: 108.138 Tflops/s, 1258.888 iter/s, 7.944e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 131.586 Tflops/s, hfu: 131.586 Tflops/s, 1531.863 iter/s, 6.528e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 118.09 Tflops/s, hfu: 118.09 Tflops/s, 1374.744 iter/s, 7.274e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 112.02 Tflops/s, hfu: 112.02 Tflops/s, 1304.080 iter/s, 7.668e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.518 Tflops/s, hfu: 104.518 Tflops/s, 1216.746 iter/s, 8.219e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(20480,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.461 Tflops/s, hfu: 19.461 Tflops/s, 362.481 iter/s, 2.759e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.853 Tflops/s, hfu: 34.853 Tflops/s, 649.193 iter/s, 1.540e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.702 Tflops/s, hfu: 16.702 Tflops/s, 311.103 iter/s, 3.214e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 93.475 Tflops/s, hfu: 93.475 Tflops/s, 870.552 iter/s, 1.149e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 95.27 Tflops/s, hfu: 95.27 Tflops/s, 887.267 iter/s, 1.127e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 89.744 Tflops/s, hfu: 89.744 Tflops/s, 835.807 iter/s, 1.196e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 119.311 Tflops/s, hfu: 119.311 Tflops/s, 1111.170 iter/s, 9.000e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 138.443 Tflops/s, hfu: 138.443 Tflops/s, 1289.351 iter/s, 7.756e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 125.333 Tflops/s, hfu: 125.333 Tflops/s, 1167.253 iter/s, 8.567e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 117.105 Tflops/s, hfu: 117.105 Tflops/s, 1090.627 iter/s, 9.169e-04 s/iter, (0.073, 0.001, 0.004) sec
mfu: 108.785 Tflops/s, hfu: 108.785 Tflops/s, 1013.138 iter/s, 9.870e-04 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(20480,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.131 Tflops/s, hfu: 23.131 Tflops/s, 359.048 iter/s, 2.785e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.121 Tflops/s, hfu: 42.121 Tflops/s, 653.797 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 20.172 Tflops/s, hfu: 20.172 Tflops/s, 313.107 iter/s, 3.194e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 101.345 Tflops/s, hfu: 101.345 Tflops/s, 786.544 iter/s, 1.271e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 101.205 Tflops/s, hfu: 101.205 Tflops/s, 785.452 iter/s, 1.273e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 101.235 Tflops/s, hfu: 101.235 Tflops/s, 785.684 iter/s, 1.273e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 122.698 Tflops/s, hfu: 122.698 Tflops/s, 952.265 iter/s, 1.050e-03 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 143.527 Tflops/s, hfu: 143.527 Tflops/s, 1113.913 iter/s, 8.977e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 131.038 Tflops/s, hfu: 131.038 Tflops/s, 1016.988 iter/s, 9.833e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.084 Tflops/s, hfu: 121.084 Tflops/s, 939.737 iter/s, 1.064e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.965 Tflops/s, hfu: 110.965 Tflops/s, 861.202 iter/s, 1.161e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(20480,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 26.991 Tflops/s, hfu: 26.991 Tflops/s, 359.111 iter/s, 2.785e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.254 Tflops/s, hfu: 49.254 Tflops/s, 655.299 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 23.691 Tflops/s, hfu: 23.691 Tflops/s, 315.200 iter/s, 3.173e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 103.852 Tflops/s, hfu: 103.852 Tflops/s, 690.856 iter/s, 1.447e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 99.021 Tflops/s, hfu: 99.021 Tflops/s, 658.720 iter/s, 1.518e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 101.321 Tflops/s, hfu: 101.321 Tflops/s, 674.018 iter/s, 1.484e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 125.08 Tflops/s, hfu: 125.08 Tflops/s, 832.069 iter/s, 1.202e-03 s/iter, (0.078, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 144.977 Tflops/s, hfu: 144.977 Tflops/s, 964.432 iter/s, 1.037e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 135.654 Tflops/s, hfu: 135.654 Tflops/s, 902.410 iter/s, 1.108e-03 s/iter, (0.078, 0.000, 0.004) sec
mfu: 123.244 Tflops/s, hfu: 123.244 Tflops/s, 819.855 iter/s, 1.220e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 110.85 Tflops/s, hfu: 110.85 Tflops/s, 737.411 iter/s, 1.356e-03 s/iter, (0.079, 0.000, 0.005) sec
SP=(1,8),S=(20480,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.777 Tflops/s, hfu: 30.777 Tflops/s, 358.288 iter/s, 2.791e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.411 Tflops/s, hfu: 55.411 Tflops/s, 645.074 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.494 Tflops/s, hfu: 26.494 Tflops/s, 308.425 iter/s, 3.242e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 106.672 Tflops/s, hfu: 106.672 Tflops/s, 620.914 iter/s, 1.611e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 97.698 Tflops/s, hfu: 97.698 Tflops/s, 568.676 iter/s, 1.758e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 99.359 Tflops/s, hfu: 99.359 Tflops/s, 578.345 iter/s, 1.729e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 132.225 Tflops/s, hfu: 132.225 Tflops/s, 769.652 iter/s, 1.299e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 148.591 Tflops/s, hfu: 148.591 Tflops/s, 864.914 iter/s, 1.156e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 139.465 Tflops/s, hfu: 139.465 Tflops/s, 811.794 iter/s, 1.232e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 126.147 Tflops/s, hfu: 126.147 Tflops/s, 734.270 iter/s, 1.362e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 112.951 Tflops/s, hfu: 112.951 Tflops/s, 657.462 iter/s, 1.521e-03 s/iter, (0.077, 0.000, 0.006) sec
SP=(1,8),S=(20480,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.216 Tflops/s, hfu: 38.216 Tflops/s, 355.911 iter/s, 2.810e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.26 Tflops/s, hfu: 69.26 Tflops/s, 645.034 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 33.155 Tflops/s, hfu: 33.155 Tflops/s, 308.779 iter/s, 3.239e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 105.792 Tflops/s, hfu: 105.792 Tflops/s, 492.632 iter/s, 2.030e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 101.971 Tflops/s, hfu: 101.971 Tflops/s, 474.841 iter/s, 2.106e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 98.013 Tflops/s, hfu: 98.013 Tflops/s, 456.408 iter/s, 2.191e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 131.931 Tflops/s, hfu: 131.931 Tflops/s, 614.350 iter/s, 1.628e-03 s/iter, (0.079, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 151.571 Tflops/s, hfu: 151.571 Tflops/s, 705.808 iter/s, 1.417e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 143.15 Tflops/s, hfu: 143.15 Tflops/s, 666.596 iter/s, 1.500e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 129.127 Tflops/s, hfu: 129.127 Tflops/s, 601.294 iter/s, 1.663e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 114.252 Tflops/s, hfu: 114.252 Tflops/s, 532.028 iter/s, 1.880e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(20480,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.923 Tflops/s, hfu: 45.923 Tflops/s, 356.412 iter/s, 2.806e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 83.116 Tflops/s, hfu: 83.116 Tflops/s, 645.064 iter/s, 1.550e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 39.716 Tflops/s, hfu: 39.716 Tflops/s, 308.237 iter/s, 3.244e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 109.428 Tflops/s, hfu: 109.428 Tflops/s, 424.637 iter/s, 2.355e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 100.717 Tflops/s, hfu: 100.717 Tflops/s, 390.834 iter/s, 2.559e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 103.268 Tflops/s, hfu: 103.268 Tflops/s, 400.731 iter/s, 2.495e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 139.968 Tflops/s, hfu: 139.968 Tflops/s, 543.148 iter/s, 1.841e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 154.366 Tflops/s, hfu: 154.366 Tflops/s, 599.018 iter/s, 1.669e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 147.26 Tflops/s, hfu: 147.26 Tflops/s, 571.444 iter/s, 1.750e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.721 Tflops/s, hfu: 131.721 Tflops/s, 511.145 iter/s, 1.956e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 116.692 Tflops/s, hfu: 116.692 Tflops/s, 452.825 iter/s, 2.208e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(20480,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.998 Tflops/s, hfu: 52.998 Tflops/s, 352.559 iter/s, 2.836e-03 s/iter, (0.035, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 96.68 Tflops/s, hfu: 96.68 Tflops/s, 643.145 iter/s, 1.555e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 45.352 Tflops/s, hfu: 45.352 Tflops/s, 301.694 iter/s, 3.315e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 108.642 Tflops/s, hfu: 108.642 Tflops/s, 361.358 iter/s, 2.767e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 101.524 Tflops/s, hfu: 101.524 Tflops/s, 337.685 iter/s, 2.961e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 102.122 Tflops/s, hfu: 102.122 Tflops/s, 339.675 iter/s, 2.944e-03 s/iter, (0.084, 0.000, 0.012) sec
mfu: 140.313 Tflops/s, hfu: 140.313 Tflops/s, 466.702 iter/s, 2.143e-03 s/iter, (0.078, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 156.602 Tflops/s, hfu: 156.602 Tflops/s, 520.883 iter/s, 1.920e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 149.833 Tflops/s, hfu: 149.833 Tflops/s, 498.367 iter/s, 2.007e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 133.381 Tflops/s, hfu: 133.381 Tflops/s, 443.645 iter/s, 2.254e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 116.772 Tflops/s, hfu: 116.772 Tflops/s, 388.403 iter/s, 2.575e-03 s/iter, (0.081, 0.000, 0.010) sec
SP=(1,8),S=(20480,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.629 Tflops/s, hfu: 61.629 Tflops/s, 358.730 iter/s, 2.788e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.845 Tflops/s, hfu: 102.845 Tflops/s, 598.635 iter/s, 1.670e-03 s/iter, (0.021, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 49.535 Tflops/s, hfu: 49.535 Tflops/s, 288.329 iter/s, 3.468e-03 s/iter, (0.039, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 110.064 Tflops/s, hfu: 110.064 Tflops/s, 320.330 iter/s, 3.122e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 103.349 Tflops/s, hfu: 103.349 Tflops/s, 300.784 iter/s, 3.325e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 103.629 Tflops/s, hfu: 103.629 Tflops/s, 301.601 iter/s, 3.316e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 141.95 Tflops/s, hfu: 141.95 Tflops/s, 413.129 iter/s, 2.421e-03 s/iter, (0.083, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 157.858 Tflops/s, hfu: 157.858 Tflops/s, 459.427 iter/s, 2.177e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 151.663 Tflops/s, hfu: 151.663 Tflops/s, 441.398 iter/s, 2.266e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 134.436 Tflops/s, hfu: 134.436 Tflops/s, 391.260 iter/s, 2.556e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 116.313 Tflops/s, hfu: 116.313 Tflops/s, 338.516 iter/s, 2.954e-03 s/iter, (0.083, 0.000, 0.012) sec
SP=(1,8),S=(20480,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.112 Tflops/s, hfu: 64.112 Tflops/s, 298.546 iter/s, 3.350e-03 s/iter, (0.042, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.264 Tflops/s, hfu: 108.264 Tflops/s, 504.141 iter/s, 1.984e-03 s/iter, (0.025, 0.000, 0.040) sec
# stripe_flash_attn_func, fwd
mfu: 54.062 Tflops/s, hfu: 54.062 Tflops/s, 251.744 iter/s, 3.972e-03 s/iter, (0.044, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 105.91 Tflops/s, hfu: 105.91 Tflops/s, 246.591 iter/s, 4.055e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 103.987 Tflops/s, hfu: 103.987 Tflops/s, 242.113 iter/s, 4.130e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 101.892 Tflops/s, hfu: 101.892 Tflops/s, 237.236 iter/s, 4.215e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 143.254 Tflops/s, hfu: 143.254 Tflops/s, 333.539 iter/s, 2.998e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 159.564 Tflops/s, hfu: 159.564 Tflops/s, 371.514 iter/s, 2.692e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 153.953 Tflops/s, hfu: 153.953 Tflops/s, 358.451 iter/s, 2.790e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 136.123 Tflops/s, hfu: 136.123 Tflops/s, 316.936 iter/s, 3.155e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 117.722 Tflops/s, hfu: 117.722 Tflops/s, 274.092 iter/s, 3.648e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(20480,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.349 Tflops/s, hfu: 66.349 Tflops/s, 257.466 iter/s, 3.884e-03 s/iter, (0.047, 0.000, 0.078) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.31 Tflops/s, hfu: 109.31 Tflops/s, 424.177 iter/s, 2.358e-03 s/iter, (0.028, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 58.567 Tflops/s, hfu: 58.567 Tflops/s, 227.270 iter/s, 4.400e-03 s/iter, (0.051, 0.000, 0.088) sec
# orchestrated_attn_func
mfu: 111.009 Tflops/s, hfu: 111.009 Tflops/s, 215.385 iter/s, 4.643e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 104.749 Tflops/s, hfu: 104.749 Tflops/s, 203.240 iter/s, 4.920e-03 s/iter, (0.092, 0.000, 0.020) sec
mfu: 104.147 Tflops/s, hfu: 104.147 Tflops/s, 202.071 iter/s, 4.949e-03 s/iter, (0.089, 0.000, 0.020) sec
mfu: 144.799 Tflops/s, hfu: 144.799 Tflops/s, 280.946 iter/s, 3.559e-03 s/iter, (0.083, 0.001, 0.014) sec
# orchestrated_attn_func fused
mfu: 161.131 Tflops/s, hfu: 161.131 Tflops/s, 312.636 iter/s, 3.199e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 156.766 Tflops/s, hfu: 156.766 Tflops/s, 304.166 iter/s, 3.288e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 137.614 Tflops/s, hfu: 137.614 Tflops/s, 267.007 iter/s, 3.745e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 118.457 Tflops/s, hfu: 118.457 Tflops/s, 229.837 iter/s, 4.351e-03 s/iter, (0.089, 0.000, 0.017) sec
SP=(1,8),S=(20480,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.758 Tflops/s, hfu: 67.758 Tflops/s, 225.372 iter/s, 4.437e-03 s/iter, (0.054, 0.000, 0.089) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 107.772 Tflops/s, hfu: 107.772 Tflops/s, 358.466 iter/s, 2.790e-03 s/iter, (0.032, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 61.342 Tflops/s, hfu: 61.342 Tflops/s, 204.034 iter/s, 4.901e-03 s/iter, (0.055, 0.000, 0.098) sec
# orchestrated_attn_func
mfu: 109.919 Tflops/s, hfu: 109.919 Tflops/s, 182.804 iter/s, 5.470e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 104.864 Tflops/s, hfu: 104.864 Tflops/s, 174.397 iter/s, 5.734e-03 s/iter, (0.095, 0.000, 0.023) sec
mfu: 105.504 Tflops/s, hfu: 105.504 Tflops/s, 175.461 iter/s, 5.699e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 141.508 Tflops/s, hfu: 141.508 Tflops/s, 235.338 iter/s, 4.249e-03 s/iter, (0.086, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 161.967 Tflops/s, hfu: 161.967 Tflops/s, 269.363 iter/s, 3.712e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 158.188 Tflops/s, hfu: 158.188 Tflops/s, 263.078 iter/s, 3.801e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 138.04 Tflops/s, hfu: 138.04 Tflops/s, 229.571 iter/s, 4.356e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 118.079 Tflops/s, hfu: 118.079 Tflops/s, 196.375 iter/s, 5.092e-03 s/iter, (0.095, 0.000, 0.020) sec
SP=(1,8),S=(20480,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.398 Tflops/s, hfu: 69.398 Tflops/s, 201.975 iter/s, 4.951e-03 s/iter, (0.060, 0.000, 0.099) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.055 Tflops/s, hfu: 111.055 Tflops/s, 323.213 iter/s, 3.094e-03 s/iter, (0.035, 0.000, 0.062) sec
# stripe_flash_attn_func, fwd
mfu: 64.059 Tflops/s, hfu: 64.059 Tflops/s, 186.437 iter/s, 5.364e-03 s/iter, (0.061, 0.000, 0.107) sec
# orchestrated_attn_func
mfu: 105.758 Tflops/s, hfu: 105.758 Tflops/s, 153.898 iter/s, 6.498e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 104.605 Tflops/s, hfu: 104.605 Tflops/s, 152.220 iter/s, 6.569e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 105.655 Tflops/s, hfu: 105.655 Tflops/s, 153.748 iter/s, 6.504e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 146.134 Tflops/s, hfu: 146.134 Tflops/s, 212.653 iter/s, 4.702e-03 s/iter, (0.089, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 163.048 Tflops/s, hfu: 163.048 Tflops/s, 237.266 iter/s, 4.215e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 159.149 Tflops/s, hfu: 159.149 Tflops/s, 231.592 iter/s, 4.318e-03 s/iter, (0.092, 0.000, 0.017) sec
mfu: 138.836 Tflops/s, hfu: 138.836 Tflops/s, 202.033 iter/s, 4.950e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 118.915 Tflops/s, hfu: 118.915 Tflops/s, 173.044 iter/s, 5.779e-03 s/iter, (0.097, 0.000, 0.023) sec
SP=(1,8),S=(24576,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.599 Tflops/s, hfu: 0.599 Tflops/s, 371.873 iter/s, 2.689e-03 s/iter, (0.039, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.096 Tflops/s, hfu: 1.096 Tflops/s, 680.463 iter/s, 1.470e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 0.522 Tflops/s, hfu: 0.522 Tflops/s, 324.334 iter/s, 3.083e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 9.162 Tflops/s, hfu: 9.162 Tflops/s, 2844.335 iter/s, 3.516e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 12.867 Tflops/s, hfu: 12.867 Tflops/s, 3994.503 iter/s, 2.503e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 13.773 Tflops/s, hfu: 13.773 Tflops/s, 4275.843 iter/s, 2.339e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 15.49 Tflops/s, hfu: 15.49 Tflops/s, 4808.802 iter/s, 2.080e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 18.338 Tflops/s, hfu: 18.338 Tflops/s, 5692.945 iter/s, 1.757e-04 s/iter, (0.191, 0.000, 0.001) sec
mfu: 17.937 Tflops/s, hfu: 17.937 Tflops/s, 5568.425 iter/s, 1.796e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.306 Tflops/s, hfu: 21.306 Tflops/s, 6614.107 iter/s, 1.512e-04 s/iter, (0.141, 0.000, 0.001) sec
mfu: 35.311 Tflops/s, hfu: 35.311 Tflops/s, 10962.028 iter/s, 9.122e-05 s/iter, (0.069, 0.000, 0.000) sec
SP=(1,8),S=(24576,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.204 Tflops/s, hfu: 1.204 Tflops/s, 373.806 iter/s, 2.675e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.201 Tflops/s, hfu: 2.201 Tflops/s, 683.334 iter/s, 1.463e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 1.05 Tflops/s, hfu: 1.05 Tflops/s, 325.965 iter/s, 3.068e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 17.823 Tflops/s, hfu: 17.823 Tflops/s, 2766.527 iter/s, 3.615e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 21.139 Tflops/s, hfu: 21.139 Tflops/s, 3281.270 iter/s, 3.048e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.481 Tflops/s, hfu: 23.481 Tflops/s, 3644.740 iter/s, 2.744e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 25.956 Tflops/s, hfu: 25.956 Tflops/s, 4028.879 iter/s, 2.482e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 34.018 Tflops/s, hfu: 34.018 Tflops/s, 5280.277 iter/s, 1.894e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 31.548 Tflops/s, hfu: 31.548 Tflops/s, 4896.968 iter/s, 2.042e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 35.179 Tflops/s, hfu: 35.179 Tflops/s, 5460.423 iter/s, 1.831e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 54.545 Tflops/s, hfu: 54.545 Tflops/s, 8466.541 iter/s, 1.181e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(24576,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.793 Tflops/s, hfu: 1.793 Tflops/s, 371.143 iter/s, 2.694e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.279 Tflops/s, hfu: 3.279 Tflops/s, 678.608 iter/s, 1.474e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 1.569 Tflops/s, hfu: 1.569 Tflops/s, 324.747 iter/s, 3.079e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 25.856 Tflops/s, hfu: 25.856 Tflops/s, 2675.571 iter/s, 3.738e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 31.378 Tflops/s, hfu: 31.378 Tflops/s, 3247.006 iter/s, 3.080e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.196 Tflops/s, hfu: 34.196 Tflops/s, 3538.570 iter/s, 2.826e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 37.641 Tflops/s, hfu: 37.641 Tflops/s, 3895.052 iter/s, 2.567e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 48.413 Tflops/s, hfu: 48.413 Tflops/s, 5009.819 iter/s, 1.996e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 43.414 Tflops/s, hfu: 43.414 Tflops/s, 4492.524 iter/s, 2.226e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 46.321 Tflops/s, hfu: 46.321 Tflops/s, 4793.312 iter/s, 2.086e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 63.954 Tflops/s, hfu: 63.954 Tflops/s, 6617.958 iter/s, 1.511e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(24576,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.368 Tflops/s, hfu: 2.368 Tflops/s, 367.533 iter/s, 2.721e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.321 Tflops/s, hfu: 4.321 Tflops/s, 670.761 iter/s, 1.491e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.082 Tflops/s, hfu: 2.082 Tflops/s, 323.168 iter/s, 3.094e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 31.392 Tflops/s, hfu: 31.392 Tflops/s, 2436.362 iter/s, 4.104e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 36.042 Tflops/s, hfu: 36.042 Tflops/s, 2797.234 iter/s, 3.575e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 37.723 Tflops/s, hfu: 37.723 Tflops/s, 2927.675 iter/s, 3.416e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.975 Tflops/s, hfu: 43.975 Tflops/s, 3412.876 iter/s, 2.930e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 58.406 Tflops/s, hfu: 58.406 Tflops/s, 4532.927 iter/s, 2.206e-04 s/iter, (0.075, 0.000, 0.001) sec
mfu: 53.031 Tflops/s, hfu: 53.031 Tflops/s, 4115.769 iter/s, 2.430e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 50.33 Tflops/s, hfu: 50.33 Tflops/s, 3906.128 iter/s, 2.560e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 70.499 Tflops/s, hfu: 70.499 Tflops/s, 5471.417 iter/s, 1.828e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(24576,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.934 Tflops/s, hfu: 2.934 Tflops/s, 364.375 iter/s, 2.744e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.373 Tflops/s, hfu: 5.373 Tflops/s, 667.192 iter/s, 1.499e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.584 Tflops/s, hfu: 2.584 Tflops/s, 320.854 iter/s, 3.117e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 39.372 Tflops/s, hfu: 39.372 Tflops/s, 2444.557 iter/s, 4.091e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 45.705 Tflops/s, hfu: 45.705 Tflops/s, 2837.749 iter/s, 3.524e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 49.324 Tflops/s, hfu: 49.324 Tflops/s, 3062.449 iter/s, 3.265e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 53.295 Tflops/s, hfu: 53.295 Tflops/s, 3308.979 iter/s, 3.022e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 68.337 Tflops/s, hfu: 68.337 Tflops/s, 4242.897 iter/s, 2.357e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 58.568 Tflops/s, hfu: 58.568 Tflops/s, 3636.364 iter/s, 2.750e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 59.139 Tflops/s, hfu: 59.139 Tflops/s, 3671.827 iter/s, 2.723e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 82.657 Tflops/s, hfu: 82.657 Tflops/s, 5131.995 iter/s, 1.949e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(24576,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.509 Tflops/s, hfu: 3.509 Tflops/s, 363.110 iter/s, 2.754e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.387 Tflops/s, hfu: 6.387 Tflops/s, 660.978 iter/s, 1.513e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.002 Tflops/s, hfu: 3.002 Tflops/s, 310.657 iter/s, 3.219e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 45.984 Tflops/s, hfu: 45.984 Tflops/s, 2379.230 iter/s, 4.203e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 48.935 Tflops/s, hfu: 48.935 Tflops/s, 2531.902 iter/s, 3.950e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 50.055 Tflops/s, hfu: 50.055 Tflops/s, 2589.868 iter/s, 3.861e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 59.46 Tflops/s, hfu: 59.46 Tflops/s, 3076.469 iter/s, 3.250e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 76.672 Tflops/s, hfu: 76.672 Tflops/s, 3966.995 iter/s, 2.521e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 65.121 Tflops/s, hfu: 65.121 Tflops/s, 3369.363 iter/s, 2.968e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 63.39 Tflops/s, hfu: 63.39 Tflops/s, 3279.807 iter/s, 3.049e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 81.462 Tflops/s, hfu: 81.462 Tflops/s, 4214.856 iter/s, 2.373e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(24576,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.083 Tflops/s, hfu: 4.083 Tflops/s, 362.138 iter/s, 2.761e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.325 Tflops/s, hfu: 7.325 Tflops/s, 649.690 iter/s, 1.539e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.514 Tflops/s, hfu: 3.514 Tflops/s, 311.710 iter/s, 3.208e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 53.201 Tflops/s, hfu: 53.201 Tflops/s, 2359.381 iter/s, 4.238e-04 s/iter, (0.078, 0.000, 0.002) sec
mfu: 56.987 Tflops/s, hfu: 56.987 Tflops/s, 2527.295 iter/s, 3.957e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 60.177 Tflops/s, hfu: 60.177 Tflops/s, 2668.773 iter/s, 3.747e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 61.983 Tflops/s, hfu: 61.983 Tflops/s, 2748.884 iter/s, 3.638e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 85.243 Tflops/s, hfu: 85.243 Tflops/s, 3780.432 iter/s, 2.645e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 70.676 Tflops/s, hfu: 70.676 Tflops/s, 3134.403 iter/s, 3.190e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 69.586 Tflops/s, hfu: 69.586 Tflops/s, 3086.039 iter/s, 3.240e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 88.028 Tflops/s, hfu: 88.028 Tflops/s, 3903.932 iter/s, 2.562e-04 s/iter, (0.075, 0.000, 0.001) sec
SP=(1,8),S=(24576,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.682 Tflops/s, hfu: 4.682 Tflops/s, 363.335 iter/s, 2.752e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.426 Tflops/s, hfu: 8.426 Tflops/s, 653.935 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.064 Tflops/s, hfu: 4.064 Tflops/s, 315.399 iter/s, 3.171e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 55.426 Tflops/s, hfu: 55.426 Tflops/s, 2150.797 iter/s, 4.649e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 56.179 Tflops/s, hfu: 56.179 Tflops/s, 2180.017 iter/s, 4.587e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.939 Tflops/s, hfu: 58.939 Tflops/s, 2287.115 iter/s, 4.372e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 68.746 Tflops/s, hfu: 68.746 Tflops/s, 2667.691 iter/s, 3.749e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 90.637 Tflops/s, hfu: 90.637 Tflops/s, 3517.164 iter/s, 2.843e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 76.318 Tflops/s, hfu: 76.318 Tflops/s, 2961.524 iter/s, 3.377e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 73.768 Tflops/s, hfu: 73.768 Tflops/s, 2862.573 iter/s, 3.493e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 90.021 Tflops/s, hfu: 90.021 Tflops/s, 3493.279 iter/s, 2.863e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(24576,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.841 Tflops/s, hfu: 5.841 Tflops/s, 362.661 iter/s, 2.757e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.707 Tflops/s, hfu: 10.707 Tflops/s, 664.797 iter/s, 1.504e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.048 Tflops/s, hfu: 5.048 Tflops/s, 313.448 iter/s, 3.190e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 63.66 Tflops/s, hfu: 63.66 Tflops/s, 1976.253 iter/s, 5.060e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 63.496 Tflops/s, hfu: 63.496 Tflops/s, 1971.174 iter/s, 5.073e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 65.383 Tflops/s, hfu: 65.383 Tflops/s, 2029.748 iter/s, 4.927e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 79.977 Tflops/s, hfu: 79.977 Tflops/s, 2482.819 iter/s, 4.028e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 100.618 Tflops/s, hfu: 100.618 Tflops/s, 3123.594 iter/s, 3.201e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 86.698 Tflops/s, hfu: 86.698 Tflops/s, 2691.471 iter/s, 3.715e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 82.465 Tflops/s, hfu: 82.465 Tflops/s, 2560.059 iter/s, 3.906e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 94.807 Tflops/s, hfu: 94.807 Tflops/s, 2943.185 iter/s, 3.398e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(24576,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.02 Tflops/s, hfu: 7.02 Tflops/s, 363.222 iter/s, 2.753e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.664 Tflops/s, hfu: 12.664 Tflops/s, 655.227 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.007 Tflops/s, hfu: 6.007 Tflops/s, 310.780 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 69.597 Tflops/s, hfu: 69.597 Tflops/s, 1800.478 iter/s, 5.554e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 69.385 Tflops/s, hfu: 69.385 Tflops/s, 1794.997 iter/s, 5.571e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 70.617 Tflops/s, hfu: 70.617 Tflops/s, 1826.871 iter/s, 5.474e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 85.733 Tflops/s, hfu: 85.733 Tflops/s, 2217.924 iter/s, 4.509e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 110.814 Tflops/s, hfu: 110.814 Tflops/s, 2866.775 iter/s, 3.488e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 93.042 Tflops/s, hfu: 93.042 Tflops/s, 2406.994 iter/s, 4.155e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 88.481 Tflops/s, hfu: 88.481 Tflops/s, 2289.000 iter/s, 4.369e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 99.84 Tflops/s, hfu: 99.84 Tflops/s, 2582.858 iter/s, 3.872e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(24576,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.062 Tflops/s, hfu: 8.062 Tflops/s, 357.530 iter/s, 2.797e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.654 Tflops/s, hfu: 14.654 Tflops/s, 649.882 iter/s, 1.539e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.963 Tflops/s, hfu: 6.963 Tflops/s, 308.819 iter/s, 3.238e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 74.51 Tflops/s, hfu: 74.51 Tflops/s, 1652.215 iter/s, 6.052e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 72.788 Tflops/s, hfu: 72.788 Tflops/s, 1614.028 iter/s, 6.196e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 74.972 Tflops/s, hfu: 74.972 Tflops/s, 1662.455 iter/s, 6.015e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 91.465 Tflops/s, hfu: 91.465 Tflops/s, 2028.167 iter/s, 4.931e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 118.41 Tflops/s, hfu: 118.41 Tflops/s, 2625.664 iter/s, 3.809e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 100.452 Tflops/s, hfu: 100.452 Tflops/s, 2227.449 iter/s, 4.489e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 94.226 Tflops/s, hfu: 94.226 Tflops/s, 2089.393 iter/s, 4.786e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 101.565 Tflops/s, hfu: 101.565 Tflops/s, 2252.131 iter/s, 4.440e-04 s/iter, (0.147, 0.000, 0.002) sec
SP=(1,8),S=(24576,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.154 Tflops/s, hfu: 9.154 Tflops/s, 355.216 iter/s, 2.815e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.705 Tflops/s, hfu: 16.705 Tflops/s, 648.245 iter/s, 1.543e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.938 Tflops/s, hfu: 7.938 Tflops/s, 308.016 iter/s, 3.247e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 78.806 Tflops/s, hfu: 78.806 Tflops/s, 1529.033 iter/s, 6.540e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 81.091 Tflops/s, hfu: 81.091 Tflops/s, 1573.376 iter/s, 6.356e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 78.333 Tflops/s, hfu: 78.333 Tflops/s, 1519.868 iter/s, 6.580e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 95.104 Tflops/s, hfu: 95.104 Tflops/s, 1845.264 iter/s, 5.419e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 125.942 Tflops/s, hfu: 125.942 Tflops/s, 2443.602 iter/s, 4.092e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 105.395 Tflops/s, hfu: 105.395 Tflops/s, 2044.923 iter/s, 4.890e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 97.863 Tflops/s, hfu: 97.863 Tflops/s, 1898.802 iter/s, 5.266e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 97.872 Tflops/s, hfu: 97.872 Tflops/s, 1898.975 iter/s, 5.266e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(24576,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.644 Tflops/s, hfu: 11.644 Tflops/s, 361.491 iter/s, 2.766e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.005 Tflops/s, hfu: 21.005 Tflops/s, 652.094 iter/s, 1.534e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.09 Tflops/s, hfu: 10.09 Tflops/s, 313.230 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 87.432 Tflops/s, hfu: 87.432 Tflops/s, 1357.117 iter/s, 7.369e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 83.778 Tflops/s, hfu: 83.778 Tflops/s, 1300.404 iter/s, 7.690e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 82.568 Tflops/s, hfu: 82.568 Tflops/s, 1281.617 iter/s, 7.803e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.304 Tflops/s, hfu: 103.304 Tflops/s, 1603.489 iter/s, 6.236e-04 s/iter, (0.073, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 136.882 Tflops/s, hfu: 136.882 Tflops/s, 2124.694 iter/s, 4.707e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 113.154 Tflops/s, hfu: 113.154 Tflops/s, 1756.383 iter/s, 5.694e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 103.908 Tflops/s, hfu: 103.908 Tflops/s, 1612.862 iter/s, 6.200e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.366 Tflops/s, hfu: 100.366 Tflops/s, 1557.885 iter/s, 6.419e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(24576,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.901 Tflops/s, hfu: 13.901 Tflops/s, 359.620 iter/s, 2.781e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.11 Tflops/s, hfu: 25.11 Tflops/s, 649.600 iter/s, 1.539e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 12.074 Tflops/s, hfu: 12.074 Tflops/s, 312.346 iter/s, 3.202e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 95.717 Tflops/s, hfu: 95.717 Tflops/s, 1238.102 iter/s, 8.077e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 87.742 Tflops/s, hfu: 87.742 Tflops/s, 1134.940 iter/s, 8.811e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 82.643 Tflops/s, hfu: 82.643 Tflops/s, 1068.988 iter/s, 9.355e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 110.227 Tflops/s, hfu: 110.227 Tflops/s, 1425.785 iter/s, 7.014e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 145.283 Tflops/s, hfu: 145.283 Tflops/s, 1879.247 iter/s, 5.321e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 120.129 Tflops/s, hfu: 120.129 Tflops/s, 1553.876 iter/s, 6.436e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 109.26 Tflops/s, hfu: 109.26 Tflops/s, 1413.276 iter/s, 7.076e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.927 Tflops/s, hfu: 104.927 Tflops/s, 1357.235 iter/s, 7.368e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(24576,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.118 Tflops/s, hfu: 16.118 Tflops/s, 357.414 iter/s, 2.798e-03 s/iter, (0.032, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.761 Tflops/s, hfu: 29.761 Tflops/s, 659.938 iter/s, 1.515e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.249 Tflops/s, hfu: 14.249 Tflops/s, 315.965 iter/s, 3.165e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 96.552 Tflops/s, hfu: 96.552 Tflops/s, 1070.490 iter/s, 9.342e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 95.827 Tflops/s, hfu: 95.827 Tflops/s, 1062.455 iter/s, 9.412e-04 s/iter, (0.078, 0.000, 0.004) sec
mfu: 86.519 Tflops/s, hfu: 86.519 Tflops/s, 959.251 iter/s, 1.042e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 114.273 Tflops/s, hfu: 114.273 Tflops/s, 1266.965 iter/s, 7.893e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 151.371 Tflops/s, hfu: 151.371 Tflops/s, 1678.280 iter/s, 5.958e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 124.895 Tflops/s, hfu: 124.895 Tflops/s, 1384.735 iter/s, 7.222e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 113.213 Tflops/s, hfu: 113.213 Tflops/s, 1255.209 iter/s, 7.967e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 106.34 Tflops/s, hfu: 106.34 Tflops/s, 1179.012 iter/s, 8.482e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(24576,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.506 Tflops/s, hfu: 18.506 Tflops/s, 359.068 iter/s, 2.785e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.707 Tflops/s, hfu: 33.707 Tflops/s, 654.001 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.167 Tflops/s, hfu: 16.167 Tflops/s, 313.690 iter/s, 3.188e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 98.195 Tflops/s, hfu: 98.195 Tflops/s, 952.613 iter/s, 1.050e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 97.658 Tflops/s, hfu: 97.658 Tflops/s, 947.408 iter/s, 1.056e-03 s/iter, (0.078, 0.000, 0.004) sec
mfu: 90.536 Tflops/s, hfu: 90.536 Tflops/s, 878.315 iter/s, 1.139e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 118.988 Tflops/s, hfu: 118.988 Tflops/s, 1154.340 iter/s, 8.663e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 154.401 Tflops/s, hfu: 154.401 Tflops/s, 1497.885 iter/s, 6.676e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 129.102 Tflops/s, hfu: 129.102 Tflops/s, 1252.455 iter/s, 7.984e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 116.232 Tflops/s, hfu: 116.232 Tflops/s, 1127.599 iter/s, 8.868e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.098 Tflops/s, hfu: 109.098 Tflops/s, 1058.389 iter/s, 9.448e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(24576,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.992 Tflops/s, hfu: 22.992 Tflops/s, 356.880 iter/s, 2.802e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.436 Tflops/s, hfu: 42.436 Tflops/s, 658.700 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 20.389 Tflops/s, hfu: 20.389 Tflops/s, 316.474 iter/s, 3.160e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 103.776 Tflops/s, hfu: 103.776 Tflops/s, 805.407 iter/s, 1.242e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 99.593 Tflops/s, hfu: 99.593 Tflops/s, 772.941 iter/s, 1.294e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 94.182 Tflops/s, hfu: 94.182 Tflops/s, 730.947 iter/s, 1.368e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 122.884 Tflops/s, hfu: 122.884 Tflops/s, 953.703 iter/s, 1.049e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 161.319 Tflops/s, hfu: 161.319 Tflops/s, 1252.003 iter/s, 7.987e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 135.616 Tflops/s, hfu: 135.616 Tflops/s, 1052.516 iter/s, 9.501e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 120.129 Tflops/s, hfu: 120.129 Tflops/s, 932.321 iter/s, 1.073e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 111.892 Tflops/s, hfu: 111.892 Tflops/s, 868.399 iter/s, 1.152e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(24576,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.506 Tflops/s, hfu: 27.506 Tflops/s, 355.795 iter/s, 2.811e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.893 Tflops/s, hfu: 49.893 Tflops/s, 645.372 iter/s, 1.549e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 23.917 Tflops/s, hfu: 23.917 Tflops/s, 309.373 iter/s, 3.232e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 117.589 Tflops/s, hfu: 117.589 Tflops/s, 760.512 iter/s, 1.315e-03 s/iter, (0.075, 0.001, 0.005) sec
mfu: 107.604 Tflops/s, hfu: 107.604 Tflops/s, 695.929 iter/s, 1.437e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 103.117 Tflops/s, hfu: 103.117 Tflops/s, 666.912 iter/s, 1.499e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 127.965 Tflops/s, hfu: 127.965 Tflops/s, 827.617 iter/s, 1.208e-03 s/iter, (0.076, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 168.074 Tflops/s, hfu: 168.074 Tflops/s, 1087.023 iter/s, 9.199e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 139.372 Tflops/s, hfu: 139.372 Tflops/s, 901.388 iter/s, 1.109e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 123.307 Tflops/s, hfu: 123.307 Tflops/s, 797.489 iter/s, 1.254e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 114.787 Tflops/s, hfu: 114.787 Tflops/s, 742.386 iter/s, 1.347e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(24576,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.179 Tflops/s, hfu: 32.179 Tflops/s, 356.769 iter/s, 2.803e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.626 Tflops/s, hfu: 58.626 Tflops/s, 649.992 iter/s, 1.538e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 28.054 Tflops/s, hfu: 28.054 Tflops/s, 311.037 iter/s, 3.215e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 116.649 Tflops/s, hfu: 116.649 Tflops/s, 646.653 iter/s, 1.546e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 106.49 Tflops/s, hfu: 106.49 Tflops/s, 590.335 iter/s, 1.694e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 97.435 Tflops/s, hfu: 97.435 Tflops/s, 540.139 iter/s, 1.851e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.393 Tflops/s, hfu: 131.393 Tflops/s, 728.387 iter/s, 1.373e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 172.729 Tflops/s, hfu: 172.729 Tflops/s, 957.539 iter/s, 1.044e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 142.785 Tflops/s, hfu: 142.785 Tflops/s, 791.540 iter/s, 1.263e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 125.722 Tflops/s, hfu: 125.722 Tflops/s, 696.950 iter/s, 1.435e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 114.727 Tflops/s, hfu: 114.727 Tflops/s, 636.000 iter/s, 1.572e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(24576,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.645 Tflops/s, hfu: 36.645 Tflops/s, 355.502 iter/s, 2.813e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 66.833 Tflops/s, hfu: 66.833 Tflops/s, 648.365 iter/s, 1.542e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 31.827 Tflops/s, hfu: 31.827 Tflops/s, 308.759 iter/s, 3.239e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 127.132 Tflops/s, hfu: 127.132 Tflops/s, 616.672 iter/s, 1.622e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 104.896 Tflops/s, hfu: 104.896 Tflops/s, 508.813 iter/s, 1.965e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 98.786 Tflops/s, hfu: 98.786 Tflops/s, 479.175 iter/s, 2.087e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 130.637 Tflops/s, hfu: 130.637 Tflops/s, 633.672 iter/s, 1.578e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 175.928 Tflops/s, hfu: 175.928 Tflops/s, 853.365 iter/s, 1.172e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 146.529 Tflops/s, hfu: 146.529 Tflops/s, 710.760 iter/s, 1.407e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 127.753 Tflops/s, hfu: 127.753 Tflops/s, 619.683 iter/s, 1.614e-03 s/iter, (0.087, 0.000, 0.006) sec
mfu: 117.17 Tflops/s, hfu: 117.17 Tflops/s, 568.347 iter/s, 1.759e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(24576,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.789 Tflops/s, hfu: 45.789 Tflops/s, 355.370 iter/s, 2.814e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 84.404 Tflops/s, hfu: 84.404 Tflops/s, 655.058 iter/s, 1.527e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 40.37 Tflops/s, hfu: 40.37 Tflops/s, 313.314 iter/s, 3.192e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 116.883 Tflops/s, hfu: 116.883 Tflops/s, 453.566 iter/s, 2.205e-03 s/iter, (0.077, 0.000, 0.009) sec
mfu: 118.168 Tflops/s, hfu: 118.168 Tflops/s, 458.554 iter/s, 2.181e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 116.218 Tflops/s, hfu: 116.218 Tflops/s, 450.984 iter/s, 2.217e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 137.433 Tflops/s, hfu: 137.433 Tflops/s, 533.311 iter/s, 1.875e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 180.51 Tflops/s, hfu: 180.51 Tflops/s, 700.472 iter/s, 1.428e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 149.48 Tflops/s, hfu: 149.48 Tflops/s, 580.057 iter/s, 1.724e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 130.109 Tflops/s, hfu: 130.109 Tflops/s, 504.889 iter/s, 1.981e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 117.734 Tflops/s, hfu: 117.734 Tflops/s, 456.866 iter/s, 2.189e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(24576,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.011 Tflops/s, hfu: 55.011 Tflops/s, 355.783 iter/s, 2.811e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.855 Tflops/s, hfu: 98.855 Tflops/s, 639.346 iter/s, 1.564e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 47.065 Tflops/s, hfu: 47.065 Tflops/s, 304.391 iter/s, 3.285e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 125.697 Tflops/s, hfu: 125.697 Tflops/s, 406.474 iter/s, 2.460e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 119.789 Tflops/s, hfu: 119.789 Tflops/s, 387.367 iter/s, 2.582e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 109.909 Tflops/s, hfu: 109.909 Tflops/s, 355.420 iter/s, 2.814e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 139.756 Tflops/s, hfu: 139.756 Tflops/s, 451.937 iter/s, 2.213e-03 s/iter, (0.081, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 184.165 Tflops/s, hfu: 184.165 Tflops/s, 595.544 iter/s, 1.679e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 152.828 Tflops/s, hfu: 152.828 Tflops/s, 494.208 iter/s, 2.023e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 132.215 Tflops/s, hfu: 132.215 Tflops/s, 427.552 iter/s, 2.339e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 119.624 Tflops/s, hfu: 119.624 Tflops/s, 386.834 iter/s, 2.585e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(24576,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.548 Tflops/s, hfu: 62.548 Tflops/s, 346.740 iter/s, 2.884e-03 s/iter, (0.038, 0.000, 0.058) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 104.941 Tflops/s, hfu: 104.941 Tflops/s, 581.750 iter/s, 1.719e-03 s/iter, (0.021, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 50.907 Tflops/s, hfu: 50.907 Tflops/s, 282.207 iter/s, 3.543e-03 s/iter, (0.039, 0.000, 0.071) sec
# orchestrated_attn_func
mfu: 122.291 Tflops/s, hfu: 122.291 Tflops/s, 338.965 iter/s, 2.950e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 118.06 Tflops/s, hfu: 118.06 Tflops/s, 327.238 iter/s, 3.056e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 107.915 Tflops/s, hfu: 107.915 Tflops/s, 299.118 iter/s, 3.343e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 142.504 Tflops/s, hfu: 142.504 Tflops/s, 394.991 iter/s, 2.532e-03 s/iter, (0.084, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 186.504 Tflops/s, hfu: 186.504 Tflops/s, 516.950 iter/s, 1.934e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 154.48 Tflops/s, hfu: 154.48 Tflops/s, 428.188 iter/s, 2.335e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 133.588 Tflops/s, hfu: 133.588 Tflops/s, 370.278 iter/s, 2.701e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 119.956 Tflops/s, hfu: 119.956 Tflops/s, 332.494 iter/s, 3.008e-03 s/iter, (0.092, 0.000, 0.012) sec
SP=(1,8),S=(24576,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.638 Tflops/s, hfu: 64.638 Tflops/s, 313.534 iter/s, 3.189e-03 s/iter, (0.045, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.796 Tflops/s, hfu: 109.796 Tflops/s, 532.580 iter/s, 1.878e-03 s/iter, (0.023, 0.000, 0.038) sec
# stripe_flash_attn_func, fwd
mfu: 53.375 Tflops/s, hfu: 53.375 Tflops/s, 258.901 iter/s, 3.862e-03 s/iter, (0.042, 0.000, 0.077) sec
# orchestrated_attn_func
mfu: 121.628 Tflops/s, hfu: 121.628 Tflops/s, 294.987 iter/s, 3.390e-03 s/iter, (0.082, 0.000, 0.014) sec
mfu: 123.029 Tflops/s, hfu: 123.029 Tflops/s, 298.384 iter/s, 3.351e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 111.653 Tflops/s, hfu: 111.653 Tflops/s, 270.795 iter/s, 3.693e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 143.477 Tflops/s, hfu: 143.477 Tflops/s, 347.977 iter/s, 2.874e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 188.302 Tflops/s, hfu: 188.302 Tflops/s, 456.693 iter/s, 2.190e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 156.255 Tflops/s, hfu: 156.255 Tflops/s, 378.967 iter/s, 2.639e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 134.377 Tflops/s, hfu: 134.377 Tflops/s, 325.907 iter/s, 3.068e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 119.594 Tflops/s, hfu: 119.594 Tflops/s, 290.053 iter/s, 3.448e-03 s/iter, (0.084, 0.000, 0.014) sec
SP=(1,8),S=(24576,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.74 Tflops/s, hfu: 66.74 Tflops/s, 258.984 iter/s, 3.861e-03 s/iter, (0.048, 0.000, 0.077) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.05 Tflops/s, hfu: 114.05 Tflops/s, 442.573 iter/s, 2.260e-03 s/iter, (0.029, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 56.693 Tflops/s, hfu: 56.693 Tflops/s, 219.999 iter/s, 4.545e-03 s/iter, (0.051, 0.000, 0.091) sec
# orchestrated_attn_func
mfu: 127.459 Tflops/s, hfu: 127.459 Tflops/s, 247.303 iter/s, 4.044e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 131.981 Tflops/s, hfu: 131.981 Tflops/s, 256.078 iter/s, 3.905e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 111.89 Tflops/s, hfu: 111.89 Tflops/s, 217.095 iter/s, 4.606e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 143.888 Tflops/s, hfu: 143.888 Tflops/s, 279.180 iter/s, 3.582e-03 s/iter, (0.086, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 190.335 Tflops/s, hfu: 190.335 Tflops/s, 369.298 iter/s, 2.708e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 157.976 Tflops/s, hfu: 157.976 Tflops/s, 306.513 iter/s, 3.263e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 135.694 Tflops/s, hfu: 135.694 Tflops/s, 263.281 iter/s, 3.798e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 120.588 Tflops/s, hfu: 120.588 Tflops/s, 233.972 iter/s, 4.274e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(24576,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.71 Tflops/s, hfu: 67.71 Tflops/s, 218.956 iter/s, 4.567e-03 s/iter, (0.055, 0.000, 0.091) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.466 Tflops/s, hfu: 117.466 Tflops/s, 379.857 iter/s, 2.633e-03 s/iter, (0.032, 0.000, 0.053) sec
# stripe_flash_attn_func, fwd
mfu: 59.767 Tflops/s, hfu: 59.767 Tflops/s, 193.272 iter/s, 5.174e-03 s/iter, (0.056, 0.000, 0.103) sec
# orchestrated_attn_func
mfu: 138.643 Tflops/s, hfu: 138.643 Tflops/s, 224.170 iter/s, 4.461e-03 s/iter, (0.093, 0.000, 0.018) sec
mfu: 147.299 Tflops/s, hfu: 147.299 Tflops/s, 238.165 iter/s, 4.199e-03 s/iter, (0.093, 0.000, 0.017) sec
mfu: 109.462 Tflops/s, hfu: 109.462 Tflops/s, 176.988 iter/s, 5.650e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 146.415 Tflops/s, hfu: 146.415 Tflops/s, 236.736 iter/s, 4.224e-03 s/iter, (0.090, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 192.515 Tflops/s, hfu: 192.515 Tflops/s, 311.274 iter/s, 3.213e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 159.428 Tflops/s, hfu: 159.428 Tflops/s, 257.776 iter/s, 3.879e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 136.991 Tflops/s, hfu: 136.991 Tflops/s, 221.497 iter/s, 4.515e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 121.444 Tflops/s, hfu: 121.444 Tflops/s, 196.360 iter/s, 5.093e-03 s/iter, (0.094, 0.000, 0.020) sec
SP=(1,8),S=(24576,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.846 Tflops/s, hfu: 68.846 Tflops/s, 190.826 iter/s, 5.240e-03 s/iter, (0.062, 0.000, 0.105) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.401 Tflops/s, hfu: 114.401 Tflops/s, 317.097 iter/s, 3.154e-03 s/iter, (0.037, 0.000, 0.063) sec
# stripe_flash_attn_func, fwd
mfu: 62.79 Tflops/s, hfu: 62.79 Tflops/s, 174.040 iter/s, 5.746e-03 s/iter, (0.065, 0.000, 0.115) sec
# orchestrated_attn_func
mfu: 128.997 Tflops/s, hfu: 128.997 Tflops/s, 178.777 iter/s, 5.594e-03 s/iter, (0.090, 0.000, 0.022) sec
mfu: 137.249 Tflops/s, hfu: 137.249 Tflops/s, 190.213 iter/s, 5.257e-03 s/iter, (0.093, 0.000, 0.021) sec
mfu: 123.922 Tflops/s, hfu: 123.922 Tflops/s, 171.742 iter/s, 5.823e-03 s/iter, (0.097, 0.000, 0.023) sec
mfu: 145.736 Tflops/s, hfu: 145.736 Tflops/s, 201.975 iter/s, 4.951e-03 s/iter, (0.091, 0.000, 0.020) sec
# orchestrated_attn_func fused
mfu: 193.777 Tflops/s, hfu: 193.777 Tflops/s, 268.554 iter/s, 3.724e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 160.522 Tflops/s, hfu: 160.522 Tflops/s, 222.467 iter/s, 4.495e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 137.335 Tflops/s, hfu: 137.335 Tflops/s, 190.332 iter/s, 5.254e-03 s/iter, (0.092, 0.000, 0.021) sec
mfu: 121.067 Tflops/s, hfu: 121.067 Tflops/s, 167.786 iter/s, 5.960e-03 s/iter, (0.096, 0.000, 0.024) sec
SP=(1,8),S=(24576,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.723 Tflops/s, hfu: 70.723 Tflops/s, 171.527 iter/s, 5.830e-03 s/iter, (0.068, 0.000, 0.117) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.705 Tflops/s, hfu: 114.705 Tflops/s, 278.196 iter/s, 3.595e-03 s/iter, (0.041, 0.000, 0.072) sec
# stripe_flash_attn_func, fwd
mfu: 64.222 Tflops/s, hfu: 64.222 Tflops/s, 155.759 iter/s, 6.420e-03 s/iter, (0.069, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 120.809 Tflops/s, hfu: 120.809 Tflops/s, 146.500 iter/s, 6.826e-03 s/iter, (0.098, 0.000, 0.027) sec
mfu: 129.937 Tflops/s, hfu: 129.937 Tflops/s, 157.569 iter/s, 6.346e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 101.96 Tflops/s, hfu: 101.96 Tflops/s, 123.643 iter/s, 8.088e-03 s/iter, (0.098, 0.000, 0.032) sec
mfu: 148.332 Tflops/s, hfu: 148.332 Tflops/s, 179.877 iter/s, 5.559e-03 s/iter, (0.097, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 194.822 Tflops/s, hfu: 194.822 Tflops/s, 236.253 iter/s, 4.233e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 161.504 Tflops/s, hfu: 161.504 Tflops/s, 195.850 iter/s, 5.106e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 137.849 Tflops/s, hfu: 137.849 Tflops/s, 167.164 iter/s, 5.982e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 121.863 Tflops/s, hfu: 121.863 Tflops/s, 147.778 iter/s, 6.767e-03 s/iter, (0.099, 0.000, 0.027) sec
SP=(1,8),S=(28672,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.703 Tflops/s, hfu: 0.703 Tflops/s, 374.227 iter/s, 2.672e-03 s/iter, (0.037, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.263 Tflops/s, hfu: 1.263 Tflops/s, 672.035 iter/s, 1.488e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.599 Tflops/s, hfu: 0.599 Tflops/s, 318.604 iter/s, 3.139e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 10.274 Tflops/s, hfu: 10.274 Tflops/s, 2733.734 iter/s, 3.658e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 13.713 Tflops/s, hfu: 13.713 Tflops/s, 3648.996 iter/s, 2.740e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 15.166 Tflops/s, hfu: 15.166 Tflops/s, 4035.513 iter/s, 2.478e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.374 Tflops/s, hfu: 16.374 Tflops/s, 4357.071 iter/s, 2.295e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 19.757 Tflops/s, hfu: 19.757 Tflops/s, 5257.181 iter/s, 1.902e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.588 Tflops/s, hfu: 18.588 Tflops/s, 4946.185 iter/s, 2.022e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 21.1 Tflops/s, hfu: 21.1 Tflops/s, 5614.445 iter/s, 1.781e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.317 Tflops/s, hfu: 39.317 Tflops/s, 10462.002 iter/s, 9.558e-05 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(28672,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.394 Tflops/s, hfu: 1.394 Tflops/s, 370.923 iter/s, 2.696e-03 s/iter, (0.038, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.518 Tflops/s, hfu: 2.518 Tflops/s, 669.968 iter/s, 1.493e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.204 Tflops/s, hfu: 1.204 Tflops/s, 320.498 iter/s, 3.120e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 19.289 Tflops/s, hfu: 19.289 Tflops/s, 2566.261 iter/s, 3.897e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 24.18 Tflops/s, hfu: 24.18 Tflops/s, 3217.089 iter/s, 3.108e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.286 Tflops/s, hfu: 26.286 Tflops/s, 3497.188 iter/s, 2.859e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.455 Tflops/s, hfu: 29.455 Tflops/s, 3918.864 iter/s, 2.552e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 34.421 Tflops/s, hfu: 34.421 Tflops/s, 4579.593 iter/s, 2.184e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 31.406 Tflops/s, hfu: 31.406 Tflops/s, 4178.506 iter/s, 2.393e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 32.908 Tflops/s, hfu: 32.908 Tflops/s, 4378.284 iter/s, 2.284e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.739 Tflops/s, hfu: 58.739 Tflops/s, 7814.942 iter/s, 1.280e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(28672,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.071 Tflops/s, hfu: 2.071 Tflops/s, 367.377 iter/s, 2.722e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.75 Tflops/s, hfu: 3.75 Tflops/s, 665.219 iter/s, 1.503e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.791 Tflops/s, hfu: 1.791 Tflops/s, 317.772 iter/s, 3.147e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 28.942 Tflops/s, hfu: 28.942 Tflops/s, 2567.104 iter/s, 3.895e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 32.588 Tflops/s, hfu: 32.588 Tflops/s, 2890.441 iter/s, 3.460e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 34.994 Tflops/s, hfu: 34.994 Tflops/s, 3103.894 iter/s, 3.222e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.731 Tflops/s, hfu: 43.731 Tflops/s, 3878.856 iter/s, 2.578e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 47.44 Tflops/s, hfu: 47.44 Tflops/s, 4207.762 iter/s, 2.377e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 42.227 Tflops/s, hfu: 42.227 Tflops/s, 3745.431 iter/s, 2.670e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 48.439 Tflops/s, hfu: 48.439 Tflops/s, 4296.419 iter/s, 2.328e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 69.167 Tflops/s, hfu: 69.167 Tflops/s, 6134.969 iter/s, 1.630e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(28672,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.781 Tflops/s, hfu: 2.781 Tflops/s, 369.972 iter/s, 2.703e-03 s/iter, (0.039, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.001 Tflops/s, hfu: 5.001 Tflops/s, 665.324 iter/s, 1.503e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.377 Tflops/s, hfu: 2.377 Tflops/s, 316.289 iter/s, 3.162e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 36.787 Tflops/s, hfu: 36.787 Tflops/s, 2447.190 iter/s, 4.086e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 40.696 Tflops/s, hfu: 40.696 Tflops/s, 2707.210 iter/s, 3.694e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 43.437 Tflops/s, hfu: 43.437 Tflops/s, 2889.572 iter/s, 3.461e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 49.625 Tflops/s, hfu: 49.625 Tflops/s, 3301.202 iter/s, 3.029e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 55.745 Tflops/s, hfu: 55.745 Tflops/s, 3708.319 iter/s, 2.697e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 49.875 Tflops/s, hfu: 49.875 Tflops/s, 3317.850 iter/s, 3.014e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 51.239 Tflops/s, hfu: 51.239 Tflops/s, 3408.595 iter/s, 2.934e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 75.464 Tflops/s, hfu: 75.464 Tflops/s, 5020.080 iter/s, 1.992e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(28672,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.434 Tflops/s, hfu: 3.434 Tflops/s, 365.525 iter/s, 2.736e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.168 Tflops/s, hfu: 6.168 Tflops/s, 656.483 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.972 Tflops/s, hfu: 2.972 Tflops/s, 316.299 iter/s, 3.162e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 43.938 Tflops/s, hfu: 43.938 Tflops/s, 2338.328 iter/s, 4.277e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 49.139 Tflops/s, hfu: 49.139 Tflops/s, 2615.117 iter/s, 3.824e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 53.559 Tflops/s, hfu: 53.559 Tflops/s, 2850.302 iter/s, 3.508e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 57.951 Tflops/s, hfu: 57.951 Tflops/s, 3084.059 iter/s, 3.242e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 65.683 Tflops/s, hfu: 65.683 Tflops/s, 3495.526 iter/s, 2.861e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 53.445 Tflops/s, hfu: 53.445 Tflops/s, 2844.271 iter/s, 3.516e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 58.259 Tflops/s, hfu: 58.259 Tflops/s, 3100.429 iter/s, 3.225e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 84.444 Tflops/s, hfu: 84.444 Tflops/s, 4493.978 iter/s, 2.225e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(28672,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.106 Tflops/s, hfu: 4.106 Tflops/s, 364.155 iter/s, 2.746e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.373 Tflops/s, hfu: 7.373 Tflops/s, 654.001 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.556 Tflops/s, hfu: 3.556 Tflops/s, 315.450 iter/s, 3.170e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 50.686 Tflops/s, hfu: 50.686 Tflops/s, 2247.838 iter/s, 4.449e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 51.533 Tflops/s, hfu: 51.533 Tflops/s, 2285.443 iter/s, 4.376e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 53.381 Tflops/s, hfu: 53.381 Tflops/s, 2367.379 iter/s, 4.224e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 67.629 Tflops/s, hfu: 67.629 Tflops/s, 2999.256 iter/s, 3.334e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 72.726 Tflops/s, hfu: 72.726 Tflops/s, 3225.307 iter/s, 3.100e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 57.703 Tflops/s, hfu: 57.703 Tflops/s, 2559.063 iter/s, 3.908e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 66.119 Tflops/s, hfu: 66.119 Tflops/s, 2932.276 iter/s, 3.410e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 87.88 Tflops/s, hfu: 87.88 Tflops/s, 3897.359 iter/s, 2.566e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(28672,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.828 Tflops/s, hfu: 4.828 Tflops/s, 367.044 iter/s, 2.724e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.625 Tflops/s, hfu: 8.625 Tflops/s, 655.734 iter/s, 1.525e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.16 Tflops/s, hfu: 4.16 Tflops/s, 316.245 iter/s, 3.162e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 57.892 Tflops/s, hfu: 57.892 Tflops/s, 2200.665 iter/s, 4.544e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 58.305 Tflops/s, hfu: 58.305 Tflops/s, 2216.351 iter/s, 4.512e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 59.496 Tflops/s, hfu: 59.496 Tflops/s, 2261.625 iter/s, 4.422e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.889 Tflops/s, hfu: 70.889 Tflops/s, 2694.721 iter/s, 3.711e-04 s/iter, (0.072, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 78.578 Tflops/s, hfu: 78.578 Tflops/s, 2987.000 iter/s, 3.348e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 62.317 Tflops/s, hfu: 62.317 Tflops/s, 2368.860 iter/s, 4.221e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 71.153 Tflops/s, hfu: 71.153 Tflops/s, 2704.749 iter/s, 3.697e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 92.33 Tflops/s, hfu: 92.33 Tflops/s, 3509.757 iter/s, 2.849e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(28672,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.459 Tflops/s, hfu: 5.459 Tflops/s, 363.164 iter/s, 2.754e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.72 Tflops/s, hfu: 9.72 Tflops/s, 646.596 iter/s, 1.547e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.744 Tflops/s, hfu: 4.744 Tflops/s, 315.612 iter/s, 3.168e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 61.682 Tflops/s, hfu: 61.682 Tflops/s, 2051.636 iter/s, 4.874e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.069 Tflops/s, hfu: 64.069 Tflops/s, 2131.033 iter/s, 4.693e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 65.074 Tflops/s, hfu: 65.074 Tflops/s, 2164.465 iter/s, 4.620e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 73.061 Tflops/s, hfu: 73.061 Tflops/s, 2430.110 iter/s, 4.115e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.324 Tflops/s, hfu: 83.324 Tflops/s, 2771.496 iter/s, 3.608e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 65.683 Tflops/s, hfu: 65.683 Tflops/s, 2184.704 iter/s, 4.577e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 75.547 Tflops/s, hfu: 75.547 Tflops/s, 2512.815 iter/s, 3.980e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 93.105 Tflops/s, hfu: 93.105 Tflops/s, 3096.819 iter/s, 3.229e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(28672,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.789 Tflops/s, hfu: 6.789 Tflops/s, 361.326 iter/s, 2.768e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.363 Tflops/s, hfu: 12.363 Tflops/s, 657.946 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.864 Tflops/s, hfu: 5.864 Tflops/s, 312.090 iter/s, 3.204e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 68.162 Tflops/s, hfu: 68.162 Tflops/s, 1813.750 iter/s, 5.513e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 67.378 Tflops/s, hfu: 67.378 Tflops/s, 1792.886 iter/s, 5.578e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 69.322 Tflops/s, hfu: 69.322 Tflops/s, 1844.610 iter/s, 5.421e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 85.508 Tflops/s, hfu: 85.508 Tflops/s, 2275.292 iter/s, 4.395e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 92.749 Tflops/s, hfu: 92.749 Tflops/s, 2467.966 iter/s, 4.052e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.302 Tflops/s, hfu: 72.302 Tflops/s, 1923.906 iter/s, 5.198e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 83.799 Tflops/s, hfu: 83.799 Tflops/s, 2229.833 iter/s, 4.485e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 101.792 Tflops/s, hfu: 101.792 Tflops/s, 2708.618 iter/s, 3.692e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(28672,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.147 Tflops/s, hfu: 8.147 Tflops/s, 361.301 iter/s, 2.768e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.791 Tflops/s, hfu: 14.791 Tflops/s, 655.954 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 7.035 Tflops/s, hfu: 7.035 Tflops/s, 311.975 iter/s, 3.205e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 72.477 Tflops/s, hfu: 72.477 Tflops/s, 1607.138 iter/s, 6.222e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 66.708 Tflops/s, hfu: 66.708 Tflops/s, 1479.202 iter/s, 6.760e-04 s/iter, (0.114, 0.000, 0.003) sec
mfu: 71.322 Tflops/s, hfu: 71.322 Tflops/s, 1581.518 iter/s, 6.323e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 91.889 Tflops/s, hfu: 91.889 Tflops/s, 2037.589 iter/s, 4.908e-04 s/iter, (0.079, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 99.475 Tflops/s, hfu: 99.475 Tflops/s, 2205.792 iter/s, 4.534e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 76.737 Tflops/s, hfu: 76.737 Tflops/s, 1701.583 iter/s, 5.877e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 90.532 Tflops/s, hfu: 90.532 Tflops/s, 2007.484 iter/s, 4.981e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 104.865 Tflops/s, hfu: 104.865 Tflops/s, 2325.322 iter/s, 4.300e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(28672,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.457 Tflops/s, hfu: 9.457 Tflops/s, 359.503 iter/s, 2.782e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.144 Tflops/s, hfu: 17.144 Tflops/s, 651.694 iter/s, 1.534e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.121 Tflops/s, hfu: 8.121 Tflops/s, 308.711 iter/s, 3.239e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 80.369 Tflops/s, hfu: 80.369 Tflops/s, 1527.538 iter/s, 6.546e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 81.09 Tflops/s, hfu: 81.09 Tflops/s, 1541.250 iter/s, 6.488e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 78.643 Tflops/s, hfu: 78.643 Tflops/s, 1494.733 iter/s, 6.690e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 92.521 Tflops/s, hfu: 92.521 Tflops/s, 1758.508 iter/s, 5.687e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 103.579 Tflops/s, hfu: 103.579 Tflops/s, 1968.690 iter/s, 5.080e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 80.151 Tflops/s, hfu: 80.151 Tflops/s, 1523.406 iter/s, 6.564e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 96.278 Tflops/s, hfu: 96.278 Tflops/s, 1829.920 iter/s, 5.465e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 107.472 Tflops/s, hfu: 107.472 Tflops/s, 2042.684 iter/s, 4.896e-04 s/iter, (0.098, 0.000, 0.002) sec
SP=(1,8),S=(28672,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.68 Tflops/s, hfu: 10.68 Tflops/s, 355.227 iter/s, 2.815e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.506 Tflops/s, hfu: 19.506 Tflops/s, 648.796 iter/s, 1.541e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.264 Tflops/s, hfu: 9.264 Tflops/s, 308.145 iter/s, 3.245e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 87.265 Tflops/s, hfu: 87.265 Tflops/s, 1451.278 iter/s, 6.890e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 82.931 Tflops/s, hfu: 82.931 Tflops/s, 1379.204 iter/s, 7.251e-04 s/iter, (0.098, 0.000, 0.003) sec
mfu: 83.934 Tflops/s, hfu: 83.934 Tflops/s, 1395.884 iter/s, 7.164e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 93.405 Tflops/s, hfu: 93.405 Tflops/s, 1553.393 iter/s, 6.438e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 109.233 Tflops/s, hfu: 109.233 Tflops/s, 1816.623 iter/s, 5.505e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 83.797 Tflops/s, hfu: 83.797 Tflops/s, 1393.612 iter/s, 7.176e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 100.69 Tflops/s, hfu: 100.69 Tflops/s, 1674.548 iter/s, 5.972e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 103.599 Tflops/s, hfu: 103.599 Tflops/s, 1722.926 iter/s, 5.804e-04 s/iter, (0.075, 0.000, 0.002) sec
SP=(1,8),S=(28672,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.655 Tflops/s, hfu: 13.655 Tflops/s, 363.360 iter/s, 2.752e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.751 Tflops/s, hfu: 24.751 Tflops/s, 658.612 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 11.891 Tflops/s, hfu: 11.891 Tflops/s, 316.422 iter/s, 3.160e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 96.52 Tflops/s, hfu: 96.52 Tflops/s, 1284.159 iter/s, 7.787e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 92.088 Tflops/s, hfu: 92.088 Tflops/s, 1225.190 iter/s, 8.162e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 93.26 Tflops/s, hfu: 93.26 Tflops/s, 1240.793 iter/s, 8.059e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.818 Tflops/s, hfu: 104.818 Tflops/s, 1394.560 iter/s, 7.171e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 115.888 Tflops/s, hfu: 115.888 Tflops/s, 1541.839 iter/s, 6.486e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 88.467 Tflops/s, hfu: 88.467 Tflops/s, 1177.024 iter/s, 8.496e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 105.908 Tflops/s, hfu: 105.908 Tflops/s, 1409.070 iter/s, 7.097e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 107.603 Tflops/s, hfu: 107.603 Tflops/s, 1431.615 iter/s, 6.985e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(28672,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.35 Tflops/s, hfu: 16.35 Tflops/s, 362.556 iter/s, 2.758e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.601 Tflops/s, hfu: 29.601 Tflops/s, 656.391 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.228 Tflops/s, hfu: 14.228 Tflops/s, 315.505 iter/s, 3.170e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 100.779 Tflops/s, hfu: 100.779 Tflops/s, 1117.358 iter/s, 8.950e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 98.355 Tflops/s, hfu: 98.355 Tflops/s, 1090.474 iter/s, 9.170e-04 s/iter, (0.130, 0.000, 0.004) sec
mfu: 98.647 Tflops/s, hfu: 98.647 Tflops/s, 1093.719 iter/s, 9.143e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 110.62 Tflops/s, hfu: 110.62 Tflops/s, 1226.464 iter/s, 8.154e-04 s/iter, (0.082, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 120.969 Tflops/s, hfu: 120.969 Tflops/s, 1341.202 iter/s, 7.456e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 91.741 Tflops/s, hfu: 91.741 Tflops/s, 1017.145 iter/s, 9.831e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.841 Tflops/s, hfu: 110.841 Tflops/s, 1228.912 iter/s, 8.137e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 112.166 Tflops/s, hfu: 112.166 Tflops/s, 1243.608 iter/s, 8.041e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(28672,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.827 Tflops/s, hfu: 18.827 Tflops/s, 357.835 iter/s, 2.795e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.545 Tflops/s, hfu: 34.545 Tflops/s, 656.591 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.519 Tflops/s, hfu: 16.519 Tflops/s, 313.967 iter/s, 3.185e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 108.964 Tflops/s, hfu: 108.964 Tflops/s, 1035.514 iter/s, 9.657e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 101.141 Tflops/s, hfu: 101.141 Tflops/s, 961.169 iter/s, 1.040e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 102.392 Tflops/s, hfu: 102.392 Tflops/s, 973.066 iter/s, 1.028e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 115.381 Tflops/s, hfu: 115.381 Tflops/s, 1096.501 iter/s, 9.120e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 125.778 Tflops/s, hfu: 125.778 Tflops/s, 1195.303 iter/s, 8.366e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 93.93 Tflops/s, hfu: 93.93 Tflops/s, 892.640 iter/s, 1.120e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 113.478 Tflops/s, hfu: 113.478 Tflops/s, 1078.414 iter/s, 9.273e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 113.811 Tflops/s, hfu: 113.811 Tflops/s, 1081.577 iter/s, 9.246e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(28672,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.515 Tflops/s, hfu: 21.515 Tflops/s, 357.810 iter/s, 2.795e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.395 Tflops/s, hfu: 39.395 Tflops/s, 655.171 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.879 Tflops/s, hfu: 18.879 Tflops/s, 313.975 iter/s, 3.185e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 110.616 Tflops/s, hfu: 110.616 Tflops/s, 919.814 iter/s, 1.087e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 108.896 Tflops/s, hfu: 108.896 Tflops/s, 905.508 iter/s, 1.104e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 105.362 Tflops/s, hfu: 105.362 Tflops/s, 876.123 iter/s, 1.141e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 116.858 Tflops/s, hfu: 116.858 Tflops/s, 971.719 iter/s, 1.029e-03 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 128.492 Tflops/s, hfu: 128.492 Tflops/s, 1068.458 iter/s, 9.359e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 96.516 Tflops/s, hfu: 96.516 Tflops/s, 802.568 iter/s, 1.246e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 116.478 Tflops/s, hfu: 116.478 Tflops/s, 968.557 iter/s, 1.032e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 114.85 Tflops/s, hfu: 114.85 Tflops/s, 955.022 iter/s, 1.047e-03 s/iter, (0.077, 0.001, 0.004) sec
SP=(1,8),S=(28672,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 26.785 Tflops/s, hfu: 26.785 Tflops/s, 356.369 iter/s, 2.806e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.408 Tflops/s, hfu: 49.408 Tflops/s, 657.358 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 23.677 Tflops/s, hfu: 23.677 Tflops/s, 315.019 iter/s, 3.174e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 117.687 Tflops/s, hfu: 117.687 Tflops/s, 782.889 iter/s, 1.277e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 110.474 Tflops/s, hfu: 110.474 Tflops/s, 734.909 iter/s, 1.361e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 109.539 Tflops/s, hfu: 109.539 Tflops/s, 728.684 iter/s, 1.372e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.841 Tflops/s, hfu: 123.841 Tflops/s, 823.826 iter/s, 1.214e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 133.682 Tflops/s, hfu: 133.682 Tflops/s, 889.294 iter/s, 1.124e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 99.503 Tflops/s, hfu: 99.503 Tflops/s, 661.922 iter/s, 1.511e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 120.956 Tflops/s, hfu: 120.956 Tflops/s, 804.635 iter/s, 1.243e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 119.321 Tflops/s, hfu: 119.321 Tflops/s, 793.757 iter/s, 1.260e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(28672,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.397 Tflops/s, hfu: 32.397 Tflops/s, 359.187 iter/s, 2.784e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.225 Tflops/s, hfu: 59.225 Tflops/s, 656.637 iter/s, 1.523e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 28.237 Tflops/s, hfu: 28.237 Tflops/s, 313.072 iter/s, 3.194e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 121.674 Tflops/s, hfu: 121.674 Tflops/s, 674.513 iter/s, 1.483e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 115.73 Tflops/s, hfu: 115.73 Tflops/s, 641.559 iter/s, 1.559e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 115.051 Tflops/s, hfu: 115.051 Tflops/s, 637.794 iter/s, 1.568e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 128.334 Tflops/s, hfu: 128.334 Tflops/s, 711.432 iter/s, 1.406e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 137.093 Tflops/s, hfu: 137.093 Tflops/s, 759.989 iter/s, 1.316e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 101.417 Tflops/s, hfu: 101.417 Tflops/s, 562.212 iter/s, 1.779e-03 s/iter, (0.082, 0.000, 0.007) sec
mfu: 124.261 Tflops/s, hfu: 124.261 Tflops/s, 688.853 iter/s, 1.452e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 121.539 Tflops/s, hfu: 121.539 Tflops/s, 673.760 iter/s, 1.484e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(28672,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.026 Tflops/s, hfu: 38.026 Tflops/s, 361.375 iter/s, 2.767e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.578 Tflops/s, hfu: 68.578 Tflops/s, 651.714 iter/s, 1.534e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.953 Tflops/s, hfu: 32.953 Tflops/s, 313.158 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 122.362 Tflops/s, hfu: 122.362 Tflops/s, 581.420 iter/s, 1.720e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 116.934 Tflops/s, hfu: 116.934 Tflops/s, 555.627 iter/s, 1.800e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 115.267 Tflops/s, hfu: 115.267 Tflops/s, 547.710 iter/s, 1.826e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 133.591 Tflops/s, hfu: 133.591 Tflops/s, 634.776 iter/s, 1.575e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 139.598 Tflops/s, hfu: 139.598 Tflops/s, 663.320 iter/s, 1.508e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 102.724 Tflops/s, hfu: 102.724 Tflops/s, 488.106 iter/s, 2.049e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 127.162 Tflops/s, hfu: 127.162 Tflops/s, 604.230 iter/s, 1.655e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 121.575 Tflops/s, hfu: 121.575 Tflops/s, 577.679 iter/s, 1.731e-03 s/iter, (0.081, 0.000, 0.007) sec
SP=(1,8),S=(28672,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.818 Tflops/s, hfu: 42.818 Tflops/s, 356.045 iter/s, 2.809e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 75.834 Tflops/s, hfu: 75.834 Tflops/s, 630.590 iter/s, 1.586e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 36.376 Tflops/s, hfu: 36.376 Tflops/s, 302.481 iter/s, 3.306e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 126.86 Tflops/s, hfu: 126.86 Tflops/s, 527.444 iter/s, 1.896e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 121.672 Tflops/s, hfu: 121.672 Tflops/s, 505.876 iter/s, 1.977e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 120.473 Tflops/s, hfu: 120.473 Tflops/s, 500.890 iter/s, 1.996e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 133.991 Tflops/s, hfu: 133.991 Tflops/s, 557.093 iter/s, 1.795e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 141.83 Tflops/s, hfu: 141.83 Tflops/s, 589.684 iter/s, 1.696e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 104.515 Tflops/s, hfu: 104.515 Tflops/s, 434.542 iter/s, 2.301e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 128.746 Tflops/s, hfu: 128.746 Tflops/s, 535.286 iter/s, 1.868e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 123.247 Tflops/s, hfu: 123.247 Tflops/s, 512.423 iter/s, 1.952e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(28672,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.109 Tflops/s, hfu: 54.109 Tflops/s, 359.952 iter/s, 2.778e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 95.267 Tflops/s, hfu: 95.267 Tflops/s, 633.743 iter/s, 1.578e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 45.626 Tflops/s, hfu: 45.626 Tflops/s, 303.518 iter/s, 3.295e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 126.311 Tflops/s, hfu: 126.311 Tflops/s, 420.130 iter/s, 2.380e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 123.586 Tflops/s, hfu: 123.586 Tflops/s, 411.065 iter/s, 2.433e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 121.413 Tflops/s, hfu: 121.413 Tflops/s, 403.839 iter/s, 2.476e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 140.923 Tflops/s, hfu: 140.923 Tflops/s, 468.732 iter/s, 2.133e-03 s/iter, (0.078, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 144.352 Tflops/s, hfu: 144.352 Tflops/s, 480.138 iter/s, 2.083e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 105.627 Tflops/s, hfu: 105.627 Tflops/s, 351.330 iter/s, 2.846e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 130.674 Tflops/s, hfu: 130.674 Tflops/s, 434.641 iter/s, 2.301e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 124.734 Tflops/s, hfu: 124.734 Tflops/s, 414.885 iter/s, 2.410e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(28672,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.055 Tflops/s, hfu: 61.055 Tflops/s, 338.465 iter/s, 2.955e-03 s/iter, (0.037, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 105.912 Tflops/s, hfu: 105.912 Tflops/s, 587.133 iter/s, 1.703e-03 s/iter, (0.021, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 54.474 Tflops/s, hfu: 54.474 Tflops/s, 301.983 iter/s, 3.311e-03 s/iter, (0.040, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 127.902 Tflops/s, hfu: 127.902 Tflops/s, 354.517 iter/s, 2.821e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 126.727 Tflops/s, hfu: 126.727 Tflops/s, 351.261 iter/s, 2.847e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 123.279 Tflops/s, hfu: 123.279 Tflops/s, 341.704 iter/s, 2.927e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 143.264 Tflops/s, hfu: 143.264 Tflops/s, 397.098 iter/s, 2.518e-03 s/iter, (0.084, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 146.226 Tflops/s, hfu: 146.226 Tflops/s, 405.309 iter/s, 2.467e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 106.967 Tflops/s, hfu: 106.967 Tflops/s, 296.491 iter/s, 3.373e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 133.378 Tflops/s, hfu: 133.378 Tflops/s, 369.696 iter/s, 2.705e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 126.442 Tflops/s, hfu: 126.442 Tflops/s, 350.471 iter/s, 2.853e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(28672,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.586 Tflops/s, hfu: 63.586 Tflops/s, 302.139 iter/s, 3.310e-03 s/iter, (0.041, 0.000, 0.066) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.457 Tflops/s, hfu: 112.457 Tflops/s, 534.354 iter/s, 1.871e-03 s/iter, (0.023, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 56.819 Tflops/s, hfu: 56.819 Tflops/s, 269.984 iter/s, 3.704e-03 s/iter, (0.042, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 131.996 Tflops/s, hfu: 131.996 Tflops/s, 313.598 iter/s, 3.189e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 125.384 Tflops/s, hfu: 125.384 Tflops/s, 297.889 iter/s, 3.357e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 126.882 Tflops/s, hfu: 126.882 Tflops/s, 301.449 iter/s, 3.317e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 146.771 Tflops/s, hfu: 146.771 Tflops/s, 348.701 iter/s, 2.868e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 147.237 Tflops/s, hfu: 147.237 Tflops/s, 349.810 iter/s, 2.859e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 107.676 Tflops/s, hfu: 107.676 Tflops/s, 255.819 iter/s, 3.909e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 133.841 Tflops/s, hfu: 133.841 Tflops/s, 317.982 iter/s, 3.145e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 126.741 Tflops/s, hfu: 126.741 Tflops/s, 301.113 iter/s, 3.321e-03 s/iter, (0.086, 0.000, 0.013) sec
SP=(1,8),S=(28672,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.649 Tflops/s, hfu: 64.649 Tflops/s, 268.791 iter/s, 3.720e-03 s/iter, (0.046, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.743 Tflops/s, hfu: 117.743 Tflops/s, 489.540 iter/s, 2.043e-03 s/iter, (0.026, 0.000, 0.041) sec
# stripe_flash_attn_func, fwd
mfu: 59.372 Tflops/s, hfu: 59.372 Tflops/s, 246.850 iter/s, 4.051e-03 s/iter, (0.046, 0.000, 0.081) sec
# orchestrated_attn_func
mfu: 129.843 Tflops/s, hfu: 129.843 Tflops/s, 269.924 iter/s, 3.705e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 126.508 Tflops/s, hfu: 126.508 Tflops/s, 262.990 iter/s, 3.802e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 127.066 Tflops/s, hfu: 127.066 Tflops/s, 264.151 iter/s, 3.786e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 147.408 Tflops/s, hfu: 147.408 Tflops/s, 306.439 iter/s, 3.263e-03 s/iter, (0.108, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 148.379 Tflops/s, hfu: 148.379 Tflops/s, 308.456 iter/s, 3.242e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 108.376 Tflops/s, hfu: 108.376 Tflops/s, 225.296 iter/s, 4.439e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 134.632 Tflops/s, hfu: 134.632 Tflops/s, 279.878 iter/s, 3.573e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 126.859 Tflops/s, hfu: 126.859 Tflops/s, 263.721 iter/s, 3.792e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(28672,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.772 Tflops/s, hfu: 66.772 Tflops/s, 222.095 iter/s, 4.503e-03 s/iter, (0.054, 0.000, 0.090) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 120.353 Tflops/s, hfu: 120.353 Tflops/s, 400.312 iter/s, 2.498e-03 s/iter, (0.031, 0.000, 0.050) sec
# stripe_flash_attn_func, fwd
mfu: 62.503 Tflops/s, hfu: 62.503 Tflops/s, 207.895 iter/s, 4.810e-03 s/iter, (0.054, 0.000, 0.096) sec
# orchestrated_attn_func
mfu: 130.639 Tflops/s, hfu: 130.639 Tflops/s, 217.262 iter/s, 4.603e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 127.863 Tflops/s, hfu: 127.863 Tflops/s, 212.646 iter/s, 4.703e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 128.791 Tflops/s, hfu: 128.791 Tflops/s, 214.190 iter/s, 4.669e-03 s/iter, (0.088, 0.000, 0.019) sec
mfu: 149.303 Tflops/s, hfu: 149.303 Tflops/s, 248.303 iter/s, 4.027e-03 s/iter, (0.088, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 150.381 Tflops/s, hfu: 150.381 Tflops/s, 250.095 iter/s, 3.998e-03 s/iter, (0.088, 0.000, 0.016) sec
mfu: 109.149 Tflops/s, hfu: 109.149 Tflops/s, 181.524 iter/s, 5.509e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 136.102 Tflops/s, hfu: 136.102 Tflops/s, 226.348 iter/s, 4.418e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 127.622 Tflops/s, hfu: 127.622 Tflops/s, 212.245 iter/s, 4.712e-03 s/iter, (0.090, 0.000, 0.019) sec
SP=(1,8),S=(28672,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.618 Tflops/s, hfu: 68.618 Tflops/s, 190.195 iter/s, 5.258e-03 s/iter, (0.062, 0.000, 0.105) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.095 Tflops/s, hfu: 119.095 Tflops/s, 330.107 iter/s, 3.029e-03 s/iter, (0.036, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 65.525 Tflops/s, hfu: 65.525 Tflops/s, 181.623 iter/s, 5.506e-03 s/iter, (0.062, 0.000, 0.110) sec
# orchestrated_attn_func
mfu: 135.713 Tflops/s, hfu: 135.713 Tflops/s, 188.084 iter/s, 5.317e-03 s/iter, (0.092, 0.000, 0.021) sec
mfu: 128.949 Tflops/s, hfu: 128.949 Tflops/s, 178.710 iter/s, 5.596e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 130.365 Tflops/s, hfu: 130.365 Tflops/s, 180.672 iter/s, 5.535e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 152.077 Tflops/s, hfu: 152.077 Tflops/s, 210.763 iter/s, 4.745e-03 s/iter, (0.088, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 151.433 Tflops/s, hfu: 151.433 Tflops/s, 209.870 iter/s, 4.765e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 110.118 Tflops/s, hfu: 110.118 Tflops/s, 152.612 iter/s, 6.553e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 137.445 Tflops/s, hfu: 137.445 Tflops/s, 190.485 iter/s, 5.250e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 128.429 Tflops/s, hfu: 128.429 Tflops/s, 177.989 iter/s, 5.618e-03 s/iter, (0.095, 0.000, 0.022) sec
SP=(1,8),S=(28672,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.68 Tflops/s, hfu: 69.68 Tflops/s, 165.548 iter/s, 6.041e-03 s/iter, (0.070, 0.000, 0.121) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.152 Tflops/s, hfu: 117.152 Tflops/s, 278.332 iter/s, 3.593e-03 s/iter, (0.040, 0.000, 0.072) sec
# stripe_flash_attn_func, fwd
mfu: 67.197 Tflops/s, hfu: 67.197 Tflops/s, 159.647 iter/s, 6.264e-03 s/iter, (0.070, 0.000, 0.125) sec
# orchestrated_attn_func
mfu: 135.769 Tflops/s, hfu: 135.769 Tflops/s, 161.282 iter/s, 6.200e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 128.866 Tflops/s, hfu: 128.866 Tflops/s, 153.081 iter/s, 6.532e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 130.795 Tflops/s, hfu: 130.795 Tflops/s, 155.373 iter/s, 6.436e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 154.035 Tflops/s, hfu: 154.035 Tflops/s, 182.980 iter/s, 5.465e-03 s/iter, (0.091, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 151.905 Tflops/s, hfu: 151.905 Tflops/s, 180.450 iter/s, 5.542e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 110.631 Tflops/s, hfu: 110.631 Tflops/s, 131.420 iter/s, 7.609e-03 s/iter, (0.101, 0.000, 0.030) sec
mfu: 137.743 Tflops/s, hfu: 137.743 Tflops/s, 163.627 iter/s, 6.111e-03 s/iter, (0.095, 0.000, 0.024) sec
mfu: 127.983 Tflops/s, hfu: 127.983 Tflops/s, 152.033 iter/s, 6.578e-03 s/iter, (0.097, 0.000, 0.026) sec
SP=(1,8),S=(28672,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.399 Tflops/s, hfu: 70.399 Tflops/s, 146.348 iter/s, 6.833e-03 s/iter, (0.078, 0.000, 0.137) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.223 Tflops/s, hfu: 119.223 Tflops/s, 247.846 iter/s, 4.035e-03 s/iter, (0.044, 0.000, 0.081) sec
# stripe_flash_attn_func, fwd
mfu: 67.786 Tflops/s, hfu: 67.786 Tflops/s, 140.917 iter/s, 7.096e-03 s/iter, (0.079, 0.000, 0.142) sec
# orchestrated_attn_func
mfu: 133.959 Tflops/s, hfu: 133.959 Tflops/s, 139.240 iter/s, 7.182e-03 s/iter, (0.106, 0.000, 0.029) sec
mfu: 131.004 Tflops/s, hfu: 131.004 Tflops/s, 136.168 iter/s, 7.344e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 131.4 Tflops/s, hfu: 131.4 Tflops/s, 136.580 iter/s, 7.322e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 154.449 Tflops/s, hfu: 154.449 Tflops/s, 160.537 iter/s, 6.229e-03 s/iter, (0.098, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 152.615 Tflops/s, hfu: 152.615 Tflops/s, 158.631 iter/s, 6.304e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 110.937 Tflops/s, hfu: 110.937 Tflops/s, 115.311 iter/s, 8.672e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 138.41 Tflops/s, hfu: 138.41 Tflops/s, 143.867 iter/s, 6.951e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 128.85 Tflops/s, hfu: 128.85 Tflops/s, 133.929 iter/s, 7.467e-03 s/iter, (0.101, 0.000, 0.030) sec
SP=(1,8),S=(32768,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 0.797 Tflops/s, hfu: 0.797 Tflops/s, 371.057 iter/s, 2.695e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.415 Tflops/s, hfu: 1.415 Tflops/s, 658.995 iter/s, 1.517e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.668 Tflops/s, hfu: 0.668 Tflops/s, 311.102 iter/s, 3.214e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 11.37 Tflops/s, hfu: 11.37 Tflops/s, 2647.183 iter/s, 3.778e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 14.794 Tflops/s, hfu: 14.794 Tflops/s, 3444.475 iter/s, 2.903e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 16.616 Tflops/s, hfu: 16.616 Tflops/s, 3868.771 iter/s, 2.585e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 18.869 Tflops/s, hfu: 18.869 Tflops/s, 4393.364 iter/s, 2.276e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 20.704 Tflops/s, hfu: 20.704 Tflops/s, 4820.485 iter/s, 2.074e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 20.954 Tflops/s, hfu: 20.954 Tflops/s, 4878.620 iter/s, 2.050e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 23.525 Tflops/s, hfu: 23.525 Tflops/s, 5477.411 iter/s, 1.826e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 42.187 Tflops/s, hfu: 42.187 Tflops/s, 9822.411 iter/s, 1.018e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(32768,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.574 Tflops/s, hfu: 1.574 Tflops/s, 366.438 iter/s, 2.729e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.808 Tflops/s, hfu: 2.808 Tflops/s, 653.833 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.342 Tflops/s, hfu: 1.342 Tflops/s, 312.399 iter/s, 3.201e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 21.657 Tflops/s, hfu: 21.657 Tflops/s, 2521.229 iter/s, 3.966e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 27.473 Tflops/s, hfu: 27.473 Tflops/s, 3198.322 iter/s, 3.127e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 30.323 Tflops/s, hfu: 30.323 Tflops/s, 3530.076 iter/s, 2.833e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 33.642 Tflops/s, hfu: 33.642 Tflops/s, 3916.408 iter/s, 2.553e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 37.131 Tflops/s, hfu: 37.131 Tflops/s, 4322.567 iter/s, 2.313e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.939 Tflops/s, hfu: 35.939 Tflops/s, 4183.820 iter/s, 2.390e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 39.846 Tflops/s, hfu: 39.846 Tflops/s, 4638.736 iter/s, 2.156e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 65.793 Tflops/s, hfu: 65.793 Tflops/s, 7659.314 iter/s, 1.306e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.357 Tflops/s, hfu: 2.357 Tflops/s, 365.930 iter/s, 2.733e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.174 Tflops/s, hfu: 4.174 Tflops/s, 647.864 iter/s, 1.544e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.008 Tflops/s, hfu: 2.008 Tflops/s, 311.710 iter/s, 3.208e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 30.913 Tflops/s, hfu: 30.913 Tflops/s, 2399.186 iter/s, 4.168e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 35.394 Tflops/s, hfu: 35.394 Tflops/s, 2746.951 iter/s, 3.640e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 37.631 Tflops/s, hfu: 37.631 Tflops/s, 2920.561 iter/s, 3.424e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 46.726 Tflops/s, hfu: 46.726 Tflops/s, 3626.447 iter/s, 2.758e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 50.069 Tflops/s, hfu: 50.069 Tflops/s, 3885.849 iter/s, 2.573e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 46.505 Tflops/s, hfu: 46.505 Tflops/s, 3609.275 iter/s, 2.771e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 53.82 Tflops/s, hfu: 53.82 Tflops/s, 4176.970 iter/s, 2.394e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 74.455 Tflops/s, hfu: 74.455 Tflops/s, 5778.476 iter/s, 1.731e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.14 Tflops/s, hfu: 3.14 Tflops/s, 365.553 iter/s, 2.736e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.554 Tflops/s, hfu: 5.554 Tflops/s, 646.571 iter/s, 1.547e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.674 Tflops/s, hfu: 2.674 Tflops/s, 311.256 iter/s, 3.213e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 37.458 Tflops/s, hfu: 37.458 Tflops/s, 2180.359 iter/s, 4.586e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 44.327 Tflops/s, hfu: 44.327 Tflops/s, 2580.192 iter/s, 3.876e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 46.106 Tflops/s, hfu: 46.106 Tflops/s, 2683.728 iter/s, 3.726e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 55.584 Tflops/s, hfu: 55.584 Tflops/s, 3235.408 iter/s, 3.091e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 60.941 Tflops/s, hfu: 60.941 Tflops/s, 3547.206 iter/s, 2.819e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 55.766 Tflops/s, hfu: 55.766 Tflops/s, 3245.995 iter/s, 3.081e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 58.46 Tflops/s, hfu: 58.46 Tflops/s, 3402.842 iter/s, 2.939e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 81.94 Tflops/s, hfu: 81.94 Tflops/s, 4769.536 iter/s, 2.097e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.931 Tflops/s, hfu: 3.931 Tflops/s, 366.113 iter/s, 2.731e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.919 Tflops/s, hfu: 6.919 Tflops/s, 644.370 iter/s, 1.552e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.318 Tflops/s, hfu: 3.318 Tflops/s, 308.984 iter/s, 3.236e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 45.733 Tflops/s, hfu: 45.733 Tflops/s, 2129.617 iter/s, 4.696e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 52.249 Tflops/s, hfu: 52.249 Tflops/s, 2433.043 iter/s, 4.110e-04 s/iter, (0.079, 0.000, 0.002) sec
mfu: 55.601 Tflops/s, hfu: 55.601 Tflops/s, 2589.118 iter/s, 3.862e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 63.243 Tflops/s, hfu: 63.243 Tflops/s, 2944.988 iter/s, 3.396e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 70.097 Tflops/s, hfu: 70.097 Tflops/s, 3264.134 iter/s, 3.064e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 60.183 Tflops/s, hfu: 60.183 Tflops/s, 2802.502 iter/s, 3.568e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 65.65 Tflops/s, hfu: 65.65 Tflops/s, 3057.057 iter/s, 3.271e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 90.306 Tflops/s, hfu: 90.306 Tflops/s, 4205.214 iter/s, 2.378e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.702 Tflops/s, hfu: 4.702 Tflops/s, 364.898 iter/s, 2.740e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.474 Tflops/s, hfu: 8.474 Tflops/s, 657.677 iter/s, 1.521e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.097 Tflops/s, hfu: 4.097 Tflops/s, 317.932 iter/s, 3.145e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 52.276 Tflops/s, hfu: 52.276 Tflops/s, 2028.562 iter/s, 4.930e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 54.969 Tflops/s, hfu: 54.969 Tflops/s, 2133.069 iter/s, 4.688e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 56.996 Tflops/s, hfu: 56.996 Tflops/s, 2211.724 iter/s, 4.521e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 70.502 Tflops/s, hfu: 70.502 Tflops/s, 2735.828 iter/s, 3.655e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 78.02 Tflops/s, hfu: 78.02 Tflops/s, 3027.587 iter/s, 3.303e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 66.454 Tflops/s, hfu: 66.454 Tflops/s, 2578.755 iter/s, 3.878e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 72.765 Tflops/s, hfu: 72.765 Tflops/s, 2823.646 iter/s, 3.542e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 95.148 Tflops/s, hfu: 95.148 Tflops/s, 3692.217 iter/s, 2.708e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.483 Tflops/s, hfu: 5.483 Tflops/s, 364.736 iter/s, 2.742e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.849 Tflops/s, hfu: 9.849 Tflops/s, 655.201 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 4.765 Tflops/s, hfu: 4.765 Tflops/s, 316.969 iter/s, 3.155e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 57.416 Tflops/s, hfu: 57.416 Tflops/s, 1909.738 iter/s, 5.236e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 61.667 Tflops/s, hfu: 61.667 Tflops/s, 2051.131 iter/s, 4.875e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 62.974 Tflops/s, hfu: 62.974 Tflops/s, 2094.609 iter/s, 4.774e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 75.189 Tflops/s, hfu: 75.189 Tflops/s, 2500.900 iter/s, 3.999e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 86.478 Tflops/s, hfu: 86.478 Tflops/s, 2876.406 iter/s, 3.477e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 70.991 Tflops/s, hfu: 70.991 Tflops/s, 2361.253 iter/s, 4.235e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 79.663 Tflops/s, hfu: 79.663 Tflops/s, 2649.708 iter/s, 3.774e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 99.663 Tflops/s, hfu: 99.663 Tflops/s, 3314.946 iter/s, 3.017e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(32768,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.236 Tflops/s, hfu: 6.236 Tflops/s, 362.986 iter/s, 2.755e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.004 Tflops/s, hfu: 11.004 Tflops/s, 640.528 iter/s, 1.561e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.362 Tflops/s, hfu: 5.362 Tflops/s, 312.135 iter/s, 3.204e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 65.393 Tflops/s, hfu: 65.393 Tflops/s, 1903.196 iter/s, 5.254e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 66.275 Tflops/s, hfu: 66.275 Tflops/s, 1928.863 iter/s, 5.184e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 68.368 Tflops/s, hfu: 68.368 Tflops/s, 1989.780 iter/s, 5.026e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 78.154 Tflops/s, hfu: 78.154 Tflops/s, 2274.588 iter/s, 4.396e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 89.587 Tflops/s, hfu: 89.587 Tflops/s, 2607.317 iter/s, 3.835e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 74.639 Tflops/s, hfu: 74.639 Tflops/s, 2172.289 iter/s, 4.603e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 82.394 Tflops/s, hfu: 82.394 Tflops/s, 2397.989 iter/s, 4.170e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.977 Tflops/s, hfu: 101.977 Tflops/s, 2967.923 iter/s, 3.369e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(32768,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.722 Tflops/s, hfu: 7.722 Tflops/s, 359.600 iter/s, 2.781e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.965 Tflops/s, hfu: 13.965 Tflops/s, 650.285 iter/s, 1.538e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.659 Tflops/s, hfu: 6.659 Tflops/s, 310.105 iter/s, 3.225e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 74.066 Tflops/s, hfu: 74.066 Tflops/s, 1724.495 iter/s, 5.799e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 72.188 Tflops/s, hfu: 72.188 Tflops/s, 1680.763 iter/s, 5.950e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 73.205 Tflops/s, hfu: 73.205 Tflops/s, 1704.437 iter/s, 5.867e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.466 Tflops/s, hfu: 90.466 Tflops/s, 2106.327 iter/s, 4.748e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 101.337 Tflops/s, hfu: 101.337 Tflops/s, 2359.425 iter/s, 4.238e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 82.279 Tflops/s, hfu: 82.279 Tflops/s, 1915.709 iter/s, 5.220e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.895 Tflops/s, hfu: 90.895 Tflops/s, 2116.313 iter/s, 4.725e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 106.223 Tflops/s, hfu: 106.223 Tflops/s, 2473.191 iter/s, 4.043e-04 s/iter, (0.074, 0.000, 0.002) sec
SP=(1,8),S=(32768,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.279 Tflops/s, hfu: 9.279 Tflops/s, 360.086 iter/s, 2.777e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.724 Tflops/s, hfu: 16.724 Tflops/s, 648.977 iter/s, 1.541e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.964 Tflops/s, hfu: 7.964 Tflops/s, 309.046 iter/s, 3.236e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 76.761 Tflops/s, hfu: 76.761 Tflops/s, 1489.354 iter/s, 6.714e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 76.32 Tflops/s, hfu: 76.32 Tflops/s, 1480.797 iter/s, 6.753e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 74.378 Tflops/s, hfu: 74.378 Tflops/s, 1443.118 iter/s, 6.929e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 99.029 Tflops/s, hfu: 99.029 Tflops/s, 1921.421 iter/s, 5.204e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 109.318 Tflops/s, hfu: 109.318 Tflops/s, 2121.053 iter/s, 4.715e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 86.362 Tflops/s, hfu: 86.362 Tflops/s, 1675.648 iter/s, 5.968e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 99.173 Tflops/s, hfu: 99.173 Tflops/s, 1924.202 iter/s, 5.197e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 111.409 Tflops/s, hfu: 111.409 Tflops/s, 2161.620 iter/s, 4.626e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(32768,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.784 Tflops/s, hfu: 10.784 Tflops/s, 358.688 iter/s, 2.788e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.539 Tflops/s, hfu: 19.539 Tflops/s, 649.882 iter/s, 1.539e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.237 Tflops/s, hfu: 9.237 Tflops/s, 307.249 iter/s, 3.255e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 85.986 Tflops/s, hfu: 85.986 Tflops/s, 1430.010 iter/s, 6.993e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 83.083 Tflops/s, hfu: 83.083 Tflops/s, 1381.735 iter/s, 7.237e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 80.052 Tflops/s, hfu: 80.052 Tflops/s, 1331.331 iter/s, 7.511e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 102.424 Tflops/s, hfu: 102.424 Tflops/s, 1703.392 iter/s, 5.871e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 116.095 Tflops/s, hfu: 116.095 Tflops/s, 1930.740 iter/s, 5.179e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 91.243 Tflops/s, hfu: 91.243 Tflops/s, 1517.432 iter/s, 6.590e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 103.619 Tflops/s, hfu: 103.619 Tflops/s, 1723.259 iter/s, 5.803e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 112.498 Tflops/s, hfu: 112.498 Tflops/s, 1870.921 iter/s, 5.345e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(32768,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.076 Tflops/s, hfu: 12.076 Tflops/s, 351.447 iter/s, 2.845e-03 s/iter, (0.037, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.221 Tflops/s, hfu: 22.221 Tflops/s, 646.730 iter/s, 1.546e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.592 Tflops/s, hfu: 10.592 Tflops/s, 308.263 iter/s, 3.244e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 87.599 Tflops/s, hfu: 87.599 Tflops/s, 1274.730 iter/s, 7.845e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 80.854 Tflops/s, hfu: 80.854 Tflops/s, 1176.581 iter/s, 8.499e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 81.412 Tflops/s, hfu: 81.412 Tflops/s, 1184.699 iter/s, 8.441e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.453 Tflops/s, hfu: 108.453 Tflops/s, 1578.203 iter/s, 6.336e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 120.593 Tflops/s, hfu: 120.593 Tflops/s, 1754.854 iter/s, 5.698e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 94.769 Tflops/s, hfu: 94.769 Tflops/s, 1379.067 iter/s, 7.251e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.527 Tflops/s, hfu: 108.527 Tflops/s, 1579.280 iter/s, 6.332e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 109.029 Tflops/s, hfu: 109.029 Tflops/s, 1586.576 iter/s, 6.303e-04 s/iter, (0.075, 0.000, 0.003) sec
SP=(1,8),S=(32768,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.556 Tflops/s, hfu: 15.556 Tflops/s, 362.195 iter/s, 2.761e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.897 Tflops/s, hfu: 27.897 Tflops/s, 649.524 iter/s, 1.540e-03 s/iter, (0.022, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.46 Tflops/s, hfu: 13.46 Tflops/s, 313.394 iter/s, 3.191e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 91.734 Tflops/s, hfu: 91.734 Tflops/s, 1067.920 iter/s, 9.364e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 90.046 Tflops/s, hfu: 90.046 Tflops/s, 1048.271 iter/s, 9.540e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 84.67 Tflops/s, hfu: 84.67 Tflops/s, 985.688 iter/s, 1.015e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 113.328 Tflops/s, hfu: 113.328 Tflops/s, 1319.317 iter/s, 7.580e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 128.633 Tflops/s, hfu: 128.633 Tflops/s, 1497.490 iter/s, 6.678e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 100.857 Tflops/s, hfu: 100.857 Tflops/s, 1174.128 iter/s, 8.517e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 113.607 Tflops/s, hfu: 113.607 Tflops/s, 1322.555 iter/s, 7.561e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 111.969 Tflops/s, hfu: 111.969 Tflops/s, 1303.495 iter/s, 7.672e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(32768,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.463 Tflops/s, hfu: 18.463 Tflops/s, 358.227 iter/s, 2.792e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.186 Tflops/s, hfu: 33.186 Tflops/s, 643.901 iter/s, 1.553e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.089 Tflops/s, hfu: 16.089 Tflops/s, 312.161 iter/s, 3.203e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 93.353 Tflops/s, hfu: 93.353 Tflops/s, 905.646 iter/s, 1.104e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 89.046 Tflops/s, hfu: 89.046 Tflops/s, 863.856 iter/s, 1.158e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 87.088 Tflops/s, hfu: 87.088 Tflops/s, 844.863 iter/s, 1.184e-03 s/iter, (0.073, 0.000, 0.005) sec
mfu: 118.919 Tflops/s, hfu: 118.919 Tflops/s, 1153.669 iter/s, 8.668e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 135.17 Tflops/s, hfu: 135.17 Tflops/s, 1311.317 iter/s, 7.626e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.405 Tflops/s, hfu: 104.405 Tflops/s, 1012.859 iter/s, 9.873e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 117.557 Tflops/s, hfu: 117.557 Tflops/s, 1140.449 iter/s, 8.768e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 116.302 Tflops/s, hfu: 116.302 Tflops/s, 1128.281 iter/s, 8.863e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(32768,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.486 Tflops/s, hfu: 21.486 Tflops/s, 357.333 iter/s, 2.799e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.136 Tflops/s, hfu: 39.136 Tflops/s, 650.855 iter/s, 1.536e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.684 Tflops/s, hfu: 18.684 Tflops/s, 310.725 iter/s, 3.218e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 95.693 Tflops/s, hfu: 95.693 Tflops/s, 795.722 iter/s, 1.257e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 91.626 Tflops/s, hfu: 91.626 Tflops/s, 761.907 iter/s, 1.312e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 90.803 Tflops/s, hfu: 90.803 Tflops/s, 755.063 iter/s, 1.324e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 123.632 Tflops/s, hfu: 123.632 Tflops/s, 1028.045 iter/s, 9.727e-04 s/iter, (0.075, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 139.892 Tflops/s, hfu: 139.892 Tflops/s, 1163.256 iter/s, 8.597e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 107.707 Tflops/s, hfu: 107.707 Tflops/s, 895.621 iter/s, 1.117e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 121.574 Tflops/s, hfu: 121.574 Tflops/s, 1010.934 iter/s, 9.892e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 117.034 Tflops/s, hfu: 117.034 Tflops/s, 973.179 iter/s, 1.028e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(32768,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.554 Tflops/s, hfu: 24.554 Tflops/s, 357.313 iter/s, 2.799e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.408 Tflops/s, hfu: 44.408 Tflops/s, 646.227 iter/s, 1.547e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.291 Tflops/s, hfu: 21.291 Tflops/s, 309.823 iter/s, 3.228e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 96.467 Tflops/s, hfu: 96.467 Tflops/s, 701.892 iter/s, 1.425e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 89.741 Tflops/s, hfu: 89.741 Tflops/s, 652.949 iter/s, 1.532e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 87.909 Tflops/s, hfu: 87.909 Tflops/s, 639.622 iter/s, 1.563e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 124.656 Tflops/s, hfu: 124.656 Tflops/s, 906.993 iter/s, 1.103e-03 s/iter, (0.075, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 144.533 Tflops/s, hfu: 144.533 Tflops/s, 1051.613 iter/s, 9.509e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 109.996 Tflops/s, hfu: 109.996 Tflops/s, 800.328 iter/s, 1.249e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.786 Tflops/s, hfu: 123.786 Tflops/s, 900.661 iter/s, 1.110e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 118.723 Tflops/s, hfu: 118.723 Tflops/s, 863.826 iter/s, 1.158e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(32768,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.681 Tflops/s, hfu: 30.681 Tflops/s, 357.176 iter/s, 2.800e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.415 Tflops/s, hfu: 55.415 Tflops/s, 645.119 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.589 Tflops/s, hfu: 26.589 Tflops/s, 309.531 iter/s, 3.231e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 99.324 Tflops/s, hfu: 99.324 Tflops/s, 578.139 iter/s, 1.730e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 94.414 Tflops/s, hfu: 94.414 Tflops/s, 549.559 iter/s, 1.820e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 94.163 Tflops/s, hfu: 94.163 Tflops/s, 548.099 iter/s, 1.824e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 131.524 Tflops/s, hfu: 131.524 Tflops/s, 765.570 iter/s, 1.306e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 150.286 Tflops/s, hfu: 150.286 Tflops/s, 874.780 iter/s, 1.143e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 113.179 Tflops/s, hfu: 113.179 Tflops/s, 658.786 iter/s, 1.518e-03 s/iter, (0.084, 0.000, 0.006) sec
mfu: 128.044 Tflops/s, hfu: 128.044 Tflops/s, 745.316 iter/s, 1.342e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 121.208 Tflops/s, hfu: 121.208 Tflops/s, 705.525 iter/s, 1.417e-03 s/iter, (0.078, 0.000, 0.006) sec
SP=(1,8),S=(32768,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.793 Tflops/s, hfu: 36.793 Tflops/s, 356.939 iter/s, 2.802e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 66.566 Tflops/s, hfu: 66.566 Tflops/s, 645.779 iter/s, 1.549e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 31.709 Tflops/s, hfu: 31.709 Tflops/s, 307.622 iter/s, 3.251e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 97.725 Tflops/s, hfu: 97.725 Tflops/s, 474.031 iter/s, 2.110e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 96.325 Tflops/s, hfu: 96.325 Tflops/s, 467.236 iter/s, 2.140e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 95.413 Tflops/s, hfu: 95.413 Tflops/s, 462.814 iter/s, 2.161e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 136.205 Tflops/s, hfu: 136.205 Tflops/s, 660.683 iter/s, 1.514e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 154.377 Tflops/s, hfu: 154.377 Tflops/s, 748.826 iter/s, 1.335e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 116.177 Tflops/s, hfu: 116.177 Tflops/s, 563.533 iter/s, 1.775e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.163 Tflops/s, hfu: 131.163 Tflops/s, 636.223 iter/s, 1.572e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 123.931 Tflops/s, hfu: 123.931 Tflops/s, 601.147 iter/s, 1.663e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(32768,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.118 Tflops/s, hfu: 43.118 Tflops/s, 358.544 iter/s, 2.789e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 77.694 Tflops/s, hfu: 77.694 Tflops/s, 646.058 iter/s, 1.548e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 37.39 Tflops/s, hfu: 37.39 Tflops/s, 310.914 iter/s, 3.216e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 104.873 Tflops/s, hfu: 104.873 Tflops/s, 436.029 iter/s, 2.293e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 99.61 Tflops/s, hfu: 99.61 Tflops/s, 414.149 iter/s, 2.415e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 96.409 Tflops/s, hfu: 96.409 Tflops/s, 400.839 iter/s, 2.495e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 139.367 Tflops/s, hfu: 139.367 Tflops/s, 579.447 iter/s, 1.726e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 156.93 Tflops/s, hfu: 156.93 Tflops/s, 652.466 iter/s, 1.533e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 117.483 Tflops/s, hfu: 117.483 Tflops/s, 488.459 iter/s, 2.047e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 132.989 Tflops/s, hfu: 132.989 Tflops/s, 552.926 iter/s, 1.809e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 124.421 Tflops/s, hfu: 124.421 Tflops/s, 517.303 iter/s, 1.933e-03 s/iter, (0.080, 0.000, 0.008) sec
SP=(1,8),S=(32768,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.892 Tflops/s, hfu: 48.892 Tflops/s, 355.733 iter/s, 2.811e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.552 Tflops/s, hfu: 88.552 Tflops/s, 644.301 iter/s, 1.552e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 42.49 Tflops/s, hfu: 42.49 Tflops/s, 309.156 iter/s, 3.235e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 98.526 Tflops/s, hfu: 98.526 Tflops/s, 358.436 iter/s, 2.790e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 96.677 Tflops/s, hfu: 96.677 Tflops/s, 351.710 iter/s, 2.843e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 97.291 Tflops/s, hfu: 97.291 Tflops/s, 353.943 iter/s, 2.825e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 142.725 Tflops/s, hfu: 142.725 Tflops/s, 519.230 iter/s, 1.926e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 160.379 Tflops/s, hfu: 160.379 Tflops/s, 583.455 iter/s, 1.714e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 119.226 Tflops/s, hfu: 119.226 Tflops/s, 433.740 iter/s, 2.306e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 135.119 Tflops/s, hfu: 135.119 Tflops/s, 491.561 iter/s, 2.034e-03 s/iter, (0.082, 0.000, 0.008) sec
mfu: 125.816 Tflops/s, hfu: 125.816 Tflops/s, 457.715 iter/s, 2.185e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(32768,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.135 Tflops/s, hfu: 61.135 Tflops/s, 355.855 iter/s, 2.810e-03 s/iter, (0.039, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 105.424 Tflops/s, hfu: 105.424 Tflops/s, 613.646 iter/s, 1.630e-03 s/iter, (0.020, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 49.896 Tflops/s, hfu: 49.896 Tflops/s, 290.430 iter/s, 3.443e-03 s/iter, (0.039, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 101.738 Tflops/s, hfu: 101.738 Tflops/s, 296.098 iter/s, 3.377e-03 s/iter, (0.082, 0.000, 0.014) sec
mfu: 100.505 Tflops/s, hfu: 100.505 Tflops/s, 292.509 iter/s, 3.419e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 98.828 Tflops/s, hfu: 98.828 Tflops/s, 287.628 iter/s, 3.477e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 144.659 Tflops/s, hfu: 144.659 Tflops/s, 421.013 iter/s, 2.375e-03 s/iter, (0.082, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 163.404 Tflops/s, hfu: 163.404 Tflops/s, 475.567 iter/s, 2.103e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 120.963 Tflops/s, hfu: 120.963 Tflops/s, 352.049 iter/s, 2.841e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 137.061 Tflops/s, hfu: 137.061 Tflops/s, 398.901 iter/s, 2.507e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 126.758 Tflops/s, hfu: 126.758 Tflops/s, 368.915 iter/s, 2.711e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(32768,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.292 Tflops/s, hfu: 64.292 Tflops/s, 311.858 iter/s, 3.207e-03 s/iter, (0.040, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.64 Tflops/s, hfu: 112.64 Tflops/s, 546.375 iter/s, 1.830e-03 s/iter, (0.023, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 53.415 Tflops/s, hfu: 53.415 Tflops/s, 259.096 iter/s, 3.860e-03 s/iter, (0.040, 0.000, 0.077) sec
# orchestrated_attn_func
mfu: 104.148 Tflops/s, hfu: 104.148 Tflops/s, 252.593 iter/s, 3.959e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 97.944 Tflops/s, hfu: 97.944 Tflops/s, 237.546 iter/s, 4.210e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 98.452 Tflops/s, hfu: 98.452 Tflops/s, 238.777 iter/s, 4.188e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 148.431 Tflops/s, hfu: 148.431 Tflops/s, 359.992 iter/s, 2.778e-03 s/iter, (0.084, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 165.779 Tflops/s, hfu: 165.779 Tflops/s, 402.066 iter/s, 2.487e-03 s/iter, (0.205, 0.000, 0.010) sec
mfu: 122.049 Tflops/s, hfu: 122.049 Tflops/s, 296.009 iter/s, 3.378e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 139.097 Tflops/s, hfu: 139.097 Tflops/s, 337.354 iter/s, 2.964e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 128.222 Tflops/s, hfu: 128.222 Tflops/s, 310.979 iter/s, 3.216e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(32768,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.658 Tflops/s, hfu: 67.658 Tflops/s, 281.300 iter/s, 3.555e-03 s/iter, (0.046, 0.000, 0.071) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.132 Tflops/s, hfu: 115.132 Tflops/s, 478.682 iter/s, 2.089e-03 s/iter, (0.026, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 55.64 Tflops/s, hfu: 55.64 Tflops/s, 231.333 iter/s, 4.323e-03 s/iter, (0.048, 0.000, 0.086) sec
# orchestrated_attn_func
mfu: 105.098 Tflops/s, hfu: 105.098 Tflops/s, 218.483 iter/s, 4.577e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 96.561 Tflops/s, hfu: 96.561 Tflops/s, 200.735 iter/s, 4.982e-03 s/iter, (0.093, 0.000, 0.020) sec
mfu: 99.734 Tflops/s, hfu: 99.734 Tflops/s, 207.331 iter/s, 4.823e-03 s/iter, (0.088, 0.000, 0.019) sec
mfu: 150.186 Tflops/s, hfu: 150.186 Tflops/s, 312.214 iter/s, 3.203e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 167.091 Tflops/s, hfu: 167.091 Tflops/s, 347.355 iter/s, 2.879e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 123.152 Tflops/s, hfu: 123.152 Tflops/s, 256.015 iter/s, 3.906e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 140.033 Tflops/s, hfu: 140.033 Tflops/s, 291.107 iter/s, 3.435e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 128.768 Tflops/s, hfu: 128.768 Tflops/s, 267.688 iter/s, 3.736e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(32768,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.727 Tflops/s, hfu: 68.727 Tflops/s, 250.026 iter/s, 4.000e-03 s/iter, (0.057, 0.000, 0.080) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 120.854 Tflops/s, hfu: 120.854 Tflops/s, 439.664 iter/s, 2.274e-03 s/iter, (0.028, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 58.686 Tflops/s, hfu: 58.686 Tflops/s, 213.497 iter/s, 4.684e-03 s/iter, (0.053, 0.000, 0.094) sec
# orchestrated_attn_func
mfu: 107.158 Tflops/s, hfu: 107.158 Tflops/s, 194.919 iter/s, 5.130e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 98.855 Tflops/s, hfu: 98.855 Tflops/s, 179.817 iter/s, 5.561e-03 s/iter, (0.095, 0.000, 0.022) sec
mfu: 100.698 Tflops/s, hfu: 100.698 Tflops/s, 183.169 iter/s, 5.459e-03 s/iter, (0.095, 0.000, 0.022) sec
mfu: 148.848 Tflops/s, hfu: 148.848 Tflops/s, 270.752 iter/s, 3.693e-03 s/iter, (0.085, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 168.61 Tflops/s, hfu: 168.61 Tflops/s, 306.700 iter/s, 3.261e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 123.755 Tflops/s, hfu: 123.755 Tflops/s, 225.109 iter/s, 4.442e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 140.409 Tflops/s, hfu: 140.409 Tflops/s, 255.402 iter/s, 3.915e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 128.13 Tflops/s, hfu: 128.13 Tflops/s, 233.068 iter/s, 4.291e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(32768,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.819 Tflops/s, hfu: 69.819 Tflops/s, 203.200 iter/s, 4.921e-03 s/iter, (0.059, 0.000, 0.098) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 122.802 Tflops/s, hfu: 122.802 Tflops/s, 357.402 iter/s, 2.798e-03 s/iter, (0.035, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 61.74 Tflops/s, hfu: 61.74 Tflops/s, 179.686 iter/s, 5.565e-03 s/iter, (0.061, 0.000, 0.111) sec
# orchestrated_attn_func
mfu: 107.507 Tflops/s, hfu: 107.507 Tflops/s, 156.443 iter/s, 6.392e-03 s/iter, (0.098, 0.000, 0.026) sec
mfu: 99.394 Tflops/s, hfu: 99.394 Tflops/s, 144.638 iter/s, 6.914e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 100.075 Tflops/s, hfu: 100.075 Tflops/s, 145.629 iter/s, 6.867e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 151.404 Tflops/s, hfu: 151.404 Tflops/s, 220.322 iter/s, 4.539e-03 s/iter, (0.088, 0.000, 0.018) sec
# orchestrated_attn_func fused
mfu: 170.611 Tflops/s, hfu: 170.611 Tflops/s, 248.272 iter/s, 4.028e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 124.817 Tflops/s, hfu: 124.817 Tflops/s, 181.632 iter/s, 5.506e-03 s/iter, (0.096, 0.000, 0.022) sec
mfu: 142.197 Tflops/s, hfu: 142.197 Tflops/s, 206.923 iter/s, 4.833e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 128.976 Tflops/s, hfu: 128.976 Tflops/s, 187.684 iter/s, 5.328e-03 s/iter, (0.092, 0.000, 0.021) sec
SP=(1,8),S=(32768,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.485 Tflops/s, hfu: 71.485 Tflops/s, 173.373 iter/s, 5.768e-03 s/iter, (0.069, 0.000, 0.115) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.635 Tflops/s, hfu: 124.635 Tflops/s, 302.279 iter/s, 3.308e-03 s/iter, (0.039, 0.000, 0.066) sec
# stripe_flash_attn_func, fwd
mfu: 64.281 Tflops/s, hfu: 64.281 Tflops/s, 155.901 iter/s, 6.414e-03 s/iter, (0.069, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 101.282 Tflops/s, hfu: 101.282 Tflops/s, 122.821 iter/s, 8.142e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 100.007 Tflops/s, hfu: 100.007 Tflops/s, 121.274 iter/s, 8.246e-03 s/iter, (0.105, 0.000, 0.033) sec
mfu: 101.256 Tflops/s, hfu: 101.256 Tflops/s, 122.789 iter/s, 8.144e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 151.044 Tflops/s, hfu: 151.044 Tflops/s, 183.165 iter/s, 5.460e-03 s/iter, (0.092, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 172.252 Tflops/s, hfu: 172.252 Tflops/s, 208.883 iter/s, 4.787e-03 s/iter, (0.092, 0.000, 0.019) sec
mfu: 125.524 Tflops/s, hfu: 125.524 Tflops/s, 152.217 iter/s, 6.570e-03 s/iter, (0.100, 0.000, 0.026) sec
mfu: 143.06 Tflops/s, hfu: 143.06 Tflops/s, 173.483 iter/s, 5.764e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 129.73 Tflops/s, hfu: 129.73 Tflops/s, 157.319 iter/s, 6.357e-03 s/iter, (0.096, 0.000, 0.025) sec
SP=(1,8),S=(32768,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.906 Tflops/s, hfu: 72.906 Tflops/s, 151.559 iter/s, 6.598e-03 s/iter, (0.079, 0.000, 0.132) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.494 Tflops/s, hfu: 123.494 Tflops/s, 256.725 iter/s, 3.895e-03 s/iter, (0.045, 0.000, 0.078) sec
# stripe_flash_attn_func, fwd
mfu: 65.885 Tflops/s, hfu: 65.885 Tflops/s, 136.964 iter/s, 7.301e-03 s/iter, (0.079, 0.000, 0.146) sec
# orchestrated_attn_func
mfu: 103.446 Tflops/s, hfu: 103.446 Tflops/s, 107.524 iter/s, 9.300e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 101.819 Tflops/s, hfu: 101.819 Tflops/s, 105.833 iter/s, 9.449e-03 s/iter, (0.113, 0.000, 0.038) sec
mfu: 100.339 Tflops/s, hfu: 100.339 Tflops/s, 104.294 iter/s, 9.588e-03 s/iter, (0.111, 0.000, 0.038) sec
mfu: 153.637 Tflops/s, hfu: 153.637 Tflops/s, 159.694 iter/s, 6.262e-03 s/iter, (0.098, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 172.792 Tflops/s, hfu: 172.792 Tflops/s, 179.604 iter/s, 5.568e-03 s/iter, (0.096, 0.000, 0.022) sec
mfu: 126.242 Tflops/s, hfu: 126.242 Tflops/s, 131.218 iter/s, 7.621e-03 s/iter, (0.103, 0.000, 0.030) sec
mfu: 143.612 Tflops/s, hfu: 143.612 Tflops/s, 149.273 iter/s, 6.699e-03 s/iter, (0.101, 0.000, 0.027) sec
mfu: 129.544 Tflops/s, hfu: 129.544 Tflops/s, 134.651 iter/s, 7.427e-03 s/iter, (0.101, 0.000, 0.030) sec
SP=(1,8),S=(32768,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.085 Tflops/s, hfu: 74.085 Tflops/s, 134.760 iter/s, 7.421e-03 s/iter, (0.087, 0.000, 0.148) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.93 Tflops/s, hfu: 123.93 Tflops/s, 225.427 iter/s, 4.436e-03 s/iter, (0.051, 0.000, 0.089) sec
# stripe_flash_attn_func, fwd
mfu: 67.623 Tflops/s, hfu: 67.623 Tflops/s, 123.006 iter/s, 8.130e-03 s/iter, (0.091, 0.000, 0.163) sec
# orchestrated_attn_func
mfu: 100.797 Tflops/s, hfu: 100.797 Tflops/s, 91.674 iter/s, 1.091e-02 s/iter, (0.116, 0.000, 0.044) sec
mfu: 101.477 Tflops/s, hfu: 101.477 Tflops/s, 92.293 iter/s, 1.084e-02 s/iter, (0.118, 0.000, 0.043) sec
mfu: 100.692 Tflops/s, hfu: 100.692 Tflops/s, 91.579 iter/s, 1.092e-02 s/iter, (0.116, 0.000, 0.044) sec
mfu: 152.33 Tflops/s, hfu: 152.33 Tflops/s, 138.543 iter/s, 7.218e-03 s/iter, (0.099, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 173.339 Tflops/s, hfu: 173.339 Tflops/s, 157.651 iter/s, 6.343e-03 s/iter, (0.097, 0.000, 0.025) sec
mfu: 126.86 Tflops/s, hfu: 126.86 Tflops/s, 115.379 iter/s, 8.667e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 144.098 Tflops/s, hfu: 144.098 Tflops/s, 131.057 iter/s, 7.630e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 130.109 Tflops/s, hfu: 130.109 Tflops/s, 118.334 iter/s, 8.451e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(40960,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.001 Tflops/s, hfu: 1.001 Tflops/s, 372.885 iter/s, 2.682e-03 s/iter, (0.031, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 1.794 Tflops/s, hfu: 1.794 Tflops/s, 668.282 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 0.852 Tflops/s, hfu: 0.852 Tflops/s, 317.356 iter/s, 3.151e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 13.65 Tflops/s, hfu: 13.65 Tflops/s, 2542.511 iter/s, 3.933e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 18.398 Tflops/s, hfu: 18.398 Tflops/s, 3426.911 iter/s, 2.918e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 20.372 Tflops/s, hfu: 20.372 Tflops/s, 3794.663 iter/s, 2.635e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 23.058 Tflops/s, hfu: 23.058 Tflops/s, 4294.942 iter/s, 2.328e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 23.15 Tflops/s, hfu: 23.15 Tflops/s, 4311.980 iter/s, 2.319e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 26.188 Tflops/s, hfu: 26.188 Tflops/s, 4877.859 iter/s, 2.050e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.688 Tflops/s, hfu: 26.688 Tflops/s, 4970.969 iter/s, 2.012e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 45.261 Tflops/s, hfu: 45.261 Tflops/s, 8430.566 iter/s, 1.186e-04 s/iter, (0.072, 0.000, 0.000) sec
SP=(1,8),S=(40960,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.992 Tflops/s, hfu: 1.992 Tflops/s, 371.049 iter/s, 2.695e-03 s/iter, (0.031, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.614 Tflops/s, hfu: 3.614 Tflops/s, 673.157 iter/s, 1.486e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.715 Tflops/s, hfu: 1.715 Tflops/s, 319.416 iter/s, 3.131e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 26.652 Tflops/s, hfu: 26.652 Tflops/s, 2482.129 iter/s, 4.029e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 32.307 Tflops/s, hfu: 32.307 Tflops/s, 3008.786 iter/s, 3.324e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 36.597 Tflops/s, hfu: 36.597 Tflops/s, 3408.316 iter/s, 2.934e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 40.426 Tflops/s, hfu: 40.426 Tflops/s, 3764.947 iter/s, 2.656e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 42.568 Tflops/s, hfu: 42.568 Tflops/s, 3964.478 iter/s, 2.522e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 44.069 Tflops/s, hfu: 44.069 Tflops/s, 4104.282 iter/s, 2.436e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 47.29 Tflops/s, hfu: 47.29 Tflops/s, 4404.200 iter/s, 2.271e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 74.69 Tflops/s, hfu: 74.69 Tflops/s, 6956.038 iter/s, 1.438e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(40960,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.965 Tflops/s, hfu: 2.965 Tflops/s, 368.225 iter/s, 2.716e-03 s/iter, (0.031, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.364 Tflops/s, hfu: 5.364 Tflops/s, 666.064 iter/s, 1.501e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.555 Tflops/s, hfu: 2.555 Tflops/s, 317.217 iter/s, 3.152e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 37.73 Tflops/s, hfu: 37.73 Tflops/s, 2342.579 iter/s, 4.269e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 43.461 Tflops/s, hfu: 43.461 Tflops/s, 2698.385 iter/s, 3.706e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 48.803 Tflops/s, hfu: 48.803 Tflops/s, 3030.083 iter/s, 3.300e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 54.398 Tflops/s, hfu: 54.398 Tflops/s, 3377.466 iter/s, 2.961e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 58.675 Tflops/s, hfu: 58.675 Tflops/s, 3643.041 iter/s, 2.745e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 58.31 Tflops/s, hfu: 58.31 Tflops/s, 3620.355 iter/s, 2.762e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 61.14 Tflops/s, hfu: 61.14 Tflops/s, 3796.046 iter/s, 2.634e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 85.547 Tflops/s, hfu: 85.547 Tflops/s, 5311.464 iter/s, 1.883e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(40960,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.934 Tflops/s, hfu: 3.934 Tflops/s, 366.382 iter/s, 2.729e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.1 Tflops/s, hfu: 7.1 Tflops/s, 661.223 iter/s, 1.512e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.388 Tflops/s, hfu: 3.388 Tflops/s, 315.494 iter/s, 3.170e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 35.788 Tflops/s, hfu: 35.788 Tflops/s, 1666.489 iter/s, 6.001e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 41.335 Tflops/s, hfu: 41.335 Tflops/s, 1924.824 iter/s, 5.195e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 43.553 Tflops/s, hfu: 43.553 Tflops/s, 2028.101 iter/s, 4.931e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 47.662 Tflops/s, hfu: 47.662 Tflops/s, 2219.421 iter/s, 4.506e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 72.191 Tflops/s, hfu: 72.191 Tflops/s, 3361.661 iter/s, 2.975e-04 s/iter, (0.078, 0.000, 0.001) sec
mfu: 67.169 Tflops/s, hfu: 67.169 Tflops/s, 3127.815 iter/s, 3.197e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 66.491 Tflops/s, hfu: 66.491 Tflops/s, 3096.205 iter/s, 3.230e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 92.398 Tflops/s, hfu: 92.398 Tflops/s, 4302.630 iter/s, 2.324e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(40960,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.85 Tflops/s, hfu: 4.85 Tflops/s, 361.374 iter/s, 2.767e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.952 Tflops/s, hfu: 8.952 Tflops/s, 666.969 iter/s, 1.499e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.281 Tflops/s, hfu: 4.281 Tflops/s, 318.973 iter/s, 3.135e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 45.639 Tflops/s, hfu: 45.639 Tflops/s, 1700.194 iter/s, 5.882e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 55.771 Tflops/s, hfu: 55.771 Tflops/s, 2077.620 iter/s, 4.813e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 57.453 Tflops/s, hfu: 57.453 Tflops/s, 2140.301 iter/s, 4.672e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.043 Tflops/s, hfu: 64.043 Tflops/s, 2385.769 iter/s, 4.192e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.993 Tflops/s, hfu: 83.993 Tflops/s, 3128.990 iter/s, 3.196e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 73.526 Tflops/s, hfu: 73.526 Tflops/s, 2739.066 iter/s, 3.651e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 74.685 Tflops/s, hfu: 74.685 Tflops/s, 2782.229 iter/s, 3.594e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 101.431 Tflops/s, hfu: 101.431 Tflops/s, 3778.604 iter/s, 2.646e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(40960,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.862 Tflops/s, hfu: 5.862 Tflops/s, 363.945 iter/s, 2.748e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.533 Tflops/s, hfu: 10.533 Tflops/s, 653.950 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.064 Tflops/s, hfu: 5.064 Tflops/s, 314.414 iter/s, 3.181e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 41.964 Tflops/s, hfu: 41.964 Tflops/s, 1302.721 iter/s, 7.676e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 43.997 Tflops/s, hfu: 43.997 Tflops/s, 1365.852 iter/s, 7.321e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 44.661 Tflops/s, hfu: 44.661 Tflops/s, 1386.470 iter/s, 7.213e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 48.625 Tflops/s, hfu: 48.625 Tflops/s, 1509.516 iter/s, 6.625e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 91.4 Tflops/s, hfu: 91.4 Tflops/s, 2837.427 iter/s, 3.524e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.729 Tflops/s, hfu: 79.729 Tflops/s, 2475.100 iter/s, 4.040e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 83.201 Tflops/s, hfu: 83.201 Tflops/s, 2582.912 iter/s, 3.872e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 108.223 Tflops/s, hfu: 108.223 Tflops/s, 3359.673 iter/s, 2.976e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(40960,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.828 Tflops/s, hfu: 6.828 Tflops/s, 363.373 iter/s, 2.752e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.223 Tflops/s, hfu: 12.223 Tflops/s, 650.502 iter/s, 1.537e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.885 Tflops/s, hfu: 5.885 Tflops/s, 313.195 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 60.072 Tflops/s, hfu: 60.072 Tflops/s, 1598.465 iter/s, 6.256e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 70.502 Tflops/s, hfu: 70.502 Tflops/s, 1876.004 iter/s, 5.330e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 71.607 Tflops/s, hfu: 71.607 Tflops/s, 1905.401 iter/s, 5.248e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 77.715 Tflops/s, hfu: 77.715 Tflops/s, 2067.927 iter/s, 4.836e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 99.754 Tflops/s, hfu: 99.754 Tflops/s, 2654.379 iter/s, 3.767e-04 s/iter, (0.074, 0.001, 0.002) sec
mfu: 88.406 Tflops/s, hfu: 88.406 Tflops/s, 2352.410 iter/s, 4.251e-04 s/iter, (0.079, 0.000, 0.002) sec
mfu: 88.765 Tflops/s, hfu: 88.765 Tflops/s, 2361.967 iter/s, 4.234e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 112.799 Tflops/s, hfu: 112.799 Tflops/s, 3001.489 iter/s, 3.332e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(40960,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.812 Tflops/s, hfu: 7.812 Tflops/s, 363.790 iter/s, 2.749e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.034 Tflops/s, hfu: 14.034 Tflops/s, 653.497 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.783 Tflops/s, hfu: 6.783 Tflops/s, 315.879 iter/s, 3.166e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 59.455 Tflops/s, hfu: 59.455 Tflops/s, 1384.290 iter/s, 7.224e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 67.55 Tflops/s, hfu: 67.55 Tflops/s, 1572.782 iter/s, 6.358e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 69.57 Tflops/s, hfu: 69.57 Tflops/s, 1619.800 iter/s, 6.174e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 75.248 Tflops/s, hfu: 75.248 Tflops/s, 1752.001 iter/s, 5.708e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 107.777 Tflops/s, hfu: 107.777 Tflops/s, 2509.385 iter/s, 3.985e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 92.671 Tflops/s, hfu: 92.671 Tflops/s, 2157.665 iter/s, 4.635e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 94.395 Tflops/s, hfu: 94.395 Tflops/s, 2197.802 iter/s, 4.550e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.116 Tflops/s, hfu: 114.116 Tflops/s, 2656.974 iter/s, 3.764e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(40960,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.668 Tflops/s, hfu: 9.668 Tflops/s, 360.168 iter/s, 2.776e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.939 Tflops/s, hfu: 17.939 Tflops/s, 668.298 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.491 Tflops/s, hfu: 8.491 Tflops/s, 316.318 iter/s, 3.161e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 81.52 Tflops/s, hfu: 81.52 Tflops/s, 1518.428 iter/s, 6.586e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 79.762 Tflops/s, hfu: 79.762 Tflops/s, 1485.690 iter/s, 6.731e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 82.094 Tflops/s, hfu: 82.094 Tflops/s, 1529.127 iter/s, 6.540e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.624 Tflops/s, hfu: 93.624 Tflops/s, 1743.886 iter/s, 5.734e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 121.735 Tflops/s, hfu: 121.735 Tflops/s, 2267.491 iter/s, 4.410e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 101.26 Tflops/s, hfu: 101.26 Tflops/s, 1886.109 iter/s, 5.302e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 105.048 Tflops/s, hfu: 105.048 Tflops/s, 1956.671 iter/s, 5.111e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 115.879 Tflops/s, hfu: 115.879 Tflops/s, 2158.410 iter/s, 4.633e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(40960,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.526 Tflops/s, hfu: 11.526 Tflops/s, 357.802 iter/s, 2.795e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.365 Tflops/s, hfu: 21.365 Tflops/s, 663.257 iter/s, 1.508e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 10.11 Tflops/s, hfu: 10.11 Tflops/s, 313.864 iter/s, 3.186e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 87.974 Tflops/s, hfu: 87.974 Tflops/s, 1365.538 iter/s, 7.323e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 89.279 Tflops/s, hfu: 89.279 Tflops/s, 1385.794 iter/s, 7.216e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 89.194 Tflops/s, hfu: 89.194 Tflops/s, 1384.474 iter/s, 7.223e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 100.315 Tflops/s, hfu: 100.315 Tflops/s, 1557.089 iter/s, 6.422e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 130.638 Tflops/s, hfu: 130.638 Tflops/s, 2027.772 iter/s, 4.932e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 108.314 Tflops/s, hfu: 108.314 Tflops/s, 1681.260 iter/s, 5.948e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 111.923 Tflops/s, hfu: 111.923 Tflops/s, 1737.269 iter/s, 5.756e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 120.362 Tflops/s, hfu: 120.362 Tflops/s, 1868.265 iter/s, 5.353e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(40960,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.434 Tflops/s, hfu: 13.434 Tflops/s, 357.461 iter/s, 2.798e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.235 Tflops/s, hfu: 24.235 Tflops/s, 644.871 iter/s, 1.551e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 11.614 Tflops/s, hfu: 11.614 Tflops/s, 309.030 iter/s, 3.236e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 95.213 Tflops/s, hfu: 95.213 Tflops/s, 1266.772 iter/s, 7.894e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 96.874 Tflops/s, hfu: 96.874 Tflops/s, 1288.872 iter/s, 7.759e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 96.351 Tflops/s, hfu: 96.351 Tflops/s, 1281.907 iter/s, 7.801e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 106.427 Tflops/s, hfu: 106.427 Tflops/s, 1415.965 iter/s, 7.062e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 140.251 Tflops/s, hfu: 140.251 Tflops/s, 1865.978 iter/s, 5.359e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 113.392 Tflops/s, hfu: 113.392 Tflops/s, 1508.641 iter/s, 6.628e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 117.016 Tflops/s, hfu: 117.016 Tflops/s, 1556.856 iter/s, 6.423e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 123.758 Tflops/s, hfu: 123.758 Tflops/s, 1646.557 iter/s, 6.073e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(40960,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.296 Tflops/s, hfu: 15.296 Tflops/s, 356.145 iter/s, 2.808e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.122 Tflops/s, hfu: 28.122 Tflops/s, 654.762 iter/s, 1.527e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.39 Tflops/s, hfu: 13.39 Tflops/s, 311.760 iter/s, 3.208e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 99.462 Tflops/s, hfu: 99.462 Tflops/s, 1157.890 iter/s, 8.636e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 101.474 Tflops/s, hfu: 101.474 Tflops/s, 1181.318 iter/s, 8.465e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 99.383 Tflops/s, hfu: 99.383 Tflops/s, 1156.968 iter/s, 8.643e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 110.392 Tflops/s, hfu: 110.392 Tflops/s, 1285.136 iter/s, 7.781e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 147.915 Tflops/s, hfu: 147.915 Tflops/s, 1721.953 iter/s, 5.807e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 118.159 Tflops/s, hfu: 118.159 Tflops/s, 1375.546 iter/s, 7.270e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 121.734 Tflops/s, hfu: 121.734 Tflops/s, 1417.169 iter/s, 7.056e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 119.963 Tflops/s, hfu: 119.963 Tflops/s, 1396.554 iter/s, 7.160e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(40960,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.235 Tflops/s, hfu: 19.235 Tflops/s, 358.276 iter/s, 2.791e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.142 Tflops/s, hfu: 35.142 Tflops/s, 654.578 iter/s, 1.528e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.881 Tflops/s, hfu: 16.881 Tflops/s, 314.424 iter/s, 3.180e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 107.397 Tflops/s, hfu: 107.397 Tflops/s, 1000.216 iter/s, 9.998e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 103.321 Tflops/s, hfu: 103.321 Tflops/s, 962.249 iter/s, 1.039e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 102.509 Tflops/s, hfu: 102.509 Tflops/s, 954.694 iter/s, 1.047e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 116.457 Tflops/s, hfu: 116.457 Tflops/s, 1084.589 iter/s, 9.220e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 157.004 Tflops/s, hfu: 157.004 Tflops/s, 1462.211 iter/s, 6.839e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 124.776 Tflops/s, hfu: 124.776 Tflops/s, 1162.066 iter/s, 8.605e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 128.058 Tflops/s, hfu: 128.058 Tflops/s, 1192.634 iter/s, 8.385e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 122.261 Tflops/s, hfu: 122.261 Tflops/s, 1138.641 iter/s, 8.782e-04 s/iter, (0.073, 0.000, 0.004) sec
SP=(1,8),S=(40960,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.16 Tflops/s, hfu: 23.16 Tflops/s, 359.488 iter/s, 2.782e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.834 Tflops/s, hfu: 41.834 Tflops/s, 649.353 iter/s, 1.540e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 20.146 Tflops/s, hfu: 20.146 Tflops/s, 312.701 iter/s, 3.198e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 118.36 Tflops/s, hfu: 118.36 Tflops/s, 918.591 iter/s, 1.089e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 111.009 Tflops/s, hfu: 111.009 Tflops/s, 861.546 iter/s, 1.161e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 108.664 Tflops/s, hfu: 108.664 Tflops/s, 843.347 iter/s, 1.186e-03 s/iter, (0.075, 0.001, 0.005) sec
mfu: 124.238 Tflops/s, hfu: 124.238 Tflops/s, 964.216 iter/s, 1.037e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 165.222 Tflops/s, hfu: 165.222 Tflops/s, 1282.288 iter/s, 7.799e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 130.018 Tflops/s, hfu: 130.018 Tflops/s, 1009.074 iter/s, 9.910e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 133.107 Tflops/s, hfu: 133.107 Tflops/s, 1033.049 iter/s, 9.680e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 127.062 Tflops/s, hfu: 127.062 Tflops/s, 986.131 iter/s, 1.014e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(40960,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 26.814 Tflops/s, hfu: 26.814 Tflops/s, 356.754 iter/s, 2.803e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 47.923 Tflops/s, hfu: 47.923 Tflops/s, 637.597 iter/s, 1.568e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 22.913 Tflops/s, hfu: 22.913 Tflops/s, 304.849 iter/s, 3.280e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 120.9 Tflops/s, hfu: 120.9 Tflops/s, 804.262 iter/s, 1.243e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 116.858 Tflops/s, hfu: 116.858 Tflops/s, 777.378 iter/s, 1.286e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 115.159 Tflops/s, hfu: 115.159 Tflops/s, 766.072 iter/s, 1.305e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 131.448 Tflops/s, hfu: 131.448 Tflops/s, 874.432 iter/s, 1.144e-03 s/iter, (0.077, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 171.006 Tflops/s, hfu: 171.006 Tflops/s, 1137.584 iter/s, 8.791e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 133.666 Tflops/s, hfu: 133.666 Tflops/s, 889.186 iter/s, 1.125e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 136.888 Tflops/s, hfu: 136.888 Tflops/s, 910.621 iter/s, 1.098e-03 s/iter, (0.093, 0.000, 0.004) sec
mfu: 128.727 Tflops/s, hfu: 128.727 Tflops/s, 856.334 iter/s, 1.168e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(40960,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.493 Tflops/s, hfu: 30.493 Tflops/s, 354.989 iter/s, 2.817e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 54.595 Tflops/s, hfu: 54.595 Tflops/s, 635.573 iter/s, 1.573e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 25.988 Tflops/s, hfu: 25.988 Tflops/s, 302.541 iter/s, 3.305e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 121.784 Tflops/s, hfu: 121.784 Tflops/s, 708.878 iter/s, 1.411e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 114.82 Tflops/s, hfu: 114.82 Tflops/s, 668.342 iter/s, 1.496e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 114.212 Tflops/s, hfu: 114.212 Tflops/s, 664.802 iter/s, 1.504e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 131.965 Tflops/s, hfu: 131.965 Tflops/s, 768.139 iter/s, 1.302e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 175.891 Tflops/s, hfu: 175.891 Tflops/s, 1023.818 iter/s, 9.767e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 136.621 Tflops/s, hfu: 136.621 Tflops/s, 795.236 iter/s, 1.257e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 139.669 Tflops/s, hfu: 139.669 Tflops/s, 812.982 iter/s, 1.230e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 130.327 Tflops/s, hfu: 130.327 Tflops/s, 758.601 iter/s, 1.318e-03 s/iter, (0.077, 0.000, 0.005) sec
SP=(1,8),S=(40960,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.24 Tflops/s, hfu: 38.24 Tflops/s, 356.136 iter/s, 2.808e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.307 Tflops/s, hfu: 69.307 Tflops/s, 645.476 iter/s, 1.549e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 33.227 Tflops/s, hfu: 33.227 Tflops/s, 309.451 iter/s, 3.232e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 126.777 Tflops/s, hfu: 126.777 Tflops/s, 590.352 iter/s, 1.694e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 119.355 Tflops/s, hfu: 119.355 Tflops/s, 555.788 iter/s, 1.799e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 116.958 Tflops/s, hfu: 116.958 Tflops/s, 544.627 iter/s, 1.836e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 136.654 Tflops/s, hfu: 136.654 Tflops/s, 636.346 iter/s, 1.571e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 184.567 Tflops/s, hfu: 184.567 Tflops/s, 859.455 iter/s, 1.164e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 141.133 Tflops/s, hfu: 141.133 Tflops/s, 657.203 iter/s, 1.522e-03 s/iter, (0.085, 0.000, 0.006) sec
mfu: 144.612 Tflops/s, hfu: 144.612 Tflops/s, 673.401 iter/s, 1.485e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 133.296 Tflops/s, hfu: 133.296 Tflops/s, 620.708 iter/s, 1.611e-03 s/iter, (0.077, 0.000, 0.006) sec
SP=(1,8),S=(40960,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.491 Tflops/s, hfu: 45.491 Tflops/s, 353.054 iter/s, 2.832e-03 s/iter, (0.034, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 82.697 Tflops/s, hfu: 82.697 Tflops/s, 641.817 iter/s, 1.558e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 39.615 Tflops/s, hfu: 39.615 Tflops/s, 307.454 iter/s, 3.253e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 130.446 Tflops/s, hfu: 130.446 Tflops/s, 506.196 iter/s, 1.976e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 124.024 Tflops/s, hfu: 124.024 Tflops/s, 481.276 iter/s, 2.078e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 124.574 Tflops/s, hfu: 124.574 Tflops/s, 483.411 iter/s, 2.069e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 142.564 Tflops/s, hfu: 142.564 Tflops/s, 553.220 iter/s, 1.808e-03 s/iter, (0.079, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 190.482 Tflops/s, hfu: 190.482 Tflops/s, 739.168 iter/s, 1.353e-03 s/iter, (0.079, 0.000, 0.005) sec
mfu: 144.511 Tflops/s, hfu: 144.511 Tflops/s, 560.777 iter/s, 1.783e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 148.077 Tflops/s, hfu: 148.077 Tflops/s, 574.615 iter/s, 1.740e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 134.906 Tflops/s, hfu: 134.906 Tflops/s, 523.503 iter/s, 1.910e-03 s/iter, (0.081, 0.000, 0.008) sec
SP=(1,8),S=(40960,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.091 Tflops/s, hfu: 53.091 Tflops/s, 353.178 iter/s, 2.831e-03 s/iter, (0.038, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 97.167 Tflops/s, hfu: 97.167 Tflops/s, 646.381 iter/s, 1.547e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 46.737 Tflops/s, hfu: 46.737 Tflops/s, 310.910 iter/s, 3.216e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 133.231 Tflops/s, hfu: 133.231 Tflops/s, 443.146 iter/s, 2.257e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 126.342 Tflops/s, hfu: 126.342 Tflops/s, 420.232 iter/s, 2.380e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 122.882 Tflops/s, hfu: 122.882 Tflops/s, 408.724 iter/s, 2.447e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 146.558 Tflops/s, hfu: 146.558 Tflops/s, 487.474 iter/s, 2.051e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 194.418 Tflops/s, hfu: 194.418 Tflops/s, 646.663 iter/s, 1.546e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 146.279 Tflops/s, hfu: 146.279 Tflops/s, 486.546 iter/s, 2.055e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 149.446 Tflops/s, hfu: 149.446 Tflops/s, 497.081 iter/s, 2.012e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 135.522 Tflops/s, hfu: 135.522 Tflops/s, 450.766 iter/s, 2.218e-03 s/iter, (0.082, 0.000, 0.009) sec
SP=(1,8),S=(40960,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.743 Tflops/s, hfu: 60.743 Tflops/s, 353.572 iter/s, 2.828e-03 s/iter, (0.038, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 106.238 Tflops/s, hfu: 106.238 Tflops/s, 618.387 iter/s, 1.617e-03 s/iter, (0.020, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 53.223 Tflops/s, hfu: 53.223 Tflops/s, 309.797 iter/s, 3.228e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 133.607 Tflops/s, hfu: 133.607 Tflops/s, 388.847 iter/s, 2.572e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 127.505 Tflops/s, hfu: 127.505 Tflops/s, 371.088 iter/s, 2.695e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 125.76 Tflops/s, hfu: 125.76 Tflops/s, 366.011 iter/s, 2.732e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 147.855 Tflops/s, hfu: 147.855 Tflops/s, 430.315 iter/s, 2.324e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 196.991 Tflops/s, hfu: 196.991 Tflops/s, 573.318 iter/s, 1.744e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 148.525 Tflops/s, hfu: 148.525 Tflops/s, 432.266 iter/s, 2.313e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 151.991 Tflops/s, hfu: 151.991 Tflops/s, 442.351 iter/s, 2.261e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 136.507 Tflops/s, hfu: 136.507 Tflops/s, 397.288 iter/s, 2.517e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(40960,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.934 Tflops/s, hfu: 66.934 Tflops/s, 311.684 iter/s, 3.208e-03 s/iter, (0.041, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.87 Tflops/s, hfu: 116.87 Tflops/s, 544.217 iter/s, 1.838e-03 s/iter, (0.023, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 60.027 Tflops/s, hfu: 60.027 Tflops/s, 279.521 iter/s, 3.578e-03 s/iter, (0.040, 0.000, 0.072) sec
# orchestrated_attn_func
mfu: 134.109 Tflops/s, hfu: 134.109 Tflops/s, 312.248 iter/s, 3.203e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 129.695 Tflops/s, hfu: 129.695 Tflops/s, 301.969 iter/s, 3.312e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 127.011 Tflops/s, hfu: 127.011 Tflops/s, 295.719 iter/s, 3.382e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 150.185 Tflops/s, hfu: 150.185 Tflops/s, 349.678 iter/s, 2.860e-03 s/iter, (0.084, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 202.174 Tflops/s, hfu: 202.174 Tflops/s, 470.723 iter/s, 2.124e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 150.258 Tflops/s, hfu: 150.258 Tflops/s, 349.847 iter/s, 2.858e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 154.076 Tflops/s, hfu: 154.076 Tflops/s, 358.737 iter/s, 2.788e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 137.301 Tflops/s, hfu: 137.301 Tflops/s, 319.679 iter/s, 3.128e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(40960,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.299 Tflops/s, hfu: 68.299 Tflops/s, 265.036 iter/s, 3.773e-03 s/iter, (0.046, 0.000, 0.075) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.593 Tflops/s, hfu: 124.593 Tflops/s, 483.485 iter/s, 2.068e-03 s/iter, (0.026, 0.000, 0.041) sec
# stripe_flash_attn_func, fwd
mfu: 64.045 Tflops/s, hfu: 64.045 Tflops/s, 248.526 iter/s, 4.024e-03 s/iter, (0.046, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 138.477 Tflops/s, hfu: 138.477 Tflops/s, 268.681 iter/s, 3.722e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 131.655 Tflops/s, hfu: 131.655 Tflops/s, 255.445 iter/s, 3.915e-03 s/iter, (0.089, 0.000, 0.016) sec
mfu: 129.842 Tflops/s, hfu: 129.842 Tflops/s, 251.926 iter/s, 3.969e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 153.43 Tflops/s, hfu: 153.43 Tflops/s, 297.694 iter/s, 3.359e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 205.716 Tflops/s, hfu: 205.716 Tflops/s, 399.142 iter/s, 2.505e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 152.31 Tflops/s, hfu: 152.31 Tflops/s, 295.520 iter/s, 3.384e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 156.025 Tflops/s, hfu: 156.025 Tflops/s, 302.729 iter/s, 3.303e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 139.287 Tflops/s, hfu: 139.287 Tflops/s, 270.253 iter/s, 3.700e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(40960,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.143 Tflops/s, hfu: 70.143 Tflops/s, 233.308 iter/s, 4.286e-03 s/iter, (0.052, 0.000, 0.086) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 126.645 Tflops/s, hfu: 126.645 Tflops/s, 421.240 iter/s, 2.374e-03 s/iter, (0.029, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 65.437 Tflops/s, hfu: 65.437 Tflops/s, 217.654 iter/s, 4.594e-03 s/iter, (0.053, 0.000, 0.092) sec
# orchestrated_attn_func
mfu: 136.086 Tflops/s, hfu: 136.086 Tflops/s, 226.322 iter/s, 4.418e-03 s/iter, (0.090, 0.000, 0.018) sec
mfu: 130.452 Tflops/s, hfu: 130.452 Tflops/s, 216.952 iter/s, 4.609e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 130.686 Tflops/s, hfu: 130.686 Tflops/s, 217.341 iter/s, 4.601e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 155.584 Tflops/s, hfu: 155.584 Tflops/s, 258.749 iter/s, 3.865e-03 s/iter, (0.085, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 207.135 Tflops/s, hfu: 207.135 Tflops/s, 344.481 iter/s, 2.903e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 153.37 Tflops/s, hfu: 153.37 Tflops/s, 255.066 iter/s, 3.921e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 157.424 Tflops/s, hfu: 157.424 Tflops/s, 261.808 iter/s, 3.820e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 139.203 Tflops/s, hfu: 139.203 Tflops/s, 231.506 iter/s, 4.320e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(40960,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.119 Tflops/s, hfu: 71.119 Tflops/s, 206.985 iter/s, 4.831e-03 s/iter, (0.058, 0.000, 0.097) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.723 Tflops/s, hfu: 127.723 Tflops/s, 371.722 iter/s, 2.690e-03 s/iter, (0.033, 0.000, 0.054) sec
# stripe_flash_attn_func, fwd
mfu: 67.457 Tflops/s, hfu: 67.457 Tflops/s, 196.327 iter/s, 5.094e-03 s/iter, (0.057, 0.000, 0.102) sec
# orchestrated_attn_func
mfu: 138.102 Tflops/s, hfu: 138.102 Tflops/s, 200.965 iter/s, 4.976e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 133.363 Tflops/s, hfu: 133.363 Tflops/s, 194.068 iter/s, 5.153e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 130.689 Tflops/s, hfu: 130.689 Tflops/s, 190.178 iter/s, 5.258e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 157.477 Tflops/s, hfu: 157.477 Tflops/s, 229.159 iter/s, 4.364e-03 s/iter, (0.087, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 208.763 Tflops/s, hfu: 208.763 Tflops/s, 303.790 iter/s, 3.292e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 154.547 Tflops/s, hfu: 154.547 Tflops/s, 224.896 iter/s, 4.446e-03 s/iter, (0.092, 0.000, 0.018) sec
mfu: 158.0 Tflops/s, hfu: 158.0 Tflops/s, 229.920 iter/s, 4.349e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 139.032 Tflops/s, hfu: 139.032 Tflops/s, 202.318 iter/s, 4.943e-03 s/iter, (0.090, 0.000, 0.020) sec
SP=(1,8),S=(40960,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.055 Tflops/s, hfu: 72.055 Tflops/s, 167.765 iter/s, 5.961e-03 s/iter, (0.069, 0.000, 0.119) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.948 Tflops/s, hfu: 127.948 Tflops/s, 297.901 iter/s, 3.357e-03 s/iter, (0.040, 0.000, 0.067) sec
# stripe_flash_attn_func, fwd
mfu: 69.107 Tflops/s, hfu: 69.107 Tflops/s, 160.902 iter/s, 6.215e-03 s/iter, (0.069, 0.000, 0.124) sec
# orchestrated_attn_func
mfu: 135.427 Tflops/s, hfu: 135.427 Tflops/s, 157.658 iter/s, 6.343e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 131.134 Tflops/s, hfu: 131.134 Tflops/s, 152.660 iter/s, 6.551e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 131.819 Tflops/s, hfu: 131.819 Tflops/s, 153.457 iter/s, 6.516e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 158.045 Tflops/s, hfu: 158.045 Tflops/s, 183.989 iter/s, 5.435e-03 s/iter, (0.091, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 211.665 Tflops/s, hfu: 211.665 Tflops/s, 246.410 iter/s, 4.058e-03 s/iter, (0.089, 0.000, 0.016) sec
mfu: 155.773 Tflops/s, hfu: 155.773 Tflops/s, 181.344 iter/s, 5.514e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 159.78 Tflops/s, hfu: 159.78 Tflops/s, 186.009 iter/s, 5.376e-03 s/iter, (0.091, 0.000, 0.022) sec
mfu: 139.548 Tflops/s, hfu: 139.548 Tflops/s, 162.455 iter/s, 6.156e-03 s/iter, (0.098, 0.000, 0.025) sec
SP=(1,8),S=(40960,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.617 Tflops/s, hfu: 73.617 Tflops/s, 142.835 iter/s, 7.001e-03 s/iter, (0.081, 0.000, 0.140) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.089 Tflops/s, hfu: 127.089 Tflops/s, 246.585 iter/s, 4.055e-03 s/iter, (0.046, 0.000, 0.081) sec
# stripe_flash_attn_func, fwd
mfu: 71.072 Tflops/s, hfu: 71.072 Tflops/s, 137.899 iter/s, 7.252e-03 s/iter, (0.081, 0.000, 0.145) sec
# orchestrated_attn_func
mfu: 137.092 Tflops/s, hfu: 137.092 Tflops/s, 132.997 iter/s, 7.519e-03 s/iter, (0.104, 0.000, 0.030) sec
mfu: 133.297 Tflops/s, hfu: 133.297 Tflops/s, 129.316 iter/s, 7.733e-03 s/iter, (0.104, 0.000, 0.031) sec
mfu: 132.986 Tflops/s, hfu: 132.986 Tflops/s, 129.013 iter/s, 7.751e-03 s/iter, (0.103, 0.000, 0.031) sec
mfu: 159.735 Tflops/s, hfu: 159.735 Tflops/s, 154.963 iter/s, 6.453e-03 s/iter, (0.096, 0.000, 0.026) sec
# orchestrated_attn_func fused
mfu: 214.052 Tflops/s, hfu: 214.052 Tflops/s, 207.658 iter/s, 4.816e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 156.715 Tflops/s, hfu: 156.715 Tflops/s, 152.033 iter/s, 6.578e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 160.941 Tflops/s, hfu: 160.941 Tflops/s, 156.134 iter/s, 6.405e-03 s/iter, (0.103, 0.000, 0.026) sec
mfu: 140.631 Tflops/s, hfu: 140.631 Tflops/s, 136.430 iter/s, 7.330e-03 s/iter, (0.100, 0.000, 0.029) sec
SP=(1,8),S=(40960,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.832 Tflops/s, hfu: 74.832 Tflops/s, 124.452 iter/s, 8.035e-03 s/iter, (0.092, 0.000, 0.161) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 129.822 Tflops/s, hfu: 129.822 Tflops/s, 215.905 iter/s, 4.632e-03 s/iter, (0.053, 0.000, 0.093) sec
# stripe_flash_attn_func, fwd
mfu: 71.234 Tflops/s, hfu: 71.234 Tflops/s, 118.467 iter/s, 8.441e-03 s/iter, (0.093, 0.000, 0.169) sec
# orchestrated_attn_func
mfu: 141.927 Tflops/s, hfu: 141.927 Tflops/s, 118.018 iter/s, 8.473e-03 s/iter, (0.115, 0.000, 0.034) sec
mfu: 132.258 Tflops/s, hfu: 132.258 Tflops/s, 109.978 iter/s, 9.093e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 133.619 Tflops/s, hfu: 133.619 Tflops/s, 111.109 iter/s, 9.000e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 160.996 Tflops/s, hfu: 160.996 Tflops/s, 133.874 iter/s, 7.470e-03 s/iter, (0.099, 0.000, 0.030) sec
# orchestrated_attn_func fused
mfu: 214.61 Tflops/s, hfu: 214.61 Tflops/s, 178.456 iter/s, 5.604e-03 s/iter, (0.096, 0.000, 0.022) sec
mfu: 157.702 Tflops/s, hfu: 157.702 Tflops/s, 131.135 iter/s, 7.626e-03 s/iter, (0.100, 0.000, 0.031) sec
mfu: 161.277 Tflops/s, hfu: 161.277 Tflops/s, 134.108 iter/s, 7.457e-03 s/iter, (0.103, 0.000, 0.030) sec
mfu: 140.38 Tflops/s, hfu: 140.38 Tflops/s, 116.731 iter/s, 8.567e-03 s/iter, (0.108, 0.000, 0.034) sec
SP=(1,8),S=(40960,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.045 Tflops/s, hfu: 76.045 Tflops/s, 110.659 iter/s, 9.037e-03 s/iter, (0.104, 0.000, 0.181) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.859 Tflops/s, hfu: 127.859 Tflops/s, 186.060 iter/s, 5.375e-03 s/iter, (0.059, 0.000, 0.107) sec
# stripe_flash_attn_func, fwd
mfu: 72.833 Tflops/s, hfu: 72.833 Tflops/s, 105.986 iter/s, 9.435e-03 s/iter, (0.104, 0.000, 0.189) sec
# orchestrated_attn_func
mfu: 137.736 Tflops/s, hfu: 137.736 Tflops/s, 100.216 iter/s, 9.978e-03 s/iter, (0.137, 0.000, 0.040) sec
mfu: 131.434 Tflops/s, hfu: 131.434 Tflops/s, 95.631 iter/s, 1.046e-02 s/iter, (0.110, 0.000, 0.042) sec
mfu: 133.773 Tflops/s, hfu: 133.773 Tflops/s, 97.332 iter/s, 1.027e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 162.194 Tflops/s, hfu: 162.194 Tflops/s, 118.012 iter/s, 8.474e-03 s/iter, (0.104, 0.000, 0.034) sec
# orchestrated_attn_func fused
mfu: 215.658 Tflops/s, hfu: 215.658 Tflops/s, 156.912 iter/s, 6.373e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 158.41 Tflops/s, hfu: 158.41 Tflops/s, 115.258 iter/s, 8.676e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 162.29 Tflops/s, hfu: 162.29 Tflops/s, 118.081 iter/s, 8.469e-03 s/iter, (0.104, 0.000, 0.034) sec
mfu: 141.152 Tflops/s, hfu: 141.152 Tflops/s, 102.702 iter/s, 9.737e-03 s/iter, (0.111, 0.000, 0.039) sec
SP=(1,8),S=(49152,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.174 Tflops/s, hfu: 1.174 Tflops/s, 364.413 iter/s, 2.744e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.18 Tflops/s, hfu: 2.18 Tflops/s, 676.621 iter/s, 1.478e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.042 Tflops/s, hfu: 1.042 Tflops/s, 323.358 iter/s, 3.093e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 15.024 Tflops/s, hfu: 15.024 Tflops/s, 2332.090 iter/s, 4.288e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 20.207 Tflops/s, hfu: 20.207 Tflops/s, 3136.605 iter/s, 3.188e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 22.674 Tflops/s, hfu: 22.674 Tflops/s, 3519.441 iter/s, 2.841e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 26.513 Tflops/s, hfu: 26.513 Tflops/s, 4115.362 iter/s, 2.430e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 24.576 Tflops/s, hfu: 24.576 Tflops/s, 3814.697 iter/s, 2.621e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 29.215 Tflops/s, hfu: 29.215 Tflops/s, 4534.736 iter/s, 2.205e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 38.535 Tflops/s, hfu: 38.535 Tflops/s, 5981.434 iter/s, 1.672e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 57.782 Tflops/s, hfu: 57.782 Tflops/s, 8968.931 iter/s, 1.115e-04 s/iter, (0.070, 0.000, 0.000) sec
SP=(1,8),S=(49152,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.341 Tflops/s, hfu: 2.341 Tflops/s, 363.431 iter/s, 2.752e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.343 Tflops/s, hfu: 4.343 Tflops/s, 674.103 iter/s, 1.483e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.079 Tflops/s, hfu: 2.079 Tflops/s, 322.760 iter/s, 3.098e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 29.316 Tflops/s, hfu: 29.316 Tflops/s, 2275.209 iter/s, 4.395e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 34.814 Tflops/s, hfu: 34.814 Tflops/s, 2701.943 iter/s, 3.701e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 38.495 Tflops/s, hfu: 38.495 Tflops/s, 2987.572 iter/s, 3.347e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 46.586 Tflops/s, hfu: 46.586 Tflops/s, 3615.538 iter/s, 2.766e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 44.495 Tflops/s, hfu: 44.495 Tflops/s, 3453.229 iter/s, 2.896e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.417 Tflops/s, hfu: 50.417 Tflops/s, 3912.853 iter/s, 2.556e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 60.638 Tflops/s, hfu: 60.638 Tflops/s, 4706.148 iter/s, 2.125e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 83.76 Tflops/s, hfu: 83.76 Tflops/s, 6500.598 iter/s, 1.538e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(49152,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.522 Tflops/s, hfu: 3.522 Tflops/s, 364.457 iter/s, 2.744e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.056 Tflops/s, hfu: 6.056 Tflops/s, 626.666 iter/s, 1.596e-03 s/iter, (0.018, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 3.106 Tflops/s, hfu: 3.106 Tflops/s, 321.409 iter/s, 3.111e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 41.3 Tflops/s, hfu: 41.3 Tflops/s, 2136.862 iter/s, 4.680e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 46.787 Tflops/s, hfu: 46.787 Tflops/s, 2420.792 iter/s, 4.131e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 51.094 Tflops/s, hfu: 51.094 Tflops/s, 2643.600 iter/s, 3.783e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 62.023 Tflops/s, hfu: 62.023 Tflops/s, 3209.078 iter/s, 3.116e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 60.066 Tflops/s, hfu: 60.066 Tflops/s, 3107.829 iter/s, 3.218e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 67.27 Tflops/s, hfu: 67.27 Tflops/s, 3480.537 iter/s, 2.873e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 75.76 Tflops/s, hfu: 75.76 Tflops/s, 3919.847 iter/s, 2.551e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 94.571 Tflops/s, hfu: 94.571 Tflops/s, 4893.134 iter/s, 2.044e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(49152,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.676 Tflops/s, hfu: 4.676 Tflops/s, 362.915 iter/s, 2.755e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.559 Tflops/s, hfu: 8.559 Tflops/s, 664.281 iter/s, 1.505e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.15 Tflops/s, hfu: 4.15 Tflops/s, 322.052 iter/s, 3.105e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 50.529 Tflops/s, hfu: 50.529 Tflops/s, 1960.784 iter/s, 5.100e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 55.549 Tflops/s, hfu: 55.549 Tflops/s, 2155.581 iter/s, 4.639e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 57.888 Tflops/s, hfu: 57.888 Tflops/s, 2246.343 iter/s, 4.452e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 72.26 Tflops/s, hfu: 72.26 Tflops/s, 2804.074 iter/s, 3.566e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 72.89 Tflops/s, hfu: 72.89 Tflops/s, 2828.502 iter/s, 3.535e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.047 Tflops/s, hfu: 79.047 Tflops/s, 3067.410 iter/s, 3.260e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 79.356 Tflops/s, hfu: 79.356 Tflops/s, 3079.425 iter/s, 3.247e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 99.725 Tflops/s, hfu: 99.725 Tflops/s, 3869.849 iter/s, 2.584e-04 s/iter, (0.070, 0.001, 0.001) sec
SP=(1,8),S=(49152,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.835 Tflops/s, hfu: 5.835 Tflops/s, 362.304 iter/s, 2.760e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.596 Tflops/s, hfu: 10.596 Tflops/s, 657.863 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.099 Tflops/s, hfu: 5.099 Tflops/s, 316.599 iter/s, 3.159e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 60.039 Tflops/s, hfu: 60.039 Tflops/s, 1863.863 iter/s, 5.365e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.059 Tflops/s, hfu: 64.059 Tflops/s, 1988.641 iter/s, 5.029e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 64.558 Tflops/s, hfu: 64.558 Tflops/s, 2004.137 iter/s, 4.990e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 82.241 Tflops/s, hfu: 82.241 Tflops/s, 2553.105 iter/s, 3.917e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.907 Tflops/s, hfu: 83.907 Tflops/s, 2604.818 iter/s, 3.839e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 87.383 Tflops/s, hfu: 87.383 Tflops/s, 2712.732 iter/s, 3.686e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 88.204 Tflops/s, hfu: 88.204 Tflops/s, 2738.226 iter/s, 3.652e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 108.383 Tflops/s, hfu: 108.383 Tflops/s, 3364.647 iter/s, 2.972e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(49152,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.059 Tflops/s, hfu: 7.059 Tflops/s, 365.222 iter/s, 2.738e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.736 Tflops/s, hfu: 12.736 Tflops/s, 658.938 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 6.125 Tflops/s, hfu: 6.125 Tflops/s, 316.911 iter/s, 3.155e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 66.419 Tflops/s, hfu: 66.419 Tflops/s, 1718.260 iter/s, 5.820e-04 s/iter, (0.072, 0.001, 0.002) sec
mfu: 67.224 Tflops/s, hfu: 67.224 Tflops/s, 1739.082 iter/s, 5.750e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 70.424 Tflops/s, hfu: 70.424 Tflops/s, 1821.865 iter/s, 5.489e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 88.794 Tflops/s, hfu: 88.794 Tflops/s, 2297.119 iter/s, 4.353e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 93.052 Tflops/s, hfu: 93.052 Tflops/s, 2407.272 iter/s, 4.154e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 96.966 Tflops/s, hfu: 96.966 Tflops/s, 2508.529 iter/s, 3.986e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 96.79 Tflops/s, hfu: 96.79 Tflops/s, 2503.956 iter/s, 3.994e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 110.193 Tflops/s, hfu: 110.193 Tflops/s, 2850.692 iter/s, 3.508e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(49152,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.151 Tflops/s, hfu: 8.151 Tflops/s, 361.464 iter/s, 2.767e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.752 Tflops/s, hfu: 14.752 Tflops/s, 654.215 iter/s, 1.529e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.123 Tflops/s, hfu: 7.123 Tflops/s, 315.894 iter/s, 3.166e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 70.675 Tflops/s, hfu: 70.675 Tflops/s, 1567.182 iter/s, 6.381e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 73.014 Tflops/s, hfu: 73.014 Tflops/s, 1619.045 iter/s, 6.176e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 75.254 Tflops/s, hfu: 75.254 Tflops/s, 1668.713 iter/s, 5.993e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 91.036 Tflops/s, hfu: 91.036 Tflops/s, 2018.669 iter/s, 4.954e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 101.264 Tflops/s, hfu: 101.264 Tflops/s, 2245.455 iter/s, 4.453e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 101.877 Tflops/s, hfu: 101.877 Tflops/s, 2259.050 iter/s, 4.427e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 103.55 Tflops/s, hfu: 103.55 Tflops/s, 2296.148 iter/s, 4.355e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.971 Tflops/s, hfu: 114.971 Tflops/s, 2549.407 iter/s, 3.922e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(49152,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.27 Tflops/s, hfu: 9.27 Tflops/s, 359.720 iter/s, 2.780e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.74 Tflops/s, hfu: 16.74 Tflops/s, 649.580 iter/s, 1.539e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.111 Tflops/s, hfu: 8.111 Tflops/s, 314.732 iter/s, 3.177e-03 s/iter, (0.036, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 77.248 Tflops/s, hfu: 77.248 Tflops/s, 1498.801 iter/s, 6.672e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 76.077 Tflops/s, hfu: 76.077 Tflops/s, 1476.093 iter/s, 6.775e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 76.258 Tflops/s, hfu: 76.258 Tflops/s, 1479.605 iter/s, 6.759e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 96.966 Tflops/s, hfu: 96.966 Tflops/s, 1881.397 iter/s, 5.315e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 106.842 Tflops/s, hfu: 106.842 Tflops/s, 2073.003 iter/s, 4.824e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 108.7 Tflops/s, hfu: 108.7 Tflops/s, 2109.064 iter/s, 4.741e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 108.044 Tflops/s, hfu: 108.044 Tflops/s, 2096.331 iter/s, 4.770e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 118.065 Tflops/s, hfu: 118.065 Tflops/s, 2290.762 iter/s, 4.365e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(49152,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.563 Tflops/s, hfu: 11.563 Tflops/s, 358.963 iter/s, 2.786e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.188 Tflops/s, hfu: 21.188 Tflops/s, 657.760 iter/s, 1.520e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 10.131 Tflops/s, hfu: 10.131 Tflops/s, 314.518 iter/s, 3.179e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 86.349 Tflops/s, hfu: 86.349 Tflops/s, 1340.310 iter/s, 7.461e-04 s/iter, (0.079, 0.000, 0.003) sec
mfu: 80.09 Tflops/s, hfu: 80.09 Tflops/s, 1243.163 iter/s, 8.044e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 85.382 Tflops/s, hfu: 85.382 Tflops/s, 1325.304 iter/s, 7.545e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.918 Tflops/s, hfu: 108.918 Tflops/s, 1690.628 iter/s, 5.915e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 120.519 Tflops/s, hfu: 120.519 Tflops/s, 1870.697 iter/s, 5.346e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 121.146 Tflops/s, hfu: 121.146 Tflops/s, 1880.434 iter/s, 5.318e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 116.989 Tflops/s, hfu: 116.989 Tflops/s, 1815.910 iter/s, 5.507e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 121.444 Tflops/s, hfu: 121.444 Tflops/s, 1885.057 iter/s, 5.305e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(49152,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.985 Tflops/s, hfu: 13.985 Tflops/s, 361.785 iter/s, 2.764e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.423 Tflops/s, hfu: 25.423 Tflops/s, 657.682 iter/s, 1.520e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 12.068 Tflops/s, hfu: 12.068 Tflops/s, 312.209 iter/s, 3.203e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 93.026 Tflops/s, hfu: 93.026 Tflops/s, 1203.300 iter/s, 8.310e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 88.326 Tflops/s, hfu: 88.326 Tflops/s, 1142.502 iter/s, 8.753e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 83.426 Tflops/s, hfu: 83.426 Tflops/s, 1079.121 iter/s, 9.267e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 116.591 Tflops/s, hfu: 116.591 Tflops/s, 1508.114 iter/s, 6.631e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 128.628 Tflops/s, hfu: 128.628 Tflops/s, 1663.805 iter/s, 6.010e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 127.919 Tflops/s, hfu: 127.919 Tflops/s, 1654.643 iter/s, 6.044e-04 s/iter, (0.081, 0.000, 0.002) sec
mfu: 124.095 Tflops/s, hfu: 124.095 Tflops/s, 1605.178 iter/s, 6.230e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 123.584 Tflops/s, hfu: 123.584 Tflops/s, 1598.568 iter/s, 6.256e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(49152,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.231 Tflops/s, hfu: 16.231 Tflops/s, 359.913 iter/s, 2.778e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.799 Tflops/s, hfu: 29.799 Tflops/s, 660.780 iter/s, 1.513e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 13.875 Tflops/s, hfu: 13.875 Tflops/s, 307.677 iter/s, 3.250e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 95.625 Tflops/s, hfu: 95.625 Tflops/s, 1060.212 iter/s, 9.432e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 97.843 Tflops/s, hfu: 97.843 Tflops/s, 1084.806 iter/s, 9.218e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 88.118 Tflops/s, hfu: 88.118 Tflops/s, 976.975 iter/s, 1.024e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 115.186 Tflops/s, hfu: 115.186 Tflops/s, 1277.087 iter/s, 7.830e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 136.704 Tflops/s, hfu: 136.704 Tflops/s, 1515.666 iter/s, 6.598e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 134.997 Tflops/s, hfu: 134.997 Tflops/s, 1496.737 iter/s, 6.681e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 127.627 Tflops/s, hfu: 127.627 Tflops/s, 1415.019 iter/s, 7.067e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 125.964 Tflops/s, hfu: 125.964 Tflops/s, 1396.586 iter/s, 7.160e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(49152,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.471 Tflops/s, hfu: 18.471 Tflops/s, 358.380 iter/s, 2.790e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.251 Tflops/s, hfu: 33.251 Tflops/s, 645.158 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 15.822 Tflops/s, hfu: 15.822 Tflops/s, 306.986 iter/s, 3.257e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 98.758 Tflops/s, hfu: 98.758 Tflops/s, 958.075 iter/s, 1.044e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 92.742 Tflops/s, hfu: 92.742 Tflops/s, 899.721 iter/s, 1.111e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 88.482 Tflops/s, hfu: 88.482 Tflops/s, 858.387 iter/s, 1.165e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 122.212 Tflops/s, hfu: 122.212 Tflops/s, 1185.610 iter/s, 8.434e-04 s/iter, (0.074, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 141.048 Tflops/s, hfu: 141.048 Tflops/s, 1368.348 iter/s, 7.308e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 140.889 Tflops/s, hfu: 140.889 Tflops/s, 1366.807 iter/s, 7.316e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 131.228 Tflops/s, hfu: 131.228 Tflops/s, 1273.081 iter/s, 7.855e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 122.466 Tflops/s, hfu: 122.466 Tflops/s, 1188.077 iter/s, 8.417e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(49152,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.461 Tflops/s, hfu: 23.461 Tflops/s, 364.160 iter/s, 2.746e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.091 Tflops/s, hfu: 42.091 Tflops/s, 653.344 iter/s, 1.531e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 20.163 Tflops/s, hfu: 20.163 Tflops/s, 312.963 iter/s, 3.195e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 106.906 Tflops/s, hfu: 106.906 Tflops/s, 829.699 iter/s, 1.205e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 98.628 Tflops/s, hfu: 98.628 Tflops/s, 765.458 iter/s, 1.306e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 93.253 Tflops/s, hfu: 93.253 Tflops/s, 723.736 iter/s, 1.382e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 125.705 Tflops/s, hfu: 125.705 Tflops/s, 975.602 iter/s, 1.025e-03 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 150.502 Tflops/s, hfu: 150.502 Tflops/s, 1168.050 iter/s, 8.561e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 149.432 Tflops/s, hfu: 149.432 Tflops/s, 1159.748 iter/s, 8.623e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 137.201 Tflops/s, hfu: 137.201 Tflops/s, 1064.818 iter/s, 9.391e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 125.177 Tflops/s, hfu: 125.177 Tflops/s, 971.500 iter/s, 1.029e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(49152,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.968 Tflops/s, hfu: 27.968 Tflops/s, 361.765 iter/s, 2.764e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.293 Tflops/s, hfu: 50.293 Tflops/s, 650.547 iter/s, 1.537e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 23.95 Tflops/s, hfu: 23.95 Tflops/s, 309.794 iter/s, 3.228e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 113.0 Tflops/s, hfu: 113.0 Tflops/s, 730.832 iter/s, 1.368e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 101.718 Tflops/s, hfu: 101.718 Tflops/s, 657.860 iter/s, 1.520e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 102.723 Tflops/s, hfu: 102.723 Tflops/s, 664.360 iter/s, 1.505e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 135.102 Tflops/s, hfu: 135.102 Tflops/s, 873.778 iter/s, 1.144e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 157.267 Tflops/s, hfu: 157.267 Tflops/s, 1017.128 iter/s, 9.832e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 154.645 Tflops/s, hfu: 154.645 Tflops/s, 1000.168 iter/s, 9.998e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 141.584 Tflops/s, hfu: 141.584 Tflops/s, 915.697 iter/s, 1.092e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 129.118 Tflops/s, hfu: 129.118 Tflops/s, 835.076 iter/s, 1.197e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(49152,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.505 Tflops/s, hfu: 32.505 Tflops/s, 360.383 iter/s, 2.775e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.152 Tflops/s, hfu: 58.152 Tflops/s, 644.742 iter/s, 1.551e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 27.955 Tflops/s, hfu: 27.955 Tflops/s, 309.941 iter/s, 3.226e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 112.628 Tflops/s, hfu: 112.628 Tflops/s, 624.363 iter/s, 1.602e-03 s/iter, (0.080, 0.000, 0.006) sec
mfu: 110.018 Tflops/s, hfu: 110.018 Tflops/s, 609.893 iter/s, 1.640e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 97.445 Tflops/s, hfu: 97.445 Tflops/s, 540.192 iter/s, 1.851e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 137.382 Tflops/s, hfu: 137.382 Tflops/s, 761.587 iter/s, 1.313e-03 s/iter, (0.078, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 164.04 Tflops/s, hfu: 164.04 Tflops/s, 909.369 iter/s, 1.100e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 159.144 Tflops/s, hfu: 159.144 Tflops/s, 882.226 iter/s, 1.133e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 144.387 Tflops/s, hfu: 144.387 Tflops/s, 800.420 iter/s, 1.249e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 130.056 Tflops/s, hfu: 130.056 Tflops/s, 720.976 iter/s, 1.387e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(49152,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.835 Tflops/s, hfu: 36.835 Tflops/s, 357.344 iter/s, 2.798e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 65.899 Tflops/s, hfu: 65.899 Tflops/s, 639.303 iter/s, 1.564e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 31.52 Tflops/s, hfu: 31.52 Tflops/s, 305.786 iter/s, 3.270e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 116.481 Tflops/s, hfu: 116.481 Tflops/s, 565.005 iter/s, 1.770e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 119.88 Tflops/s, hfu: 119.88 Tflops/s, 581.493 iter/s, 1.720e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 107.273 Tflops/s, hfu: 107.273 Tflops/s, 520.343 iter/s, 1.922e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 138.201 Tflops/s, hfu: 138.201 Tflops/s, 670.363 iter/s, 1.492e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 168.151 Tflops/s, hfu: 168.151 Tflops/s, 815.639 iter/s, 1.226e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 163.565 Tflops/s, hfu: 163.565 Tflops/s, 793.394 iter/s, 1.260e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 146.48 Tflops/s, hfu: 146.48 Tflops/s, 710.522 iter/s, 1.407e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 131.311 Tflops/s, hfu: 131.311 Tflops/s, 636.943 iter/s, 1.570e-03 s/iter, (0.079, 0.000, 0.006) sec
SP=(1,8),S=(49152,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 46.253 Tflops/s, hfu: 46.253 Tflops/s, 358.969 iter/s, 2.786e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 82.931 Tflops/s, hfu: 82.931 Tflops/s, 643.629 iter/s, 1.554e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 39.447 Tflops/s, hfu: 39.447 Tflops/s, 306.152 iter/s, 3.266e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 124.419 Tflops/s, hfu: 124.419 Tflops/s, 482.808 iter/s, 2.071e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 117.091 Tflops/s, hfu: 117.091 Tflops/s, 454.372 iter/s, 2.201e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 108.061 Tflops/s, hfu: 108.061 Tflops/s, 419.332 iter/s, 2.385e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 144.355 Tflops/s, hfu: 144.355 Tflops/s, 560.171 iter/s, 1.785e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 174.472 Tflops/s, hfu: 174.472 Tflops/s, 677.041 iter/s, 1.477e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 168.431 Tflops/s, hfu: 168.431 Tflops/s, 653.598 iter/s, 1.530e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 150.301 Tflops/s, hfu: 150.301 Tflops/s, 583.245 iter/s, 1.715e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 133.483 Tflops/s, hfu: 133.483 Tflops/s, 517.982 iter/s, 1.931e-03 s/iter, (0.079, 0.000, 0.008) sec
SP=(1,8),S=(49152,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.917 Tflops/s, hfu: 54.917 Tflops/s, 355.174 iter/s, 2.816e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.83 Tflops/s, hfu: 99.83 Tflops/s, 645.650 iter/s, 1.549e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 47.75 Tflops/s, hfu: 47.75 Tflops/s, 308.823 iter/s, 3.238e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 123.139 Tflops/s, hfu: 123.139 Tflops/s, 398.202 iter/s, 2.511e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 115.284 Tflops/s, hfu: 115.284 Tflops/s, 372.802 iter/s, 2.682e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 106.327 Tflops/s, hfu: 106.327 Tflops/s, 343.837 iter/s, 2.908e-03 s/iter, (0.084, 0.000, 0.012) sec
mfu: 148.12 Tflops/s, hfu: 148.12 Tflops/s, 478.984 iter/s, 2.088e-03 s/iter, (0.082, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 178.687 Tflops/s, hfu: 178.687 Tflops/s, 577.832 iter/s, 1.731e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 172.316 Tflops/s, hfu: 172.316 Tflops/s, 557.227 iter/s, 1.795e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 153.633 Tflops/s, hfu: 153.633 Tflops/s, 496.810 iter/s, 2.013e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 134.952 Tflops/s, hfu: 134.952 Tflops/s, 436.404 iter/s, 2.291e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(49152,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.462 Tflops/s, hfu: 64.462 Tflops/s, 357.353 iter/s, 2.798e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 107.17 Tflops/s, hfu: 107.17 Tflops/s, 594.107 iter/s, 1.683e-03 s/iter, (0.020, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 53.332 Tflops/s, hfu: 53.332 Tflops/s, 295.649 iter/s, 3.382e-03 s/iter, (0.039, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 125.649 Tflops/s, hfu: 125.649 Tflops/s, 348.273 iter/s, 2.871e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 117.083 Tflops/s, hfu: 117.083 Tflops/s, 324.529 iter/s, 3.081e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 132.532 Tflops/s, hfu: 132.532 Tflops/s, 367.350 iter/s, 2.722e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 147.386 Tflops/s, hfu: 147.386 Tflops/s, 408.525 iter/s, 2.448e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 182.488 Tflops/s, hfu: 182.488 Tflops/s, 505.819 iter/s, 1.977e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 175.614 Tflops/s, hfu: 175.614 Tflops/s, 486.766 iter/s, 2.054e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 154.403 Tflops/s, hfu: 154.403 Tflops/s, 427.972 iter/s, 2.337e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 135.736 Tflops/s, hfu: 135.736 Tflops/s, 376.232 iter/s, 2.658e-03 s/iter, (0.085, 0.000, 0.011) sec
SP=(1,8),S=(49152,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 65.731 Tflops/s, hfu: 65.731 Tflops/s, 318.838 iter/s, 3.136e-03 s/iter, (0.039, 0.000, 0.063) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.364 Tflops/s, hfu: 112.364 Tflops/s, 545.037 iter/s, 1.835e-03 s/iter, (0.022, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 54.589 Tflops/s, hfu: 54.589 Tflops/s, 264.794 iter/s, 3.777e-03 s/iter, (0.040, 0.000, 0.076) sec
# orchestrated_attn_func
mfu: 130.139 Tflops/s, hfu: 130.139 Tflops/s, 315.628 iter/s, 3.168e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 120.496 Tflops/s, hfu: 120.496 Tflops/s, 292.241 iter/s, 3.422e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 109.39 Tflops/s, hfu: 109.39 Tflops/s, 265.305 iter/s, 3.769e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 148.545 Tflops/s, hfu: 148.545 Tflops/s, 360.269 iter/s, 2.776e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 185.006 Tflops/s, hfu: 185.006 Tflops/s, 448.698 iter/s, 2.229e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 177.452 Tflops/s, hfu: 177.452 Tflops/s, 430.379 iter/s, 2.324e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 156.13 Tflops/s, hfu: 156.13 Tflops/s, 378.665 iter/s, 2.641e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 136.543 Tflops/s, hfu: 136.543 Tflops/s, 331.159 iter/s, 3.020e-03 s/iter, (0.082, 0.000, 0.012) sec
SP=(1,8),S=(49152,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.116 Tflops/s, hfu: 69.116 Tflops/s, 268.204 iter/s, 3.729e-03 s/iter, (0.048, 0.000, 0.075) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.129 Tflops/s, hfu: 117.129 Tflops/s, 454.522 iter/s, 2.200e-03 s/iter, (0.026, 0.000, 0.044) sec
# stripe_flash_attn_func, fwd
mfu: 56.98 Tflops/s, hfu: 56.98 Tflops/s, 221.112 iter/s, 4.523e-03 s/iter, (0.047, 0.000, 0.090) sec
# orchestrated_attn_func
mfu: 134.62 Tflops/s, hfu: 134.62 Tflops/s, 261.198 iter/s, 3.829e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 127.903 Tflops/s, hfu: 127.903 Tflops/s, 248.164 iter/s, 4.030e-03 s/iter, (0.087, 0.000, 0.016) sec
mfu: 119.381 Tflops/s, hfu: 119.381 Tflops/s, 231.630 iter/s, 4.317e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 152.783 Tflops/s, hfu: 152.783 Tflops/s, 296.438 iter/s, 3.373e-03 s/iter, (0.096, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 187.568 Tflops/s, hfu: 187.568 Tflops/s, 363.931 iter/s, 2.748e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 180.218 Tflops/s, hfu: 180.218 Tflops/s, 349.669 iter/s, 2.860e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 157.605 Tflops/s, hfu: 157.605 Tflops/s, 305.795 iter/s, 3.270e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 137.356 Tflops/s, hfu: 137.356 Tflops/s, 266.506 iter/s, 3.752e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(49152,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.496 Tflops/s, hfu: 70.496 Tflops/s, 227.967 iter/s, 4.387e-03 s/iter, (0.056, 0.000, 0.088) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.413 Tflops/s, hfu: 119.413 Tflops/s, 386.152 iter/s, 2.590e-03 s/iter, (0.030, 0.000, 0.052) sec
# stripe_flash_attn_func, fwd
mfu: 60.144 Tflops/s, hfu: 60.144 Tflops/s, 194.490 iter/s, 5.142e-03 s/iter, (0.057, 0.000, 0.103) sec
# orchestrated_attn_func
mfu: 119.707 Tflops/s, hfu: 119.707 Tflops/s, 193.552 iter/s, 5.167e-03 s/iter, (0.089, 0.000, 0.021) sec
mfu: 144.165 Tflops/s, hfu: 144.165 Tflops/s, 233.097 iter/s, 4.290e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 120.567 Tflops/s, hfu: 120.567 Tflops/s, 194.942 iter/s, 5.130e-03 s/iter, (0.093, 0.000, 0.021) sec
mfu: 154.242 Tflops/s, hfu: 154.242 Tflops/s, 249.391 iter/s, 4.010e-03 s/iter, (0.086, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 190.492 Tflops/s, hfu: 190.492 Tflops/s, 308.002 iter/s, 3.247e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 182.717 Tflops/s, hfu: 182.717 Tflops/s, 295.432 iter/s, 3.385e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 159.379 Tflops/s, hfu: 159.379 Tflops/s, 257.697 iter/s, 3.881e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 138.421 Tflops/s, hfu: 138.421 Tflops/s, 223.810 iter/s, 4.468e-03 s/iter, (0.088, 0.000, 0.018) sec
SP=(1,8),S=(49152,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.697 Tflops/s, hfu: 71.697 Tflops/s, 198.729 iter/s, 5.032e-03 s/iter, (0.061, 0.000, 0.101) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.749 Tflops/s, hfu: 127.749 Tflops/s, 354.093 iter/s, 2.824e-03 s/iter, (0.034, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 63.697 Tflops/s, hfu: 63.697 Tflops/s, 176.556 iter/s, 5.664e-03 s/iter, (0.063, 0.000, 0.113) sec
# orchestrated_attn_func
mfu: 138.847 Tflops/s, hfu: 138.847 Tflops/s, 192.428 iter/s, 5.197e-03 s/iter, (0.094, 0.000, 0.021) sec
mfu: 129.431 Tflops/s, hfu: 129.431 Tflops/s, 179.378 iter/s, 5.575e-03 s/iter, (0.099, 0.000, 0.022) sec
mfu: 123.092 Tflops/s, hfu: 123.092 Tflops/s, 170.592 iter/s, 5.862e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 155.641 Tflops/s, hfu: 155.641 Tflops/s, 215.702 iter/s, 4.636e-03 s/iter, (0.088, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 192.793 Tflops/s, hfu: 192.793 Tflops/s, 267.192 iter/s, 3.743e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 183.801 Tflops/s, hfu: 183.801 Tflops/s, 254.730 iter/s, 3.926e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 160.199 Tflops/s, hfu: 160.199 Tflops/s, 222.019 iter/s, 4.504e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 138.652 Tflops/s, hfu: 138.652 Tflops/s, 192.158 iter/s, 5.204e-03 s/iter, (0.091, 0.000, 0.021) sec
SP=(1,8),S=(49152,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.025 Tflops/s, hfu: 73.025 Tflops/s, 177.110 iter/s, 5.646e-03 s/iter, (0.068, 0.000, 0.113) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 128.978 Tflops/s, hfu: 128.978 Tflops/s, 312.812 iter/s, 3.197e-03 s/iter, (0.039, 0.000, 0.064) sec
# stripe_flash_attn_func, fwd
mfu: 65.485 Tflops/s, hfu: 65.485 Tflops/s, 158.822 iter/s, 6.296e-03 s/iter, (0.068, 0.000, 0.126) sec
# orchestrated_attn_func
mfu: 139.078 Tflops/s, hfu: 139.078 Tflops/s, 168.655 iter/s, 5.929e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 153.019 Tflops/s, hfu: 153.019 Tflops/s, 185.560 iter/s, 5.389e-03 s/iter, (0.096, 0.000, 0.022) sec
mfu: 126.506 Tflops/s, hfu: 126.506 Tflops/s, 153.409 iter/s, 6.519e-03 s/iter, (0.102, 0.000, 0.026) sec
mfu: 156.457 Tflops/s, hfu: 156.457 Tflops/s, 189.729 iter/s, 5.271e-03 s/iter, (0.095, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 194.533 Tflops/s, hfu: 194.533 Tflops/s, 235.902 iter/s, 4.239e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 184.947 Tflops/s, hfu: 184.947 Tflops/s, 224.278 iter/s, 4.459e-03 s/iter, (0.098, 0.000, 0.018) sec
mfu: 160.709 Tflops/s, hfu: 160.709 Tflops/s, 194.885 iter/s, 5.131e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 138.064 Tflops/s, hfu: 138.064 Tflops/s, 167.425 iter/s, 5.973e-03 s/iter, (0.095, 0.000, 0.024) sec
SP=(1,8),S=(49152,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.331 Tflops/s, hfu: 74.331 Tflops/s, 144.221 iter/s, 6.934e-03 s/iter, (0.082, 0.000, 0.139) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 130.458 Tflops/s, hfu: 130.458 Tflops/s, 253.123 iter/s, 3.951e-03 s/iter, (0.047, 0.000, 0.079) sec
# stripe_flash_attn_func, fwd
mfu: 68.091 Tflops/s, hfu: 68.091 Tflops/s, 132.113 iter/s, 7.569e-03 s/iter, (0.084, 0.000, 0.151) sec
# orchestrated_attn_func
mfu: 123.94 Tflops/s, hfu: 123.94 Tflops/s, 120.238 iter/s, 8.317e-03 s/iter, (0.099, 0.000, 0.033) sec
mfu: 127.053 Tflops/s, hfu: 127.053 Tflops/s, 123.258 iter/s, 8.113e-03 s/iter, (0.104, 0.000, 0.032) sec
mfu: 113.187 Tflops/s, hfu: 113.187 Tflops/s, 109.806 iter/s, 9.107e-03 s/iter, (0.108, 0.000, 0.036) sec
mfu: 157.547 Tflops/s, hfu: 157.547 Tflops/s, 152.841 iter/s, 6.543e-03 s/iter, (0.099, 0.000, 0.026) sec
# orchestrated_attn_func fused
mfu: 196.327 Tflops/s, hfu: 196.327 Tflops/s, 190.462 iter/s, 5.250e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 186.49 Tflops/s, hfu: 186.49 Tflops/s, 180.919 iter/s, 5.527e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 161.656 Tflops/s, hfu: 161.656 Tflops/s, 156.827 iter/s, 6.376e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 139.02 Tflops/s, hfu: 139.02 Tflops/s, 134.867 iter/s, 7.415e-03 s/iter, (0.101, 0.000, 0.030) sec
SP=(1,8),S=(49152,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.642 Tflops/s, hfu: 75.642 Tflops/s, 122.304 iter/s, 8.176e-03 s/iter, (0.096, 0.000, 0.164) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.874 Tflops/s, hfu: 132.874 Tflops/s, 214.842 iter/s, 4.655e-03 s/iter, (0.055, 0.000, 0.093) sec
# stripe_flash_attn_func, fwd
mfu: 69.689 Tflops/s, hfu: 69.689 Tflops/s, 112.679 iter/s, 8.875e-03 s/iter, (0.099, 0.000, 0.177) sec
# orchestrated_attn_func
mfu: 142.42 Tflops/s, hfu: 142.42 Tflops/s, 115.138 iter/s, 8.685e-03 s/iter, (0.108, 0.000, 0.035) sec
mfu: 147.206 Tflops/s, hfu: 147.206 Tflops/s, 119.007 iter/s, 8.403e-03 s/iter, (0.117, 0.000, 0.034) sec
mfu: 130.6 Tflops/s, hfu: 130.6 Tflops/s, 105.582 iter/s, 9.471e-03 s/iter, (0.115, 0.000, 0.038) sec
mfu: 155.983 Tflops/s, hfu: 155.983 Tflops/s, 126.103 iter/s, 7.930e-03 s/iter, (0.102, 0.000, 0.032) sec
# orchestrated_attn_func fused
mfu: 197.449 Tflops/s, hfu: 197.449 Tflops/s, 159.626 iter/s, 6.265e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 187.703 Tflops/s, hfu: 187.703 Tflops/s, 151.747 iter/s, 6.590e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 162.797 Tflops/s, hfu: 162.797 Tflops/s, 131.612 iter/s, 7.598e-03 s/iter, (0.101, 0.000, 0.030) sec
mfu: 139.754 Tflops/s, hfu: 139.754 Tflops/s, 112.983 iter/s, 8.851e-03 s/iter, (0.106, 0.000, 0.035) sec
SP=(1,8),S=(49152,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.361 Tflops/s, hfu: 76.361 Tflops/s, 105.828 iter/s, 9.449e-03 s/iter, (0.109, 0.000, 0.189) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.547 Tflops/s, hfu: 132.547 Tflops/s, 183.696 iter/s, 5.444e-03 s/iter, (0.063, 0.000, 0.109) sec
# stripe_flash_attn_func, fwd
mfu: 71.057 Tflops/s, hfu: 71.057 Tflops/s, 98.478 iter/s, 1.015e-02 s/iter, (0.110, 0.000, 0.203) sec
# orchestrated_attn_func
mfu: 143.384 Tflops/s, hfu: 143.384 Tflops/s, 99.358 iter/s, 1.006e-02 s/iter, (0.114, 0.000, 0.040) sec
mfu: 111.119 Tflops/s, hfu: 111.119 Tflops/s, 77.000 iter/s, 1.299e-02 s/iter, (0.121, 0.000, 0.052) sec
mfu: 123.149 Tflops/s, hfu: 123.149 Tflops/s, 85.336 iter/s, 1.172e-02 s/iter, (0.120, 0.000, 0.047) sec
mfu: 158.886 Tflops/s, hfu: 158.886 Tflops/s, 110.100 iter/s, 9.083e-03 s/iter, (0.107, 0.000, 0.036) sec
# orchestrated_attn_func fused
mfu: 198.914 Tflops/s, hfu: 198.914 Tflops/s, 137.837 iter/s, 7.255e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 188.892 Tflops/s, hfu: 188.892 Tflops/s, 130.893 iter/s, 7.640e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 163.145 Tflops/s, hfu: 163.145 Tflops/s, 113.051 iter/s, 8.846e-03 s/iter, (0.109, 0.000, 0.035) sec
mfu: 139.41 Tflops/s, hfu: 139.41 Tflops/s, 96.604 iter/s, 1.035e-02 s/iter, (0.112, 0.000, 0.041) sec
SP=(1,8),S=(49152,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.486 Tflops/s, hfu: 77.486 Tflops/s, 93.964 iter/s, 1.064e-02 s/iter, (0.124, 0.000, 0.213) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.685 Tflops/s, hfu: 132.685 Tflops/s, 160.902 iter/s, 6.215e-03 s/iter, (0.071, 0.000, 0.124) sec
# stripe_flash_attn_func, fwd
mfu: 71.186 Tflops/s, hfu: 71.186 Tflops/s, 86.324 iter/s, 1.158e-02 s/iter, (0.125, 0.000, 0.232) sec
# orchestrated_attn_func
mfu: 143.186 Tflops/s, hfu: 143.186 Tflops/s, 86.818 iter/s, 1.152e-02 s/iter, (0.118, 0.000, 0.046) sec
mfu: 129.55 Tflops/s, hfu: 129.55 Tflops/s, 78.550 iter/s, 1.273e-02 s/iter, (0.119, 0.000, 0.051) sec
mfu: 127.828 Tflops/s, hfu: 127.828 Tflops/s, 77.506 iter/s, 1.290e-02 s/iter, (0.128, 0.000, 0.052) sec
mfu: 159.153 Tflops/s, hfu: 159.153 Tflops/s, 96.499 iter/s, 1.036e-02 s/iter, (0.116, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 199.73 Tflops/s, hfu: 199.73 Tflops/s, 121.102 iter/s, 8.257e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 189.657 Tflops/s, hfu: 189.657 Tflops/s, 114.995 iter/s, 8.696e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 163.471 Tflops/s, hfu: 163.471 Tflops/s, 99.117 iter/s, 1.009e-02 s/iter, (0.111, 0.000, 0.040) sec
mfu: 139.902 Tflops/s, hfu: 139.902 Tflops/s, 84.827 iter/s, 1.179e-02 s/iter, (0.121, 0.000, 0.047) sec
SP=(1,8),S=(57344,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.424 Tflops/s, hfu: 1.424 Tflops/s, 378.923 iter/s, 2.639e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.56 Tflops/s, hfu: 2.56 Tflops/s, 681.093 iter/s, 1.468e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 1.232 Tflops/s, hfu: 1.232 Tflops/s, 327.855 iter/s, 3.050e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 18.986 Tflops/s, hfu: 18.986 Tflops/s, 2526.018 iter/s, 3.959e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 29.923 Tflops/s, hfu: 29.923 Tflops/s, 3981.146 iter/s, 2.512e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 35.736 Tflops/s, hfu: 35.736 Tflops/s, 4754.479 iter/s, 2.103e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 43.066 Tflops/s, hfu: 43.066 Tflops/s, 5729.740 iter/s, 1.745e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 25.769 Tflops/s, hfu: 25.769 Tflops/s, 3428.509 iter/s, 2.917e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 30.473 Tflops/s, hfu: 30.473 Tflops/s, 4054.361 iter/s, 2.466e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 37.256 Tflops/s, hfu: 37.256 Tflops/s, 4956.777 iter/s, 2.017e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 51.014 Tflops/s, hfu: 51.014 Tflops/s, 6787.207 iter/s, 1.473e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(57344,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.779 Tflops/s, hfu: 2.779 Tflops/s, 369.721 iter/s, 2.705e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.087 Tflops/s, hfu: 5.087 Tflops/s, 676.774 iter/s, 1.478e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.394 Tflops/s, hfu: 2.394 Tflops/s, 318.493 iter/s, 3.140e-03 s/iter, (0.035, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 26.03 Tflops/s, hfu: 26.03 Tflops/s, 1731.590 iter/s, 5.775e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 33.758 Tflops/s, hfu: 33.758 Tflops/s, 2245.657 iter/s, 4.453e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 36.104 Tflops/s, hfu: 36.104 Tflops/s, 2401.768 iter/s, 4.164e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 41.034 Tflops/s, hfu: 41.034 Tflops/s, 2729.734 iter/s, 3.663e-04 s/iter, (0.075, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 45.649 Tflops/s, hfu: 45.649 Tflops/s, 3036.708 iter/s, 3.293e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 51.638 Tflops/s, hfu: 51.638 Tflops/s, 3435.104 iter/s, 2.911e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 55.393 Tflops/s, hfu: 55.393 Tflops/s, 3684.924 iter/s, 2.714e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 80.608 Tflops/s, hfu: 80.608 Tflops/s, 5362.275 iter/s, 1.865e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(57344,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.154 Tflops/s, hfu: 4.154 Tflops/s, 368.468 iter/s, 2.714e-03 s/iter, (0.036, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.528 Tflops/s, hfu: 7.528 Tflops/s, 667.675 iter/s, 1.498e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.6 Tflops/s, hfu: 3.6 Tflops/s, 319.308 iter/s, 3.132e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 37.971 Tflops/s, hfu: 37.971 Tflops/s, 1683.978 iter/s, 5.938e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 47.875 Tflops/s, hfu: 47.875 Tflops/s, 2123.178 iter/s, 4.710e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 49.968 Tflops/s, hfu: 49.968 Tflops/s, 2216.037 iter/s, 4.513e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 59.077 Tflops/s, hfu: 59.077 Tflops/s, 2619.996 iter/s, 3.817e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 61.643 Tflops/s, hfu: 61.643 Tflops/s, 2733.794 iter/s, 3.658e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 66.427 Tflops/s, hfu: 66.427 Tflops/s, 2945.959 iter/s, 3.394e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 65.413 Tflops/s, hfu: 65.413 Tflops/s, 2900.972 iter/s, 3.447e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 91.879 Tflops/s, hfu: 91.879 Tflops/s, 4074.714 iter/s, 2.454e-04 s/iter, (0.073, 0.000, 0.001) sec
SP=(1,8),S=(57344,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.518 Tflops/s, hfu: 5.518 Tflops/s, 367.091 iter/s, 2.724e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 9.928 Tflops/s, hfu: 9.928 Tflops/s, 660.432 iter/s, 1.514e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.742 Tflops/s, hfu: 4.742 Tflops/s, 315.423 iter/s, 3.170e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 47.678 Tflops/s, hfu: 47.678 Tflops/s, 1585.852 iter/s, 6.306e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 57.91 Tflops/s, hfu: 57.91 Tflops/s, 1926.159 iter/s, 5.192e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 61.67 Tflops/s, hfu: 61.67 Tflops/s, 2051.232 iter/s, 4.875e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.378 Tflops/s, hfu: 70.378 Tflops/s, 2340.868 iter/s, 4.272e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 73.964 Tflops/s, hfu: 73.964 Tflops/s, 2460.146 iter/s, 4.065e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 75.765 Tflops/s, hfu: 75.765 Tflops/s, 2520.060 iter/s, 3.968e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 69.563 Tflops/s, hfu: 69.563 Tflops/s, 2313.786 iter/s, 4.322e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 99.711 Tflops/s, hfu: 99.711 Tflops/s, 3316.530 iter/s, 3.015e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(57344,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.889 Tflops/s, hfu: 6.889 Tflops/s, 366.629 iter/s, 2.728e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.299 Tflops/s, hfu: 12.299 Tflops/s, 654.521 iter/s, 1.528e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.905 Tflops/s, hfu: 5.905 Tflops/s, 314.242 iter/s, 3.182e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 58.247 Tflops/s, hfu: 58.247 Tflops/s, 1549.907 iter/s, 6.452e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 67.303 Tflops/s, hfu: 67.303 Tflops/s, 1790.882 iter/s, 5.584e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 70.811 Tflops/s, hfu: 70.811 Tflops/s, 1884.233 iter/s, 5.307e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 77.464 Tflops/s, hfu: 77.464 Tflops/s, 2061.244 iter/s, 4.851e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 84.882 Tflops/s, hfu: 84.882 Tflops/s, 2258.642 iter/s, 4.427e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 81.306 Tflops/s, hfu: 81.306 Tflops/s, 2163.491 iter/s, 4.622e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 75.68 Tflops/s, hfu: 75.68 Tflops/s, 2013.790 iter/s, 4.966e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 106.139 Tflops/s, hfu: 106.139 Tflops/s, 2824.284 iter/s, 3.541e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(57344,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.205 Tflops/s, hfu: 8.205 Tflops/s, 363.874 iter/s, 2.748e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.712 Tflops/s, hfu: 14.712 Tflops/s, 652.470 iter/s, 1.533e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.073 Tflops/s, hfu: 7.073 Tflops/s, 313.681 iter/s, 3.188e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 64.497 Tflops/s, hfu: 64.497 Tflops/s, 1430.173 iter/s, 6.992e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 73.471 Tflops/s, hfu: 73.471 Tflops/s, 1629.174 iter/s, 6.138e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 73.535 Tflops/s, hfu: 73.535 Tflops/s, 1630.598 iter/s, 6.133e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 86.404 Tflops/s, hfu: 86.404 Tflops/s, 1915.944 iter/s, 5.219e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 93.552 Tflops/s, hfu: 93.552 Tflops/s, 2074.448 iter/s, 4.821e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 89.229 Tflops/s, hfu: 89.229 Tflops/s, 1978.600 iter/s, 5.054e-04 s/iter, (0.072, 0.001, 0.002) sec
mfu: 79.395 Tflops/s, hfu: 79.395 Tflops/s, 1760.539 iter/s, 5.680e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 111.206 Tflops/s, hfu: 111.206 Tflops/s, 2465.921 iter/s, 4.055e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(57344,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.451 Tflops/s, hfu: 9.451 Tflops/s, 359.275 iter/s, 2.783e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.18 Tflops/s, hfu: 17.18 Tflops/s, 653.074 iter/s, 1.531e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 8.307 Tflops/s, hfu: 8.307 Tflops/s, 315.783 iter/s, 3.167e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 72.116 Tflops/s, hfu: 72.116 Tflops/s, 1370.674 iter/s, 7.296e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 77.537 Tflops/s, hfu: 77.537 Tflops/s, 1473.709 iter/s, 6.786e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 78.628 Tflops/s, hfu: 78.628 Tflops/s, 1494.447 iter/s, 6.691e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 91.82 Tflops/s, hfu: 91.82 Tflops/s, 1745.176 iter/s, 5.730e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 100.137 Tflops/s, hfu: 100.137 Tflops/s, 1903.254 iter/s, 5.254e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 94.168 Tflops/s, hfu: 94.168 Tflops/s, 1789.805 iter/s, 5.587e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 82.209 Tflops/s, hfu: 82.209 Tflops/s, 1562.520 iter/s, 6.400e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 115.888 Tflops/s, hfu: 115.888 Tflops/s, 2202.643 iter/s, 4.540e-04 s/iter, (0.075, 0.000, 0.002) sec
SP=(1,8),S=(57344,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.797 Tflops/s, hfu: 10.797 Tflops/s, 359.115 iter/s, 2.785e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.426 Tflops/s, hfu: 19.426 Tflops/s, 646.147 iter/s, 1.548e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.436 Tflops/s, hfu: 9.436 Tflops/s, 313.860 iter/s, 3.186e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 66.419 Tflops/s, hfu: 66.419 Tflops/s, 1104.601 iter/s, 9.053e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 67.969 Tflops/s, hfu: 67.969 Tflops/s, 1130.373 iter/s, 8.847e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 69.095 Tflops/s, hfu: 69.095 Tflops/s, 1149.098 iter/s, 8.702e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 75.587 Tflops/s, hfu: 75.587 Tflops/s, 1257.077 iter/s, 7.955e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 107.065 Tflops/s, hfu: 107.065 Tflops/s, 1780.576 iter/s, 5.616e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 98.162 Tflops/s, hfu: 98.162 Tflops/s, 1632.514 iter/s, 6.126e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 86.033 Tflops/s, hfu: 86.033 Tflops/s, 1430.795 iter/s, 6.989e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 118.237 Tflops/s, hfu: 118.237 Tflops/s, 1966.367 iter/s, 5.086e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(57344,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.45 Tflops/s, hfu: 13.45 Tflops/s, 357.896 iter/s, 2.794e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.879 Tflops/s, hfu: 24.879 Tflops/s, 662.016 iter/s, 1.511e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 11.803 Tflops/s, hfu: 11.803 Tflops/s, 314.080 iter/s, 3.184e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 84.844 Tflops/s, hfu: 84.844 Tflops/s, 1128.811 iter/s, 8.859e-04 s/iter, (0.082, 0.000, 0.004) sec
mfu: 90.36 Tflops/s, hfu: 90.36 Tflops/s, 1202.201 iter/s, 8.318e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 90.758 Tflops/s, hfu: 90.758 Tflops/s, 1207.496 iter/s, 8.282e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 100.205 Tflops/s, hfu: 100.205 Tflops/s, 1333.191 iter/s, 7.501e-04 s/iter, (0.077, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 118.325 Tflops/s, hfu: 118.325 Tflops/s, 1574.268 iter/s, 6.352e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 106.469 Tflops/s, hfu: 106.469 Tflops/s, 1416.527 iter/s, 7.060e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 90.365 Tflops/s, hfu: 90.365 Tflops/s, 1202.270 iter/s, 8.318e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 120.52 Tflops/s, hfu: 120.52 Tflops/s, 1603.469 iter/s, 6.236e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(57344,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.102 Tflops/s, hfu: 16.102 Tflops/s, 357.044 iter/s, 2.801e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.7 Tflops/s, hfu: 29.7 Tflops/s, 658.581 iter/s, 1.518e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.124 Tflops/s, hfu: 14.124 Tflops/s, 313.180 iter/s, 3.193e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 95.662 Tflops/s, hfu: 95.662 Tflops/s, 1060.625 iter/s, 9.428e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 95.969 Tflops/s, hfu: 95.969 Tflops/s, 1064.020 iter/s, 9.398e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 95.635 Tflops/s, hfu: 95.635 Tflops/s, 1060.319 iter/s, 9.431e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 108.105 Tflops/s, hfu: 108.105 Tflops/s, 1198.581 iter/s, 8.343e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 125.298 Tflops/s, hfu: 125.298 Tflops/s, 1389.198 iter/s, 7.198e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 112.362 Tflops/s, hfu: 112.362 Tflops/s, 1245.777 iter/s, 8.027e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 94.818 Tflops/s, hfu: 94.818 Tflops/s, 1051.268 iter/s, 9.512e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 123.874 Tflops/s, hfu: 123.874 Tflops/s, 1373.415 iter/s, 7.281e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(57344,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.694 Tflops/s, hfu: 18.694 Tflops/s, 355.300 iter/s, 2.815e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.344 Tflops/s, hfu: 34.344 Tflops/s, 652.769 iter/s, 1.532e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.331 Tflops/s, hfu: 16.331 Tflops/s, 310.388 iter/s, 3.222e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 100.578 Tflops/s, hfu: 100.578 Tflops/s, 955.818 iter/s, 1.046e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 99.579 Tflops/s, hfu: 99.579 Tflops/s, 946.332 iter/s, 1.057e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 100.7 Tflops/s, hfu: 100.7 Tflops/s, 956.982 iter/s, 1.045e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 112.204 Tflops/s, hfu: 112.204 Tflops/s, 1066.307 iter/s, 9.378e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 133.105 Tflops/s, hfu: 133.105 Tflops/s, 1264.939 iter/s, 7.906e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 116.856 Tflops/s, hfu: 116.856 Tflops/s, 1110.519 iter/s, 9.005e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 96.205 Tflops/s, hfu: 96.205 Tflops/s, 914.264 iter/s, 1.094e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 125.684 Tflops/s, hfu: 125.684 Tflops/s, 1194.412 iter/s, 8.372e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(57344,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.669 Tflops/s, hfu: 21.669 Tflops/s, 360.368 iter/s, 2.775e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.098 Tflops/s, hfu: 39.098 Tflops/s, 650.234 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.604 Tflops/s, hfu: 18.604 Tflops/s, 309.407 iter/s, 3.232e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 107.087 Tflops/s, hfu: 107.087 Tflops/s, 890.466 iter/s, 1.123e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 107.116 Tflops/s, hfu: 107.116 Tflops/s, 890.707 iter/s, 1.123e-03 s/iter, (0.081, 0.000, 0.004) sec
mfu: 102.769 Tflops/s, hfu: 102.769 Tflops/s, 854.566 iter/s, 1.170e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 113.749 Tflops/s, hfu: 113.749 Tflops/s, 945.866 iter/s, 1.057e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 137.65 Tflops/s, hfu: 137.65 Tflops/s, 1144.615 iter/s, 8.737e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 119.484 Tflops/s, hfu: 119.484 Tflops/s, 993.554 iter/s, 1.006e-03 s/iter, (0.074, 0.001, 0.004) sec
mfu: 98.051 Tflops/s, hfu: 98.051 Tflops/s, 815.331 iter/s, 1.226e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.247 Tflops/s, hfu: 123.247 Tflops/s, 1024.842 iter/s, 9.758e-04 s/iter, (0.076, 0.000, 0.004) sec
SP=(1,8),S=(57344,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.415 Tflops/s, hfu: 27.415 Tflops/s, 364.741 iter/s, 2.742e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.388 Tflops/s, hfu: 49.388 Tflops/s, 657.085 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 23.791 Tflops/s, hfu: 23.791 Tflops/s, 316.527 iter/s, 3.159e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 111.573 Tflops/s, hfu: 111.573 Tflops/s, 742.214 iter/s, 1.347e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 111.61 Tflops/s, hfu: 111.61 Tflops/s, 742.461 iter/s, 1.347e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 110.233 Tflops/s, hfu: 110.233 Tflops/s, 733.301 iter/s, 1.364e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 122.301 Tflops/s, hfu: 122.301 Tflops/s, 813.585 iter/s, 1.229e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 146.661 Tflops/s, hfu: 146.661 Tflops/s, 975.633 iter/s, 1.025e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 124.968 Tflops/s, hfu: 124.968 Tflops/s, 831.327 iter/s, 1.203e-03 s/iter, (0.078, 0.001, 0.005) sec
mfu: 100.854 Tflops/s, hfu: 100.854 Tflops/s, 670.914 iter/s, 1.491e-03 s/iter, (0.084, 0.000, 0.006) sec
mfu: 125.432 Tflops/s, hfu: 125.432 Tflops/s, 834.413 iter/s, 1.198e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(57344,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.339 Tflops/s, hfu: 32.339 Tflops/s, 358.552 iter/s, 2.789e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.839 Tflops/s, hfu: 57.839 Tflops/s, 641.272 iter/s, 1.559e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 27.751 Tflops/s, hfu: 27.751 Tflops/s, 307.685 iter/s, 3.250e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 118.993 Tflops/s, hfu: 118.993 Tflops/s, 659.648 iter/s, 1.516e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 116.296 Tflops/s, hfu: 116.296 Tflops/s, 644.699 iter/s, 1.551e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 115.942 Tflops/s, hfu: 115.942 Tflops/s, 642.733 iter/s, 1.556e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 127.999 Tflops/s, hfu: 127.999 Tflops/s, 709.574 iter/s, 1.409e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 151.987 Tflops/s, hfu: 151.987 Tflops/s, 842.551 iter/s, 1.187e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 129.223 Tflops/s, hfu: 129.223 Tflops/s, 716.361 iter/s, 1.396e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 102.695 Tflops/s, hfu: 102.695 Tflops/s, 569.300 iter/s, 1.757e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 129.783 Tflops/s, hfu: 129.783 Tflops/s, 719.462 iter/s, 1.390e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(57344,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.428 Tflops/s, hfu: 37.428 Tflops/s, 355.694 iter/s, 2.811e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 67.551 Tflops/s, hfu: 67.551 Tflops/s, 641.954 iter/s, 1.558e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.423 Tflops/s, hfu: 32.423 Tflops/s, 308.127 iter/s, 3.245e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 122.636 Tflops/s, hfu: 122.636 Tflops/s, 582.723 iter/s, 1.716e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 120.417 Tflops/s, hfu: 120.417 Tflops/s, 572.179 iter/s, 1.748e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 121.992 Tflops/s, hfu: 121.992 Tflops/s, 579.662 iter/s, 1.725e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.434 Tflops/s, hfu: 131.434 Tflops/s, 624.528 iter/s, 1.601e-03 s/iter, (0.085, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 156.641 Tflops/s, hfu: 156.641 Tflops/s, 744.305 iter/s, 1.344e-03 s/iter, (0.194, 0.000, 0.005) sec
mfu: 132.196 Tflops/s, hfu: 132.196 Tflops/s, 628.150 iter/s, 1.592e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 103.728 Tflops/s, hfu: 103.728 Tflops/s, 492.879 iter/s, 2.029e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 130.239 Tflops/s, hfu: 130.239 Tflops/s, 618.852 iter/s, 1.616e-03 s/iter, (0.077, 0.000, 0.006) sec
SP=(1,8),S=(57344,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.136 Tflops/s, hfu: 43.136 Tflops/s, 358.693 iter/s, 2.788e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.988 Tflops/s, hfu: 78.988 Tflops/s, 656.817 iter/s, 1.522e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 37.758 Tflops/s, hfu: 37.758 Tflops/s, 313.971 iter/s, 3.185e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.945 Tflops/s, hfu: 125.945 Tflops/s, 523.639 iter/s, 1.910e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 120.941 Tflops/s, hfu: 120.941 Tflops/s, 502.836 iter/s, 1.989e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 121.491 Tflops/s, hfu: 121.491 Tflops/s, 505.120 iter/s, 1.980e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 133.993 Tflops/s, hfu: 133.993 Tflops/s, 557.101 iter/s, 1.795e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 160.066 Tflops/s, hfu: 160.066 Tflops/s, 665.506 iter/s, 1.503e-03 s/iter, (0.080, 0.000, 0.006) sec
mfu: 134.05 Tflops/s, hfu: 134.05 Tflops/s, 557.337 iter/s, 1.794e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 104.757 Tflops/s, hfu: 104.757 Tflops/s, 435.549 iter/s, 2.296e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 132.07 Tflops/s, hfu: 132.07 Tflops/s, 549.108 iter/s, 1.821e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(57344,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.355 Tflops/s, hfu: 53.355 Tflops/s, 354.937 iter/s, 2.817e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 97.631 Tflops/s, hfu: 97.631 Tflops/s, 649.474 iter/s, 1.540e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 46.742 Tflops/s, hfu: 46.742 Tflops/s, 310.939 iter/s, 3.216e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 127.489 Tflops/s, hfu: 127.489 Tflops/s, 424.047 iter/s, 2.358e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 127.403 Tflops/s, hfu: 127.403 Tflops/s, 423.763 iter/s, 2.360e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 124.391 Tflops/s, hfu: 124.391 Tflops/s, 413.743 iter/s, 2.417e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 136.755 Tflops/s, hfu: 136.755 Tflops/s, 454.868 iter/s, 2.198e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 165.999 Tflops/s, hfu: 165.999 Tflops/s, 552.137 iter/s, 1.811e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 137.817 Tflops/s, hfu: 137.817 Tflops/s, 458.401 iter/s, 2.181e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 106.198 Tflops/s, hfu: 106.198 Tflops/s, 353.231 iter/s, 2.831e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 133.802 Tflops/s, hfu: 133.802 Tflops/s, 445.046 iter/s, 2.247e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(57344,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.55 Tflops/s, hfu: 61.55 Tflops/s, 341.206 iter/s, 2.931e-03 s/iter, (0.037, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.75 Tflops/s, hfu: 116.75 Tflops/s, 647.214 iter/s, 1.545e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 55.862 Tflops/s, hfu: 55.862 Tflops/s, 309.678 iter/s, 3.229e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 134.917 Tflops/s, hfu: 134.917 Tflops/s, 373.962 iter/s, 2.674e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 130.591 Tflops/s, hfu: 130.591 Tflops/s, 361.972 iter/s, 2.763e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 131.978 Tflops/s, hfu: 131.978 Tflops/s, 365.816 iter/s, 2.734e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 140.829 Tflops/s, hfu: 140.829 Tflops/s, 390.349 iter/s, 2.562e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 169.659 Tflops/s, hfu: 169.659 Tflops/s, 470.259 iter/s, 2.126e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 140.371 Tflops/s, hfu: 140.371 Tflops/s, 389.080 iter/s, 2.570e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 107.283 Tflops/s, hfu: 107.283 Tflops/s, 297.366 iter/s, 3.363e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 135.638 Tflops/s, hfu: 135.638 Tflops/s, 375.961 iter/s, 2.660e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(57344,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.641 Tflops/s, hfu: 63.641 Tflops/s, 302.400 iter/s, 3.307e-03 s/iter, (0.042, 0.000, 0.066) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.842 Tflops/s, hfu: 119.842 Tflops/s, 569.445 iter/s, 1.756e-03 s/iter, (0.022, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 64.786 Tflops/s, hfu: 64.786 Tflops/s, 307.839 iter/s, 3.248e-03 s/iter, (0.039, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 136.263 Tflops/s, hfu: 136.263 Tflops/s, 323.736 iter/s, 3.089e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 133.057 Tflops/s, hfu: 133.057 Tflops/s, 316.120 iter/s, 3.163e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 126.842 Tflops/s, hfu: 126.842 Tflops/s, 301.355 iter/s, 3.318e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 142.337 Tflops/s, hfu: 142.337 Tflops/s, 338.167 iter/s, 2.957e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 172.471 Tflops/s, hfu: 172.471 Tflops/s, 409.760 iter/s, 2.440e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 141.07 Tflops/s, hfu: 141.07 Tflops/s, 335.158 iter/s, 2.984e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 107.812 Tflops/s, hfu: 107.812 Tflops/s, 256.142 iter/s, 3.904e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 136.044 Tflops/s, hfu: 136.044 Tflops/s, 323.216 iter/s, 3.094e-03 s/iter, (0.082, 0.000, 0.012) sec
SP=(1,8),S=(57344,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.574 Tflops/s, hfu: 64.574 Tflops/s, 268.477 iter/s, 3.725e-03 s/iter, (0.045, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.791 Tflops/s, hfu: 123.791 Tflops/s, 514.686 iter/s, 1.943e-03 s/iter, (0.025, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 65.833 Tflops/s, hfu: 65.833 Tflops/s, 273.714 iter/s, 3.653e-03 s/iter, (0.041, 0.000, 0.073) sec
# orchestrated_attn_func
mfu: 136.84 Tflops/s, hfu: 136.84 Tflops/s, 284.469 iter/s, 3.515e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 132.124 Tflops/s, hfu: 132.124 Tflops/s, 274.666 iter/s, 3.641e-03 s/iter, (0.083, 0.000, 0.015) sec
mfu: 133.022 Tflops/s, hfu: 133.022 Tflops/s, 276.532 iter/s, 3.616e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 143.507 Tflops/s, hfu: 143.507 Tflops/s, 298.329 iter/s, 3.352e-03 s/iter, (0.087, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 173.8 Tflops/s, hfu: 173.8 Tflops/s, 361.303 iter/s, 2.768e-03 s/iter, (0.086, 0.000, 0.011) sec
mfu: 142.781 Tflops/s, hfu: 142.781 Tflops/s, 296.820 iter/s, 3.369e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 108.693 Tflops/s, hfu: 108.693 Tflops/s, 225.957 iter/s, 4.426e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 137.155 Tflops/s, hfu: 137.155 Tflops/s, 285.123 iter/s, 3.507e-03 s/iter, (0.088, 0.000, 0.014) sec
SP=(1,8),S=(57344,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.263 Tflops/s, hfu: 66.263 Tflops/s, 220.400 iter/s, 4.537e-03 s/iter, (0.055, 0.000, 0.091) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 128.43 Tflops/s, hfu: 128.43 Tflops/s, 427.177 iter/s, 2.341e-03 s/iter, (0.029, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 68.457 Tflops/s, hfu: 68.457 Tflops/s, 227.699 iter/s, 4.392e-03 s/iter, (0.050, 0.000, 0.088) sec
# orchestrated_attn_func
mfu: 139.765 Tflops/s, hfu: 139.765 Tflops/s, 232.440 iter/s, 4.302e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 133.406 Tflops/s, hfu: 133.406 Tflops/s, 221.865 iter/s, 4.507e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 135.766 Tflops/s, hfu: 135.766 Tflops/s, 225.789 iter/s, 4.429e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 144.169 Tflops/s, hfu: 144.169 Tflops/s, 239.764 iter/s, 4.171e-03 s/iter, (0.086, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 177.313 Tflops/s, hfu: 177.313 Tflops/s, 294.884 iter/s, 3.391e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 144.762 Tflops/s, hfu: 144.762 Tflops/s, 240.750 iter/s, 4.154e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 109.3 Tflops/s, hfu: 109.3 Tflops/s, 181.775 iter/s, 5.501e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 137.448 Tflops/s, hfu: 137.448 Tflops/s, 228.586 iter/s, 4.375e-03 s/iter, (0.087, 0.000, 0.017) sec
SP=(1,8),S=(57344,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.184 Tflops/s, hfu: 68.184 Tflops/s, 188.991 iter/s, 5.291e-03 s/iter, (0.063, 0.000, 0.106) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 129.048 Tflops/s, hfu: 129.048 Tflops/s, 357.696 iter/s, 2.796e-03 s/iter, (0.034, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 68.706 Tflops/s, hfu: 68.706 Tflops/s, 190.440 iter/s, 5.251e-03 s/iter, (0.058, 0.000, 0.105) sec
# orchestrated_attn_func
mfu: 140.261 Tflops/s, hfu: 140.261 Tflops/s, 194.388 iter/s, 5.144e-03 s/iter, (0.089, 0.000, 0.021) sec
mfu: 138.226 Tflops/s, hfu: 138.226 Tflops/s, 191.566 iter/s, 5.220e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 138.853 Tflops/s, hfu: 138.853 Tflops/s, 192.436 iter/s, 5.197e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 147.837 Tflops/s, hfu: 147.837 Tflops/s, 204.886 iter/s, 4.881e-03 s/iter, (0.091, 0.000, 0.020) sec
# orchestrated_attn_func fused
mfu: 179.882 Tflops/s, hfu: 179.882 Tflops/s, 249.298 iter/s, 4.011e-03 s/iter, (0.094, 0.000, 0.016) sec
mfu: 145.892 Tflops/s, hfu: 145.892 Tflops/s, 202.191 iter/s, 4.946e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 110.128 Tflops/s, hfu: 110.128 Tflops/s, 152.626 iter/s, 6.552e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 139.12 Tflops/s, hfu: 139.12 Tflops/s, 192.806 iter/s, 5.187e-03 s/iter, (0.091, 0.000, 0.021) sec
SP=(1,8),S=(57344,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.038 Tflops/s, hfu: 69.038 Tflops/s, 164.022 iter/s, 6.097e-03 s/iter, (0.071, 0.000, 0.122) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 128.804 Tflops/s, hfu: 128.804 Tflops/s, 306.016 iter/s, 3.268e-03 s/iter, (0.038, 0.000, 0.065) sec
# stripe_flash_attn_func, fwd
mfu: 70.544 Tflops/s, hfu: 70.544 Tflops/s, 167.600 iter/s, 5.967e-03 s/iter, (0.067, 0.000, 0.119) sec
# orchestrated_attn_func
mfu: 142.239 Tflops/s, hfu: 142.239 Tflops/s, 168.967 iter/s, 5.918e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 139.393 Tflops/s, hfu: 139.393 Tflops/s, 165.586 iter/s, 6.039e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 140.953 Tflops/s, hfu: 140.953 Tflops/s, 167.440 iter/s, 5.972e-03 s/iter, (0.097, 0.000, 0.024) sec
mfu: 149.313 Tflops/s, hfu: 149.313 Tflops/s, 177.370 iter/s, 5.638e-03 s/iter, (0.095, 0.000, 0.023) sec
# orchestrated_attn_func fused
mfu: 181.553 Tflops/s, hfu: 181.553 Tflops/s, 215.669 iter/s, 4.637e-03 s/iter, (0.092, 0.000, 0.019) sec
mfu: 146.557 Tflops/s, hfu: 146.557 Tflops/s, 174.096 iter/s, 5.744e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 110.599 Tflops/s, hfu: 110.599 Tflops/s, 131.381 iter/s, 7.611e-03 s/iter, (0.101, 0.000, 0.030) sec
mfu: 139.014 Tflops/s, hfu: 139.014 Tflops/s, 165.136 iter/s, 6.056e-03 s/iter, (0.095, 0.000, 0.024) sec
SP=(1,8),S=(57344,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.654 Tflops/s, hfu: 70.654 Tflops/s, 146.879 iter/s, 6.808e-03 s/iter, (0.079, 0.000, 0.136) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 129.709 Tflops/s, hfu: 129.709 Tflops/s, 269.644 iter/s, 3.709e-03 s/iter, (0.043, 0.000, 0.074) sec
# stripe_flash_attn_func, fwd
mfu: 73.504 Tflops/s, hfu: 73.504 Tflops/s, 152.804 iter/s, 6.544e-03 s/iter, (0.073, 0.000, 0.131) sec
# orchestrated_attn_func
mfu: 141.795 Tflops/s, hfu: 141.795 Tflops/s, 147.385 iter/s, 6.785e-03 s/iter, (0.099, 0.000, 0.027) sec
mfu: 141.224 Tflops/s, hfu: 141.224 Tflops/s, 146.791 iter/s, 6.812e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 136.95 Tflops/s, hfu: 136.95 Tflops/s, 142.349 iter/s, 7.025e-03 s/iter, (0.099, 0.000, 0.028) sec
mfu: 148.582 Tflops/s, hfu: 148.582 Tflops/s, 154.439 iter/s, 6.475e-03 s/iter, (0.095, 0.000, 0.026) sec
# orchestrated_attn_func fused
mfu: 182.876 Tflops/s, hfu: 182.876 Tflops/s, 190.086 iter/s, 5.261e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 147.241 Tflops/s, hfu: 147.241 Tflops/s, 153.046 iter/s, 6.534e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 110.752 Tflops/s, hfu: 110.752 Tflops/s, 115.119 iter/s, 8.687e-03 s/iter, (0.104, 0.000, 0.035) sec
mfu: 138.849 Tflops/s, hfu: 138.849 Tflops/s, 144.323 iter/s, 6.929e-03 s/iter, (0.098, 0.000, 0.028) sec
SP=(1,8),S=(57344,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.281 Tflops/s, hfu: 71.281 Tflops/s, 118.546 iter/s, 8.436e-03 s/iter, (0.096, 0.000, 0.169) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 129.536 Tflops/s, hfu: 129.536 Tflops/s, 215.429 iter/s, 4.642e-03 s/iter, (0.052, 0.000, 0.093) sec
# stripe_flash_attn_func, fwd
mfu: 70.18 Tflops/s, hfu: 70.18 Tflops/s, 116.714 iter/s, 8.568e-03 s/iter, (0.096, 0.000, 0.171) sec
# orchestrated_attn_func
mfu: 144.148 Tflops/s, hfu: 144.148 Tflops/s, 119.865 iter/s, 8.343e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 143.513 Tflops/s, hfu: 143.513 Tflops/s, 119.336 iter/s, 8.380e-03 s/iter, (0.104, 0.000, 0.034) sec
mfu: 137.619 Tflops/s, hfu: 137.619 Tflops/s, 114.436 iter/s, 8.739e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 151.297 Tflops/s, hfu: 151.297 Tflops/s, 125.809 iter/s, 7.949e-03 s/iter, (0.102, 0.000, 0.032) sec
# orchestrated_attn_func fused
mfu: 184.643 Tflops/s, hfu: 184.643 Tflops/s, 153.537 iter/s, 6.513e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 148.511 Tflops/s, hfu: 148.511 Tflops/s, 123.493 iter/s, 8.098e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 111.197 Tflops/s, hfu: 111.197 Tflops/s, 92.465 iter/s, 1.081e-02 s/iter, (0.113, 0.000, 0.043) sec
mfu: 139.654 Tflops/s, hfu: 139.654 Tflops/s, 116.128 iter/s, 8.611e-03 s/iter, (0.105, 0.000, 0.034) sec
SP=(1,8),S=(57344,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.485 Tflops/s, hfu: 72.485 Tflops/s, 100.457 iter/s, 9.955e-03 s/iter, (0.113, 0.000, 0.199) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.221 Tflops/s, hfu: 131.221 Tflops/s, 181.859 iter/s, 5.499e-03 s/iter, (0.061, 0.000, 0.110) sec
# stripe_flash_attn_func, fwd
mfu: 70.503 Tflops/s, hfu: 70.503 Tflops/s, 97.710 iter/s, 1.023e-02 s/iter, (0.113, 0.000, 0.205) sec
# orchestrated_attn_func
mfu: 145.784 Tflops/s, hfu: 145.784 Tflops/s, 101.020 iter/s, 9.899e-03 s/iter, (0.117, 0.000, 0.040) sec
mfu: 141.002 Tflops/s, hfu: 141.002 Tflops/s, 97.707 iter/s, 1.023e-02 s/iter, (0.109, 0.000, 0.041) sec
mfu: 140.093 Tflops/s, hfu: 140.093 Tflops/s, 97.077 iter/s, 1.030e-02 s/iter, (0.110, 0.000, 0.041) sec
mfu: 152.415 Tflops/s, hfu: 152.415 Tflops/s, 105.616 iter/s, 9.468e-03 s/iter, (0.112, 0.000, 0.038) sec
# orchestrated_attn_func fused
mfu: 185.93 Tflops/s, hfu: 185.93 Tflops/s, 128.840 iter/s, 7.762e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 149.54 Tflops/s, hfu: 149.54 Tflops/s, 103.623 iter/s, 9.650e-03 s/iter, (0.113, 0.000, 0.039) sec
mfu: 111.54 Tflops/s, hfu: 111.54 Tflops/s, 77.292 iter/s, 1.294e-02 s/iter, (0.123, 0.000, 0.052) sec
mfu: 140.322 Tflops/s, hfu: 140.322 Tflops/s, 97.236 iter/s, 1.028e-02 s/iter, (0.116, 0.000, 0.041) sec
SP=(1,8),S=(57344,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.237 Tflops/s, hfu: 73.237 Tflops/s, 86.999 iter/s, 1.149e-02 s/iter, (0.130, 0.000, 0.230) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.07 Tflops/s, hfu: 132.07 Tflops/s, 156.887 iter/s, 6.374e-03 s/iter, (0.070, 0.000, 0.127) sec
# stripe_flash_attn_func, fwd
mfu: 71.458 Tflops/s, hfu: 71.458 Tflops/s, 84.885 iter/s, 1.178e-02 s/iter, (0.130, 0.000, 0.236) sec
# orchestrated_attn_func
mfu: 146.993 Tflops/s, hfu: 146.993 Tflops/s, 87.308 iter/s, 1.145e-02 s/iter, (0.125, 0.000, 0.046) sec
mfu: 145.823 Tflops/s, hfu: 145.823 Tflops/s, 86.612 iter/s, 1.155e-02 s/iter, (0.117, 0.000, 0.046) sec
mfu: 136.261 Tflops/s, hfu: 136.261 Tflops/s, 80.933 iter/s, 1.236e-02 s/iter, (0.123, 0.000, 0.049) sec
mfu: 153.551 Tflops/s, hfu: 153.551 Tflops/s, 91.203 iter/s, 1.096e-02 s/iter, (0.114, 0.000, 0.044) sec
# orchestrated_attn_func fused
mfu: 186.642 Tflops/s, hfu: 186.642 Tflops/s, 110.857 iter/s, 9.021e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 149.497 Tflops/s, hfu: 149.497 Tflops/s, 88.794 iter/s, 1.126e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 111.812 Tflops/s, hfu: 111.812 Tflops/s, 66.412 iter/s, 1.506e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 140.002 Tflops/s, hfu: 140.002 Tflops/s, 83.155 iter/s, 1.203e-02 s/iter, (0.119, 0.000, 0.048) sec
SP=(1,8),S=(57344,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.982 Tflops/s, hfu: 73.982 Tflops/s, 76.898 iter/s, 1.300e-02 s/iter, (0.147, 0.000, 0.260) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 135.591 Tflops/s, hfu: 135.591 Tflops/s, 140.936 iter/s, 7.095e-03 s/iter, (0.080, 0.000, 0.142) sec
# stripe_flash_attn_func, fwd
mfu: 71.983 Tflops/s, hfu: 71.983 Tflops/s, 74.821 iter/s, 1.337e-02 s/iter, (0.146, 0.000, 0.267) sec
# orchestrated_attn_func
mfu: 145.949 Tflops/s, hfu: 145.949 Tflops/s, 75.852 iter/s, 1.318e-02 s/iter, (0.129, 0.000, 0.053) sec
mfu: 140.355 Tflops/s, hfu: 140.355 Tflops/s, 72.944 iter/s, 1.371e-02 s/iter, (0.123, 0.000, 0.055) sec
mfu: 138.517 Tflops/s, hfu: 138.517 Tflops/s, 71.989 iter/s, 1.389e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 154.861 Tflops/s, hfu: 154.861 Tflops/s, 80.483 iter/s, 1.243e-02 s/iter, (0.124, 0.000, 0.050) sec
# orchestrated_attn_func fused
mfu: 187.302 Tflops/s, hfu: 187.302 Tflops/s, 97.343 iter/s, 1.027e-02 s/iter, (0.114, 0.000, 0.041) sec
mfu: 149.917 Tflops/s, hfu: 149.917 Tflops/s, 77.914 iter/s, 1.283e-02 s/iter, (0.122, 0.000, 0.051) sec
mfu: 111.911 Tflops/s, hfu: 111.911 Tflops/s, 58.162 iter/s, 1.719e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 140.379 Tflops/s, hfu: 140.379 Tflops/s, 72.956 iter/s, 1.371e-02 s/iter, (0.126, 0.000, 0.055) sec
SP=(1,8),S=(65536,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.627 Tflops/s, hfu: 1.627 Tflops/s, 378.864 iter/s, 2.639e-03 s/iter, (0.031, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.839 Tflops/s, hfu: 2.839 Tflops/s, 660.942 iter/s, 1.513e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.368 Tflops/s, hfu: 1.368 Tflops/s, 318.440 iter/s, 3.140e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 21.522 Tflops/s, hfu: 21.522 Tflops/s, 2505.512 iter/s, 3.991e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 32.101 Tflops/s, hfu: 32.101 Tflops/s, 3737.032 iter/s, 2.676e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 39.431 Tflops/s, hfu: 39.431 Tflops/s, 4590.356 iter/s, 2.178e-04 s/iter, (0.073, 0.000, 0.001) sec
mfu: 47.798 Tflops/s, hfu: 47.798 Tflops/s, 5564.459 iter/s, 1.797e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 25.251 Tflops/s, hfu: 25.251 Tflops/s, 2939.586 iter/s, 3.402e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 33.571 Tflops/s, hfu: 33.571 Tflops/s, 3908.204 iter/s, 2.559e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 42.302 Tflops/s, hfu: 42.302 Tflops/s, 4924.556 iter/s, 2.031e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 64.675 Tflops/s, hfu: 64.675 Tflops/s, 7529.213 iter/s, 1.328e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(65536,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.187 Tflops/s, hfu: 3.187 Tflops/s, 370.980 iter/s, 2.696e-03 s/iter, (0.033, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.616 Tflops/s, hfu: 5.616 Tflops/s, 653.807 iter/s, 1.530e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 2.686 Tflops/s, hfu: 2.686 Tflops/s, 312.727 iter/s, 3.198e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 27.551 Tflops/s, hfu: 27.551 Tflops/s, 1603.674 iter/s, 6.236e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 35.394 Tflops/s, hfu: 35.394 Tflops/s, 2060.191 iter/s, 4.854e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 37.083 Tflops/s, hfu: 37.083 Tflops/s, 2158.522 iter/s, 4.633e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 44.4 Tflops/s, hfu: 44.4 Tflops/s, 2584.407 iter/s, 3.869e-04 s/iter, (0.070, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 44.759 Tflops/s, hfu: 44.759 Tflops/s, 2605.307 iter/s, 3.838e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 57.129 Tflops/s, hfu: 57.129 Tflops/s, 3325.352 iter/s, 3.007e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 62.36 Tflops/s, hfu: 62.36 Tflops/s, 3629.817 iter/s, 2.755e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 88.886 Tflops/s, hfu: 88.886 Tflops/s, 5173.841 iter/s, 1.933e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(65536,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.798 Tflops/s, hfu: 4.798 Tflops/s, 372.377 iter/s, 2.685e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.467 Tflops/s, hfu: 8.467 Tflops/s, 657.141 iter/s, 1.522e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.045 Tflops/s, hfu: 4.045 Tflops/s, 313.958 iter/s, 3.185e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 41.408 Tflops/s, hfu: 41.408 Tflops/s, 1606.849 iter/s, 6.223e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 50.785 Tflops/s, hfu: 50.785 Tflops/s, 1970.707 iter/s, 5.074e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 53.975 Tflops/s, hfu: 53.975 Tflops/s, 2094.504 iter/s, 4.774e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 63.61 Tflops/s, hfu: 63.61 Tflops/s, 2468.404 iter/s, 4.051e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 61.386 Tflops/s, hfu: 61.386 Tflops/s, 2382.087 iter/s, 4.198e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 72.46 Tflops/s, hfu: 72.46 Tflops/s, 2811.832 iter/s, 3.556e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 75.888 Tflops/s, hfu: 75.888 Tflops/s, 2944.849 iter/s, 3.396e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 100.859 Tflops/s, hfu: 100.859 Tflops/s, 3913.833 iter/s, 2.555e-04 s/iter, (0.070, 0.000, 0.001) sec
SP=(1,8),S=(65536,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.382 Tflops/s, hfu: 6.382 Tflops/s, 371.498 iter/s, 2.692e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.275 Tflops/s, hfu: 11.275 Tflops/s, 656.314 iter/s, 1.524e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.382 Tflops/s, hfu: 5.382 Tflops/s, 313.288 iter/s, 3.192e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 50.832 Tflops/s, hfu: 50.832 Tflops/s, 1479.395 iter/s, 6.760e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 61.166 Tflops/s, hfu: 61.166 Tflops/s, 1780.170 iter/s, 5.617e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 65.689 Tflops/s, hfu: 65.689 Tflops/s, 1911.812 iter/s, 5.231e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 74.519 Tflops/s, hfu: 74.519 Tflops/s, 2168.783 iter/s, 4.611e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 75.414 Tflops/s, hfu: 75.414 Tflops/s, 2194.831 iter/s, 4.556e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 85.636 Tflops/s, hfu: 85.636 Tflops/s, 2492.324 iter/s, 4.012e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 78.332 Tflops/s, hfu: 78.332 Tflops/s, 2279.774 iter/s, 4.386e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 109.795 Tflops/s, hfu: 109.795 Tflops/s, 3195.460 iter/s, 3.129e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(65536,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.863 Tflops/s, hfu: 7.863 Tflops/s, 366.140 iter/s, 2.731e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.843 Tflops/s, hfu: 13.843 Tflops/s, 644.613 iter/s, 1.551e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.665 Tflops/s, hfu: 6.665 Tflops/s, 310.368 iter/s, 3.222e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 60.603 Tflops/s, hfu: 60.603 Tflops/s, 1411.026 iter/s, 7.087e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 69.07 Tflops/s, hfu: 69.07 Tflops/s, 1608.172 iter/s, 6.218e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 73.49 Tflops/s, hfu: 73.49 Tflops/s, 1711.063 iter/s, 5.844e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.892 Tflops/s, hfu: 84.892 Tflops/s, 1976.534 iter/s, 5.059e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 85.191 Tflops/s, hfu: 85.191 Tflops/s, 1983.497 iter/s, 5.042e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.792 Tflops/s, hfu: 90.792 Tflops/s, 2113.915 iter/s, 4.731e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 84.865 Tflops/s, hfu: 84.865 Tflops/s, 1975.910 iter/s, 5.061e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.718 Tflops/s, hfu: 114.718 Tflops/s, 2670.997 iter/s, 3.744e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(65536,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.374 Tflops/s, hfu: 9.374 Tflops/s, 363.772 iter/s, 2.749e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.624 Tflops/s, hfu: 16.624 Tflops/s, 645.109 iter/s, 1.550e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.962 Tflops/s, hfu: 7.962 Tflops/s, 308.983 iter/s, 3.236e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 72.983 Tflops/s, hfu: 72.983 Tflops/s, 1416.062 iter/s, 7.062e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 74.904 Tflops/s, hfu: 74.904 Tflops/s, 1453.336 iter/s, 6.881e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 76.383 Tflops/s, hfu: 76.383 Tflops/s, 1482.026 iter/s, 6.748e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 93.631 Tflops/s, hfu: 93.631 Tflops/s, 1816.676 iter/s, 5.505e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 96.357 Tflops/s, hfu: 96.357 Tflops/s, 1869.578 iter/s, 5.349e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 99.61 Tflops/s, hfu: 99.61 Tflops/s, 1932.681 iter/s, 5.174e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 89.316 Tflops/s, hfu: 89.316 Tflops/s, 1732.958 iter/s, 5.770e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 117.187 Tflops/s, hfu: 117.187 Tflops/s, 2273.719 iter/s, 4.398e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(65536,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.953 Tflops/s, hfu: 10.953 Tflops/s, 364.324 iter/s, 2.745e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.327 Tflops/s, hfu: 19.327 Tflops/s, 642.859 iter/s, 1.556e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.302 Tflops/s, hfu: 9.302 Tflops/s, 309.408 iter/s, 3.232e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 80.987 Tflops/s, hfu: 80.987 Tflops/s, 1346.881 iter/s, 7.425e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 82.385 Tflops/s, hfu: 82.385 Tflops/s, 1370.133 iter/s, 7.299e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 83.349 Tflops/s, hfu: 83.349 Tflops/s, 1386.163 iter/s, 7.214e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 100.281 Tflops/s, hfu: 100.281 Tflops/s, 1667.756 iter/s, 5.996e-04 s/iter, (0.076, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 103.059 Tflops/s, hfu: 103.059 Tflops/s, 1713.949 iter/s, 5.834e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 106.18 Tflops/s, hfu: 106.18 Tflops/s, 1765.861 iter/s, 5.663e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 93.697 Tflops/s, hfu: 93.697 Tflops/s, 1558.254 iter/s, 6.417e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 122.471 Tflops/s, hfu: 122.471 Tflops/s, 2036.793 iter/s, 4.910e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(65536,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.456 Tflops/s, hfu: 12.456 Tflops/s, 362.503 iter/s, 2.759e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.881 Tflops/s, hfu: 21.881 Tflops/s, 636.818 iter/s, 1.570e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.579 Tflops/s, hfu: 10.579 Tflops/s, 307.879 iter/s, 3.248e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 86.378 Tflops/s, hfu: 86.378 Tflops/s, 1256.964 iter/s, 7.956e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 86.073 Tflops/s, hfu: 86.073 Tflops/s, 1252.530 iter/s, 7.984e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 88.304 Tflops/s, hfu: 88.304 Tflops/s, 1284.990 iter/s, 7.782e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.178 Tflops/s, hfu: 101.178 Tflops/s, 1472.338 iter/s, 6.792e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 112.158 Tflops/s, hfu: 112.158 Tflops/s, 1632.110 iter/s, 6.127e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 111.423 Tflops/s, hfu: 111.423 Tflops/s, 1621.418 iter/s, 6.167e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 96.654 Tflops/s, hfu: 96.654 Tflops/s, 1406.501 iter/s, 7.110e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 125.736 Tflops/s, hfu: 125.736 Tflops/s, 1829.706 iter/s, 5.465e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(65536,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.455 Tflops/s, hfu: 15.455 Tflops/s, 359.844 iter/s, 2.779e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.744 Tflops/s, hfu: 27.744 Tflops/s, 645.963 iter/s, 1.548e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.177 Tflops/s, hfu: 13.177 Tflops/s, 306.799 iter/s, 3.259e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 95.177 Tflops/s, hfu: 95.177 Tflops/s, 1108.009 iter/s, 9.025e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 92.136 Tflops/s, hfu: 92.136 Tflops/s, 1072.602 iter/s, 9.323e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 93.819 Tflops/s, hfu: 93.819 Tflops/s, 1092.199 iter/s, 9.156e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 113.228 Tflops/s, hfu: 113.228 Tflops/s, 1318.148 iter/s, 7.586e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 124.881 Tflops/s, hfu: 124.881 Tflops/s, 1453.810 iter/s, 6.878e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 119.29 Tflops/s, hfu: 119.29 Tflops/s, 1388.719 iter/s, 7.201e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.367 Tflops/s, hfu: 103.367 Tflops/s, 1203.346 iter/s, 8.310e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 129.618 Tflops/s, hfu: 129.618 Tflops/s, 1508.951 iter/s, 6.627e-04 s/iter, (0.075, 0.000, 0.003) sec
SP=(1,8),S=(65536,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.502 Tflops/s, hfu: 18.502 Tflops/s, 358.985 iter/s, 2.786e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.151 Tflops/s, hfu: 33.151 Tflops/s, 643.204 iter/s, 1.555e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 15.825 Tflops/s, hfu: 15.825 Tflops/s, 307.051 iter/s, 3.257e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 101.152 Tflops/s, hfu: 101.152 Tflops/s, 981.308 iter/s, 1.019e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 95.401 Tflops/s, hfu: 95.401 Tflops/s, 925.508 iter/s, 1.080e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 94.449 Tflops/s, hfu: 94.449 Tflops/s, 916.275 iter/s, 1.091e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 117.642 Tflops/s, hfu: 117.642 Tflops/s, 1141.282 iter/s, 8.762e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 132.671 Tflops/s, hfu: 132.671 Tflops/s, 1287.081 iter/s, 7.770e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 127.105 Tflops/s, hfu: 127.105 Tflops/s, 1233.082 iter/s, 8.110e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 106.478 Tflops/s, hfu: 106.478 Tflops/s, 1032.973 iter/s, 9.681e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 130.664 Tflops/s, hfu: 130.664 Tflops/s, 1267.607 iter/s, 7.889e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(65536,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.512 Tflops/s, hfu: 21.512 Tflops/s, 357.757 iter/s, 2.795e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.398 Tflops/s, hfu: 38.398 Tflops/s, 638.582 iter/s, 1.566e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.368 Tflops/s, hfu: 18.368 Tflops/s, 305.470 iter/s, 3.274e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 108.614 Tflops/s, hfu: 108.614 Tflops/s, 903.166 iter/s, 1.107e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 101.576 Tflops/s, hfu: 101.576 Tflops/s, 844.640 iter/s, 1.184e-03 s/iter, (0.073, 0.000, 0.005) sec
mfu: 100.215 Tflops/s, hfu: 100.215 Tflops/s, 833.328 iter/s, 1.200e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 123.39 Tflops/s, hfu: 123.39 Tflops/s, 1026.037 iter/s, 9.746e-04 s/iter, (0.075, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 141.147 Tflops/s, hfu: 141.147 Tflops/s, 1173.687 iter/s, 8.520e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 131.805 Tflops/s, hfu: 131.805 Tflops/s, 1096.010 iter/s, 9.124e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 109.798 Tflops/s, hfu: 109.798 Tflops/s, 913.009 iter/s, 1.095e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 132.428 Tflops/s, hfu: 132.428 Tflops/s, 1101.186 iter/s, 9.081e-04 s/iter, (0.073, 0.000, 0.004) sec
SP=(1,8),S=(65536,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.58 Tflops/s, hfu: 24.58 Tflops/s, 357.682 iter/s, 2.796e-03 s/iter, (0.035, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.829 Tflops/s, hfu: 44.829 Tflops/s, 652.353 iter/s, 1.533e-03 s/iter, (0.028, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.39 Tflops/s, hfu: 21.39 Tflops/s, 311.259 iter/s, 3.213e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 113.289 Tflops/s, hfu: 113.289 Tflops/s, 824.283 iter/s, 1.213e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 103.969 Tflops/s, hfu: 103.969 Tflops/s, 756.471 iter/s, 1.322e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 104.471 Tflops/s, hfu: 104.471 Tflops/s, 760.128 iter/s, 1.316e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 127.142 Tflops/s, hfu: 127.142 Tflops/s, 925.083 iter/s, 1.081e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 148.113 Tflops/s, hfu: 148.113 Tflops/s, 1077.661 iter/s, 9.279e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 136.372 Tflops/s, hfu: 136.372 Tflops/s, 992.237 iter/s, 1.008e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 111.699 Tflops/s, hfu: 111.699 Tflops/s, 812.717 iter/s, 1.230e-03 s/iter, (0.075, 0.001, 0.005) sec
mfu: 130.544 Tflops/s, hfu: 130.544 Tflops/s, 949.834 iter/s, 1.053e-03 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(65536,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.147 Tflops/s, hfu: 31.147 Tflops/s, 362.603 iter/s, 2.758e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 56.324 Tflops/s, hfu: 56.324 Tflops/s, 655.703 iter/s, 1.525e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 27.218 Tflops/s, hfu: 27.218 Tflops/s, 316.862 iter/s, 3.156e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 118.349 Tflops/s, hfu: 118.349 Tflops/s, 688.880 iter/s, 1.452e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 112.628 Tflops/s, hfu: 112.628 Tflops/s, 655.583 iter/s, 1.525e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 104.867 Tflops/s, hfu: 104.867 Tflops/s, 610.405 iter/s, 1.638e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 133.961 Tflops/s, hfu: 133.961 Tflops/s, 779.754 iter/s, 1.282e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 158.712 Tflops/s, hfu: 158.712 Tflops/s, 923.825 iter/s, 1.082e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 141.854 Tflops/s, hfu: 141.854 Tflops/s, 825.698 iter/s, 1.211e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 114.849 Tflops/s, hfu: 114.849 Tflops/s, 668.510 iter/s, 1.496e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 132.625 Tflops/s, hfu: 132.625 Tflops/s, 771.977 iter/s, 1.295e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(65536,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.043 Tflops/s, hfu: 37.043 Tflops/s, 359.366 iter/s, 2.783e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 66.868 Tflops/s, hfu: 66.868 Tflops/s, 648.706 iter/s, 1.542e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.345 Tflops/s, hfu: 32.345 Tflops/s, 313.789 iter/s, 3.187e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 114.697 Tflops/s, hfu: 114.697 Tflops/s, 556.352 iter/s, 1.797e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 109.938 Tflops/s, hfu: 109.938 Tflops/s, 533.267 iter/s, 1.875e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 107.327 Tflops/s, hfu: 107.327 Tflops/s, 520.603 iter/s, 1.921e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 137.198 Tflops/s, hfu: 137.198 Tflops/s, 665.499 iter/s, 1.503e-03 s/iter, (0.079, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 165.994 Tflops/s, hfu: 165.994 Tflops/s, 805.179 iter/s, 1.242e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 146.344 Tflops/s, hfu: 146.344 Tflops/s, 709.860 iter/s, 1.409e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 117.064 Tflops/s, hfu: 117.064 Tflops/s, 567.836 iter/s, 1.761e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 135.428 Tflops/s, hfu: 135.428 Tflops/s, 656.913 iter/s, 1.522e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(65536,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.938 Tflops/s, hfu: 42.938 Tflops/s, 357.047 iter/s, 2.801e-03 s/iter, (0.044, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.157 Tflops/s, hfu: 78.157 Tflops/s, 649.902 iter/s, 1.539e-03 s/iter, (0.021, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 37.396 Tflops/s, hfu: 37.396 Tflops/s, 310.964 iter/s, 3.216e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 121.256 Tflops/s, hfu: 121.256 Tflops/s, 504.146 iter/s, 1.984e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 112.317 Tflops/s, hfu: 112.317 Tflops/s, 466.977 iter/s, 2.141e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 112.164 Tflops/s, hfu: 112.164 Tflops/s, 466.345 iter/s, 2.144e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 141.714 Tflops/s, hfu: 141.714 Tflops/s, 589.203 iter/s, 1.697e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 171.854 Tflops/s, hfu: 171.854 Tflops/s, 714.514 iter/s, 1.400e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 149.87 Tflops/s, hfu: 149.87 Tflops/s, 623.115 iter/s, 1.605e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 118.803 Tflops/s, hfu: 118.803 Tflops/s, 493.944 iter/s, 2.025e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 136.768 Tflops/s, hfu: 136.768 Tflops/s, 568.639 iter/s, 1.759e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(65536,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.904 Tflops/s, hfu: 48.904 Tflops/s, 355.820 iter/s, 2.810e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 89.373 Tflops/s, hfu: 89.373 Tflops/s, 650.275 iter/s, 1.538e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 42.499 Tflops/s, hfu: 42.499 Tflops/s, 309.223 iter/s, 3.234e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 124.513 Tflops/s, hfu: 124.513 Tflops/s, 452.974 iter/s, 2.208e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 114.045 Tflops/s, hfu: 114.045 Tflops/s, 414.895 iter/s, 2.410e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 111.068 Tflops/s, hfu: 111.068 Tflops/s, 404.063 iter/s, 2.475e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 144.629 Tflops/s, hfu: 144.629 Tflops/s, 526.158 iter/s, 1.901e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 176.183 Tflops/s, hfu: 176.183 Tflops/s, 640.950 iter/s, 1.560e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 152.988 Tflops/s, hfu: 152.988 Tflops/s, 556.567 iter/s, 1.797e-03 s/iter, (0.091, 0.000, 0.007) sec
mfu: 119.865 Tflops/s, hfu: 119.865 Tflops/s, 436.067 iter/s, 2.293e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 137.994 Tflops/s, hfu: 137.994 Tflops/s, 502.018 iter/s, 1.992e-03 s/iter, (0.081, 0.000, 0.008) sec
SP=(1,8),S=(65536,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.093 Tflops/s, hfu: 61.093 Tflops/s, 355.611 iter/s, 2.812e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.507 Tflops/s, hfu: 103.507 Tflops/s, 602.491 iter/s, 1.660e-03 s/iter, (0.020, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 53.754 Tflops/s, hfu: 53.754 Tflops/s, 312.890 iter/s, 3.196e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 124.098 Tflops/s, hfu: 124.098 Tflops/s, 361.172 iter/s, 2.769e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 118.9 Tflops/s, hfu: 118.9 Tflops/s, 346.044 iter/s, 2.890e-03 s/iter, (0.085, 0.000, 0.012) sec
mfu: 111.192 Tflops/s, hfu: 111.192 Tflops/s, 323.611 iter/s, 3.090e-03 s/iter, (0.084, 0.000, 0.012) sec
mfu: 146.987 Tflops/s, hfu: 146.987 Tflops/s, 427.789 iter/s, 2.338e-03 s/iter, (0.080, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 183.543 Tflops/s, hfu: 183.543 Tflops/s, 534.181 iter/s, 1.872e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 156.435 Tflops/s, hfu: 156.435 Tflops/s, 455.286 iter/s, 2.196e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 121.229 Tflops/s, hfu: 121.229 Tflops/s, 352.822 iter/s, 2.834e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 140.478 Tflops/s, hfu: 140.478 Tflops/s, 408.845 iter/s, 2.446e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(65536,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 65.423 Tflops/s, hfu: 65.423 Tflops/s, 317.344 iter/s, 3.151e-03 s/iter, (0.038, 0.000, 0.063) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.572 Tflops/s, hfu: 111.572 Tflops/s, 541.194 iter/s, 1.848e-03 s/iter, (0.022, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 64.152 Tflops/s, hfu: 64.152 Tflops/s, 311.180 iter/s, 3.214e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.502 Tflops/s, hfu: 125.502 Tflops/s, 304.381 iter/s, 3.285e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 114.731 Tflops/s, hfu: 114.731 Tflops/s, 278.259 iter/s, 3.594e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 116.631 Tflops/s, hfu: 116.631 Tflops/s, 282.868 iter/s, 3.535e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 147.559 Tflops/s, hfu: 147.559 Tflops/s, 357.877 iter/s, 2.794e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 188.8 Tflops/s, hfu: 188.8 Tflops/s, 457.901 iter/s, 2.184e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 159.897 Tflops/s, hfu: 159.897 Tflops/s, 387.800 iter/s, 2.579e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 122.62 Tflops/s, hfu: 122.62 Tflops/s, 297.392 iter/s, 3.363e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 141.813 Tflops/s, hfu: 141.813 Tflops/s, 343.942 iter/s, 2.907e-03 s/iter, (0.082, 0.000, 0.012) sec
SP=(1,8),S=(65536,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.525 Tflops/s, hfu: 67.525 Tflops/s, 280.750 iter/s, 3.562e-03 s/iter, (0.044, 0.000, 0.071) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.023 Tflops/s, hfu: 119.023 Tflops/s, 494.862 iter/s, 2.021e-03 s/iter, (0.024, 0.000, 0.040) sec
# stripe_flash_attn_func, fwd
mfu: 69.07 Tflops/s, hfu: 69.07 Tflops/s, 287.171 iter/s, 3.482e-03 s/iter, (0.040, 0.000, 0.070) sec
# orchestrated_attn_func
mfu: 125.694 Tflops/s, hfu: 125.694 Tflops/s, 261.299 iter/s, 3.827e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 120.947 Tflops/s, hfu: 120.947 Tflops/s, 251.429 iter/s, 3.977e-03 s/iter, (0.088, 0.000, 0.016) sec
mfu: 117.103 Tflops/s, hfu: 117.103 Tflops/s, 243.438 iter/s, 4.108e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 150.665 Tflops/s, hfu: 150.665 Tflops/s, 313.209 iter/s, 3.193e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 192.866 Tflops/s, hfu: 192.866 Tflops/s, 400.939 iter/s, 2.494e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 160.774 Tflops/s, hfu: 160.774 Tflops/s, 334.225 iter/s, 2.992e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 122.993 Tflops/s, hfu: 122.993 Tflops/s, 255.684 iter/s, 3.911e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 142.054 Tflops/s, hfu: 142.054 Tflops/s, 295.309 iter/s, 3.386e-03 s/iter, (0.084, 0.000, 0.014) sec
SP=(1,8),S=(65536,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.422 Tflops/s, hfu: 68.422 Tflops/s, 248.919 iter/s, 4.017e-03 s/iter, (0.049, 0.000, 0.080) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 121.954 Tflops/s, hfu: 121.954 Tflops/s, 443.666 iter/s, 2.254e-03 s/iter, (0.027, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 67.821 Tflops/s, hfu: 67.821 Tflops/s, 246.730 iter/s, 4.053e-03 s/iter, (0.046, 0.000, 0.081) sec
# orchestrated_attn_func
mfu: 124.581 Tflops/s, hfu: 124.581 Tflops/s, 226.612 iter/s, 4.413e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 118.436 Tflops/s, hfu: 118.436 Tflops/s, 215.433 iter/s, 4.642e-03 s/iter, (0.088, 0.000, 0.019) sec
mfu: 112.06 Tflops/s, hfu: 112.06 Tflops/s, 203.836 iter/s, 4.906e-03 s/iter, (0.088, 0.000, 0.020) sec
mfu: 151.373 Tflops/s, hfu: 151.373 Tflops/s, 275.346 iter/s, 3.632e-03 s/iter, (0.084, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 194.628 Tflops/s, hfu: 194.628 Tflops/s, 354.026 iter/s, 2.825e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 162.337 Tflops/s, hfu: 162.337 Tflops/s, 295.289 iter/s, 3.387e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 124.125 Tflops/s, hfu: 124.125 Tflops/s, 225.782 iter/s, 4.429e-03 s/iter, (0.091, 0.000, 0.018) sec
mfu: 142.917 Tflops/s, hfu: 142.917 Tflops/s, 259.965 iter/s, 3.847e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(65536,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.108 Tflops/s, hfu: 70.108 Tflops/s, 204.040 iter/s, 4.901e-03 s/iter, (0.060, 0.000, 0.098) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 127.995 Tflops/s, hfu: 127.995 Tflops/s, 372.516 iter/s, 2.684e-03 s/iter, (0.032, 0.000, 0.054) sec
# stripe_flash_attn_func, fwd
mfu: 69.22 Tflops/s, hfu: 69.22 Tflops/s, 201.456 iter/s, 4.964e-03 s/iter, (0.057, 0.000, 0.099) sec
# orchestrated_attn_func
mfu: 130.997 Tflops/s, hfu: 130.997 Tflops/s, 190.625 iter/s, 5.246e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 121.52 Tflops/s, hfu: 121.52 Tflops/s, 176.835 iter/s, 5.655e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 115.898 Tflops/s, hfu: 115.898 Tflops/s, 168.654 iter/s, 5.929e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 153.382 Tflops/s, hfu: 153.382 Tflops/s, 223.201 iter/s, 4.480e-03 s/iter, (0.092, 0.000, 0.018) sec
# orchestrated_attn_func fused
mfu: 199.228 Tflops/s, hfu: 199.228 Tflops/s, 289.914 iter/s, 3.449e-03 s/iter, (0.087, 0.000, 0.014) sec
mfu: 164.352 Tflops/s, hfu: 164.352 Tflops/s, 239.163 iter/s, 4.181e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 124.905 Tflops/s, hfu: 124.905 Tflops/s, 181.760 iter/s, 5.502e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 143.139 Tflops/s, hfu: 143.139 Tflops/s, 208.294 iter/s, 4.801e-03 s/iter, (0.090, 0.000, 0.019) sec
SP=(1,8),S=(65536,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.427 Tflops/s, hfu: 71.427 Tflops/s, 173.234 iter/s, 5.773e-03 s/iter, (0.067, 0.000, 0.115) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.632 Tflops/s, hfu: 131.632 Tflops/s, 319.250 iter/s, 3.132e-03 s/iter, (0.037, 0.000, 0.063) sec
# stripe_flash_attn_func, fwd
mfu: 70.109 Tflops/s, hfu: 70.109 Tflops/s, 170.037 iter/s, 5.881e-03 s/iter, (0.067, 0.000, 0.118) sec
# orchestrated_attn_func
mfu: 129.102 Tflops/s, hfu: 129.102 Tflops/s, 156.556 iter/s, 6.387e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 122.072 Tflops/s, hfu: 122.072 Tflops/s, 148.032 iter/s, 6.755e-03 s/iter, (0.096, 0.000, 0.027) sec
mfu: 118.896 Tflops/s, hfu: 118.896 Tflops/s, 144.181 iter/s, 6.936e-03 s/iter, (0.097, 0.000, 0.028) sec
mfu: 154.869 Tflops/s, hfu: 154.869 Tflops/s, 187.803 iter/s, 5.325e-03 s/iter, (0.094, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 201.875 Tflops/s, hfu: 201.875 Tflops/s, 244.806 iter/s, 4.085e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 166.183 Tflops/s, hfu: 166.183 Tflops/s, 201.523 iter/s, 4.962e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 125.843 Tflops/s, hfu: 125.843 Tflops/s, 152.605 iter/s, 6.553e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 144.544 Tflops/s, hfu: 144.544 Tflops/s, 175.283 iter/s, 5.705e-03 s/iter, (0.093, 0.000, 0.023) sec
SP=(1,8),S=(65536,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.791 Tflops/s, hfu: 72.791 Tflops/s, 151.321 iter/s, 6.608e-03 s/iter, (0.076, 0.000, 0.132) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.952 Tflops/s, hfu: 132.952 Tflops/s, 276.387 iter/s, 3.618e-03 s/iter, (0.043, 0.000, 0.072) sec
# stripe_flash_attn_func, fwd
mfu: 71.414 Tflops/s, hfu: 71.414 Tflops/s, 148.459 iter/s, 6.736e-03 s/iter, (0.075, 0.000, 0.135) sec
# orchestrated_attn_func
mfu: 129.552 Tflops/s, hfu: 129.552 Tflops/s, 134.659 iter/s, 7.426e-03 s/iter, (0.098, 0.000, 0.030) sec
mfu: 121.647 Tflops/s, hfu: 121.647 Tflops/s, 126.443 iter/s, 7.909e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 123.461 Tflops/s, hfu: 123.461 Tflops/s, 128.328 iter/s, 7.793e-03 s/iter, (0.103, 0.000, 0.031) sec
mfu: 155.772 Tflops/s, hfu: 155.772 Tflops/s, 161.913 iter/s, 6.176e-03 s/iter, (0.094, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 203.965 Tflops/s, hfu: 203.965 Tflops/s, 212.006 iter/s, 4.717e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 166.723 Tflops/s, hfu: 166.723 Tflops/s, 173.296 iter/s, 5.770e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 126.213 Tflops/s, hfu: 126.213 Tflops/s, 131.189 iter/s, 7.623e-03 s/iter, (0.101, 0.000, 0.030) sec
mfu: 144.822 Tflops/s, hfu: 144.822 Tflops/s, 150.531 iter/s, 6.643e-03 s/iter, (0.099, 0.000, 0.027) sec
SP=(1,8),S=(65536,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.791 Tflops/s, hfu: 73.791 Tflops/s, 134.225 iter/s, 7.450e-03 s/iter, (0.086, 0.000, 0.149) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 134.333 Tflops/s, hfu: 134.333 Tflops/s, 244.351 iter/s, 4.092e-03 s/iter, (0.048, 0.000, 0.082) sec
# stripe_flash_attn_func, fwd
mfu: 72.085 Tflops/s, hfu: 72.085 Tflops/s, 131.121 iter/s, 7.627e-03 s/iter, (0.085, 0.000, 0.153) sec
# orchestrated_attn_func
mfu: 130.267 Tflops/s, hfu: 130.267 Tflops/s, 118.478 iter/s, 8.440e-03 s/iter, (0.105, 0.000, 0.034) sec
mfu: 120.99 Tflops/s, hfu: 120.99 Tflops/s, 110.040 iter/s, 9.088e-03 s/iter, (0.108, 0.000, 0.036) sec
mfu: 125.138 Tflops/s, hfu: 125.138 Tflops/s, 113.812 iter/s, 8.786e-03 s/iter, (0.106, 0.000, 0.035) sec
mfu: 157.55 Tflops/s, hfu: 157.55 Tflops/s, 143.291 iter/s, 6.979e-03 s/iter, (0.098, 0.000, 0.028) sec
# orchestrated_attn_func fused
mfu: 205.52 Tflops/s, hfu: 205.52 Tflops/s, 186.920 iter/s, 5.350e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 167.695 Tflops/s, hfu: 167.695 Tflops/s, 152.518 iter/s, 6.557e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 126.7 Tflops/s, hfu: 126.7 Tflops/s, 115.233 iter/s, 8.678e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 144.284 Tflops/s, hfu: 144.284 Tflops/s, 131.225 iter/s, 7.620e-03 s/iter, (0.101, 0.000, 0.030) sec
SP=(1,8),S=(65536,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.751 Tflops/s, hfu: 74.751 Tflops/s, 108.776 iter/s, 9.193e-03 s/iter, (0.105, 0.000, 0.184) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 134.199 Tflops/s, hfu: 134.199 Tflops/s, 195.285 iter/s, 5.121e-03 s/iter, (0.059, 0.000, 0.102) sec
# stripe_flash_attn_func, fwd
mfu: 72.146 Tflops/s, hfu: 72.146 Tflops/s, 104.987 iter/s, 9.525e-03 s/iter, (0.104, 0.000, 0.191) sec
# orchestrated_attn_func
mfu: 127.98 Tflops/s, hfu: 127.98 Tflops/s, 93.118 iter/s, 1.074e-02 s/iter, (0.113, 0.000, 0.043) sec
mfu: 122.896 Tflops/s, hfu: 122.896 Tflops/s, 89.418 iter/s, 1.118e-02 s/iter, (0.119, 0.000, 0.045) sec
mfu: 122.623 Tflops/s, hfu: 122.623 Tflops/s, 89.220 iter/s, 1.121e-02 s/iter, (0.117, 0.000, 0.045) sec
mfu: 157.306 Tflops/s, hfu: 157.306 Tflops/s, 114.455 iter/s, 8.737e-03 s/iter, (0.113, 0.000, 0.035) sec
# orchestrated_attn_func fused
mfu: 207.488 Tflops/s, hfu: 207.488 Tflops/s, 150.967 iter/s, 6.624e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 168.878 Tflops/s, hfu: 168.878 Tflops/s, 122.875 iter/s, 8.138e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 126.954 Tflops/s, hfu: 126.954 Tflops/s, 92.371 iter/s, 1.083e-02 s/iter, (0.119, 0.001, 0.043) sec
mfu: 145.27 Tflops/s, hfu: 145.27 Tflops/s, 105.698 iter/s, 9.461e-03 s/iter, (0.108, 0.000, 0.038) sec
SP=(1,8),S=(65536,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.939 Tflops/s, hfu: 74.939 Tflops/s, 90.876 iter/s, 1.100e-02 s/iter, (0.123, 0.000, 0.220) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 130.885 Tflops/s, hfu: 130.885 Tflops/s, 158.719 iter/s, 6.300e-03 s/iter, (0.069, 0.000, 0.126) sec
# stripe_flash_attn_func, fwd
mfu: 72.658 Tflops/s, hfu: 72.658 Tflops/s, 88.110 iter/s, 1.135e-02 s/iter, (0.123, 0.000, 0.227) sec
# orchestrated_attn_func
mfu: 132.147 Tflops/s, hfu: 132.147 Tflops/s, 80.125 iter/s, 1.248e-02 s/iter, (0.121, 0.000, 0.050) sec
mfu: 123.039 Tflops/s, hfu: 123.039 Tflops/s, 74.602 iter/s, 1.340e-02 s/iter, (0.124, 0.000, 0.054) sec
mfu: 119.246 Tflops/s, hfu: 119.246 Tflops/s, 72.302 iter/s, 1.383e-02 s/iter, (0.132, 0.000, 0.055) sec
mfu: 159.108 Tflops/s, hfu: 159.108 Tflops/s, 96.472 iter/s, 1.037e-02 s/iter, (0.115, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 209.672 Tflops/s, hfu: 209.672 Tflops/s, 127.130 iter/s, 7.866e-03 s/iter, (0.102, 0.000, 0.031) sec
mfu: 170.056 Tflops/s, hfu: 170.056 Tflops/s, 103.110 iter/s, 9.698e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 127.447 Tflops/s, hfu: 127.447 Tflops/s, 77.275 iter/s, 1.294e-02 s/iter, (0.126, 0.000, 0.052) sec
mfu: 145.643 Tflops/s, hfu: 145.643 Tflops/s, 88.308 iter/s, 1.132e-02 s/iter, (0.118, 0.000, 0.045) sec
SP=(1,8),S=(65536,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.63 Tflops/s, hfu: 75.63 Tflops/s, 78.612 iter/s, 1.272e-02 s/iter, (0.142, 0.000, 0.254) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 134.826 Tflops/s, hfu: 134.826 Tflops/s, 140.141 iter/s, 7.136e-03 s/iter, (0.080, 0.000, 0.143) sec
# stripe_flash_attn_func, fwd
mfu: 73.005 Tflops/s, hfu: 73.005 Tflops/s, 75.883 iter/s, 1.318e-02 s/iter, (0.142, 0.000, 0.264) sec
# orchestrated_attn_func
mfu: 127.166 Tflops/s, hfu: 127.166 Tflops/s, 66.090 iter/s, 1.513e-02 s/iter, (0.140, 0.000, 0.061) sec
mfu: 125.417 Tflops/s, hfu: 125.417 Tflops/s, 65.180 iter/s, 1.534e-02 s/iter, (0.137, 0.000, 0.061) sec
mfu: 119.692 Tflops/s, hfu: 119.692 Tflops/s, 62.205 iter/s, 1.608e-02 s/iter, (0.133, 0.000, 0.064) sec
mfu: 159.787 Tflops/s, hfu: 159.787 Tflops/s, 83.043 iter/s, 1.204e-02 s/iter, (0.119, 0.000, 0.048) sec
# orchestrated_attn_func fused
mfu: 210.762 Tflops/s, hfu: 210.762 Tflops/s, 109.536 iter/s, 9.129e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 170.257 Tflops/s, hfu: 170.257 Tflops/s, 88.485 iter/s, 1.130e-02 s/iter, (0.116, 0.000, 0.045) sec
mfu: 127.59 Tflops/s, hfu: 127.59 Tflops/s, 66.310 iter/s, 1.508e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 145.458 Tflops/s, hfu: 145.458 Tflops/s, 75.596 iter/s, 1.323e-02 s/iter, (0.124, 0.000, 0.053) sec
SP=(1,8),S=(65536,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.958 Tflops/s, hfu: 76.958 Tflops/s, 69.993 iter/s, 1.429e-02 s/iter, (0.160, 0.000, 0.286) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 133.163 Tflops/s, hfu: 133.163 Tflops/s, 121.111 iter/s, 8.257e-03 s/iter, (0.090, 0.000, 0.165) sec
# stripe_flash_attn_func, fwd
mfu: 73.676 Tflops/s, hfu: 73.676 Tflops/s, 67.008 iter/s, 1.492e-02 s/iter, (0.161, 0.000, 0.298) sec
# orchestrated_attn_func
mfu: 127.057 Tflops/s, hfu: 127.057 Tflops/s, 57.779 iter/s, 1.731e-02 s/iter, (0.156, 0.000, 0.069) sec
mfu: 118.476 Tflops/s, hfu: 118.476 Tflops/s, 53.877 iter/s, 1.856e-02 s/iter, (0.144, 0.000, 0.074) sec
mfu: 113.728 Tflops/s, hfu: 113.728 Tflops/s, 51.717 iter/s, 1.934e-02 s/iter, (0.142, 0.000, 0.077) sec
mfu: 159.905 Tflops/s, hfu: 159.905 Tflops/s, 72.716 iter/s, 1.375e-02 s/iter, (0.130, 0.000, 0.055) sec
# orchestrated_attn_func fused
mfu: 211.143 Tflops/s, hfu: 211.143 Tflops/s, 96.017 iter/s, 1.041e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 170.682 Tflops/s, hfu: 170.682 Tflops/s, 77.617 iter/s, 1.288e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 127.909 Tflops/s, hfu: 127.909 Tflops/s, 58.166 iter/s, 1.719e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 145.871 Tflops/s, hfu: 145.871 Tflops/s, 66.334 iter/s, 1.508e-02 s/iter, (0.133, 0.000, 0.060) sec
SP=(1,8),S=(81920,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.003 Tflops/s, hfu: 2.003 Tflops/s, 373.011 iter/s, 2.681e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 3.622 Tflops/s, hfu: 3.622 Tflops/s, 674.580 iter/s, 1.482e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 1.744 Tflops/s, hfu: 1.744 Tflops/s, 324.914 iter/s, 3.078e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 22.503 Tflops/s, hfu: 22.503 Tflops/s, 2095.768 iter/s, 4.772e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 37.649 Tflops/s, hfu: 37.649 Tflops/s, 3506.311 iter/s, 2.852e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 47.834 Tflops/s, hfu: 47.834 Tflops/s, 4454.899 iter/s, 2.245e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 58.414 Tflops/s, hfu: 58.414 Tflops/s, 5440.223 iter/s, 1.838e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 27.547 Tflops/s, hfu: 27.547 Tflops/s, 2565.471 iter/s, 3.898e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 39.121 Tflops/s, hfu: 39.121 Tflops/s, 3643.465 iter/s, 2.745e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 49.285 Tflops/s, hfu: 49.285 Tflops/s, 4590.019 iter/s, 2.179e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 75.997 Tflops/s, hfu: 75.997 Tflops/s, 7077.742 iter/s, 1.413e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(81920,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.92 Tflops/s, hfu: 3.92 Tflops/s, 365.036 iter/s, 2.739e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.187 Tflops/s, hfu: 7.187 Tflops/s, 669.311 iter/s, 1.494e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 3.441 Tflops/s, hfu: 3.441 Tflops/s, 320.461 iter/s, 3.121e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 29.91 Tflops/s, hfu: 29.91 Tflops/s, 1392.804 iter/s, 7.180e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 38.344 Tflops/s, hfu: 38.344 Tflops/s, 1785.510 iter/s, 5.601e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 41.056 Tflops/s, hfu: 41.056 Tflops/s, 1911.841 iter/s, 5.231e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 47.804 Tflops/s, hfu: 47.804 Tflops/s, 2226.061 iter/s, 4.492e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 47.976 Tflops/s, hfu: 47.976 Tflops/s, 2234.058 iter/s, 4.476e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 67.521 Tflops/s, hfu: 67.521 Tflops/s, 3144.180 iter/s, 3.180e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 73.504 Tflops/s, hfu: 73.504 Tflops/s, 3422.782 iter/s, 2.922e-04 s/iter, (0.074, 0.000, 0.001) sec
mfu: 101.342 Tflops/s, hfu: 101.342 Tflops/s, 4719.118 iter/s, 2.119e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(81920,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.843 Tflops/s, hfu: 5.843 Tflops/s, 362.776 iter/s, 2.757e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.757 Tflops/s, hfu: 10.757 Tflops/s, 667.888 iter/s, 1.497e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.138 Tflops/s, hfu: 5.138 Tflops/s, 319.005 iter/s, 3.135e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 37.712 Tflops/s, hfu: 37.712 Tflops/s, 1170.730 iter/s, 8.542e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 41.844 Tflops/s, hfu: 41.844 Tflops/s, 1298.998 iter/s, 7.698e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 43.66 Tflops/s, hfu: 43.66 Tflops/s, 1355.396 iter/s, 7.378e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 49.033 Tflops/s, hfu: 49.033 Tflops/s, 1522.181 iter/s, 6.570e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 65.178 Tflops/s, hfu: 65.178 Tflops/s, 2023.407 iter/s, 4.942e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 84.914 Tflops/s, hfu: 84.914 Tflops/s, 2636.074 iter/s, 3.794e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 89.62 Tflops/s, hfu: 89.62 Tflops/s, 2782.167 iter/s, 3.594e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 112.816 Tflops/s, hfu: 112.816 Tflops/s, 3502.283 iter/s, 2.855e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(81920,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.787 Tflops/s, hfu: 7.787 Tflops/s, 362.592 iter/s, 2.758e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.395 Tflops/s, hfu: 14.395 Tflops/s, 670.322 iter/s, 1.492e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 6.862 Tflops/s, hfu: 6.862 Tflops/s, 319.534 iter/s, 3.130e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 51.984 Tflops/s, hfu: 51.984 Tflops/s, 1210.337 iter/s, 8.262e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 62.505 Tflops/s, hfu: 62.505 Tflops/s, 1455.316 iter/s, 6.871e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 65.472 Tflops/s, hfu: 65.472 Tflops/s, 1524.390 iter/s, 6.560e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 74.755 Tflops/s, hfu: 74.755 Tflops/s, 1740.535 iter/s, 5.745e-04 s/iter, (0.076, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 80.077 Tflops/s, hfu: 80.077 Tflops/s, 1864.447 iter/s, 5.364e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.851 Tflops/s, hfu: 100.851 Tflops/s, 2348.123 iter/s, 4.259e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 94.984 Tflops/s, hfu: 94.984 Tflops/s, 2211.528 iter/s, 4.522e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 121.132 Tflops/s, hfu: 121.132 Tflops/s, 2820.333 iter/s, 3.546e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(81920,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.696 Tflops/s, hfu: 9.696 Tflops/s, 361.221 iter/s, 2.768e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.783 Tflops/s, hfu: 17.783 Tflops/s, 662.471 iter/s, 1.509e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.582 Tflops/s, hfu: 8.582 Tflops/s, 319.715 iter/s, 3.128e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 61.523 Tflops/s, hfu: 61.523 Tflops/s, 1145.958 iter/s, 8.726e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 73.26 Tflops/s, hfu: 73.26 Tflops/s, 1364.569 iter/s, 7.328e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 74.208 Tflops/s, hfu: 74.208 Tflops/s, 1382.224 iter/s, 7.235e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 86.325 Tflops/s, hfu: 86.325 Tflops/s, 1607.924 iter/s, 6.219e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 91.4 Tflops/s, hfu: 91.4 Tflops/s, 1702.464 iter/s, 5.874e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 108.062 Tflops/s, hfu: 108.062 Tflops/s, 2012.818 iter/s, 4.968e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 103.275 Tflops/s, hfu: 103.275 Tflops/s, 1923.639 iter/s, 5.198e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 129.534 Tflops/s, hfu: 129.534 Tflops/s, 2412.755 iter/s, 4.145e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(81920,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.596 Tflops/s, hfu: 11.596 Tflops/s, 359.994 iter/s, 2.778e-03 s/iter, (0.033, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.867 Tflops/s, hfu: 20.867 Tflops/s, 647.794 iter/s, 1.544e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 10.233 Tflops/s, hfu: 10.233 Tflops/s, 317.661 iter/s, 3.148e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 69.321 Tflops/s, hfu: 69.321 Tflops/s, 1076.000 iter/s, 9.294e-04 s/iter, (0.073, 0.003, 0.004) sec
mfu: 79.408 Tflops/s, hfu: 79.408 Tflops/s, 1232.571 iter/s, 8.113e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 81.501 Tflops/s, hfu: 81.501 Tflops/s, 1265.067 iter/s, 7.905e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 93.327 Tflops/s, hfu: 93.327 Tflops/s, 1448.620 iter/s, 6.903e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 101.861 Tflops/s, hfu: 101.861 Tflops/s, 1581.098 iter/s, 6.325e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 117.704 Tflops/s, hfu: 117.704 Tflops/s, 1827.004 iter/s, 5.473e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 111.486 Tflops/s, hfu: 111.486 Tflops/s, 1730.487 iter/s, 5.779e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 135.337 Tflops/s, hfu: 135.337 Tflops/s, 2100.699 iter/s, 4.760e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(81920,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.486 Tflops/s, hfu: 13.486 Tflops/s, 358.856 iter/s, 2.787e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.63 Tflops/s, hfu: 24.63 Tflops/s, 655.386 iter/s, 1.526e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 11.927 Tflops/s, hfu: 11.927 Tflops/s, 317.369 iter/s, 3.151e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 76.592 Tflops/s, hfu: 76.592 Tflops/s, 1019.027 iter/s, 9.813e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 86.61 Tflops/s, hfu: 86.61 Tflops/s, 1152.307 iter/s, 8.678e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 85.749 Tflops/s, hfu: 85.749 Tflops/s, 1140.854 iter/s, 8.765e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 99.226 Tflops/s, hfu: 99.226 Tflops/s, 1320.167 iter/s, 7.575e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 110.168 Tflops/s, hfu: 110.168 Tflops/s, 1465.743 iter/s, 6.822e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 126.433 Tflops/s, hfu: 126.433 Tflops/s, 1682.142 iter/s, 5.945e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 115.776 Tflops/s, hfu: 115.776 Tflops/s, 1540.357 iter/s, 6.492e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 136.06 Tflops/s, hfu: 136.06 Tflops/s, 1810.230 iter/s, 5.524e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(81920,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.366 Tflops/s, hfu: 15.366 Tflops/s, 357.772 iter/s, 2.795e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.924 Tflops/s, hfu: 27.924 Tflops/s, 650.149 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 13.559 Tflops/s, hfu: 13.559 Tflops/s, 315.699 iter/s, 3.168e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 86.28 Tflops/s, hfu: 86.28 Tflops/s, 1004.428 iter/s, 9.956e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 91.31 Tflops/s, hfu: 91.31 Tflops/s, 1062.988 iter/s, 9.407e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 91.159 Tflops/s, hfu: 91.159 Tflops/s, 1061.229 iter/s, 9.423e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 105.476 Tflops/s, hfu: 105.476 Tflops/s, 1227.898 iter/s, 8.144e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 118.356 Tflops/s, hfu: 118.356 Tflops/s, 1377.851 iter/s, 7.258e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 133.45 Tflops/s, hfu: 133.45 Tflops/s, 1553.567 iter/s, 6.437e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 120.751 Tflops/s, hfu: 120.751 Tflops/s, 1405.726 iter/s, 7.114e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 139.754 Tflops/s, hfu: 139.754 Tflops/s, 1626.947 iter/s, 6.146e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(81920,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.641 Tflops/s, hfu: 19.641 Tflops/s, 365.837 iter/s, 2.733e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.636 Tflops/s, hfu: 35.636 Tflops/s, 663.776 iter/s, 1.507e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.877 Tflops/s, hfu: 16.877 Tflops/s, 314.353 iter/s, 3.181e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 96.015 Tflops/s, hfu: 96.015 Tflops/s, 894.211 iter/s, 1.118e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 98.856 Tflops/s, hfu: 98.856 Tflops/s, 920.668 iter/s, 1.086e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 99.527 Tflops/s, hfu: 99.527 Tflops/s, 926.922 iter/s, 1.079e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 114.01 Tflops/s, hfu: 114.01 Tflops/s, 1061.797 iter/s, 9.418e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 130.6 Tflops/s, hfu: 130.6 Tflops/s, 1216.308 iter/s, 8.222e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 143.896 Tflops/s, hfu: 143.896 Tflops/s, 1340.138 iter/s, 7.462e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 127.553 Tflops/s, hfu: 127.553 Tflops/s, 1187.931 iter/s, 8.418e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 143.166 Tflops/s, hfu: 143.166 Tflops/s, 1333.333 iter/s, 7.500e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(81920,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.482 Tflops/s, hfu: 23.482 Tflops/s, 364.486 iter/s, 2.744e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.414 Tflops/s, hfu: 42.414 Tflops/s, 658.348 iter/s, 1.519e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 20.327 Tflops/s, hfu: 20.327 Tflops/s, 315.511 iter/s, 3.169e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 103.724 Tflops/s, hfu: 103.724 Tflops/s, 805.003 iter/s, 1.242e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 104.128 Tflops/s, hfu: 104.128 Tflops/s, 808.141 iter/s, 1.237e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 106.353 Tflops/s, hfu: 106.353 Tflops/s, 825.409 iter/s, 1.212e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 122.221 Tflops/s, hfu: 122.221 Tflops/s, 948.558 iter/s, 1.054e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 141.036 Tflops/s, hfu: 141.036 Tflops/s, 1094.581 iter/s, 9.136e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 154.134 Tflops/s, hfu: 154.134 Tflops/s, 1196.241 iter/s, 8.360e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 131.966 Tflops/s, hfu: 131.966 Tflops/s, 1024.187 iter/s, 9.764e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 146.487 Tflops/s, hfu: 146.487 Tflops/s, 1136.891 iter/s, 8.796e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(81920,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.338 Tflops/s, hfu: 27.338 Tflops/s, 363.718 iter/s, 2.749e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.758 Tflops/s, hfu: 49.758 Tflops/s, 662.011 iter/s, 1.511e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 23.758 Tflops/s, hfu: 23.758 Tflops/s, 316.092 iter/s, 3.164e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 110.508 Tflops/s, hfu: 110.508 Tflops/s, 735.134 iter/s, 1.360e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 109.738 Tflops/s, hfu: 109.738 Tflops/s, 730.008 iter/s, 1.370e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 110.707 Tflops/s, hfu: 110.707 Tflops/s, 736.459 iter/s, 1.358e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.349 Tflops/s, hfu: 123.349 Tflops/s, 820.555 iter/s, 1.219e-03 s/iter, (0.077, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 149.291 Tflops/s, hfu: 149.291 Tflops/s, 993.128 iter/s, 1.007e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 160.866 Tflops/s, hfu: 160.866 Tflops/s, 1070.132 iter/s, 9.345e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 135.525 Tflops/s, hfu: 135.525 Tflops/s, 901.551 iter/s, 1.109e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 148.792 Tflops/s, hfu: 148.792 Tflops/s, 989.809 iter/s, 1.010e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(81920,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.972 Tflops/s, hfu: 30.972 Tflops/s, 360.560 iter/s, 2.773e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 56.666 Tflops/s, hfu: 56.666 Tflops/s, 659.684 iter/s, 1.516e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 26.881 Tflops/s, hfu: 26.881 Tflops/s, 312.939 iter/s, 3.196e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 115.616 Tflops/s, hfu: 115.616 Tflops/s, 672.973 iter/s, 1.486e-03 s/iter, (0.075, 0.001, 0.006) sec
mfu: 115.492 Tflops/s, hfu: 115.492 Tflops/s, 672.253 iter/s, 1.488e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 114.027 Tflops/s, hfu: 114.027 Tflops/s, 663.725 iter/s, 1.507e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 132.938 Tflops/s, hfu: 132.938 Tflops/s, 773.802 iter/s, 1.292e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 155.967 Tflops/s, hfu: 155.967 Tflops/s, 907.850 iter/s, 1.102e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 166.531 Tflops/s, hfu: 166.531 Tflops/s, 969.338 iter/s, 1.032e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 139.211 Tflops/s, hfu: 139.211 Tflops/s, 810.315 iter/s, 1.234e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 146.705 Tflops/s, hfu: 146.705 Tflops/s, 853.936 iter/s, 1.171e-03 s/iter, (0.078, 0.000, 0.005) sec
SP=(1,8),S=(81920,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 39.281 Tflops/s, hfu: 39.281 Tflops/s, 365.829 iter/s, 2.734e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 64.998 Tflops/s, hfu: 64.998 Tflops/s, 605.343 iter/s, 1.652e-03 s/iter, (0.021, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 34.22 Tflops/s, hfu: 34.22 Tflops/s, 318.703 iter/s, 3.138e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 121.82 Tflops/s, hfu: 121.82 Tflops/s, 567.269 iter/s, 1.763e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 118.498 Tflops/s, hfu: 118.498 Tflops/s, 551.801 iter/s, 1.812e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 119.434 Tflops/s, hfu: 119.434 Tflops/s, 556.156 iter/s, 1.798e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 135.359 Tflops/s, hfu: 135.359 Tflops/s, 630.317 iter/s, 1.587e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 166.645 Tflops/s, hfu: 166.645 Tflops/s, 776.002 iter/s, 1.289e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 174.998 Tflops/s, hfu: 174.998 Tflops/s, 814.900 iter/s, 1.227e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 142.333 Tflops/s, hfu: 142.333 Tflops/s, 662.789 iter/s, 1.509e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 149.146 Tflops/s, hfu: 149.146 Tflops/s, 694.514 iter/s, 1.440e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(81920,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 46.602 Tflops/s, hfu: 46.602 Tflops/s, 361.681 iter/s, 2.765e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.22 Tflops/s, hfu: 76.22 Tflops/s, 591.543 iter/s, 1.690e-03 s/iter, (0.021, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 40.792 Tflops/s, hfu: 40.792 Tflops/s, 316.587 iter/s, 3.159e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 129.035 Tflops/s, hfu: 129.035 Tflops/s, 500.723 iter/s, 1.997e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 122.953 Tflops/s, hfu: 122.953 Tflops/s, 477.121 iter/s, 2.096e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 124.609 Tflops/s, hfu: 124.609 Tflops/s, 483.546 iter/s, 2.068e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 142.376 Tflops/s, hfu: 142.376 Tflops/s, 552.491 iter/s, 1.810e-03 s/iter, (0.079, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 174.292 Tflops/s, hfu: 174.292 Tflops/s, 676.341 iter/s, 1.479e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 181.282 Tflops/s, hfu: 181.282 Tflops/s, 703.468 iter/s, 1.422e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 145.375 Tflops/s, hfu: 145.375 Tflops/s, 564.130 iter/s, 1.773e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 153.03 Tflops/s, hfu: 153.03 Tflops/s, 593.833 iter/s, 1.684e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(81920,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.974 Tflops/s, hfu: 53.974 Tflops/s, 359.054 iter/s, 2.785e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.008 Tflops/s, hfu: 88.008 Tflops/s, 585.453 iter/s, 1.708e-03 s/iter, (0.021, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 46.509 Tflops/s, hfu: 46.509 Tflops/s, 309.392 iter/s, 3.232e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 133.878 Tflops/s, hfu: 133.878 Tflops/s, 445.299 iter/s, 2.246e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 126.59 Tflops/s, hfu: 126.59 Tflops/s, 421.057 iter/s, 2.375e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 124.885 Tflops/s, hfu: 124.885 Tflops/s, 415.386 iter/s, 2.407e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 145.032 Tflops/s, hfu: 145.032 Tflops/s, 482.398 iter/s, 2.073e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 181.044 Tflops/s, hfu: 181.044 Tflops/s, 602.180 iter/s, 1.661e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 186.005 Tflops/s, hfu: 186.005 Tflops/s, 618.680 iter/s, 1.616e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 146.926 Tflops/s, hfu: 146.926 Tflops/s, 488.699 iter/s, 2.046e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 153.69 Tflops/s, hfu: 153.69 Tflops/s, 511.197 iter/s, 1.956e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(81920,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.355 Tflops/s, hfu: 60.355 Tflops/s, 351.310 iter/s, 2.846e-03 s/iter, (0.043, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.01 Tflops/s, hfu: 100.01 Tflops/s, 582.134 iter/s, 1.718e-03 s/iter, (0.022, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 53.28 Tflops/s, hfu: 53.28 Tflops/s, 310.132 iter/s, 3.224e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 133.387 Tflops/s, hfu: 133.387 Tflops/s, 388.208 iter/s, 2.576e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 128.111 Tflops/s, hfu: 128.111 Tflops/s, 372.852 iter/s, 2.682e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 125.749 Tflops/s, hfu: 125.749 Tflops/s, 365.976 iter/s, 2.732e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 143.507 Tflops/s, hfu: 143.507 Tflops/s, 417.659 iter/s, 2.394e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 186.717 Tflops/s, hfu: 186.717 Tflops/s, 543.419 iter/s, 1.840e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 188.448 Tflops/s, hfu: 188.448 Tflops/s, 548.455 iter/s, 1.823e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 148.863 Tflops/s, hfu: 148.863 Tflops/s, 433.247 iter/s, 2.308e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 156.044 Tflops/s, hfu: 156.044 Tflops/s, 454.147 iter/s, 2.202e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(81920,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.99 Tflops/s, hfu: 67.99 Tflops/s, 316.603 iter/s, 3.159e-03 s/iter, (0.041, 0.000, 0.063) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.319 Tflops/s, hfu: 115.319 Tflops/s, 536.998 iter/s, 1.862e-03 s/iter, (0.023, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 64.862 Tflops/s, hfu: 64.862 Tflops/s, 302.036 iter/s, 3.311e-03 s/iter, (0.039, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 137.52 Tflops/s, hfu: 137.52 Tflops/s, 320.188 iter/s, 3.123e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 132.989 Tflops/s, hfu: 132.989 Tflops/s, 309.640 iter/s, 3.230e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 131.196 Tflops/s, hfu: 131.196 Tflops/s, 305.464 iter/s, 3.274e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 150.806 Tflops/s, hfu: 150.806 Tflops/s, 351.124 iter/s, 2.848e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 193.331 Tflops/s, hfu: 193.331 Tflops/s, 450.134 iter/s, 2.222e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 193.711 Tflops/s, hfu: 193.711 Tflops/s, 451.019 iter/s, 2.217e-03 s/iter, (0.083, 0.000, 0.009) sec
mfu: 151.119 Tflops/s, hfu: 151.119 Tflops/s, 351.851 iter/s, 2.842e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 157.26 Tflops/s, hfu: 157.26 Tflops/s, 366.150 iter/s, 2.731e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(81920,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.119 Tflops/s, hfu: 71.119 Tflops/s, 275.977 iter/s, 3.623e-03 s/iter, (0.050, 0.000, 0.072) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 128.2 Tflops/s, hfu: 128.2 Tflops/s, 497.483 iter/s, 2.010e-03 s/iter, (0.025, 0.000, 0.040) sec
# stripe_flash_attn_func, fwd
mfu: 75.382 Tflops/s, hfu: 75.382 Tflops/s, 292.521 iter/s, 3.419e-03 s/iter, (0.040, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 143.78 Tflops/s, hfu: 143.78 Tflops/s, 278.970 iter/s, 3.585e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 136.151 Tflops/s, hfu: 136.151 Tflops/s, 264.168 iter/s, 3.785e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 137.264 Tflops/s, hfu: 137.264 Tflops/s, 266.326 iter/s, 3.755e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 151.636 Tflops/s, hfu: 151.636 Tflops/s, 294.212 iter/s, 3.399e-03 s/iter, (0.085, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 198.507 Tflops/s, hfu: 198.507 Tflops/s, 385.155 iter/s, 2.596e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 197.597 Tflops/s, hfu: 197.597 Tflops/s, 383.389 iter/s, 2.608e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 152.709 Tflops/s, hfu: 152.709 Tflops/s, 296.295 iter/s, 3.375e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 159.408 Tflops/s, hfu: 159.408 Tflops/s, 309.292 iter/s, 3.233e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(81920,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.243 Tflops/s, hfu: 72.243 Tflops/s, 240.290 iter/s, 4.162e-03 s/iter, (0.051, 0.000, 0.083) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.535 Tflops/s, hfu: 132.535 Tflops/s, 440.831 iter/s, 2.268e-03 s/iter, (0.027, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 79.702 Tflops/s, hfu: 79.702 Tflops/s, 265.102 iter/s, 3.772e-03 s/iter, (0.042, 0.000, 0.075) sec
# orchestrated_attn_func
mfu: 142.488 Tflops/s, hfu: 142.488 Tflops/s, 236.969 iter/s, 4.220e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 139.067 Tflops/s, hfu: 139.067 Tflops/s, 231.278 iter/s, 4.324e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 134.865 Tflops/s, hfu: 134.865 Tflops/s, 224.291 iter/s, 4.458e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 154.733 Tflops/s, hfu: 154.733 Tflops/s, 257.332 iter/s, 3.886e-03 s/iter, (0.085, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 201.767 Tflops/s, hfu: 201.767 Tflops/s, 335.554 iter/s, 2.980e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 199.502 Tflops/s, hfu: 199.502 Tflops/s, 331.788 iter/s, 3.014e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 153.637 Tflops/s, hfu: 153.637 Tflops/s, 255.510 iter/s, 3.914e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 159.254 Tflops/s, hfu: 159.254 Tflops/s, 264.851 iter/s, 3.776e-03 s/iter, (0.091, 0.000, 0.015) sec
SP=(1,8),S=(81920,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.04 Tflops/s, hfu: 74.04 Tflops/s, 215.484 iter/s, 4.641e-03 s/iter, (0.056, 0.000, 0.093) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 135.51 Tflops/s, hfu: 135.51 Tflops/s, 394.387 iter/s, 2.536e-03 s/iter, (0.031, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 80.869 Tflops/s, hfu: 80.869 Tflops/s, 235.360 iter/s, 4.249e-03 s/iter, (0.049, 0.000, 0.085) sec
# orchestrated_attn_func
mfu: 143.848 Tflops/s, hfu: 143.848 Tflops/s, 209.327 iter/s, 4.777e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 136.507 Tflops/s, hfu: 136.507 Tflops/s, 198.643 iter/s, 5.034e-03 s/iter, (0.092, 0.000, 0.020) sec
mfu: 142.224 Tflops/s, hfu: 142.224 Tflops/s, 206.963 iter/s, 4.832e-03 s/iter, (0.092, 0.000, 0.019) sec
mfu: 157.504 Tflops/s, hfu: 157.504 Tflops/s, 229.198 iter/s, 4.363e-03 s/iter, (0.087, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 204.134 Tflops/s, hfu: 204.134 Tflops/s, 297.055 iter/s, 3.366e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 201.212 Tflops/s, hfu: 201.212 Tflops/s, 292.802 iter/s, 3.415e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 154.635 Tflops/s, hfu: 154.635 Tflops/s, 225.024 iter/s, 4.444e-03 s/iter, (0.091, 0.000, 0.018) sec
mfu: 160.37 Tflops/s, hfu: 160.37 Tflops/s, 233.370 iter/s, 4.285e-03 s/iter, (0.091, 0.000, 0.017) sec
SP=(1,8),S=(81920,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.965 Tflops/s, hfu: 75.965 Tflops/s, 176.870 iter/s, 5.654e-03 s/iter, (0.069, 0.000, 0.113) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 137.388 Tflops/s, hfu: 137.388 Tflops/s, 319.882 iter/s, 3.126e-03 s/iter, (0.038, 0.000, 0.063) sec
# stripe_flash_attn_func, fwd
mfu: 80.471 Tflops/s, hfu: 80.471 Tflops/s, 187.361 iter/s, 5.337e-03 s/iter, (0.061, 0.000, 0.107) sec
# orchestrated_attn_func
mfu: 144.561 Tflops/s, hfu: 144.561 Tflops/s, 168.291 iter/s, 5.942e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 140.808 Tflops/s, hfu: 140.808 Tflops/s, 163.922 iter/s, 6.100e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 138.474 Tflops/s, hfu: 138.474 Tflops/s, 161.205 iter/s, 6.203e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 158.449 Tflops/s, hfu: 158.449 Tflops/s, 184.459 iter/s, 5.421e-03 s/iter, (0.092, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 208.408 Tflops/s, hfu: 208.408 Tflops/s, 242.619 iter/s, 4.122e-03 s/iter, (0.087, 0.000, 0.016) sec
mfu: 203.878 Tflops/s, hfu: 203.878 Tflops/s, 237.345 iter/s, 4.213e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 155.514 Tflops/s, hfu: 155.514 Tflops/s, 181.043 iter/s, 5.524e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 161.073 Tflops/s, hfu: 161.073 Tflops/s, 187.513 iter/s, 5.333e-03 s/iter, (0.092, 0.000, 0.021) sec
SP=(1,8),S=(81920,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.098 Tflops/s, hfu: 78.098 Tflops/s, 151.530 iter/s, 6.599e-03 s/iter, (0.077, 0.000, 0.132) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 136.76 Tflops/s, hfu: 136.76 Tflops/s, 265.350 iter/s, 3.769e-03 s/iter, (0.044, 0.000, 0.075) sec
# stripe_flash_attn_func, fwd
mfu: 80.584 Tflops/s, hfu: 80.584 Tflops/s, 156.354 iter/s, 6.396e-03 s/iter, (0.071, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 148.002 Tflops/s, hfu: 148.002 Tflops/s, 143.581 iter/s, 6.965e-03 s/iter, (0.098, 0.001, 0.028) sec
mfu: 141.252 Tflops/s, hfu: 141.252 Tflops/s, 137.033 iter/s, 7.298e-03 s/iter, (0.100, 0.000, 0.029) sec
mfu: 140.791 Tflops/s, hfu: 140.791 Tflops/s, 136.585 iter/s, 7.321e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 165.783 Tflops/s, hfu: 165.783 Tflops/s, 160.831 iter/s, 6.218e-03 s/iter, (0.098, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 211.77 Tflops/s, hfu: 211.77 Tflops/s, 205.444 iter/s, 4.868e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 206.067 Tflops/s, hfu: 206.067 Tflops/s, 199.912 iter/s, 5.002e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 156.821 Tflops/s, hfu: 156.821 Tflops/s, 152.137 iter/s, 6.573e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 162.464 Tflops/s, hfu: 162.464 Tflops/s, 157.610 iter/s, 6.345e-03 s/iter, (0.096, 0.000, 0.025) sec
SP=(1,8),S=(81920,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.415 Tflops/s, hfu: 79.415 Tflops/s, 132.073 iter/s, 7.572e-03 s/iter, (0.087, 0.000, 0.151) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 137.463 Tflops/s, hfu: 137.463 Tflops/s, 228.611 iter/s, 4.374e-03 s/iter, (0.050, 0.000, 0.087) sec
# stripe_flash_attn_func, fwd
mfu: 79.389 Tflops/s, hfu: 79.389 Tflops/s, 132.029 iter/s, 7.574e-03 s/iter, (0.085, 0.000, 0.151) sec
# orchestrated_attn_func
mfu: 141.807 Tflops/s, hfu: 141.807 Tflops/s, 117.918 iter/s, 8.480e-03 s/iter, (0.104, 0.000, 0.034) sec
mfu: 140.739 Tflops/s, hfu: 140.739 Tflops/s, 117.030 iter/s, 8.545e-03 s/iter, (0.104, 0.000, 0.034) sec
mfu: 144.276 Tflops/s, hfu: 144.276 Tflops/s, 119.971 iter/s, 8.335e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 164.151 Tflops/s, hfu: 164.151 Tflops/s, 136.498 iter/s, 7.326e-03 s/iter, (0.101, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 213.913 Tflops/s, hfu: 213.913 Tflops/s, 177.876 iter/s, 5.622e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 207.353 Tflops/s, hfu: 207.353 Tflops/s, 172.422 iter/s, 5.800e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 157.541 Tflops/s, hfu: 157.541 Tflops/s, 131.001 iter/s, 7.634e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 162.703 Tflops/s, hfu: 162.703 Tflops/s, 135.294 iter/s, 7.391e-03 s/iter, (0.103, 0.000, 0.030) sec
SP=(1,8),S=(81920,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.194 Tflops/s, hfu: 80.194 Tflops/s, 116.698 iter/s, 8.569e-03 s/iter, (0.098, 0.000, 0.171) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 137.362 Tflops/s, hfu: 137.362 Tflops/s, 199.889 iter/s, 5.003e-03 s/iter, (0.056, 0.000, 0.100) sec
# stripe_flash_attn_func, fwd
mfu: 79.475 Tflops/s, hfu: 79.475 Tflops/s, 115.651 iter/s, 8.647e-03 s/iter, (0.096, 0.000, 0.173) sec
# orchestrated_attn_func
mfu: 146.529 Tflops/s, hfu: 146.529 Tflops/s, 106.614 iter/s, 9.380e-03 s/iter, (0.109, 0.000, 0.038) sec
mfu: 145.243 Tflops/s, hfu: 145.243 Tflops/s, 105.678 iter/s, 9.463e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 143.57 Tflops/s, hfu: 143.57 Tflops/s, 104.461 iter/s, 9.573e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 167.37 Tflops/s, hfu: 167.37 Tflops/s, 121.777 iter/s, 8.212e-03 s/iter, (0.107, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 215.51 Tflops/s, hfu: 215.51 Tflops/s, 156.804 iter/s, 6.377e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 208.295 Tflops/s, hfu: 208.295 Tflops/s, 151.554 iter/s, 6.598e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 158.031 Tflops/s, hfu: 158.031 Tflops/s, 114.983 iter/s, 8.697e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 162.622 Tflops/s, hfu: 162.622 Tflops/s, 118.323 iter/s, 8.451e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(81920,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.936 Tflops/s, hfu: 80.936 Tflops/s, 94.222 iter/s, 1.061e-02 s/iter, (0.119, 0.000, 0.212) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 138.64 Tflops/s, hfu: 138.64 Tflops/s, 161.398 iter/s, 6.196e-03 s/iter, (0.069, 0.000, 0.124) sec
# stripe_flash_attn_func, fwd
mfu: 78.593 Tflops/s, hfu: 78.593 Tflops/s, 91.494 iter/s, 1.093e-02 s/iter, (0.117, 0.000, 0.219) sec
# orchestrated_attn_func
mfu: 148.473 Tflops/s, hfu: 148.473 Tflops/s, 86.423 iter/s, 1.157e-02 s/iter, (0.127, 0.000, 0.046) sec
mfu: 145.487 Tflops/s, hfu: 145.487 Tflops/s, 84.685 iter/s, 1.181e-02 s/iter, (0.118, 0.000, 0.047) sec
mfu: 145.178 Tflops/s, hfu: 145.178 Tflops/s, 84.504 iter/s, 1.183e-02 s/iter, (0.118, 0.000, 0.047) sec
mfu: 168.344 Tflops/s, hfu: 168.344 Tflops/s, 97.989 iter/s, 1.021e-02 s/iter, (0.117, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 217.572 Tflops/s, hfu: 217.572 Tflops/s, 126.643 iter/s, 7.896e-03 s/iter, (0.101, 0.000, 0.032) sec
mfu: 210.01 Tflops/s, hfu: 210.01 Tflops/s, 122.242 iter/s, 8.181e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 158.557 Tflops/s, hfu: 158.557 Tflops/s, 92.292 iter/s, 1.084e-02 s/iter, (0.113, 0.000, 0.043) sec
mfu: 163.035 Tflops/s, hfu: 163.035 Tflops/s, 94.899 iter/s, 1.054e-02 s/iter, (0.114, 0.000, 0.042) sec
SP=(1,8),S=(81920,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 82.551 Tflops/s, hfu: 82.551 Tflops/s, 80.085 iter/s, 1.249e-02 s/iter, (0.141, 0.000, 0.250) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.29 Tflops/s, hfu: 140.29 Tflops/s, 136.099 iter/s, 7.348e-03 s/iter, (0.082, 0.000, 0.147) sec
# stripe_flash_attn_func, fwd
mfu: 79.286 Tflops/s, hfu: 79.286 Tflops/s, 76.917 iter/s, 1.300e-02 s/iter, (0.139, 0.000, 0.260) sec
# orchestrated_attn_func
mfu: 147.153 Tflops/s, hfu: 147.153 Tflops/s, 71.378 iter/s, 1.401e-02 s/iter, (0.132, 0.000, 0.056) sec
mfu: 143.355 Tflops/s, hfu: 143.355 Tflops/s, 69.536 iter/s, 1.438e-02 s/iter, (0.129, 0.000, 0.058) sec
mfu: 144.349 Tflops/s, hfu: 144.349 Tflops/s, 70.019 iter/s, 1.428e-02 s/iter, (0.130, 0.000, 0.057) sec
mfu: 170.386 Tflops/s, hfu: 170.386 Tflops/s, 82.648 iter/s, 1.210e-02 s/iter, (0.124, 0.000, 0.048) sec
# orchestrated_attn_func fused
mfu: 219.336 Tflops/s, hfu: 219.336 Tflops/s, 106.392 iter/s, 9.399e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 211.503 Tflops/s, hfu: 211.503 Tflops/s, 102.592 iter/s, 9.747e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 159.08 Tflops/s, hfu: 159.08 Tflops/s, 77.164 iter/s, 1.296e-02 s/iter, (0.125, 0.000, 0.052) sec
mfu: 163.62 Tflops/s, hfu: 163.62 Tflops/s, 79.366 iter/s, 1.260e-02 s/iter, (0.124, 0.000, 0.050) sec
SP=(1,8),S=(81920,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.343 Tflops/s, hfu: 83.343 Tflops/s, 69.302 iter/s, 1.443e-02 s/iter, (0.162, 0.000, 0.289) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.745 Tflops/s, hfu: 139.745 Tflops/s, 116.203 iter/s, 8.606e-03 s/iter, (0.095, 0.000, 0.172) sec
# stripe_flash_attn_func, fwd
mfu: 79.954 Tflops/s, hfu: 79.954 Tflops/s, 66.485 iter/s, 1.504e-02 s/iter, (0.160, 0.000, 0.301) sec
# orchestrated_attn_func
mfu: 146.099 Tflops/s, hfu: 146.099 Tflops/s, 60.744 iter/s, 1.646e-02 s/iter, (0.137, 0.000, 0.066) sec
mfu: 141.347 Tflops/s, hfu: 141.347 Tflops/s, 58.768 iter/s, 1.702e-02 s/iter, (0.139, 0.000, 0.068) sec
mfu: 146.276 Tflops/s, hfu: 146.276 Tflops/s, 60.817 iter/s, 1.644e-02 s/iter, (0.134, 0.000, 0.066) sec
mfu: 169.784 Tflops/s, hfu: 169.784 Tflops/s, 70.591 iter/s, 1.417e-02 s/iter, (0.129, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 220.059 Tflops/s, hfu: 220.059 Tflops/s, 91.494 iter/s, 1.093e-02 s/iter, (0.116, 0.000, 0.044) sec
mfu: 211.362 Tflops/s, hfu: 211.362 Tflops/s, 87.878 iter/s, 1.138e-02 s/iter, (0.119, 0.000, 0.046) sec
mfu: 159.462 Tflops/s, hfu: 159.462 Tflops/s, 66.299 iter/s, 1.508e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 163.591 Tflops/s, hfu: 163.591 Tflops/s, 68.016 iter/s, 1.470e-02 s/iter, (0.132, 0.000, 0.059) sec
SP=(1,8),S=(81920,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.076 Tflops/s, hfu: 84.076 Tflops/s, 61.173 iter/s, 1.635e-02 s/iter, (0.184, 0.000, 0.327) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 142.628 Tflops/s, hfu: 142.628 Tflops/s, 103.775 iter/s, 9.636e-03 s/iter, (0.108, 0.000, 0.193) sec
# stripe_flash_attn_func, fwd
mfu: 80.037 Tflops/s, hfu: 80.037 Tflops/s, 58.234 iter/s, 1.717e-02 s/iter, (0.181, 0.000, 0.343) sec
# orchestrated_attn_func
mfu: 148.14 Tflops/s, hfu: 148.14 Tflops/s, 53.893 iter/s, 1.856e-02 s/iter, (0.150, 0.000, 0.074) sec
mfu: 144.196 Tflops/s, hfu: 144.196 Tflops/s, 52.458 iter/s, 1.906e-02 s/iter, (0.148, 0.000, 0.076) sec
mfu: 150.734 Tflops/s, hfu: 150.734 Tflops/s, 54.837 iter/s, 1.824e-02 s/iter, (0.147, 0.000, 0.073) sec
mfu: 169.627 Tflops/s, hfu: 169.627 Tflops/s, 61.710 iter/s, 1.620e-02 s/iter, (0.146, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 221.193 Tflops/s, hfu: 221.193 Tflops/s, 80.469 iter/s, 1.243e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 212.113 Tflops/s, hfu: 212.113 Tflops/s, 77.166 iter/s, 1.296e-02 s/iter, (0.123, 0.000, 0.052) sec
mfu: 159.81 Tflops/s, hfu: 159.81 Tflops/s, 58.139 iter/s, 1.720e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 163.999 Tflops/s, hfu: 163.999 Tflops/s, 59.662 iter/s, 1.676e-02 s/iter, (0.138, 0.000, 0.067) sec
SP=(1,8),S=(98304,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.412 Tflops/s, hfu: 2.412 Tflops/s, 374.410 iter/s, 2.671e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 4.367 Tflops/s, hfu: 4.367 Tflops/s, 677.774 iter/s, 1.475e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 2.097 Tflops/s, hfu: 2.097 Tflops/s, 325.526 iter/s, 3.072e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 25.136 Tflops/s, hfu: 25.136 Tflops/s, 1950.778 iter/s, 5.126e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 38.499 Tflops/s, hfu: 38.499 Tflops/s, 2987.929 iter/s, 3.347e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 48.512 Tflops/s, hfu: 48.512 Tflops/s, 3765.060 iter/s, 2.656e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 68.639 Tflops/s, hfu: 68.639 Tflops/s, 5327.083 iter/s, 1.877e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 29.301 Tflops/s, hfu: 29.301 Tflops/s, 2274.050 iter/s, 4.397e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 43.223 Tflops/s, hfu: 43.223 Tflops/s, 3354.534 iter/s, 2.981e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 57.734 Tflops/s, hfu: 57.734 Tflops/s, 4480.769 iter/s, 2.232e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 95.762 Tflops/s, hfu: 95.762 Tflops/s, 7432.071 iter/s, 1.346e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(98304,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.859 Tflops/s, hfu: 4.859 Tflops/s, 377.145 iter/s, 2.652e-03 s/iter, (0.032, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.713 Tflops/s, hfu: 8.713 Tflops/s, 676.217 iter/s, 1.479e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.212 Tflops/s, hfu: 4.212 Tflops/s, 326.865 iter/s, 3.059e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 48.114 Tflops/s, hfu: 48.114 Tflops/s, 1867.065 iter/s, 5.356e-04 s/iter, (0.081, 0.000, 0.002) sec
mfu: 62.06 Tflops/s, hfu: 62.06 Tflops/s, 2408.246 iter/s, 4.152e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 68.343 Tflops/s, hfu: 68.343 Tflops/s, 2652.070 iter/s, 3.771e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 100.884 Tflops/s, hfu: 100.884 Tflops/s, 3914.814 iter/s, 2.554e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 51.783 Tflops/s, hfu: 51.783 Tflops/s, 2009.452 iter/s, 4.976e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 69.586 Tflops/s, hfu: 69.586 Tflops/s, 2700.309 iter/s, 3.703e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 86.837 Tflops/s, hfu: 86.837 Tflops/s, 3369.726 iter/s, 2.968e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 122.067 Tflops/s, hfu: 122.067 Tflops/s, 4736.822 iter/s, 2.111e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(98304,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.186 Tflops/s, hfu: 7.186 Tflops/s, 371.814 iter/s, 2.690e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.916 Tflops/s, hfu: 12.916 Tflops/s, 668.287 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 6.284 Tflops/s, hfu: 6.284 Tflops/s, 325.132 iter/s, 3.076e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 67.845 Tflops/s, hfu: 67.845 Tflops/s, 1755.150 iter/s, 5.698e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 74.133 Tflops/s, hfu: 74.133 Tflops/s, 1917.825 iter/s, 5.214e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 77.146 Tflops/s, hfu: 77.146 Tflops/s, 1995.785 iter/s, 5.011e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 117.838 Tflops/s, hfu: 117.838 Tflops/s, 3048.483 iter/s, 3.280e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 69.442 Tflops/s, hfu: 69.442 Tflops/s, 1796.467 iter/s, 5.566e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 89.611 Tflops/s, hfu: 89.611 Tflops/s, 2318.249 iter/s, 4.314e-04 s/iter, (0.079, 0.000, 0.002) sec
mfu: 106.522 Tflops/s, hfu: 106.522 Tflops/s, 2755.732 iter/s, 3.629e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 130.031 Tflops/s, hfu: 130.031 Tflops/s, 3363.923 iter/s, 2.973e-04 s/iter, (0.075, 0.000, 0.001) sec
SP=(1,8),S=(98304,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.712 Tflops/s, hfu: 9.712 Tflops/s, 376.879 iter/s, 2.653e-03 s/iter, (0.031, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.406 Tflops/s, hfu: 17.406 Tflops/s, 675.444 iter/s, 1.481e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.439 Tflops/s, hfu: 8.439 Tflops/s, 327.478 iter/s, 3.054e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 76.588 Tflops/s, hfu: 76.588 Tflops/s, 1486.008 iter/s, 6.729e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 79.908 Tflops/s, hfu: 79.908 Tflops/s, 1550.426 iter/s, 6.450e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 84.877 Tflops/s, hfu: 84.877 Tflops/s, 1646.839 iter/s, 6.072e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 123.445 Tflops/s, hfu: 123.445 Tflops/s, 2395.141 iter/s, 4.175e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.05 Tflops/s, hfu: 83.05 Tflops/s, 1611.385 iter/s, 6.206e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 102.801 Tflops/s, hfu: 102.801 Tflops/s, 1994.607 iter/s, 5.014e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 114.63 Tflops/s, hfu: 114.63 Tflops/s, 2224.120 iter/s, 4.496e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 138.479 Tflops/s, hfu: 138.479 Tflops/s, 2686.843 iter/s, 3.722e-04 s/iter, (0.077, 0.000, 0.001) sec
SP=(1,8),S=(98304,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.811 Tflops/s, hfu: 11.811 Tflops/s, 366.667 iter/s, 2.727e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.363 Tflops/s, hfu: 21.363 Tflops/s, 663.194 iter/s, 1.508e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 10.504 Tflops/s, hfu: 10.504 Tflops/s, 326.088 iter/s, 3.067e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 82.771 Tflops/s, hfu: 82.771 Tflops/s, 1284.779 iter/s, 7.783e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 83.977 Tflops/s, hfu: 83.977 Tflops/s, 1303.495 iter/s, 7.672e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 88.63 Tflops/s, hfu: 88.63 Tflops/s, 1375.713 iter/s, 7.269e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 130.732 Tflops/s, hfu: 130.732 Tflops/s, 2029.221 iter/s, 4.928e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 94.795 Tflops/s, hfu: 94.795 Tflops/s, 1471.419 iter/s, 6.796e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 109.903 Tflops/s, hfu: 109.903 Tflops/s, 1705.926 iter/s, 5.862e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 123.701 Tflops/s, hfu: 123.701 Tflops/s, 1920.093 iter/s, 5.208e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 143.219 Tflops/s, hfu: 143.219 Tflops/s, 2223.052 iter/s, 4.498e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(98304,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 14.128 Tflops/s, hfu: 14.128 Tflops/s, 365.483 iter/s, 2.736e-03 s/iter, (0.032, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.528 Tflops/s, hfu: 25.528 Tflops/s, 660.411 iter/s, 1.514e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 12.478 Tflops/s, hfu: 12.478 Tflops/s, 322.795 iter/s, 3.098e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 83.893 Tflops/s, hfu: 83.893 Tflops/s, 1085.164 iter/s, 9.215e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 88.498 Tflops/s, hfu: 88.498 Tflops/s, 1144.731 iter/s, 8.736e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 90.25 Tflops/s, hfu: 90.25 Tflops/s, 1167.384 iter/s, 8.566e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 137.549 Tflops/s, hfu: 137.549 Tflops/s, 1779.207 iter/s, 5.620e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 103.794 Tflops/s, hfu: 103.794 Tflops/s, 1342.585 iter/s, 7.448e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 119.078 Tflops/s, hfu: 119.078 Tflops/s, 1540.282 iter/s, 6.492e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 131.625 Tflops/s, hfu: 131.625 Tflops/s, 1702.580 iter/s, 5.873e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 146.357 Tflops/s, hfu: 146.357 Tflops/s, 1893.136 iter/s, 5.282e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(98304,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.529 Tflops/s, hfu: 16.529 Tflops/s, 366.516 iter/s, 2.728e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.331 Tflops/s, hfu: 29.331 Tflops/s, 650.386 iter/s, 1.538e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 14.605 Tflops/s, hfu: 14.605 Tflops/s, 323.848 iter/s, 3.088e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 85.219 Tflops/s, hfu: 85.219 Tflops/s, 944.837 iter/s, 1.058e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 89.421 Tflops/s, hfu: 89.421 Tflops/s, 991.426 iter/s, 1.009e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 92.738 Tflops/s, hfu: 92.738 Tflops/s, 1028.206 iter/s, 9.726e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 138.435 Tflops/s, hfu: 138.435 Tflops/s, 1534.853 iter/s, 6.515e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 111.71 Tflops/s, hfu: 111.71 Tflops/s, 1238.544 iter/s, 8.074e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 128.182 Tflops/s, hfu: 128.182 Tflops/s, 1421.181 iter/s, 7.036e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 137.795 Tflops/s, hfu: 137.795 Tflops/s, 1527.763 iter/s, 6.546e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 148.408 Tflops/s, hfu: 148.408 Tflops/s, 1645.430 iter/s, 6.077e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(98304,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.894 Tflops/s, hfu: 18.894 Tflops/s, 366.595 iter/s, 2.728e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.977 Tflops/s, hfu: 33.977 Tflops/s, 659.238 iter/s, 1.517e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.665 Tflops/s, hfu: 16.665 Tflops/s, 323.338 iter/s, 3.093e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 88.098 Tflops/s, hfu: 88.098 Tflops/s, 854.660 iter/s, 1.170e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 92.142 Tflops/s, hfu: 92.142 Tflops/s, 893.898 iter/s, 1.119e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 93.193 Tflops/s, hfu: 93.193 Tflops/s, 904.087 iter/s, 1.106e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 142.376 Tflops/s, hfu: 142.376 Tflops/s, 1381.231 iter/s, 7.240e-04 s/iter, (0.075, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 118.267 Tflops/s, hfu: 118.267 Tflops/s, 1147.336 iter/s, 8.716e-04 s/iter, (0.194, 0.000, 0.003) sec
mfu: 134.155 Tflops/s, hfu: 134.155 Tflops/s, 1301.473 iter/s, 7.684e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 142.243 Tflops/s, hfu: 142.243 Tflops/s, 1379.935 iter/s, 7.247e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 149.59 Tflops/s, hfu: 149.59 Tflops/s, 1451.210 iter/s, 6.891e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(98304,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.534 Tflops/s, hfu: 23.534 Tflops/s, 365.295 iter/s, 2.738e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.243 Tflops/s, hfu: 43.243 Tflops/s, 671.218 iter/s, 1.490e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 20.849 Tflops/s, hfu: 20.849 Tflops/s, 323.612 iter/s, 3.090e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 91.049 Tflops/s, hfu: 91.049 Tflops/s, 706.634 iter/s, 1.415e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 94.03 Tflops/s, hfu: 94.03 Tflops/s, 729.765 iter/s, 1.370e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 96.443 Tflops/s, hfu: 96.443 Tflops/s, 748.494 iter/s, 1.336e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 148.839 Tflops/s, hfu: 148.839 Tflops/s, 1155.140 iter/s, 8.657e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 129.708 Tflops/s, hfu: 129.708 Tflops/s, 1006.668 iter/s, 9.934e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 143.929 Tflops/s, hfu: 143.929 Tflops/s, 1117.039 iter/s, 8.952e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 152.591 Tflops/s, hfu: 152.591 Tflops/s, 1184.262 iter/s, 8.444e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 152.477 Tflops/s, hfu: 152.477 Tflops/s, 1183.376 iter/s, 8.450e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(98304,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 28.619 Tflops/s, hfu: 28.619 Tflops/s, 370.191 iter/s, 2.701e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.509 Tflops/s, hfu: 51.509 Tflops/s, 666.265 iter/s, 1.501e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.872 Tflops/s, hfu: 24.872 Tflops/s, 321.717 iter/s, 3.108e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 92.967 Tflops/s, hfu: 92.967 Tflops/s, 601.265 iter/s, 1.663e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 95.183 Tflops/s, hfu: 95.183 Tflops/s, 615.597 iter/s, 1.624e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 97.126 Tflops/s, hfu: 97.126 Tflops/s, 628.163 iter/s, 1.592e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 150.726 Tflops/s, hfu: 150.726 Tflops/s, 974.826 iter/s, 1.026e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 138.376 Tflops/s, hfu: 138.376 Tflops/s, 894.948 iter/s, 1.117e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 151.242 Tflops/s, hfu: 151.242 Tflops/s, 978.160 iter/s, 1.022e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 157.981 Tflops/s, hfu: 157.981 Tflops/s, 1021.743 iter/s, 9.787e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 154.818 Tflops/s, hfu: 154.818 Tflops/s, 1001.290 iter/s, 9.987e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(98304,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.529 Tflops/s, hfu: 33.529 Tflops/s, 371.743 iter/s, 2.690e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.835 Tflops/s, hfu: 55.835 Tflops/s, 619.049 iter/s, 1.615e-03 s/iter, (0.019, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 28.693 Tflops/s, hfu: 28.693 Tflops/s, 318.119 iter/s, 3.143e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 94.488 Tflops/s, hfu: 94.488 Tflops/s, 523.802 iter/s, 1.909e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 97.732 Tflops/s, hfu: 97.732 Tflops/s, 541.787 iter/s, 1.846e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 98.026 Tflops/s, hfu: 98.026 Tflops/s, 543.417 iter/s, 1.840e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 155.674 Tflops/s, hfu: 155.674 Tflops/s, 862.992 iter/s, 1.159e-03 s/iter, (0.074, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 145.663 Tflops/s, hfu: 145.663 Tflops/s, 807.494 iter/s, 1.238e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 157.188 Tflops/s, hfu: 157.188 Tflops/s, 871.384 iter/s, 1.148e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 162.065 Tflops/s, hfu: 162.065 Tflops/s, 898.421 iter/s, 1.113e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 155.679 Tflops/s, hfu: 155.679 Tflops/s, 863.021 iter/s, 1.159e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(98304,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.833 Tflops/s, hfu: 37.833 Tflops/s, 367.030 iter/s, 2.725e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.249 Tflops/s, hfu: 58.249 Tflops/s, 565.091 iter/s, 1.770e-03 s/iter, (0.022, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 32.496 Tflops/s, hfu: 32.496 Tflops/s, 315.251 iter/s, 3.172e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 96.07 Tflops/s, hfu: 96.07 Tflops/s, 466.002 iter/s, 2.146e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 97.05 Tflops/s, hfu: 97.05 Tflops/s, 470.755 iter/s, 2.124e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 98.281 Tflops/s, hfu: 98.281 Tflops/s, 476.724 iter/s, 2.098e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 159.746 Tflops/s, hfu: 159.746 Tflops/s, 774.872 iter/s, 1.291e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 151.366 Tflops/s, hfu: 151.366 Tflops/s, 734.223 iter/s, 1.362e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 160.323 Tflops/s, hfu: 160.323 Tflops/s, 777.668 iter/s, 1.286e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 165.504 Tflops/s, hfu: 165.504 Tflops/s, 802.800 iter/s, 1.246e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 153.316 Tflops/s, hfu: 153.316 Tflops/s, 743.680 iter/s, 1.345e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(98304,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.828 Tflops/s, hfu: 47.828 Tflops/s, 371.192 iter/s, 2.694e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 63.037 Tflops/s, hfu: 63.037 Tflops/s, 489.229 iter/s, 2.044e-03 s/iter, (0.024, 0.000, 0.041) sec
# stripe_flash_attn_func, fwd
mfu: 41.087 Tflops/s, hfu: 41.087 Tflops/s, 318.880 iter/s, 3.136e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 96.964 Tflops/s, hfu: 96.964 Tflops/s, 376.271 iter/s, 2.658e-03 s/iter, (0.085, 0.000, 0.011) sec
mfu: 97.805 Tflops/s, hfu: 97.805 Tflops/s, 379.533 iter/s, 2.635e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 99.31 Tflops/s, hfu: 99.31 Tflops/s, 385.373 iter/s, 2.595e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 161.416 Tflops/s, hfu: 161.416 Tflops/s, 626.378 iter/s, 1.596e-03 s/iter, (0.079, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 159.9 Tflops/s, hfu: 159.9 Tflops/s, 620.495 iter/s, 1.612e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 167.673 Tflops/s, hfu: 167.673 Tflops/s, 650.655 iter/s, 1.537e-03 s/iter, (0.080, 0.000, 0.006) sec
mfu: 169.975 Tflops/s, hfu: 169.975 Tflops/s, 659.589 iter/s, 1.516e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 155.69 Tflops/s, hfu: 155.69 Tflops/s, 604.157 iter/s, 1.655e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(98304,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.588 Tflops/s, hfu: 56.588 Tflops/s, 365.981 iter/s, 2.732e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 65.593 Tflops/s, hfu: 65.593 Tflops/s, 424.224 iter/s, 2.357e-03 s/iter, (0.027, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 49.236 Tflops/s, hfu: 49.236 Tflops/s, 318.438 iter/s, 3.140e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 97.645 Tflops/s, hfu: 97.645 Tflops/s, 315.760 iter/s, 3.167e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 99.306 Tflops/s, hfu: 99.306 Tflops/s, 321.131 iter/s, 3.114e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 100.34 Tflops/s, hfu: 100.34 Tflops/s, 324.476 iter/s, 3.082e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 162.43 Tflops/s, hfu: 162.43 Tflops/s, 525.259 iter/s, 1.904e-03 s/iter, (0.077, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 166.407 Tflops/s, hfu: 166.407 Tflops/s, 538.120 iter/s, 1.858e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 172.51 Tflops/s, hfu: 172.51 Tflops/s, 557.856 iter/s, 1.793e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 174.506 Tflops/s, hfu: 174.506 Tflops/s, 564.311 iter/s, 1.772e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 157.62 Tflops/s, hfu: 157.62 Tflops/s, 509.705 iter/s, 1.962e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(98304,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.816 Tflops/s, hfu: 64.816 Tflops/s, 359.315 iter/s, 2.783e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 75.716 Tflops/s, hfu: 75.716 Tflops/s, 419.739 iter/s, 2.382e-03 s/iter, (0.027, 0.000, 0.048) sec
# stripe_flash_attn_func, fwd
mfu: 57.051 Tflops/s, hfu: 57.051 Tflops/s, 316.267 iter/s, 3.162e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 98.59 Tflops/s, hfu: 98.59 Tflops/s, 273.270 iter/s, 3.659e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 99.589 Tflops/s, hfu: 99.589 Tflops/s, 276.041 iter/s, 3.623e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 100.758 Tflops/s, hfu: 100.758 Tflops/s, 279.280 iter/s, 3.581e-03 s/iter, (0.087, 0.000, 0.014) sec
mfu: 163.546 Tflops/s, hfu: 163.546 Tflops/s, 453.316 iter/s, 2.206e-03 s/iter, (0.078, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 171.417 Tflops/s, hfu: 171.417 Tflops/s, 475.133 iter/s, 2.105e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 176.16 Tflops/s, hfu: 176.16 Tflops/s, 488.279 iter/s, 2.048e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 176.285 Tflops/s, hfu: 176.285 Tflops/s, 488.625 iter/s, 2.047e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 158.356 Tflops/s, hfu: 158.356 Tflops/s, 438.929 iter/s, 2.278e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(98304,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.229 Tflops/s, hfu: 67.229 Tflops/s, 326.103 iter/s, 3.067e-03 s/iter, (0.038, 0.000, 0.061) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 85.228 Tflops/s, hfu: 85.228 Tflops/s, 413.411 iter/s, 2.419e-03 s/iter, (0.028, 0.000, 0.048) sec
# stripe_flash_attn_func, fwd
mfu: 62.216 Tflops/s, hfu: 62.216 Tflops/s, 301.788 iter/s, 3.314e-03 s/iter, (0.040, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 99.012 Tflops/s, hfu: 99.012 Tflops/s, 240.135 iter/s, 4.164e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 100.198 Tflops/s, hfu: 100.198 Tflops/s, 243.012 iter/s, 4.115e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 100.691 Tflops/s, hfu: 100.691 Tflops/s, 244.209 iter/s, 4.095e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 163.881 Tflops/s, hfu: 163.881 Tflops/s, 397.463 iter/s, 2.516e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 175.569 Tflops/s, hfu: 175.569 Tflops/s, 425.812 iter/s, 2.348e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 179.05 Tflops/s, hfu: 179.05 Tflops/s, 434.252 iter/s, 2.303e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 178.497 Tflops/s, hfu: 178.497 Tflops/s, 432.912 iter/s, 2.310e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 159.079 Tflops/s, hfu: 159.079 Tflops/s, 385.817 iter/s, 2.592e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(98304,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.85 Tflops/s, hfu: 69.85 Tflops/s, 271.053 iter/s, 3.689e-03 s/iter, (0.044, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.496 Tflops/s, hfu: 103.496 Tflops/s, 401.619 iter/s, 2.490e-03 s/iter, (0.029, 0.000, 0.050) sec
# stripe_flash_attn_func, fwd
mfu: 67.702 Tflops/s, hfu: 67.702 Tflops/s, 262.717 iter/s, 3.806e-03 s/iter, (0.044, 0.000, 0.076) sec
# orchestrated_attn_func
mfu: 99.771 Tflops/s, hfu: 99.771 Tflops/s, 193.582 iter/s, 5.166e-03 s/iter, (0.092, 0.000, 0.021) sec
mfu: 100.595 Tflops/s, hfu: 100.595 Tflops/s, 195.180 iter/s, 5.123e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 101.394 Tflops/s, hfu: 101.394 Tflops/s, 196.730 iter/s, 5.083e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 168.816 Tflops/s, hfu: 168.816 Tflops/s, 327.546 iter/s, 3.053e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 180.495 Tflops/s, hfu: 180.495 Tflops/s, 350.206 iter/s, 2.855e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 182.541 Tflops/s, hfu: 182.541 Tflops/s, 354.176 iter/s, 2.823e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 180.634 Tflops/s, hfu: 180.634 Tflops/s, 350.477 iter/s, 2.853e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 160.963 Tflops/s, hfu: 160.963 Tflops/s, 312.310 iter/s, 3.202e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(98304,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.504 Tflops/s, hfu: 71.504 Tflops/s, 231.228 iter/s, 4.325e-03 s/iter, (0.055, 0.000, 0.086) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.225 Tflops/s, hfu: 118.225 Tflops/s, 382.312 iter/s, 2.616e-03 s/iter, (0.032, 0.000, 0.052) sec
# stripe_flash_attn_func, fwd
mfu: 66.394 Tflops/s, hfu: 66.394 Tflops/s, 214.703 iter/s, 4.658e-03 s/iter, (0.053, 0.000, 0.093) sec
# orchestrated_attn_func
mfu: 100.007 Tflops/s, hfu: 100.007 Tflops/s, 161.699 iter/s, 6.184e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 101.095 Tflops/s, hfu: 101.095 Tflops/s, 163.459 iter/s, 6.118e-03 s/iter, (0.095, 0.000, 0.024) sec
mfu: 101.587 Tflops/s, hfu: 101.587 Tflops/s, 164.254 iter/s, 6.088e-03 s/iter, (0.095, 0.000, 0.024) sec
mfu: 169.357 Tflops/s, hfu: 169.357 Tflops/s, 273.829 iter/s, 3.652e-03 s/iter, (0.084, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 184.336 Tflops/s, hfu: 184.336 Tflops/s, 298.048 iter/s, 3.355e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 185.383 Tflops/s, hfu: 185.383 Tflops/s, 299.742 iter/s, 3.336e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 182.749 Tflops/s, hfu: 182.749 Tflops/s, 295.483 iter/s, 3.384e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 161.658 Tflops/s, hfu: 161.658 Tflops/s, 261.382 iter/s, 3.826e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(98304,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.637 Tflops/s, hfu: 73.637 Tflops/s, 204.107 iter/s, 4.899e-03 s/iter, (0.061, 0.000, 0.098) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.258 Tflops/s, hfu: 123.258 Tflops/s, 341.646 iter/s, 2.927e-03 s/iter, (0.036, 0.000, 0.059) sec
# stripe_flash_attn_func, fwd
mfu: 68.035 Tflops/s, hfu: 68.035 Tflops/s, 188.578 iter/s, 5.303e-03 s/iter, (0.061, 0.000, 0.106) sec
# orchestrated_attn_func
mfu: 100.994 Tflops/s, hfu: 100.994 Tflops/s, 139.967 iter/s, 7.145e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 101.414 Tflops/s, hfu: 101.414 Tflops/s, 140.549 iter/s, 7.115e-03 s/iter, (0.099, 0.000, 0.028) sec
mfu: 101.595 Tflops/s, hfu: 101.595 Tflops/s, 140.801 iter/s, 7.102e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 169.756 Tflops/s, hfu: 169.756 Tflops/s, 235.265 iter/s, 4.251e-03 s/iter, (0.087, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 187.514 Tflops/s, hfu: 187.514 Tflops/s, 259.875 iter/s, 3.848e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 186.986 Tflops/s, hfu: 186.986 Tflops/s, 259.143 iter/s, 3.859e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 184.011 Tflops/s, hfu: 184.011 Tflops/s, 255.021 iter/s, 3.921e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 161.925 Tflops/s, hfu: 161.925 Tflops/s, 224.411 iter/s, 4.456e-03 s/iter, (0.091, 0.000, 0.018) sec
SP=(1,8),S=(98304,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.765 Tflops/s, hfu: 74.765 Tflops/s, 181.330 iter/s, 5.515e-03 s/iter, (0.065, 0.000, 0.110) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 128.079 Tflops/s, hfu: 128.079 Tflops/s, 310.633 iter/s, 3.219e-03 s/iter, (0.039, 0.000, 0.064) sec
# stripe_flash_attn_func, fwd
mfu: 68.617 Tflops/s, hfu: 68.617 Tflops/s, 166.418 iter/s, 6.009e-03 s/iter, (0.070, 0.000, 0.120) sec
# orchestrated_attn_func
mfu: 101.436 Tflops/s, hfu: 101.436 Tflops/s, 123.008 iter/s, 8.130e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 102.156 Tflops/s, hfu: 102.156 Tflops/s, 123.880 iter/s, 8.072e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 101.829 Tflops/s, hfu: 101.829 Tflops/s, 123.483 iter/s, 8.098e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 170.081 Tflops/s, hfu: 170.081 Tflops/s, 206.250 iter/s, 4.848e-03 s/iter, (0.089, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 189.874 Tflops/s, hfu: 189.874 Tflops/s, 230.252 iter/s, 4.343e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 188.878 Tflops/s, hfu: 188.878 Tflops/s, 229.045 iter/s, 4.366e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 185.565 Tflops/s, hfu: 185.565 Tflops/s, 225.027 iter/s, 4.444e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 162.839 Tflops/s, hfu: 162.839 Tflops/s, 197.469 iter/s, 5.064e-03 s/iter, (0.093, 0.000, 0.020) sec
SP=(1,8),S=(98304,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.792 Tflops/s, hfu: 80.792 Tflops/s, 156.758 iter/s, 6.379e-03 s/iter, (0.084, 0.000, 0.128) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 135.668 Tflops/s, hfu: 135.668 Tflops/s, 263.231 iter/s, 3.799e-03 s/iter, (0.048, 0.000, 0.076) sec
# stripe_flash_attn_func, fwd
mfu: 70.552 Tflops/s, hfu: 70.552 Tflops/s, 136.888 iter/s, 7.305e-03 s/iter, (0.087, 0.000, 0.146) sec
# orchestrated_attn_func
mfu: 101.472 Tflops/s, hfu: 101.472 Tflops/s, 98.441 iter/s, 1.016e-02 s/iter, (0.110, 0.000, 0.041) sec
mfu: 102.34 Tflops/s, hfu: 102.34 Tflops/s, 99.283 iter/s, 1.007e-02 s/iter, (0.110, 0.000, 0.040) sec
mfu: 102.27 Tflops/s, hfu: 102.27 Tflops/s, 99.215 iter/s, 1.008e-02 s/iter, (0.111, 0.000, 0.040) sec
mfu: 170.581 Tflops/s, hfu: 170.581 Tflops/s, 165.485 iter/s, 6.043e-03 s/iter, (0.094, 0.000, 0.024) sec
# orchestrated_attn_func fused
mfu: 192.872 Tflops/s, hfu: 192.872 Tflops/s, 187.111 iter/s, 5.344e-03 s/iter, (0.094, 0.000, 0.021) sec
mfu: 190.175 Tflops/s, hfu: 190.175 Tflops/s, 184.494 iter/s, 5.420e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 186.948 Tflops/s, hfu: 186.948 Tflops/s, 181.363 iter/s, 5.514e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 163.182 Tflops/s, hfu: 163.182 Tflops/s, 158.307 iter/s, 6.317e-03 s/iter, (0.095, 0.000, 0.025) sec
SP=(1,8),S=(98304,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.983 Tflops/s, hfu: 79.983 Tflops/s, 129.323 iter/s, 7.733e-03 s/iter, (0.095, 0.000, 0.155) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 137.939 Tflops/s, hfu: 137.939 Tflops/s, 223.031 iter/s, 4.484e-03 s/iter, (0.055, 0.000, 0.090) sec
# stripe_flash_attn_func, fwd
mfu: 71.196 Tflops/s, hfu: 71.196 Tflops/s, 115.115 iter/s, 8.687e-03 s/iter, (0.098, 0.000, 0.174) sec
# orchestrated_attn_func
mfu: 101.65 Tflops/s, hfu: 101.65 Tflops/s, 82.178 iter/s, 1.217e-02 s/iter, (0.118, 0.000, 0.049) sec
mfu: 102.327 Tflops/s, hfu: 102.327 Tflops/s, 82.725 iter/s, 1.209e-02 s/iter, (0.119, 0.000, 0.048) sec
mfu: 102.145 Tflops/s, hfu: 102.145 Tflops/s, 82.578 iter/s, 1.211e-02 s/iter, (0.118, 0.000, 0.048) sec
mfu: 170.721 Tflops/s, hfu: 170.721 Tflops/s, 138.018 iter/s, 7.245e-03 s/iter, (0.099, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 195.57 Tflops/s, hfu: 195.57 Tflops/s, 158.107 iter/s, 6.325e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 192.473 Tflops/s, hfu: 192.473 Tflops/s, 155.603 iter/s, 6.427e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 188.076 Tflops/s, hfu: 188.076 Tflops/s, 152.048 iter/s, 6.577e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 164.226 Tflops/s, hfu: 164.226 Tflops/s, 132.767 iter/s, 7.532e-03 s/iter, (0.101, 0.000, 0.030) sec
SP=(1,8),S=(98304,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.518 Tflops/s, hfu: 81.518 Tflops/s, 112.976 iter/s, 8.851e-03 s/iter, (0.103, 0.000, 0.177) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 138.732 Tflops/s, hfu: 138.732 Tflops/s, 192.268 iter/s, 5.201e-03 s/iter, (0.064, 0.000, 0.104) sec
# stripe_flash_attn_func, fwd
mfu: 72.382 Tflops/s, hfu: 72.382 Tflops/s, 100.314 iter/s, 9.969e-03 s/iter, (0.114, 0.000, 0.199) sec
# orchestrated_attn_func
mfu: 102.064 Tflops/s, hfu: 102.064 Tflops/s, 70.725 iter/s, 1.414e-02 s/iter, (0.129, 0.000, 0.057) sec
mfu: 102.232 Tflops/s, hfu: 102.232 Tflops/s, 70.841 iter/s, 1.412e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 102.366 Tflops/s, hfu: 102.366 Tflops/s, 70.934 iter/s, 1.410e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 171.031 Tflops/s, hfu: 171.031 Tflops/s, 118.516 iter/s, 8.438e-03 s/iter, (0.103, 0.000, 0.034) sec
# orchestrated_attn_func fused
mfu: 197.101 Tflops/s, hfu: 197.101 Tflops/s, 136.581 iter/s, 7.322e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 193.924 Tflops/s, hfu: 193.924 Tflops/s, 134.379 iter/s, 7.442e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 188.915 Tflops/s, hfu: 188.915 Tflops/s, 130.908 iter/s, 7.639e-03 s/iter, (0.102, 0.000, 0.031) sec
mfu: 164.299 Tflops/s, hfu: 164.299 Tflops/s, 113.851 iter/s, 8.783e-03 s/iter, (0.106, 0.000, 0.035) sec
SP=(1,8),S=(98304,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.109 Tflops/s, hfu: 83.109 Tflops/s, 100.783 iter/s, 9.922e-03 s/iter, (0.123, 0.000, 0.198) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.34 Tflops/s, hfu: 139.34 Tflops/s, 168.972 iter/s, 5.918e-03 s/iter, (0.073, 0.000, 0.118) sec
# stripe_flash_attn_func, fwd
mfu: 72.344 Tflops/s, hfu: 72.344 Tflops/s, 87.729 iter/s, 1.140e-02 s/iter, (0.129, 0.000, 0.228) sec
# orchestrated_attn_func
mfu: 102.504 Tflops/s, hfu: 102.504 Tflops/s, 62.151 iter/s, 1.609e-02 s/iter, (0.135, 0.000, 0.064) sec
mfu: 102.557 Tflops/s, hfu: 102.557 Tflops/s, 62.183 iter/s, 1.608e-02 s/iter, (0.135, 0.000, 0.064) sec
mfu: 102.392 Tflops/s, hfu: 102.392 Tflops/s, 62.083 iter/s, 1.611e-02 s/iter, (0.134, 0.000, 0.064) sec
mfu: 171.027 Tflops/s, hfu: 171.027 Tflops/s, 103.699 iter/s, 9.643e-03 s/iter, (0.109, 0.000, 0.039) sec
# orchestrated_attn_func fused
mfu: 198.508 Tflops/s, hfu: 198.508 Tflops/s, 120.362 iter/s, 8.308e-03 s/iter, (0.105, 0.000, 0.033) sec
mfu: 194.515 Tflops/s, hfu: 194.515 Tflops/s, 117.940 iter/s, 8.479e-03 s/iter, (0.105, 0.000, 0.034) sec
mfu: 189.313 Tflops/s, hfu: 189.313 Tflops/s, 114.786 iter/s, 8.712e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 164.019 Tflops/s, hfu: 164.019 Tflops/s, 99.450 iter/s, 1.006e-02 s/iter, (0.111, 0.000, 0.040) sec
SP=(1,8),S=(98304,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 85.163 Tflops/s, hfu: 85.163 Tflops/s, 82.619 iter/s, 1.210e-02 s/iter, (0.146, 0.000, 0.242) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.123 Tflops/s, hfu: 140.123 Tflops/s, 135.937 iter/s, 7.356e-03 s/iter, (0.090, 0.000, 0.147) sec
# stripe_flash_attn_func, fwd
mfu: 73.524 Tflops/s, hfu: 73.524 Tflops/s, 71.327 iter/s, 1.402e-02 s/iter, (0.161, 0.000, 0.280) sec
# orchestrated_attn_func
mfu: 102.623 Tflops/s, hfu: 102.623 Tflops/s, 49.779 iter/s, 2.009e-02 s/iter, (0.151, 0.000, 0.080) sec
mfu: 102.863 Tflops/s, hfu: 102.863 Tflops/s, 49.895 iter/s, 2.004e-02 s/iter, (0.151, 0.000, 0.080) sec
mfu: 102.475 Tflops/s, hfu: 102.475 Tflops/s, 49.707 iter/s, 2.012e-02 s/iter, (0.151, 0.000, 0.080) sec
mfu: 171.341 Tflops/s, hfu: 171.341 Tflops/s, 83.111 iter/s, 1.203e-02 s/iter, (0.119, 0.000, 0.048) sec
# orchestrated_attn_func fused
mfu: 200.198 Tflops/s, hfu: 200.198 Tflops/s, 97.109 iter/s, 1.030e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 195.584 Tflops/s, hfu: 195.584 Tflops/s, 94.871 iter/s, 1.054e-02 s/iter, (0.113, 0.000, 0.042) sec
mfu: 190.061 Tflops/s, hfu: 190.061 Tflops/s, 92.192 iter/s, 1.085e-02 s/iter, (0.114, 0.000, 0.043) sec
mfu: 164.248 Tflops/s, hfu: 164.248 Tflops/s, 79.671 iter/s, 1.255e-02 s/iter, (0.121, 0.000, 0.050) sec
SP=(1,8),S=(98304,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.104 Tflops/s, hfu: 84.104 Tflops/s, 67.993 iter/s, 1.471e-02 s/iter, (0.173, 0.000, 0.294) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.161 Tflops/s, hfu: 140.161 Tflops/s, 113.311 iter/s, 8.825e-03 s/iter, (0.107, 0.000, 0.177) sec
# stripe_flash_attn_func, fwd
mfu: 74.213 Tflops/s, hfu: 74.213 Tflops/s, 59.996 iter/s, 1.667e-02 s/iter, (0.180, 0.000, 0.333) sec
# orchestrated_attn_func
mfu: 102.78 Tflops/s, hfu: 102.78 Tflops/s, 41.546 iter/s, 2.407e-02 s/iter, (0.167, 0.000, 0.096) sec
mfu: 102.543 Tflops/s, hfu: 102.543 Tflops/s, 41.450 iter/s, 2.413e-02 s/iter, (0.170, 0.000, 0.097) sec
mfu: 102.623 Tflops/s, hfu: 102.623 Tflops/s, 41.482 iter/s, 2.411e-02 s/iter, (0.168, 0.000, 0.096) sec
mfu: 171.426 Tflops/s, hfu: 171.426 Tflops/s, 69.294 iter/s, 1.443e-02 s/iter, (0.129, 0.000, 0.058) sec
# orchestrated_attn_func fused
mfu: 201.364 Tflops/s, hfu: 201.364 Tflops/s, 81.395 iter/s, 1.229e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 196.249 Tflops/s, hfu: 196.249 Tflops/s, 79.328 iter/s, 1.261e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 190.731 Tflops/s, hfu: 190.731 Tflops/s, 77.097 iter/s, 1.297e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 164.583 Tflops/s, hfu: 164.583 Tflops/s, 66.528 iter/s, 1.503e-02 s/iter, (0.164, 0.000, 0.060) sec
SP=(1,8),S=(98304,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 86.331 Tflops/s, hfu: 86.331 Tflops/s, 59.823 iter/s, 1.672e-02 s/iter, (0.200, 0.000, 0.334) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 141.24 Tflops/s, hfu: 141.24 Tflops/s, 97.872 iter/s, 1.022e-02 s/iter, (0.127, 0.000, 0.204) sec
# stripe_flash_attn_func, fwd
mfu: 74.495 Tflops/s, hfu: 74.495 Tflops/s, 51.621 iter/s, 1.937e-02 s/iter, (0.208, 0.000, 0.387) sec
# orchestrated_attn_func
mfu: 102.782 Tflops/s, hfu: 102.782 Tflops/s, 35.611 iter/s, 2.808e-02 s/iter, (0.184, 0.000, 0.112) sec
mfu: 102.724 Tflops/s, hfu: 102.724 Tflops/s, 35.591 iter/s, 2.810e-02 s/iter, (0.183, 0.000, 0.112) sec
mfu: 102.641 Tflops/s, hfu: 102.641 Tflops/s, 35.563 iter/s, 2.812e-02 s/iter, (0.184, 0.000, 0.112) sec
mfu: 171.588 Tflops/s, hfu: 171.588 Tflops/s, 59.451 iter/s, 1.682e-02 s/iter, (0.137, 0.000, 0.067) sec
# orchestrated_attn_func fused
mfu: 202.504 Tflops/s, hfu: 202.504 Tflops/s, 70.162 iter/s, 1.425e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 196.738 Tflops/s, hfu: 196.738 Tflops/s, 68.165 iter/s, 1.467e-02 s/iter, (0.129, 0.000, 0.059) sec
mfu: 191.124 Tflops/s, hfu: 191.124 Tflops/s, 66.219 iter/s, 1.510e-02 s/iter, (0.134, 0.000, 0.060) sec
mfu: 164.592 Tflops/s, hfu: 164.592 Tflops/s, 57.027 iter/s, 1.754e-02 s/iter, (0.141, 0.000, 0.070) sec
SP=(1,8),S=(98304,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 86.67 Tflops/s, hfu: 86.67 Tflops/s, 52.551 iter/s, 1.903e-02 s/iter, (0.228, 0.000, 0.381) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 141.672 Tflops/s, hfu: 141.672 Tflops/s, 85.900 iter/s, 1.164e-02 s/iter, (0.143, 0.000, 0.233) sec
# stripe_flash_attn_func, fwd
mfu: 75.195 Tflops/s, hfu: 75.195 Tflops/s, 45.593 iter/s, 2.193e-02 s/iter, (0.236, 0.000, 0.439) sec
# orchestrated_attn_func
mfu: 102.984 Tflops/s, hfu: 102.984 Tflops/s, 31.221 iter/s, 3.203e-02 s/iter, (0.200, 0.000, 0.128) sec
mfu: 102.682 Tflops/s, hfu: 102.682 Tflops/s, 31.130 iter/s, 3.212e-02 s/iter, (0.203, 0.000, 0.128) sec
mfu: 102.713 Tflops/s, hfu: 102.713 Tflops/s, 31.139 iter/s, 3.211e-02 s/iter, (0.199, 0.000, 0.128) sec
mfu: 171.681 Tflops/s, hfu: 171.681 Tflops/s, 52.048 iter/s, 1.921e-02 s/iter, (0.150, 0.000, 0.077) sec
# orchestrated_attn_func fused
mfu: 203.118 Tflops/s, hfu: 203.118 Tflops/s, 61.578 iter/s, 1.624e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 197.409 Tflops/s, hfu: 197.409 Tflops/s, 59.848 iter/s, 1.671e-02 s/iter, (0.137, 0.000, 0.067) sec
mfu: 191.431 Tflops/s, hfu: 191.431 Tflops/s, 58.035 iter/s, 1.723e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 164.859 Tflops/s, hfu: 164.859 Tflops/s, 49.979 iter/s, 2.001e-02 s/iter, (0.151, 0.000, 0.080) sec
SP=(1,8),S=(114688,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 2.844 Tflops/s, hfu: 2.844 Tflops/s, 378.344 iter/s, 2.643e-03 s/iter, (0.037, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.244 Tflops/s, hfu: 5.244 Tflops/s, 697.690 iter/s, 1.433e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 2.438 Tflops/s, hfu: 2.438 Tflops/s, 324.360 iter/s, 3.083e-03 s/iter, (0.035, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 25.175 Tflops/s, hfu: 25.175 Tflops/s, 1674.728 iter/s, 5.971e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 42.765 Tflops/s, hfu: 42.765 Tflops/s, 2844.853 iter/s, 3.515e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 50.202 Tflops/s, hfu: 50.202 Tflops/s, 3339.567 iter/s, 2.994e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 59.73 Tflops/s, hfu: 59.73 Tflops/s, 3973.426 iter/s, 2.517e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 29.332 Tflops/s, hfu: 29.332 Tflops/s, 1951.235 iter/s, 5.125e-04 s/iter, (0.102, 0.000, 0.002) sec
mfu: 43.263 Tflops/s, hfu: 43.263 Tflops/s, 2877.996 iter/s, 3.475e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 56.567 Tflops/s, hfu: 56.567 Tflops/s, 3763.020 iter/s, 2.657e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 81.102 Tflops/s, hfu: 81.102 Tflops/s, 5395.140 iter/s, 1.854e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(114688,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.694 Tflops/s, hfu: 5.694 Tflops/s, 378.793 iter/s, 2.640e-03 s/iter, (0.032, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.143 Tflops/s, hfu: 10.143 Tflops/s, 674.770 iter/s, 1.482e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.883 Tflops/s, hfu: 4.883 Tflops/s, 324.844 iter/s, 3.078e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 49.491 Tflops/s, hfu: 49.491 Tflops/s, 1646.145 iter/s, 6.075e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 67.287 Tflops/s, hfu: 67.287 Tflops/s, 2238.058 iter/s, 4.468e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 73.213 Tflops/s, hfu: 73.213 Tflops/s, 2435.176 iter/s, 4.106e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 87.148 Tflops/s, hfu: 87.148 Tflops/s, 2898.685 iter/s, 3.450e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 52.112 Tflops/s, hfu: 52.112 Tflops/s, 1733.318 iter/s, 5.769e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 69.244 Tflops/s, hfu: 69.244 Tflops/s, 2303.171 iter/s, 4.342e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 81.787 Tflops/s, hfu: 81.787 Tflops/s, 2720.348 iter/s, 3.676e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 92.475 Tflops/s, hfu: 92.475 Tflops/s, 3075.863 iter/s, 3.251e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(114688,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.516 Tflops/s, hfu: 8.516 Tflops/s, 377.675 iter/s, 2.648e-03 s/iter, (0.032, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 15.208 Tflops/s, hfu: 15.208 Tflops/s, 674.439 iter/s, 1.483e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 7.33 Tflops/s, hfu: 7.33 Tflops/s, 325.096 iter/s, 3.076e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 67.871 Tflops/s, hfu: 67.871 Tflops/s, 1504.991 iter/s, 6.645e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 80.976 Tflops/s, hfu: 80.976 Tflops/s, 1795.590 iter/s, 5.569e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 86.078 Tflops/s, hfu: 86.078 Tflops/s, 1908.717 iter/s, 5.239e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 96.757 Tflops/s, hfu: 96.757 Tflops/s, 2145.518 iter/s, 4.661e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 69.594 Tflops/s, hfu: 69.594 Tflops/s, 1543.191 iter/s, 6.480e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 87.593 Tflops/s, hfu: 87.593 Tflops/s, 1942.321 iter/s, 5.148e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 95.398 Tflops/s, hfu: 95.398 Tflops/s, 2115.381 iter/s, 4.727e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 97.03 Tflops/s, hfu: 97.03 Tflops/s, 2151.574 iter/s, 4.648e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(114688,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.272 Tflops/s, hfu: 11.272 Tflops/s, 374.913 iter/s, 2.667e-03 s/iter, (0.033, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.1 Tflops/s, hfu: 20.1 Tflops/s, 668.569 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 9.674 Tflops/s, hfu: 9.674 Tflops/s, 321.789 iter/s, 3.108e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 83.881 Tflops/s, hfu: 83.881 Tflops/s, 1395.011 iter/s, 7.168e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 90.428 Tflops/s, hfu: 90.428 Tflops/s, 1503.886 iter/s, 6.649e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 94.82 Tflops/s, hfu: 94.82 Tflops/s, 1576.929 iter/s, 6.341e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.776 Tflops/s, hfu: 101.776 Tflops/s, 1692.620 iter/s, 5.908e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.228 Tflops/s, hfu: 83.228 Tflops/s, 1384.152 iter/s, 7.225e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.598 Tflops/s, hfu: 101.598 Tflops/s, 1689.646 iter/s, 5.918e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 100.622 Tflops/s, hfu: 100.622 Tflops/s, 1673.427 iter/s, 5.976e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 100.149 Tflops/s, hfu: 100.149 Tflops/s, 1665.556 iter/s, 6.004e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(114688,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 14.057 Tflops/s, hfu: 14.057 Tflops/s, 374.044 iter/s, 2.673e-03 s/iter, (0.033, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.799 Tflops/s, hfu: 24.799 Tflops/s, 659.871 iter/s, 1.515e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 12.099 Tflops/s, hfu: 12.099 Tflops/s, 321.949 iter/s, 3.106e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 90.414 Tflops/s, hfu: 90.414 Tflops/s, 1202.929 iter/s, 8.313e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 96.432 Tflops/s, hfu: 96.432 Tflops/s, 1282.986 iter/s, 7.794e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 99.387 Tflops/s, hfu: 99.387 Tflops/s, 1322.304 iter/s, 7.563e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 105.281 Tflops/s, hfu: 105.281 Tflops/s, 1400.717 iter/s, 7.139e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 95.082 Tflops/s, hfu: 95.082 Tflops/s, 1265.029 iter/s, 7.905e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 108.475 Tflops/s, hfu: 108.475 Tflops/s, 1443.218 iter/s, 6.929e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.068 Tflops/s, hfu: 108.068 Tflops/s, 1437.806 iter/s, 6.955e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 103.418 Tflops/s, hfu: 103.418 Tflops/s, 1375.940 iter/s, 7.268e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(114688,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.829 Tflops/s, hfu: 16.829 Tflops/s, 373.180 iter/s, 2.680e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.795 Tflops/s, hfu: 29.795 Tflops/s, 660.682 iter/s, 1.514e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.493 Tflops/s, hfu: 14.493 Tflops/s, 321.367 iter/s, 3.112e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 93.818 Tflops/s, hfu: 93.818 Tflops/s, 1040.176 iter/s, 9.614e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 100.398 Tflops/s, hfu: 100.398 Tflops/s, 1113.130 iter/s, 8.984e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 103.361 Tflops/s, hfu: 103.361 Tflops/s, 1145.979 iter/s, 8.726e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 107.857 Tflops/s, hfu: 107.857 Tflops/s, 1195.829 iter/s, 8.362e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 104.932 Tflops/s, hfu: 104.932 Tflops/s, 1163.397 iter/s, 8.596e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 117.035 Tflops/s, hfu: 117.035 Tflops/s, 1297.582 iter/s, 7.707e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 114.838 Tflops/s, hfu: 114.838 Tflops/s, 1273.224 iter/s, 7.854e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 104.566 Tflops/s, hfu: 104.566 Tflops/s, 1159.340 iter/s, 8.626e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(114688,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.022 Tflops/s, hfu: 19.022 Tflops/s, 361.539 iter/s, 2.766e-03 s/iter, (0.033, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.429 Tflops/s, hfu: 34.429 Tflops/s, 654.373 iter/s, 1.528e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.826 Tflops/s, hfu: 16.826 Tflops/s, 319.807 iter/s, 3.127e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 97.858 Tflops/s, hfu: 97.858 Tflops/s, 929.976 iter/s, 1.075e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 101.992 Tflops/s, hfu: 101.992 Tflops/s, 969.255 iter/s, 1.032e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 105.728 Tflops/s, hfu: 105.728 Tflops/s, 1004.767 iter/s, 9.953e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.203 Tflops/s, hfu: 109.203 Tflops/s, 1037.792 iter/s, 9.636e-04 s/iter, (0.076, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 113.055 Tflops/s, hfu: 113.055 Tflops/s, 1074.391 iter/s, 9.308e-04 s/iter, (0.104, 0.000, 0.004) sec
mfu: 124.949 Tflops/s, hfu: 124.949 Tflops/s, 1187.423 iter/s, 8.422e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 117.947 Tflops/s, hfu: 117.947 Tflops/s, 1120.885 iter/s, 8.922e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 105.99 Tflops/s, hfu: 105.99 Tflops/s, 1007.252 iter/s, 9.928e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(114688,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.285 Tflops/s, hfu: 22.285 Tflops/s, 370.623 iter/s, 2.698e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.33 Tflops/s, hfu: 39.33 Tflops/s, 654.082 iter/s, 1.529e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 19.194 Tflops/s, hfu: 19.194 Tflops/s, 319.204 iter/s, 3.133e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 99.292 Tflops/s, hfu: 99.292 Tflops/s, 825.649 iter/s, 1.211e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 103.78 Tflops/s, hfu: 103.78 Tflops/s, 862.968 iter/s, 1.159e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 107.168 Tflops/s, hfu: 107.168 Tflops/s, 891.145 iter/s, 1.122e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.089 Tflops/s, hfu: 110.089 Tflops/s, 915.429 iter/s, 1.092e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 120.607 Tflops/s, hfu: 120.607 Tflops/s, 1002.896 iter/s, 9.971e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 129.91 Tflops/s, hfu: 129.91 Tflops/s, 1080.250 iter/s, 9.257e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.574 Tflops/s, hfu: 121.574 Tflops/s, 1010.934 iter/s, 9.892e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 105.633 Tflops/s, hfu: 105.633 Tflops/s, 878.383 iter/s, 1.138e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(114688,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.941 Tflops/s, hfu: 27.941 Tflops/s, 371.746 iter/s, 2.690e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.245 Tflops/s, hfu: 50.245 Tflops/s, 668.484 iter/s, 1.496e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.101 Tflops/s, hfu: 24.101 Tflops/s, 320.661 iter/s, 3.119e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 102.287 Tflops/s, hfu: 102.287 Tflops/s, 680.446 iter/s, 1.470e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 107.22 Tflops/s, hfu: 107.22 Tflops/s, 713.263 iter/s, 1.402e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 109.849 Tflops/s, hfu: 109.849 Tflops/s, 730.746 iter/s, 1.368e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 112.205 Tflops/s, hfu: 112.205 Tflops/s, 746.425 iter/s, 1.340e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 132.802 Tflops/s, hfu: 132.802 Tflops/s, 883.442 iter/s, 1.132e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 138.334 Tflops/s, hfu: 138.334 Tflops/s, 920.241 iter/s, 1.087e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 127.169 Tflops/s, hfu: 127.169 Tflops/s, 845.966 iter/s, 1.182e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 107.834 Tflops/s, hfu: 107.834 Tflops/s, 717.344 iter/s, 1.394e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(114688,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.115 Tflops/s, hfu: 33.115 Tflops/s, 367.152 iter/s, 2.724e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.058 Tflops/s, hfu: 57.058 Tflops/s, 632.615 iter/s, 1.581e-03 s/iter, (0.021, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 28.622 Tflops/s, hfu: 28.622 Tflops/s, 317.333 iter/s, 3.151e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 104.71 Tflops/s, hfu: 104.71 Tflops/s, 580.467 iter/s, 1.723e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 108.216 Tflops/s, hfu: 108.216 Tflops/s, 599.903 iter/s, 1.667e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 111.028 Tflops/s, hfu: 111.028 Tflops/s, 615.494 iter/s, 1.625e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 113.103 Tflops/s, hfu: 113.103 Tflops/s, 626.997 iter/s, 1.595e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 141.607 Tflops/s, hfu: 141.607 Tflops/s, 785.008 iter/s, 1.274e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 144.975 Tflops/s, hfu: 144.975 Tflops/s, 803.683 iter/s, 1.244e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 131.244 Tflops/s, hfu: 131.244 Tflops/s, 727.561 iter/s, 1.374e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 108.426 Tflops/s, hfu: 108.426 Tflops/s, 601.071 iter/s, 1.664e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(114688,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.332 Tflops/s, hfu: 38.332 Tflops/s, 364.280 iter/s, 2.745e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.645 Tflops/s, hfu: 57.645 Tflops/s, 547.820 iter/s, 1.825e-03 s/iter, (0.024, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 33.169 Tflops/s, hfu: 33.169 Tflops/s, 315.211 iter/s, 3.172e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 107.135 Tflops/s, hfu: 107.135 Tflops/s, 509.065 iter/s, 1.964e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 110.25 Tflops/s, hfu: 110.25 Tflops/s, 523.867 iter/s, 1.909e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 112.089 Tflops/s, hfu: 112.089 Tflops/s, 532.606 iter/s, 1.878e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 113.764 Tflops/s, hfu: 113.764 Tflops/s, 540.569 iter/s, 1.850e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 149.298 Tflops/s, hfu: 149.298 Tflops/s, 709.409 iter/s, 1.410e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 149.938 Tflops/s, hfu: 149.938 Tflops/s, 712.454 iter/s, 1.404e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 133.835 Tflops/s, hfu: 133.835 Tflops/s, 635.935 iter/s, 1.572e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 108.848 Tflops/s, hfu: 108.848 Tflops/s, 517.206 iter/s, 1.933e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(114688,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.817 Tflops/s, hfu: 43.817 Tflops/s, 364.358 iter/s, 2.745e-03 s/iter, (0.037, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.073 Tflops/s, hfu: 57.073 Tflops/s, 474.584 iter/s, 2.107e-03 s/iter, (0.026, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 37.839 Tflops/s, hfu: 37.839 Tflops/s, 314.646 iter/s, 3.178e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 107.819 Tflops/s, hfu: 107.819 Tflops/s, 448.279 iter/s, 2.231e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 111.135 Tflops/s, hfu: 111.135 Tflops/s, 462.063 iter/s, 2.164e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 112.904 Tflops/s, hfu: 112.904 Tflops/s, 469.420 iter/s, 2.130e-03 s/iter, (0.093, 0.000, 0.009) sec
mfu: 114.394 Tflops/s, hfu: 114.394 Tflops/s, 475.614 iter/s, 2.103e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 154.546 Tflops/s, hfu: 154.546 Tflops/s, 642.555 iter/s, 1.556e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 154.421 Tflops/s, hfu: 154.421 Tflops/s, 642.036 iter/s, 1.558e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 135.518 Tflops/s, hfu: 135.518 Tflops/s, 563.441 iter/s, 1.775e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 108.196 Tflops/s, hfu: 108.196 Tflops/s, 449.847 iter/s, 2.223e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(114688,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 50.02 Tflops/s, hfu: 50.02 Tflops/s, 332.749 iter/s, 3.005e-03 s/iter, (0.038, 0.000, 0.060) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.138 Tflops/s, hfu: 59.138 Tflops/s, 393.407 iter/s, 2.542e-03 s/iter, (0.031, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 47.466 Tflops/s, hfu: 47.466 Tflops/s, 315.758 iter/s, 3.167e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 109.886 Tflops/s, hfu: 109.886 Tflops/s, 365.499 iter/s, 2.736e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 112.923 Tflops/s, hfu: 112.923 Tflops/s, 375.600 iter/s, 2.662e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 113.594 Tflops/s, hfu: 113.594 Tflops/s, 377.831 iter/s, 2.647e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 115.161 Tflops/s, hfu: 115.161 Tflops/s, 383.042 iter/s, 2.611e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 164.052 Tflops/s, hfu: 164.052 Tflops/s, 545.663 iter/s, 1.833e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 159.884 Tflops/s, hfu: 159.884 Tflops/s, 531.797 iter/s, 1.880e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 138.701 Tflops/s, hfu: 138.701 Tflops/s, 461.341 iter/s, 2.168e-03 s/iter, (0.082, 0.001, 0.009) sec
mfu: 108.681 Tflops/s, hfu: 108.681 Tflops/s, 361.491 iter/s, 2.766e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(114688,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.042 Tflops/s, hfu: 52.042 Tflops/s, 288.500 iter/s, 3.466e-03 s/iter, (0.043, 0.000, 0.069) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.568 Tflops/s, hfu: 59.568 Tflops/s, 330.221 iter/s, 3.028e-03 s/iter, (0.036, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 56.969 Tflops/s, hfu: 56.969 Tflops/s, 315.814 iter/s, 3.166e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 111.823 Tflops/s, hfu: 111.823 Tflops/s, 309.951 iter/s, 3.226e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 113.307 Tflops/s, hfu: 113.307 Tflops/s, 314.063 iter/s, 3.184e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 114.597 Tflops/s, hfu: 114.597 Tflops/s, 317.640 iter/s, 3.148e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 115.731 Tflops/s, hfu: 115.731 Tflops/s, 320.783 iter/s, 3.117e-03 s/iter, (0.083, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 171.151 Tflops/s, hfu: 171.151 Tflops/s, 474.396 iter/s, 2.108e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 164.397 Tflops/s, hfu: 164.397 Tflops/s, 455.674 iter/s, 2.195e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 140.818 Tflops/s, hfu: 140.818 Tflops/s, 390.319 iter/s, 2.562e-03 s/iter, (0.084, 0.000, 0.010) sec
mfu: 109.737 Tflops/s, hfu: 109.737 Tflops/s, 304.168 iter/s, 3.288e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(114688,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.456 Tflops/s, hfu: 53.456 Tflops/s, 254.002 iter/s, 3.937e-03 s/iter, (0.048, 0.000, 0.079) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 60.089 Tflops/s, hfu: 60.089 Tflops/s, 285.523 iter/s, 3.502e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 66.883 Tflops/s, hfu: 66.883 Tflops/s, 317.803 iter/s, 3.147e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 112.394 Tflops/s, hfu: 112.394 Tflops/s, 267.028 iter/s, 3.745e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 114.003 Tflops/s, hfu: 114.003 Tflops/s, 270.851 iter/s, 3.692e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 115.14 Tflops/s, hfu: 115.14 Tflops/s, 273.551 iter/s, 3.656e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 116.257 Tflops/s, hfu: 116.257 Tflops/s, 276.205 iter/s, 3.620e-03 s/iter, (0.087, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 176.284 Tflops/s, hfu: 176.284 Tflops/s, 418.819 iter/s, 2.388e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 167.372 Tflops/s, hfu: 167.372 Tflops/s, 397.646 iter/s, 2.515e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 141.629 Tflops/s, hfu: 141.629 Tflops/s, 336.486 iter/s, 2.972e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 109.843 Tflops/s, hfu: 109.843 Tflops/s, 260.968 iter/s, 3.832e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(114688,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.452 Tflops/s, hfu: 54.452 Tflops/s, 226.395 iter/s, 4.417e-03 s/iter, (0.053, 0.000, 0.088) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.232 Tflops/s, hfu: 68.232 Tflops/s, 283.688 iter/s, 3.525e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 73.188 Tflops/s, hfu: 73.188 Tflops/s, 304.291 iter/s, 3.286e-03 s/iter, (0.040, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 112.912 Tflops/s, hfu: 112.912 Tflops/s, 234.726 iter/s, 4.260e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 115.045 Tflops/s, hfu: 115.045 Tflops/s, 239.162 iter/s, 4.181e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 115.646 Tflops/s, hfu: 115.646 Tflops/s, 240.411 iter/s, 4.160e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 116.535 Tflops/s, hfu: 116.535 Tflops/s, 242.257 iter/s, 4.128e-03 s/iter, (0.086, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 180.463 Tflops/s, hfu: 180.463 Tflops/s, 375.155 iter/s, 2.666e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 169.123 Tflops/s, hfu: 169.123 Tflops/s, 351.581 iter/s, 2.844e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 143.205 Tflops/s, hfu: 143.205 Tflops/s, 297.701 iter/s, 3.359e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 109.972 Tflops/s, hfu: 109.972 Tflops/s, 228.614 iter/s, 4.374e-03 s/iter, (0.090, 0.000, 0.017) sec
SP=(1,8),S=(114688,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.763 Tflops/s, hfu: 55.763 Tflops/s, 185.477 iter/s, 5.391e-03 s/iter, (0.063, 0.000, 0.108) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 82.665 Tflops/s, hfu: 82.665 Tflops/s, 274.958 iter/s, 3.637e-03 s/iter, (0.043, 0.000, 0.073) sec
# stripe_flash_attn_func, fwd
mfu: 77.527 Tflops/s, hfu: 77.527 Tflops/s, 257.867 iter/s, 3.878e-03 s/iter, (0.045, 0.000, 0.078) sec
# orchestrated_attn_func
mfu: 114.574 Tflops/s, hfu: 114.574 Tflops/s, 190.546 iter/s, 5.248e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 115.414 Tflops/s, hfu: 115.414 Tflops/s, 191.942 iter/s, 5.210e-03 s/iter, (0.092, 0.000, 0.021) sec
mfu: 116.281 Tflops/s, hfu: 116.281 Tflops/s, 193.384 iter/s, 5.171e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 116.92 Tflops/s, hfu: 116.92 Tflops/s, 194.448 iter/s, 5.143e-03 s/iter, (0.091, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 185.651 Tflops/s, hfu: 185.651 Tflops/s, 308.753 iter/s, 3.239e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 172.96 Tflops/s, hfu: 172.96 Tflops/s, 287.646 iter/s, 3.476e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 144.815 Tflops/s, hfu: 144.815 Tflops/s, 240.838 iter/s, 4.152e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 110.906 Tflops/s, hfu: 110.906 Tflops/s, 184.445 iter/s, 5.422e-03 s/iter, (0.092, 0.000, 0.022) sec
SP=(1,8),S=(114688,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.041 Tflops/s, hfu: 57.041 Tflops/s, 158.107 iter/s, 6.325e-03 s/iter, (0.075, 0.000, 0.126) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 96.87 Tflops/s, hfu: 96.87 Tflops/s, 268.502 iter/s, 3.724e-03 s/iter, (0.044, 0.000, 0.074) sec
# stripe_flash_attn_func, fwd
mfu: 76.892 Tflops/s, hfu: 76.892 Tflops/s, 213.130 iter/s, 4.692e-03 s/iter, (0.053, 0.000, 0.094) sec
# orchestrated_attn_func
mfu: 114.996 Tflops/s, hfu: 114.996 Tflops/s, 159.373 iter/s, 6.275e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 116.163 Tflops/s, hfu: 116.163 Tflops/s, 160.990 iter/s, 6.212e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 116.471 Tflops/s, hfu: 116.471 Tflops/s, 161.417 iter/s, 6.195e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 117.202 Tflops/s, hfu: 117.202 Tflops/s, 162.429 iter/s, 6.157e-03 s/iter, (0.097, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 190.212 Tflops/s, hfu: 190.212 Tflops/s, 263.614 iter/s, 3.793e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 175.427 Tflops/s, hfu: 175.427 Tflops/s, 243.123 iter/s, 4.113e-03 s/iter, (0.087, 0.000, 0.016) sec
mfu: 146.017 Tflops/s, hfu: 146.017 Tflops/s, 202.365 iter/s, 4.942e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 111.177 Tflops/s, hfu: 111.177 Tflops/s, 154.080 iter/s, 6.490e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(114688,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.719 Tflops/s, hfu: 57.719 Tflops/s, 137.129 iter/s, 7.292e-03 s/iter, (0.085, 0.000, 0.146) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.638 Tflops/s, hfu: 109.638 Tflops/s, 260.479 iter/s, 3.839e-03 s/iter, (0.047, 0.000, 0.077) sec
# stripe_flash_attn_func, fwd
mfu: 77.702 Tflops/s, hfu: 77.702 Tflops/s, 184.606 iter/s, 5.417e-03 s/iter, (0.064, 0.000, 0.108) sec
# orchestrated_attn_func
mfu: 115.486 Tflops/s, hfu: 115.486 Tflops/s, 137.187 iter/s, 7.289e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 116.365 Tflops/s, hfu: 116.365 Tflops/s, 138.231 iter/s, 7.234e-03 s/iter, (0.102, 0.000, 0.029) sec
mfu: 116.818 Tflops/s, hfu: 116.818 Tflops/s, 138.769 iter/s, 7.206e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 117.415 Tflops/s, hfu: 117.415 Tflops/s, 139.479 iter/s, 7.170e-03 s/iter, (0.099, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 193.307 Tflops/s, hfu: 193.307 Tflops/s, 229.631 iter/s, 4.355e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 177.372 Tflops/s, hfu: 177.372 Tflops/s, 210.702 iter/s, 4.746e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 146.64 Tflops/s, hfu: 146.64 Tflops/s, 174.196 iter/s, 5.741e-03 s/iter, (0.094, 0.000, 0.023) sec
mfu: 111.434 Tflops/s, hfu: 111.434 Tflops/s, 132.374 iter/s, 7.554e-03 s/iter, (0.104, 0.000, 0.030) sec
SP=(1,8),S=(114688,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.982 Tflops/s, hfu: 57.982 Tflops/s, 120.537 iter/s, 8.296e-03 s/iter, (0.097, 0.000, 0.166) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 122.157 Tflops/s, hfu: 122.157 Tflops/s, 253.945 iter/s, 3.938e-03 s/iter, (0.049, 0.000, 0.079) sec
# stripe_flash_attn_func, fwd
mfu: 75.518 Tflops/s, hfu: 75.518 Tflops/s, 156.990 iter/s, 6.370e-03 s/iter, (0.074, 0.000, 0.127) sec
# orchestrated_attn_func
mfu: 115.962 Tflops/s, hfu: 115.962 Tflops/s, 120.533 iter/s, 8.296e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 116.756 Tflops/s, hfu: 116.756 Tflops/s, 121.359 iter/s, 8.240e-03 s/iter, (0.107, 0.000, 0.033) sec
mfu: 116.994 Tflops/s, hfu: 116.994 Tflops/s, 121.606 iter/s, 8.223e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 117.543 Tflops/s, hfu: 117.543 Tflops/s, 122.176 iter/s, 8.185e-03 s/iter, (0.103, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 196.05 Tflops/s, hfu: 196.05 Tflops/s, 203.779 iter/s, 4.907e-03 s/iter, (0.089, 0.000, 0.020) sec
mfu: 178.347 Tflops/s, hfu: 178.347 Tflops/s, 185.378 iter/s, 5.394e-03 s/iter, (0.096, 0.000, 0.022) sec
mfu: 147.573 Tflops/s, hfu: 147.573 Tflops/s, 153.391 iter/s, 6.519e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 111.761 Tflops/s, hfu: 111.761 Tflops/s, 116.167 iter/s, 8.608e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(114688,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.26 Tflops/s, hfu: 58.26 Tflops/s, 96.890 iter/s, 1.032e-02 s/iter, (0.119, 0.000, 0.206) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.088 Tflops/s, hfu: 132.088 Tflops/s, 219.672 iter/s, 4.552e-03 s/iter, (0.055, 0.000, 0.091) sec
# stripe_flash_attn_func, fwd
mfu: 72.623 Tflops/s, hfu: 72.623 Tflops/s, 120.777 iter/s, 8.280e-03 s/iter, (0.096, 0.000, 0.166) sec
# orchestrated_attn_func
mfu: 116.622 Tflops/s, hfu: 116.622 Tflops/s, 96.975 iter/s, 1.031e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 117.183 Tflops/s, hfu: 117.183 Tflops/s, 97.442 iter/s, 1.026e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 117.29 Tflops/s, hfu: 117.29 Tflops/s, 97.531 iter/s, 1.025e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 117.781 Tflops/s, hfu: 117.781 Tflops/s, 97.939 iter/s, 1.021e-02 s/iter, (0.113, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 199.029 Tflops/s, hfu: 199.029 Tflops/s, 165.500 iter/s, 6.042e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 180.382 Tflops/s, hfu: 180.382 Tflops/s, 149.994 iter/s, 6.667e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 148.411 Tflops/s, hfu: 148.411 Tflops/s, 123.410 iter/s, 8.103e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 111.762 Tflops/s, hfu: 111.762 Tflops/s, 92.934 iter/s, 1.076e-02 s/iter, (0.114, 0.000, 0.043) sec
SP=(1,8),S=(114688,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.579 Tflops/s, hfu: 58.579 Tflops/s, 81.185 iter/s, 1.232e-02 s/iter, (0.141, 0.000, 0.246) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.571 Tflops/s, hfu: 131.571 Tflops/s, 182.344 iter/s, 5.484e-03 s/iter, (0.064, 0.000, 0.110) sec
# stripe_flash_attn_func, fwd
mfu: 70.325 Tflops/s, hfu: 70.325 Tflops/s, 97.464 iter/s, 1.026e-02 s/iter, (0.116, 0.000, 0.205) sec
# orchestrated_attn_func
mfu: 117.121 Tflops/s, hfu: 117.121 Tflops/s, 81.159 iter/s, 1.232e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 117.406 Tflops/s, hfu: 117.406 Tflops/s, 81.356 iter/s, 1.229e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 117.477 Tflops/s, hfu: 117.477 Tflops/s, 81.405 iter/s, 1.228e-02 s/iter, (0.118, 0.000, 0.049) sec
mfu: 117.929 Tflops/s, hfu: 117.929 Tflops/s, 81.719 iter/s, 1.224e-02 s/iter, (0.119, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 201.688 Tflops/s, hfu: 201.688 Tflops/s, 139.759 iter/s, 7.155e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 181.834 Tflops/s, hfu: 181.834 Tflops/s, 126.002 iter/s, 7.936e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 149.325 Tflops/s, hfu: 149.325 Tflops/s, 103.474 iter/s, 9.664e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 112.251 Tflops/s, hfu: 112.251 Tflops/s, 77.784 iter/s, 1.286e-02 s/iter, (0.122, 0.000, 0.051) sec
SP=(1,8),S=(114688,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.831 Tflops/s, hfu: 58.831 Tflops/s, 69.885 iter/s, 1.431e-02 s/iter, (0.163, 0.000, 0.286) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.165 Tflops/s, hfu: 132.165 Tflops/s, 157.001 iter/s, 6.369e-03 s/iter, (0.073, 0.000, 0.127) sec
# stripe_flash_attn_func, fwd
mfu: 68.631 Tflops/s, hfu: 68.631 Tflops/s, 81.527 iter/s, 1.227e-02 s/iter, (0.140, 0.000, 0.245) sec
# orchestrated_attn_func
mfu: 117.216 Tflops/s, hfu: 117.216 Tflops/s, 69.621 iter/s, 1.436e-02 s/iter, (0.130, 0.001, 0.057) sec
mfu: 117.516 Tflops/s, hfu: 117.516 Tflops/s, 69.799 iter/s, 1.433e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 117.648 Tflops/s, hfu: 117.648 Tflops/s, 69.878 iter/s, 1.431e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 117.991 Tflops/s, hfu: 117.991 Tflops/s, 70.081 iter/s, 1.427e-02 s/iter, (0.127, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 203.97 Tflops/s, hfu: 203.97 Tflops/s, 121.149 iter/s, 8.254e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 182.808 Tflops/s, hfu: 182.808 Tflops/s, 108.580 iter/s, 9.210e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 149.349 Tflops/s, hfu: 149.349 Tflops/s, 88.707 iter/s, 1.127e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 112.262 Tflops/s, hfu: 112.262 Tflops/s, 66.678 iter/s, 1.500e-02 s/iter, (0.131, 0.001, 0.060) sec
SP=(1,8),S=(114688,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.942 Tflops/s, hfu: 58.942 Tflops/s, 61.265 iter/s, 1.632e-02 s/iter, (0.186, 0.000, 0.326) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 132.836 Tflops/s, hfu: 132.836 Tflops/s, 138.072 iter/s, 7.243e-03 s/iter, (0.083, 0.000, 0.145) sec
# stripe_flash_attn_func, fwd
mfu: 67.578 Tflops/s, hfu: 67.578 Tflops/s, 70.242 iter/s, 1.424e-02 s/iter, (0.163, 0.000, 0.285) sec
# orchestrated_attn_func
mfu: 117.565 Tflops/s, hfu: 117.565 Tflops/s, 61.100 iter/s, 1.637e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 117.774 Tflops/s, hfu: 117.774 Tflops/s, 61.208 iter/s, 1.634e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 117.644 Tflops/s, hfu: 117.644 Tflops/s, 61.141 iter/s, 1.636e-02 s/iter, (0.137, 0.000, 0.065) sec
mfu: 117.988 Tflops/s, hfu: 117.988 Tflops/s, 61.320 iter/s, 1.631e-02 s/iter, (0.135, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 205.094 Tflops/s, hfu: 205.094 Tflops/s, 106.589 iter/s, 9.382e-03 s/iter, (0.111, 0.000, 0.038) sec
mfu: 183.659 Tflops/s, hfu: 183.659 Tflops/s, 95.450 iter/s, 1.048e-02 s/iter, (0.115, 0.000, 0.042) sec
mfu: 149.861 Tflops/s, hfu: 149.861 Tflops/s, 77.884 iter/s, 1.284e-02 s/iter, (0.122, 0.000, 0.051) sec
mfu: 112.055 Tflops/s, hfu: 112.055 Tflops/s, 58.236 iter/s, 1.717e-02 s/iter, (0.143, 0.000, 0.069) sec
SP=(1,8),S=(114688,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.143 Tflops/s, hfu: 59.143 Tflops/s, 49.180 iter/s, 2.033e-02 s/iter, (0.231, 0.000, 0.407) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.821 Tflops/s, hfu: 131.821 Tflops/s, 109.614 iter/s, 9.123e-03 s/iter, (0.103, 0.000, 0.182) sec
# stripe_flash_attn_func, fwd
mfu: 65.905 Tflops/s, hfu: 65.905 Tflops/s, 54.803 iter/s, 1.825e-02 s/iter, (0.207, 0.000, 0.365) sec
# orchestrated_attn_func
mfu: 117.64 Tflops/s, hfu: 117.64 Tflops/s, 48.911 iter/s, 2.045e-02 s/iter, (0.152, 0.000, 0.082) sec
mfu: 117.894 Tflops/s, hfu: 117.894 Tflops/s, 49.017 iter/s, 2.040e-02 s/iter, (0.152, 0.000, 0.082) sec
mfu: 117.794 Tflops/s, hfu: 117.794 Tflops/s, 48.975 iter/s, 2.042e-02 s/iter, (0.151, 0.000, 0.082) sec
mfu: 118.044 Tflops/s, hfu: 118.044 Tflops/s, 49.079 iter/s, 2.038e-02 s/iter, (0.154, 0.000, 0.082) sec
# orchestrated_attn_func fused
mfu: 206.576 Tflops/s, hfu: 206.576 Tflops/s, 85.888 iter/s, 1.164e-02 s/iter, (0.117, 0.000, 0.047) sec
mfu: 184.333 Tflops/s, hfu: 184.333 Tflops/s, 76.640 iter/s, 1.305e-02 s/iter, (0.123, 0.000, 0.052) sec
mfu: 150.38 Tflops/s, hfu: 150.38 Tflops/s, 62.523 iter/s, 1.599e-02 s/iter, (0.134, 0.000, 0.064) sec
mfu: 112.386 Tflops/s, hfu: 112.386 Tflops/s, 46.727 iter/s, 2.140e-02 s/iter, (0.156, 0.000, 0.086) sec
SP=(1,8),S=(114688,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.182 Tflops/s, hfu: 59.182 Tflops/s, 41.010 iter/s, 2.438e-02 s/iter, (0.275, 0.000, 0.488) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 130.966 Tflops/s, hfu: 130.966 Tflops/s, 90.753 iter/s, 1.102e-02 s/iter, (0.123, 0.000, 0.220) sec
# stripe_flash_attn_func, fwd
mfu: 64.855 Tflops/s, hfu: 64.855 Tflops/s, 44.941 iter/s, 2.225e-02 s/iter, (0.249, 0.000, 0.445) sec
# orchestrated_attn_func
mfu: 117.913 Tflops/s, hfu: 117.913 Tflops/s, 40.854 iter/s, 2.448e-02 s/iter, (0.169, 0.000, 0.098) sec
mfu: 118.08 Tflops/s, hfu: 118.08 Tflops/s, 40.912 iter/s, 2.444e-02 s/iter, (0.171, 0.000, 0.098) sec
mfu: 117.999 Tflops/s, hfu: 117.999 Tflops/s, 40.884 iter/s, 2.446e-02 s/iter, (0.167, 0.000, 0.098) sec
mfu: 118.21 Tflops/s, hfu: 118.21 Tflops/s, 40.957 iter/s, 2.442e-02 s/iter, (0.167, 0.000, 0.098) sec
# orchestrated_attn_func fused
mfu: 208.021 Tflops/s, hfu: 208.021 Tflops/s, 72.074 iter/s, 1.387e-02 s/iter, (0.126, 0.000, 0.055) sec
mfu: 185.525 Tflops/s, hfu: 185.525 Tflops/s, 64.280 iter/s, 1.556e-02 s/iter, (0.133, 0.000, 0.062) sec
mfu: 150.927 Tflops/s, hfu: 150.927 Tflops/s, 52.292 iter/s, 1.912e-02 s/iter, (0.148, 0.000, 0.076) sec
mfu: 112.533 Tflops/s, hfu: 112.533 Tflops/s, 38.990 iter/s, 2.565e-02 s/iter, (0.173, 0.000, 0.103) sec
SP=(1,8),S=(114688,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.324 Tflops/s, hfu: 59.324 Tflops/s, 35.236 iter/s, 2.838e-02 s/iter, (0.320, 0.000, 0.568) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.278 Tflops/s, hfu: 131.278 Tflops/s, 77.974 iter/s, 1.282e-02 s/iter, (0.145, 0.000, 0.256) sec
# stripe_flash_attn_func, fwd
mfu: 64.043 Tflops/s, hfu: 64.043 Tflops/s, 38.039 iter/s, 2.629e-02 s/iter, (0.293, 0.000, 0.526) sec
# orchestrated_attn_func
mfu: 117.987 Tflops/s, hfu: 117.987 Tflops/s, 35.040 iter/s, 2.854e-02 s/iter, (0.187, 0.000, 0.114) sec
mfu: 118.048 Tflops/s, hfu: 118.048 Tflops/s, 35.058 iter/s, 2.852e-02 s/iter, (0.184, 0.000, 0.114) sec
mfu: 118.086 Tflops/s, hfu: 118.086 Tflops/s, 35.069 iter/s, 2.852e-02 s/iter, (0.183, 0.000, 0.114) sec
mfu: 118.263 Tflops/s, hfu: 118.263 Tflops/s, 35.121 iter/s, 2.847e-02 s/iter, (0.184, 0.000, 0.114) sec
# orchestrated_attn_func fused
mfu: 209.225 Tflops/s, hfu: 209.225 Tflops/s, 62.135 iter/s, 1.609e-02 s/iter, (0.134, 0.000, 0.064) sec
mfu: 185.724 Tflops/s, hfu: 185.724 Tflops/s, 55.156 iter/s, 1.813e-02 s/iter, (0.143, 0.000, 0.073) sec
mfu: 151.17 Tflops/s, hfu: 151.17 Tflops/s, 44.894 iter/s, 2.227e-02 s/iter, (0.162, 0.000, 0.089) sec
mfu: 112.446 Tflops/s, hfu: 112.446 Tflops/s, 33.394 iter/s, 2.995e-02 s/iter, (0.191, 0.000, 0.120) sec
SP=(1,8),S=(114688,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.373 Tflops/s, hfu: 59.373 Tflops/s, 30.857 iter/s, 3.241e-02 s/iter, (0.364, 0.000, 0.648) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.812 Tflops/s, hfu: 131.812 Tflops/s, 68.504 iter/s, 1.460e-02 s/iter, (0.163, 0.000, 0.292) sec
# stripe_flash_attn_func, fwd
mfu: 63.501 Tflops/s, hfu: 63.501 Tflops/s, 33.002 iter/s, 3.030e-02 s/iter, (0.337, 0.000, 0.606) sec
# orchestrated_attn_func
mfu: 118.104 Tflops/s, hfu: 118.104 Tflops/s, 30.690 iter/s, 3.258e-02 s/iter, (0.201, 0.000, 0.130) sec
mfu: 118.119 Tflops/s, hfu: 118.119 Tflops/s, 30.694 iter/s, 3.258e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 118.19 Tflops/s, hfu: 118.19 Tflops/s, 30.712 iter/s, 3.256e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 118.373 Tflops/s, hfu: 118.373 Tflops/s, 30.760 iter/s, 3.251e-02 s/iter, (0.200, 0.000, 0.130) sec
# orchestrated_attn_func fused
mfu: 209.976 Tflops/s, hfu: 209.976 Tflops/s, 54.563 iter/s, 1.833e-02 s/iter, (0.144, 0.000, 0.073) sec
mfu: 186.299 Tflops/s, hfu: 186.299 Tflops/s, 48.411 iter/s, 2.066e-02 s/iter, (0.154, 0.000, 0.083) sec
mfu: 151.451 Tflops/s, hfu: 151.451 Tflops/s, 39.355 iter/s, 2.541e-02 s/iter, (0.172, 0.000, 0.102) sec
mfu: 112.556 Tflops/s, hfu: 112.556 Tflops/s, 29.248 iter/s, 3.419e-02 s/iter, (0.209, 0.000, 0.137) sec
SP=(1,8),S=(131072,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.259 Tflops/s, hfu: 3.259 Tflops/s, 379.431 iter/s, 2.636e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 6.0 Tflops/s, hfu: 6.0 Tflops/s, 698.533 iter/s, 1.432e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 2.747 Tflops/s, hfu: 2.747 Tflops/s, 319.834 iter/s, 3.127e-03 s/iter, (0.035, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 27.258 Tflops/s, hfu: 27.258 Tflops/s, 1586.596 iter/s, 6.303e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 46.453 Tflops/s, hfu: 46.453 Tflops/s, 2703.930 iter/s, 3.698e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 57.134 Tflops/s, hfu: 57.134 Tflops/s, 3325.618 iter/s, 3.007e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 69.994 Tflops/s, hfu: 69.994 Tflops/s, 4074.183 iter/s, 2.454e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 31.34 Tflops/s, hfu: 31.34 Tflops/s, 1824.232 iter/s, 5.482e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 46.824 Tflops/s, hfu: 46.824 Tflops/s, 2725.509 iter/s, 3.669e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 62.989 Tflops/s, hfu: 62.989 Tflops/s, 3666.442 iter/s, 2.727e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 92.317 Tflops/s, hfu: 92.317 Tflops/s, 5373.571 iter/s, 1.861e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(131072,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.51 Tflops/s, hfu: 6.51 Tflops/s, 378.918 iter/s, 2.639e-03 s/iter, (0.041, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.788 Tflops/s, hfu: 11.788 Tflops/s, 686.129 iter/s, 1.457e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 5.645 Tflops/s, hfu: 5.645 Tflops/s, 328.607 iter/s, 3.043e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 51.612 Tflops/s, hfu: 51.612 Tflops/s, 1502.115 iter/s, 6.657e-04 s/iter, (0.072, 0.001, 0.003) sec
mfu: 73.196 Tflops/s, hfu: 73.196 Tflops/s, 2130.270 iter/s, 4.694e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 81.698 Tflops/s, hfu: 81.698 Tflops/s, 2377.737 iter/s, 4.206e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 97.54 Tflops/s, hfu: 97.54 Tflops/s, 2838.780 iter/s, 3.523e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 55.048 Tflops/s, hfu: 55.048 Tflops/s, 1602.112 iter/s, 6.242e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 78.362 Tflops/s, hfu: 78.362 Tflops/s, 2280.647 iter/s, 4.385e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 90.004 Tflops/s, hfu: 90.004 Tflops/s, 2619.447 iter/s, 3.818e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 105.512 Tflops/s, hfu: 105.512 Tflops/s, 3070.800 iter/s, 3.256e-04 s/iter, (0.074, 0.000, 0.001) sec
SP=(1,8),S=(131072,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.762 Tflops/s, hfu: 9.762 Tflops/s, 378.819 iter/s, 2.640e-03 s/iter, (0.032, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.609 Tflops/s, hfu: 17.609 Tflops/s, 683.301 iter/s, 1.463e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 8.452 Tflops/s, hfu: 8.452 Tflops/s, 327.970 iter/s, 3.049e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 75.432 Tflops/s, hfu: 75.432 Tflops/s, 1463.580 iter/s, 6.833e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 91.845 Tflops/s, hfu: 91.845 Tflops/s, 1782.023 iter/s, 5.612e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 98.993 Tflops/s, hfu: 98.993 Tflops/s, 1920.713 iter/s, 5.206e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 109.917 Tflops/s, hfu: 109.917 Tflops/s, 2132.669 iter/s, 4.689e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 73.03 Tflops/s, hfu: 73.03 Tflops/s, 1416.960 iter/s, 7.057e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 97.921 Tflops/s, hfu: 97.921 Tflops/s, 1899.927 iter/s, 5.263e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 107.548 Tflops/s, hfu: 107.548 Tflops/s, 2086.707 iter/s, 4.792e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 111.664 Tflops/s, hfu: 111.664 Tflops/s, 2166.566 iter/s, 4.616e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(131072,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.831 Tflops/s, hfu: 12.831 Tflops/s, 373.436 iter/s, 2.678e-03 s/iter, (0.032, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.06 Tflops/s, hfu: 23.06 Tflops/s, 671.142 iter/s, 1.490e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 11.065 Tflops/s, hfu: 11.065 Tflops/s, 322.038 iter/s, 3.105e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 96.519 Tflops/s, hfu: 96.519 Tflops/s, 1404.542 iter/s, 7.120e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.592 Tflops/s, hfu: 101.592 Tflops/s, 1478.363 iter/s, 6.764e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 107.826 Tflops/s, hfu: 107.826 Tflops/s, 1569.071 iter/s, 6.373e-04 s/iter, (0.124, 0.000, 0.003) sec
mfu: 115.326 Tflops/s, hfu: 115.326 Tflops/s, 1678.213 iter/s, 5.959e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 88.097 Tflops/s, hfu: 88.097 Tflops/s, 1281.985 iter/s, 7.800e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 112.837 Tflops/s, hfu: 112.837 Tflops/s, 1641.993 iter/s, 6.090e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 112.661 Tflops/s, hfu: 112.661 Tflops/s, 1639.430 iter/s, 6.100e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 114.263 Tflops/s, hfu: 114.263 Tflops/s, 1662.743 iter/s, 6.014e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(131072,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.188 Tflops/s, hfu: 16.188 Tflops/s, 376.909 iter/s, 2.653e-03 s/iter, (0.032, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.217 Tflops/s, hfu: 28.217 Tflops/s, 656.982 iter/s, 1.522e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 13.536 Tflops/s, hfu: 13.536 Tflops/s, 315.161 iter/s, 3.173e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 100.359 Tflops/s, hfu: 100.359 Tflops/s, 1168.333 iter/s, 8.559e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.646 Tflops/s, hfu: 108.646 Tflops/s, 1264.811 iter/s, 7.906e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 112.152 Tflops/s, hfu: 112.152 Tflops/s, 1305.619 iter/s, 7.659e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 119.922 Tflops/s, hfu: 119.922 Tflops/s, 1396.071 iter/s, 7.163e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 100.74 Tflops/s, hfu: 100.74 Tflops/s, 1172.773 iter/s, 8.527e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 120.86 Tflops/s, hfu: 120.86 Tflops/s, 1406.992 iter/s, 7.107e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 123.072 Tflops/s, hfu: 123.072 Tflops/s, 1432.747 iter/s, 6.980e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 117.185 Tflops/s, hfu: 117.185 Tflops/s, 1364.212 iter/s, 7.330e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(131072,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.358 Tflops/s, hfu: 19.358 Tflops/s, 375.588 iter/s, 2.662e-03 s/iter, (0.039, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.729 Tflops/s, hfu: 33.729 Tflops/s, 654.429 iter/s, 1.528e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 16.377 Tflops/s, hfu: 16.377 Tflops/s, 317.758 iter/s, 3.147e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 105.878 Tflops/s, hfu: 105.878 Tflops/s, 1027.150 iter/s, 9.736e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 112.441 Tflops/s, hfu: 112.441 Tflops/s, 1090.817 iter/s, 9.167e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 117.985 Tflops/s, hfu: 117.985 Tflops/s, 1144.605 iter/s, 8.737e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 122.216 Tflops/s, hfu: 122.216 Tflops/s, 1185.655 iter/s, 8.434e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 110.679 Tflops/s, hfu: 110.679 Tflops/s, 1073.726 iter/s, 9.313e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 131.259 Tflops/s, hfu: 131.259 Tflops/s, 1273.379 iter/s, 7.853e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 128.903 Tflops/s, hfu: 128.903 Tflops/s, 1250.525 iter/s, 7.997e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 119.206 Tflops/s, hfu: 119.206 Tflops/s, 1156.454 iter/s, 8.647e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(131072,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.406 Tflops/s, hfu: 22.406 Tflops/s, 372.625 iter/s, 2.684e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.525 Tflops/s, hfu: 38.525 Tflops/s, 640.694 iter/s, 1.561e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 18.869 Tflops/s, hfu: 18.869 Tflops/s, 313.811 iter/s, 3.187e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 109.593 Tflops/s, hfu: 109.593 Tflops/s, 911.305 iter/s, 1.097e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 116.657 Tflops/s, hfu: 116.657 Tflops/s, 970.045 iter/s, 1.031e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 120.234 Tflops/s, hfu: 120.234 Tflops/s, 999.792 iter/s, 1.000e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 124.175 Tflops/s, hfu: 124.175 Tflops/s, 1032.563 iter/s, 9.685e-04 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 119.03 Tflops/s, hfu: 119.03 Tflops/s, 989.778 iter/s, 1.010e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 138.662 Tflops/s, hfu: 138.662 Tflops/s, 1153.030 iter/s, 8.673e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 133.754 Tflops/s, hfu: 133.754 Tflops/s, 1112.218 iter/s, 8.991e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 120.385 Tflops/s, hfu: 120.385 Tflops/s, 1001.049 iter/s, 9.990e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(131072,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.261 Tflops/s, hfu: 25.261 Tflops/s, 367.589 iter/s, 2.720e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.893 Tflops/s, hfu: 43.893 Tflops/s, 638.723 iter/s, 1.566e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.482 Tflops/s, hfu: 21.482 Tflops/s, 312.604 iter/s, 3.199e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 112.936 Tflops/s, hfu: 112.936 Tflops/s, 821.714 iter/s, 1.217e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 118.23 Tflops/s, hfu: 118.23 Tflops/s, 860.236 iter/s, 1.162e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 121.582 Tflops/s, hfu: 121.582 Tflops/s, 884.624 iter/s, 1.130e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 125.127 Tflops/s, hfu: 125.127 Tflops/s, 910.415 iter/s, 1.098e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 126.088 Tflops/s, hfu: 126.088 Tflops/s, 917.411 iter/s, 1.090e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 145.813 Tflops/s, hfu: 145.813 Tflops/s, 1060.931 iter/s, 9.426e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 137.704 Tflops/s, hfu: 137.704 Tflops/s, 1001.932 iter/s, 9.981e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.238 Tflops/s, hfu: 121.238 Tflops/s, 882.121 iter/s, 1.134e-03 s/iter, (0.074, 0.000, 0.005) sec
SP=(1,8),S=(131072,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.63 Tflops/s, hfu: 31.63 Tflops/s, 368.223 iter/s, 2.716e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.738 Tflops/s, hfu: 55.738 Tflops/s, 648.871 iter/s, 1.541e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 26.881 Tflops/s, hfu: 26.881 Tflops/s, 312.938 iter/s, 3.196e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 116.274 Tflops/s, hfu: 116.274 Tflops/s, 676.806 iter/s, 1.478e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 122.285 Tflops/s, hfu: 122.285 Tflops/s, 711.792 iter/s, 1.405e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 124.843 Tflops/s, hfu: 124.843 Tflops/s, 726.681 iter/s, 1.376e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 127.909 Tflops/s, hfu: 127.909 Tflops/s, 744.531 iter/s, 1.343e-03 s/iter, (0.079, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 137.919 Tflops/s, hfu: 137.919 Tflops/s, 802.795 iter/s, 1.246e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 157.014 Tflops/s, hfu: 157.014 Tflops/s, 913.943 iter/s, 1.094e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 143.504 Tflops/s, hfu: 143.504 Tflops/s, 835.305 iter/s, 1.197e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 122.434 Tflops/s, hfu: 122.434 Tflops/s, 712.661 iter/s, 1.403e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(131072,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.651 Tflops/s, hfu: 37.651 Tflops/s, 365.267 iter/s, 2.738e-03 s/iter, (0.040, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 65.526 Tflops/s, hfu: 65.526 Tflops/s, 635.684 iter/s, 1.573e-03 s/iter, (0.021, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 31.203 Tflops/s, hfu: 31.203 Tflops/s, 302.705 iter/s, 3.304e-03 s/iter, (0.037, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 119.664 Tflops/s, hfu: 119.664 Tflops/s, 580.445 iter/s, 1.723e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 123.746 Tflops/s, hfu: 123.746 Tflops/s, 600.246 iter/s, 1.666e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 126.533 Tflops/s, hfu: 126.533 Tflops/s, 613.768 iter/s, 1.629e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 129.059 Tflops/s, hfu: 129.059 Tflops/s, 626.020 iter/s, 1.597e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 147.031 Tflops/s, hfu: 147.031 Tflops/s, 713.194 iter/s, 1.402e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 163.468 Tflops/s, hfu: 163.468 Tflops/s, 792.926 iter/s, 1.261e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 149.027 Tflops/s, hfu: 149.027 Tflops/s, 722.878 iter/s, 1.383e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 123.482 Tflops/s, hfu: 123.482 Tflops/s, 598.966 iter/s, 1.670e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(131072,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.768 Tflops/s, hfu: 43.768 Tflops/s, 363.951 iter/s, 2.748e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 65.07 Tflops/s, hfu: 65.07 Tflops/s, 541.085 iter/s, 1.848e-03 s/iter, (0.026, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 37.036 Tflops/s, hfu: 37.036 Tflops/s, 307.970 iter/s, 3.247e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 120.793 Tflops/s, hfu: 120.793 Tflops/s, 502.222 iter/s, 1.991e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 125.455 Tflops/s, hfu: 125.455 Tflops/s, 521.603 iter/s, 1.917e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 127.922 Tflops/s, hfu: 127.922 Tflops/s, 531.858 iter/s, 1.880e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 129.522 Tflops/s, hfu: 129.522 Tflops/s, 538.512 iter/s, 1.857e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 155.609 Tflops/s, hfu: 155.609 Tflops/s, 646.974 iter/s, 1.546e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 168.874 Tflops/s, hfu: 168.874 Tflops/s, 702.125 iter/s, 1.424e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 151.947 Tflops/s, hfu: 151.947 Tflops/s, 631.747 iter/s, 1.583e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 124.444 Tflops/s, hfu: 124.444 Tflops/s, 517.401 iter/s, 1.933e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(131072,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 49.709 Tflops/s, hfu: 49.709 Tflops/s, 361.684 iter/s, 2.765e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 64.645 Tflops/s, hfu: 64.645 Tflops/s, 470.353 iter/s, 2.126e-03 s/iter, (0.027, 0.000, 0.043) sec
# stripe_flash_attn_func, fwd
mfu: 42.705 Tflops/s, hfu: 42.705 Tflops/s, 310.721 iter/s, 3.218e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 122.665 Tflops/s, hfu: 122.665 Tflops/s, 446.253 iter/s, 2.241e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 127.053 Tflops/s, hfu: 127.053 Tflops/s, 462.217 iter/s, 2.163e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 129.077 Tflops/s, hfu: 129.077 Tflops/s, 469.581 iter/s, 2.130e-03 s/iter, (0.077, 0.000, 0.009) sec
mfu: 130.596 Tflops/s, hfu: 130.596 Tflops/s, 475.105 iter/s, 2.105e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 160.86 Tflops/s, hfu: 160.86 Tflops/s, 585.206 iter/s, 1.709e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 174.492 Tflops/s, hfu: 174.492 Tflops/s, 634.798 iter/s, 1.575e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 154.423 Tflops/s, hfu: 154.423 Tflops/s, 561.788 iter/s, 1.780e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 122.954 Tflops/s, hfu: 122.954 Tflops/s, 447.304 iter/s, 2.236e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(131072,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.667 Tflops/s, hfu: 56.667 Tflops/s, 329.846 iter/s, 3.032e-03 s/iter, (0.039, 0.000, 0.061) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 67.112 Tflops/s, hfu: 67.112 Tflops/s, 390.642 iter/s, 2.560e-03 s/iter, (0.031, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 53.837 Tflops/s, hfu: 53.837 Tflops/s, 313.375 iter/s, 3.191e-03 s/iter, (0.047, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.178 Tflops/s, hfu: 125.178 Tflops/s, 364.315 iter/s, 2.745e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 128.458 Tflops/s, hfu: 128.458 Tflops/s, 373.861 iter/s, 2.675e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 129.812 Tflops/s, hfu: 129.812 Tflops/s, 377.802 iter/s, 2.647e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 131.468 Tflops/s, hfu: 131.468 Tflops/s, 382.623 iter/s, 2.614e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 170.541 Tflops/s, hfu: 170.541 Tflops/s, 496.339 iter/s, 2.015e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 180.827 Tflops/s, hfu: 180.827 Tflops/s, 526.276 iter/s, 1.900e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 157.368 Tflops/s, hfu: 157.368 Tflops/s, 458.001 iter/s, 2.183e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 124.043 Tflops/s, hfu: 124.043 Tflops/s, 361.012 iter/s, 2.770e-03 s/iter, (0.138, 0.000, 0.011) sec
SP=(1,8),S=(131072,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.836 Tflops/s, hfu: 58.836 Tflops/s, 285.390 iter/s, 3.504e-03 s/iter, (0.043, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.395 Tflops/s, hfu: 68.395 Tflops/s, 331.760 iter/s, 3.014e-03 s/iter, (0.036, 0.000, 0.060) sec
# stripe_flash_attn_func, fwd
mfu: 64.327 Tflops/s, hfu: 64.327 Tflops/s, 312.027 iter/s, 3.205e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 126.719 Tflops/s, hfu: 126.719 Tflops/s, 307.334 iter/s, 3.254e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 129.68 Tflops/s, hfu: 129.68 Tflops/s, 314.515 iter/s, 3.179e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 130.842 Tflops/s, hfu: 130.842 Tflops/s, 317.333 iter/s, 3.151e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 132.202 Tflops/s, hfu: 132.202 Tflops/s, 320.631 iter/s, 3.119e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 177.365 Tflops/s, hfu: 177.365 Tflops/s, 430.167 iter/s, 2.325e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 185.941 Tflops/s, hfu: 185.941 Tflops/s, 450.966 iter/s, 2.217e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 160.0 Tflops/s, hfu: 160.0 Tflops/s, 388.051 iter/s, 2.577e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 125.205 Tflops/s, hfu: 125.205 Tflops/s, 303.662 iter/s, 3.293e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(131072,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.522 Tflops/s, hfu: 60.522 Tflops/s, 251.631 iter/s, 3.974e-03 s/iter, (0.048, 0.000, 0.079) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.761 Tflops/s, hfu: 68.761 Tflops/s, 285.888 iter/s, 3.498e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 74.822 Tflops/s, hfu: 74.822 Tflops/s, 311.087 iter/s, 3.215e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 127.385 Tflops/s, hfu: 127.385 Tflops/s, 264.814 iter/s, 3.776e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 130.651 Tflops/s, hfu: 130.651 Tflops/s, 271.603 iter/s, 3.682e-03 s/iter, (0.087, 0.000, 0.015) sec
mfu: 131.665 Tflops/s, hfu: 131.665 Tflops/s, 273.710 iter/s, 3.653e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 132.703 Tflops/s, hfu: 132.703 Tflops/s, 275.870 iter/s, 3.625e-03 s/iter, (0.087, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 182.65 Tflops/s, hfu: 182.65 Tflops/s, 379.701 iter/s, 2.634e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 190.341 Tflops/s, hfu: 190.341 Tflops/s, 395.689 iter/s, 2.527e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 161.148 Tflops/s, hfu: 161.148 Tflops/s, 335.002 iter/s, 2.985e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 125.113 Tflops/s, hfu: 125.113 Tflops/s, 260.090 iter/s, 3.845e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(131072,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.653 Tflops/s, hfu: 61.653 Tflops/s, 224.294 iter/s, 4.458e-03 s/iter, (0.053, 0.000, 0.089) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.641 Tflops/s, hfu: 68.641 Tflops/s, 249.716 iter/s, 4.005e-03 s/iter, (0.047, 0.000, 0.080) sec
# stripe_flash_attn_func, fwd
mfu: 80.698 Tflops/s, hfu: 80.698 Tflops/s, 293.579 iter/s, 3.406e-03 s/iter, (0.041, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 129.317 Tflops/s, hfu: 129.317 Tflops/s, 235.227 iter/s, 4.251e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 131.099 Tflops/s, hfu: 131.099 Tflops/s, 238.467 iter/s, 4.193e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 132.167 Tflops/s, hfu: 132.167 Tflops/s, 240.411 iter/s, 4.160e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 132.791 Tflops/s, hfu: 132.791 Tflops/s, 241.545 iter/s, 4.140e-03 s/iter, (0.086, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 185.209 Tflops/s, hfu: 185.209 Tflops/s, 336.893 iter/s, 2.968e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 192.184 Tflops/s, hfu: 192.184 Tflops/s, 349.580 iter/s, 2.861e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 162.513 Tflops/s, hfu: 162.513 Tflops/s, 295.610 iter/s, 3.383e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 125.71 Tflops/s, hfu: 125.71 Tflops/s, 228.666 iter/s, 4.373e-03 s/iter, (0.091, 0.000, 0.017) sec
SP=(1,8),S=(131072,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.508 Tflops/s, hfu: 63.508 Tflops/s, 184.831 iter/s, 5.410e-03 s/iter, (0.064, 0.000, 0.108) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 84.26 Tflops/s, hfu: 84.26 Tflops/s, 245.229 iter/s, 4.078e-03 s/iter, (0.048, 0.000, 0.082) sec
# stripe_flash_attn_func, fwd
mfu: 87.385 Tflops/s, hfu: 87.385 Tflops/s, 254.325 iter/s, 3.932e-03 s/iter, (0.045, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 130.517 Tflops/s, hfu: 130.517 Tflops/s, 189.927 iter/s, 5.265e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 131.681 Tflops/s, hfu: 131.681 Tflops/s, 191.621 iter/s, 5.219e-03 s/iter, (0.129, 0.000, 0.021) sec
mfu: 132.537 Tflops/s, hfu: 132.537 Tflops/s, 192.866 iter/s, 5.185e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 133.545 Tflops/s, hfu: 133.545 Tflops/s, 194.334 iter/s, 5.146e-03 s/iter, (0.091, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 192.214 Tflops/s, hfu: 192.214 Tflops/s, 279.708 iter/s, 3.575e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 196.252 Tflops/s, hfu: 196.252 Tflops/s, 285.584 iter/s, 3.502e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 164.58 Tflops/s, hfu: 164.58 Tflops/s, 239.496 iter/s, 4.175e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 126.612 Tflops/s, hfu: 126.612 Tflops/s, 184.245 iter/s, 5.428e-03 s/iter, (0.092, 0.000, 0.022) sec
SP=(1,8),S=(131072,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.746 Tflops/s, hfu: 64.746 Tflops/s, 157.029 iter/s, 6.368e-03 s/iter, (0.075, 0.000, 0.127) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.142 Tflops/s, hfu: 99.142 Tflops/s, 240.452 iter/s, 4.159e-03 s/iter, (0.050, 0.000, 0.083) sec
# stripe_flash_attn_func, fwd
mfu: 86.703 Tflops/s, hfu: 86.703 Tflops/s, 210.282 iter/s, 4.756e-03 s/iter, (0.054, 0.000, 0.095) sec
# orchestrated_attn_func
mfu: 131.177 Tflops/s, hfu: 131.177 Tflops/s, 159.073 iter/s, 6.286e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 132.495 Tflops/s, hfu: 132.495 Tflops/s, 160.671 iter/s, 6.224e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 132.944 Tflops/s, hfu: 132.944 Tflops/s, 161.215 iter/s, 6.203e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 133.869 Tflops/s, hfu: 133.869 Tflops/s, 162.338 iter/s, 6.160e-03 s/iter, (0.097, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 196.685 Tflops/s, hfu: 196.685 Tflops/s, 238.512 iter/s, 4.193e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 198.45 Tflops/s, hfu: 198.45 Tflops/s, 240.653 iter/s, 4.155e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 166.53 Tflops/s, hfu: 166.53 Tflops/s, 201.945 iter/s, 4.952e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 127.169 Tflops/s, hfu: 127.169 Tflops/s, 154.213 iter/s, 6.485e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(131072,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 65.588 Tflops/s, hfu: 65.588 Tflops/s, 136.347 iter/s, 7.334e-03 s/iter, (0.086, 0.000, 0.147) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.123 Tflops/s, hfu: 113.123 Tflops/s, 235.165 iter/s, 4.252e-03 s/iter, (0.052, 0.000, 0.085) sec
# stripe_flash_attn_func, fwd
mfu: 87.972 Tflops/s, hfu: 87.972 Tflops/s, 182.880 iter/s, 5.468e-03 s/iter, (0.063, 0.000, 0.109) sec
# orchestrated_attn_func
mfu: 131.589 Tflops/s, hfu: 131.589 Tflops/s, 136.776 iter/s, 7.311e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 132.827 Tflops/s, hfu: 132.827 Tflops/s, 138.063 iter/s, 7.243e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 133.401 Tflops/s, hfu: 133.401 Tflops/s, 138.660 iter/s, 7.212e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 134.033 Tflops/s, hfu: 134.033 Tflops/s, 139.316 iter/s, 7.178e-03 s/iter, (0.098, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 199.648 Tflops/s, hfu: 199.648 Tflops/s, 207.518 iter/s, 4.819e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 200.462 Tflops/s, hfu: 200.462 Tflops/s, 208.365 iter/s, 4.799e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 166.86 Tflops/s, hfu: 166.86 Tflops/s, 173.438 iter/s, 5.766e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 127.308 Tflops/s, hfu: 127.308 Tflops/s, 132.327 iter/s, 7.557e-03 s/iter, (0.104, 0.000, 0.030) sec
SP=(1,8),S=(131072,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 65.937 Tflops/s, hfu: 65.937 Tflops/s, 119.938 iter/s, 8.338e-03 s/iter, (0.098, 0.000, 0.167) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.647 Tflops/s, hfu: 124.647 Tflops/s, 226.731 iter/s, 4.411e-03 s/iter, (0.054, 0.000, 0.088) sec
# stripe_flash_attn_func, fwd
mfu: 85.673 Tflops/s, hfu: 85.673 Tflops/s, 155.839 iter/s, 6.417e-03 s/iter, (0.075, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 132.317 Tflops/s, hfu: 132.317 Tflops/s, 120.342 iter/s, 8.310e-03 s/iter, (0.132, 0.000, 0.033) sec
mfu: 133.212 Tflops/s, hfu: 133.212 Tflops/s, 121.156 iter/s, 8.254e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 133.602 Tflops/s, hfu: 133.602 Tflops/s, 121.510 iter/s, 8.230e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 134.273 Tflops/s, hfu: 134.273 Tflops/s, 122.121 iter/s, 8.189e-03 s/iter, (0.103, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 202.338 Tflops/s, hfu: 202.338 Tflops/s, 184.026 iter/s, 5.434e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 201.882 Tflops/s, hfu: 201.882 Tflops/s, 183.611 iter/s, 5.446e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 167.961 Tflops/s, hfu: 167.961 Tflops/s, 152.760 iter/s, 6.546e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 127.713 Tflops/s, hfu: 127.713 Tflops/s, 116.154 iter/s, 8.609e-03 s/iter, (0.105, 0.000, 0.034) sec
SP=(1,8),S=(131072,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.466 Tflops/s, hfu: 66.466 Tflops/s, 96.720 iter/s, 1.034e-02 s/iter, (0.119, 0.000, 0.207) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.738 Tflops/s, hfu: 140.738 Tflops/s, 204.801 iter/s, 4.883e-03 s/iter, (0.061, 0.000, 0.098) sec
# stripe_flash_attn_func, fwd
mfu: 82.291 Tflops/s, hfu: 82.291 Tflops/s, 119.750 iter/s, 8.351e-03 s/iter, (0.097, 0.000, 0.167) sec
# orchestrated_attn_func
mfu: 132.875 Tflops/s, hfu: 132.875 Tflops/s, 96.679 iter/s, 1.034e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 133.565 Tflops/s, hfu: 133.565 Tflops/s, 97.181 iter/s, 1.029e-02 s/iter, (0.112, 0.000, 0.041) sec
mfu: 133.936 Tflops/s, hfu: 133.936 Tflops/s, 97.452 iter/s, 1.026e-02 s/iter, (0.110, 0.000, 0.041) sec
mfu: 134.557 Tflops/s, hfu: 134.557 Tflops/s, 97.903 iter/s, 1.021e-02 s/iter, (0.114, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 205.453 Tflops/s, hfu: 205.453 Tflops/s, 149.487 iter/s, 6.690e-03 s/iter, (0.100, 0.000, 0.027) sec
mfu: 204.622 Tflops/s, hfu: 204.622 Tflops/s, 148.882 iter/s, 6.717e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 169.189 Tflops/s, hfu: 169.189 Tflops/s, 123.101 iter/s, 8.123e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 127.886 Tflops/s, hfu: 127.886 Tflops/s, 93.049 iter/s, 1.075e-02 s/iter, (0.113, 0.000, 0.043) sec
SP=(1,8),S=(131072,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.893 Tflops/s, hfu: 66.893 Tflops/s, 81.118 iter/s, 1.233e-02 s/iter, (0.141, 0.000, 0.247) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.832 Tflops/s, hfu: 139.832 Tflops/s, 169.569 iter/s, 5.897e-03 s/iter, (0.069, 0.000, 0.118) sec
# stripe_flash_attn_func, fwd
mfu: 79.886 Tflops/s, hfu: 79.886 Tflops/s, 96.874 iter/s, 1.032e-02 s/iter, (0.117, 0.000, 0.206) sec
# orchestrated_attn_func
mfu: 133.562 Tflops/s, hfu: 133.562 Tflops/s, 80.983 iter/s, 1.235e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 133.994 Tflops/s, hfu: 133.994 Tflops/s, 81.244 iter/s, 1.231e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 134.053 Tflops/s, hfu: 134.053 Tflops/s, 81.280 iter/s, 1.230e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 134.632 Tflops/s, hfu: 134.632 Tflops/s, 81.631 iter/s, 1.225e-02 s/iter, (0.118, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 208.423 Tflops/s, hfu: 208.423 Tflops/s, 126.373 iter/s, 7.913e-03 s/iter, (0.104, 0.000, 0.032) sec
mfu: 206.277 Tflops/s, hfu: 206.277 Tflops/s, 125.072 iter/s, 7.995e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 170.048 Tflops/s, hfu: 170.048 Tflops/s, 103.105 iter/s, 9.699e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 128.059 Tflops/s, hfu: 128.059 Tflops/s, 77.646 iter/s, 1.288e-02 s/iter, (0.123, 0.000, 0.052) sec
SP=(1,8),S=(131072,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.798 Tflops/s, hfu: 66.798 Tflops/s, 69.431 iter/s, 1.440e-02 s/iter, (0.165, 0.000, 0.288) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.66 Tflops/s, hfu: 140.66 Tflops/s, 146.206 iter/s, 6.840e-03 s/iter, (0.078, 0.000, 0.137) sec
# stripe_flash_attn_func, fwd
mfu: 78.063 Tflops/s, hfu: 78.063 Tflops/s, 81.140 iter/s, 1.232e-02 s/iter, (0.140, 0.000, 0.246) sec
# orchestrated_attn_func
mfu: 133.995 Tflops/s, hfu: 133.995 Tflops/s, 69.639 iter/s, 1.436e-02 s/iter, (0.130, 0.000, 0.057) sec
mfu: 134.298 Tflops/s, hfu: 134.298 Tflops/s, 69.796 iter/s, 1.433e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 134.268 Tflops/s, hfu: 134.268 Tflops/s, 69.781 iter/s, 1.433e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 134.678 Tflops/s, hfu: 134.678 Tflops/s, 69.994 iter/s, 1.429e-02 s/iter, (0.127, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 209.837 Tflops/s, hfu: 209.837 Tflops/s, 109.055 iter/s, 9.170e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 207.375 Tflops/s, hfu: 207.375 Tflops/s, 107.775 iter/s, 9.279e-03 s/iter, (0.108, 0.000, 0.037) sec
mfu: 170.462 Tflops/s, hfu: 170.462 Tflops/s, 88.591 iter/s, 1.129e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 127.96 Tflops/s, hfu: 127.96 Tflops/s, 66.502 iter/s, 1.504e-02 s/iter, (0.130, 0.000, 0.060) sec
SP=(1,8),S=(131072,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.301 Tflops/s, hfu: 67.301 Tflops/s, 61.210 iter/s, 1.634e-02 s/iter, (0.187, 0.000, 0.327) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.402 Tflops/s, hfu: 140.402 Tflops/s, 127.695 iter/s, 7.831e-03 s/iter, (0.089, 0.000, 0.157) sec
# stripe_flash_attn_func, fwd
mfu: 76.915 Tflops/s, hfu: 76.915 Tflops/s, 69.954 iter/s, 1.430e-02 s/iter, (0.164, 0.000, 0.286) sec
# orchestrated_attn_func
mfu: 134.166 Tflops/s, hfu: 134.166 Tflops/s, 61.012 iter/s, 1.639e-02 s/iter, (0.137, 0.000, 0.066) sec
mfu: 134.358 Tflops/s, hfu: 134.358 Tflops/s, 61.099 iter/s, 1.637e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 134.372 Tflops/s, hfu: 134.372 Tflops/s, 61.105 iter/s, 1.637e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 134.804 Tflops/s, hfu: 134.804 Tflops/s, 61.302 iter/s, 1.631e-02 s/iter, (0.135, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 211.219 Tflops/s, hfu: 211.219 Tflops/s, 96.051 iter/s, 1.041e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 207.805 Tflops/s, hfu: 207.805 Tflops/s, 94.499 iter/s, 1.058e-02 s/iter, (0.116, 0.000, 0.042) sec
mfu: 170.681 Tflops/s, hfu: 170.681 Tflops/s, 77.617 iter/s, 1.288e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 127.987 Tflops/s, hfu: 127.987 Tflops/s, 58.202 iter/s, 1.718e-02 s/iter, (0.139, 0.000, 0.069) sec
SP=(1,8),S=(131072,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.437 Tflops/s, hfu: 67.437 Tflops/s, 49.067 iter/s, 2.038e-02 s/iter, (0.232, 0.000, 0.408) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.628 Tflops/s, hfu: 139.628 Tflops/s, 101.593 iter/s, 9.843e-03 s/iter, (0.111, 0.000, 0.197) sec
# stripe_flash_attn_func, fwd
mfu: 75.177 Tflops/s, hfu: 75.177 Tflops/s, 54.698 iter/s, 1.828e-02 s/iter, (0.207, 0.000, 0.366) sec
# orchestrated_attn_func
mfu: 134.451 Tflops/s, hfu: 134.451 Tflops/s, 48.913 iter/s, 2.044e-02 s/iter, (0.152, 0.000, 0.082) sec
mfu: 134.6 Tflops/s, hfu: 134.6 Tflops/s, 48.967 iter/s, 2.042e-02 s/iter, (0.151, 0.000, 0.082) sec
mfu: 134.709 Tflops/s, hfu: 134.709 Tflops/s, 49.007 iter/s, 2.041e-02 s/iter, (0.151, 0.000, 0.082) sec
mfu: 134.83 Tflops/s, hfu: 134.83 Tflops/s, 49.051 iter/s, 2.039e-02 s/iter, (0.151, 0.000, 0.082) sec
# orchestrated_attn_func fused
mfu: 212.753 Tflops/s, hfu: 212.753 Tflops/s, 77.399 iter/s, 1.292e-02 s/iter, (0.125, 0.000, 0.052) sec
mfu: 209.119 Tflops/s, hfu: 209.119 Tflops/s, 76.077 iter/s, 1.314e-02 s/iter, (0.127, 0.000, 0.053) sec
mfu: 171.401 Tflops/s, hfu: 171.401 Tflops/s, 62.355 iter/s, 1.604e-02 s/iter, (0.134, 0.000, 0.064) sec
mfu: 128.426 Tflops/s, hfu: 128.426 Tflops/s, 46.721 iter/s, 2.140e-02 s/iter, (0.157, 0.000, 0.086) sec
SP=(1,8),S=(131072,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.558 Tflops/s, hfu: 67.558 Tflops/s, 40.962 iter/s, 2.441e-02 s/iter, (0.276, 0.000, 0.488) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 138.209 Tflops/s, hfu: 138.209 Tflops/s, 83.800 iter/s, 1.193e-02 s/iter, (0.133, 0.000, 0.239) sec
# stripe_flash_attn_func, fwd
mfu: 73.992 Tflops/s, hfu: 73.992 Tflops/s, 44.863 iter/s, 2.229e-02 s/iter, (0.249, 0.000, 0.446) sec
# orchestrated_attn_func
mfu: 134.554 Tflops/s, hfu: 134.554 Tflops/s, 40.792 iter/s, 2.451e-02 s/iter, (0.168, 0.000, 0.098) sec
mfu: 134.722 Tflops/s, hfu: 134.722 Tflops/s, 40.843 iter/s, 2.448e-02 s/iter, (0.171, 0.000, 0.098) sec
mfu: 134.77 Tflops/s, hfu: 134.77 Tflops/s, 40.857 iter/s, 2.448e-02 s/iter, (0.170, 0.000, 0.098) sec
mfu: 135.069 Tflops/s, hfu: 135.069 Tflops/s, 40.948 iter/s, 2.442e-02 s/iter, (0.167, 0.000, 0.098) sec
# orchestrated_attn_func fused
mfu: 214.386 Tflops/s, hfu: 214.386 Tflops/s, 64.994 iter/s, 1.539e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 210.123 Tflops/s, hfu: 210.123 Tflops/s, 63.702 iter/s, 1.570e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 171.71 Tflops/s, hfu: 171.71 Tflops/s, 52.056 iter/s, 1.921e-02 s/iter, (0.147, 0.000, 0.077) sec
mfu: 128.527 Tflops/s, hfu: 128.527 Tflops/s, 38.965 iter/s, 2.566e-02 s/iter, (0.173, 0.000, 0.103) sec
SP=(1,8),S=(131072,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.671 Tflops/s, hfu: 67.671 Tflops/s, 35.169 iter/s, 2.843e-02 s/iter, (0.320, 0.000, 0.569) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.193 Tflops/s, hfu: 139.193 Tflops/s, 72.340 iter/s, 1.382e-02 s/iter, (0.156, 0.000, 0.276) sec
# stripe_flash_attn_func, fwd
mfu: 73.025 Tflops/s, hfu: 73.025 Tflops/s, 37.952 iter/s, 2.635e-02 s/iter, (0.293, 0.000, 0.527) sec
# orchestrated_attn_func
mfu: 134.762 Tflops/s, hfu: 134.762 Tflops/s, 35.019 iter/s, 2.856e-02 s/iter, (0.186, 0.000, 0.114) sec
mfu: 134.878 Tflops/s, hfu: 134.878 Tflops/s, 35.049 iter/s, 2.853e-02 s/iter, (0.184, 0.000, 0.114) sec
mfu: 134.859 Tflops/s, hfu: 134.859 Tflops/s, 35.044 iter/s, 2.854e-02 s/iter, (0.184, 0.000, 0.114) sec
mfu: 135.071 Tflops/s, hfu: 135.071 Tflops/s, 35.099 iter/s, 2.849e-02 s/iter, (0.183, 0.000, 0.114) sec
# orchestrated_attn_func fused
mfu: 215.288 Tflops/s, hfu: 215.288 Tflops/s, 55.944 iter/s, 1.788e-02 s/iter, (0.142, 0.000, 0.072) sec
mfu: 211.075 Tflops/s, hfu: 211.075 Tflops/s, 54.849 iter/s, 1.823e-02 s/iter, (0.143, 0.000, 0.073) sec
mfu: 172.178 Tflops/s, hfu: 172.178 Tflops/s, 44.741 iter/s, 2.235e-02 s/iter, (0.163, 0.000, 0.089) sec
mfu: 128.492 Tflops/s, hfu: 128.492 Tflops/s, 33.389 iter/s, 2.995e-02 s/iter, (0.190, 0.000, 0.120) sec
SP=(1,8),S=(131072,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.803 Tflops/s, hfu: 67.803 Tflops/s, 30.833 iter/s, 3.243e-02 s/iter, (0.366, 0.000, 0.649) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 138.208 Tflops/s, hfu: 138.208 Tflops/s, 62.850 iter/s, 1.591e-02 s/iter, (0.178, 0.000, 0.318) sec
# stripe_flash_attn_func, fwd
mfu: 72.478 Tflops/s, hfu: 72.478 Tflops/s, 32.959 iter/s, 3.034e-02 s/iter, (0.337, 0.000, 0.607) sec
# orchestrated_attn_func
mfu: 134.834 Tflops/s, hfu: 134.834 Tflops/s, 30.658 iter/s, 3.262e-02 s/iter, (0.202, 0.000, 0.130) sec
mfu: 134.929 Tflops/s, hfu: 134.929 Tflops/s, 30.679 iter/s, 3.260e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 134.912 Tflops/s, hfu: 134.912 Tflops/s, 30.675 iter/s, 3.260e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 135.156 Tflops/s, hfu: 135.156 Tflops/s, 30.731 iter/s, 3.254e-02 s/iter, (0.200, 0.000, 0.130) sec
# orchestrated_attn_func fused
mfu: 215.96 Tflops/s, hfu: 215.96 Tflops/s, 49.104 iter/s, 2.037e-02 s/iter, (0.152, 0.000, 0.081) sec
mfu: 211.979 Tflops/s, hfu: 211.979 Tflops/s, 48.198 iter/s, 2.075e-02 s/iter, (0.154, 0.000, 0.083) sec
mfu: 172.471 Tflops/s, hfu: 172.471 Tflops/s, 39.215 iter/s, 2.550e-02 s/iter, (0.173, 0.000, 0.102) sec
mfu: 128.702 Tflops/s, hfu: 128.702 Tflops/s, 29.263 iter/s, 3.417e-02 s/iter, (0.211, 0.000, 0.137) sec
SP=(1,8),S=(163840,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.052 Tflops/s, hfu: 4.052 Tflops/s, 377.388 iter/s, 2.650e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 7.484 Tflops/s, hfu: 7.484 Tflops/s, 696.983 iter/s, 1.435e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 3.482 Tflops/s, hfu: 3.482 Tflops/s, 324.281 iter/s, 3.084e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 27.322 Tflops/s, hfu: 27.322 Tflops/s, 1272.278 iter/s, 7.860e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 50.034 Tflops/s, hfu: 50.034 Tflops/s, 2329.873 iter/s, 4.292e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 64.237 Tflops/s, hfu: 64.237 Tflops/s, 2991.289 iter/s, 3.343e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 84.701 Tflops/s, hfu: 84.701 Tflops/s, 3944.213 iter/s, 2.535e-04 s/iter, (0.073, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 34.566 Tflops/s, hfu: 34.566 Tflops/s, 1609.622 iter/s, 6.213e-04 s/iter, (0.193, 0.000, 0.002) sec
mfu: 53.886 Tflops/s, hfu: 53.886 Tflops/s, 2509.284 iter/s, 3.985e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 75.266 Tflops/s, hfu: 75.266 Tflops/s, 3504.837 iter/s, 2.853e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 115.825 Tflops/s, hfu: 115.825 Tflops/s, 5393.511 iter/s, 1.854e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(163840,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.147 Tflops/s, hfu: 8.147 Tflops/s, 379.390 iter/s, 2.636e-03 s/iter, (0.038, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.566 Tflops/s, hfu: 14.566 Tflops/s, 678.278 iter/s, 1.474e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 7.065 Tflops/s, hfu: 7.065 Tflops/s, 328.979 iter/s, 3.040e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 54.008 Tflops/s, hfu: 54.008 Tflops/s, 1257.469 iter/s, 7.952e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 78.096 Tflops/s, hfu: 78.096 Tflops/s, 1818.314 iter/s, 5.500e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 92.545 Tflops/s, hfu: 92.545 Tflops/s, 2154.727 iter/s, 4.641e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 121.903 Tflops/s, hfu: 121.903 Tflops/s, 2838.264 iter/s, 3.523e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 60.538 Tflops/s, hfu: 60.538 Tflops/s, 1409.515 iter/s, 7.095e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 85.429 Tflops/s, hfu: 85.429 Tflops/s, 1989.052 iter/s, 5.028e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 112.786 Tflops/s, hfu: 112.786 Tflops/s, 2625.995 iter/s, 3.808e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 131.399 Tflops/s, hfu: 131.399 Tflops/s, 3059.376 iter/s, 3.269e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(163840,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.123 Tflops/s, hfu: 12.123 Tflops/s, 376.333 iter/s, 2.657e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.926 Tflops/s, hfu: 21.926 Tflops/s, 680.661 iter/s, 1.469e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 10.695 Tflops/s, hfu: 10.695 Tflops/s, 332.012 iter/s, 3.012e-03 s/iter, (0.035, 0.000, 0.060) sec
# orchestrated_attn_func
mfu: 76.973 Tflops/s, hfu: 76.973 Tflops/s, 1194.777 iter/s, 8.370e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 97.619 Tflops/s, hfu: 97.619 Tflops/s, 1515.243 iter/s, 6.600e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 110.47 Tflops/s, hfu: 110.47 Tflops/s, 1714.725 iter/s, 5.832e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 136.813 Tflops/s, hfu: 136.813 Tflops/s, 2123.611 iter/s, 4.709e-04 s/iter, (0.075, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 79.972 Tflops/s, hfu: 79.972 Tflops/s, 1241.323 iter/s, 8.056e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 108.602 Tflops/s, hfu: 108.602 Tflops/s, 1685.727 iter/s, 5.932e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 132.898 Tflops/s, hfu: 132.898 Tflops/s, 2062.842 iter/s, 4.848e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 138.286 Tflops/s, hfu: 138.286 Tflops/s, 2146.475 iter/s, 4.659e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(163840,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.078 Tflops/s, hfu: 16.078 Tflops/s, 374.341 iter/s, 2.671e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 29.09 Tflops/s, hfu: 29.09 Tflops/s, 677.298 iter/s, 1.476e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 14.111 Tflops/s, hfu: 14.111 Tflops/s, 328.558 iter/s, 3.044e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 101.277 Tflops/s, hfu: 101.277 Tflops/s, 1179.023 iter/s, 8.482e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 107.538 Tflops/s, hfu: 107.538 Tflops/s, 1251.903 iter/s, 7.988e-04 s/iter, (0.077, 0.000, 0.003) sec
mfu: 117.557 Tflops/s, hfu: 117.557 Tflops/s, 1368.543 iter/s, 7.307e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 143.481 Tflops/s, hfu: 143.481 Tflops/s, 1670.341 iter/s, 5.987e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 96.315 Tflops/s, hfu: 96.315 Tflops/s, 1121.257 iter/s, 8.919e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 123.953 Tflops/s, hfu: 123.953 Tflops/s, 1443.001 iter/s, 6.930e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 139.46 Tflops/s, hfu: 139.46 Tflops/s, 1623.524 iter/s, 6.159e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 144.25 Tflops/s, hfu: 144.25 Tflops/s, 1679.295 iter/s, 5.955e-04 s/iter, (0.073, 0.000, 0.002) sec
SP=(1,8),S=(163840,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 20.079 Tflops/s, hfu: 20.079 Tflops/s, 373.999 iter/s, 2.674e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 36.135 Tflops/s, hfu: 36.135 Tflops/s, 673.059 iter/s, 1.486e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 17.615 Tflops/s, hfu: 17.615 Tflops/s, 328.097 iter/s, 3.048e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 111.871 Tflops/s, hfu: 111.871 Tflops/s, 1041.884 iter/s, 9.598e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 113.279 Tflops/s, hfu: 113.279 Tflops/s, 1054.995 iter/s, 9.479e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 129.19 Tflops/s, hfu: 129.19 Tflops/s, 1203.173 iter/s, 8.311e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 148.07 Tflops/s, hfu: 148.07 Tflops/s, 1379.006 iter/s, 7.252e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 108.781 Tflops/s, hfu: 108.781 Tflops/s, 1013.106 iter/s, 9.871e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 131.725 Tflops/s, hfu: 131.725 Tflops/s, 1226.789 iter/s, 8.151e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 150.695 Tflops/s, hfu: 150.695 Tflops/s, 1403.454 iter/s, 7.125e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 145.856 Tflops/s, hfu: 145.856 Tflops/s, 1358.386 iter/s, 7.362e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(163840,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.035 Tflops/s, hfu: 24.035 Tflops/s, 373.069 iter/s, 2.680e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 42.874 Tflops/s, hfu: 42.874 Tflops/s, 665.488 iter/s, 1.503e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 21.063 Tflops/s, hfu: 21.063 Tflops/s, 326.946 iter/s, 3.059e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 117.363 Tflops/s, hfu: 117.363 Tflops/s, 910.860 iter/s, 1.098e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 116.784 Tflops/s, hfu: 116.784 Tflops/s, 906.362 iter/s, 1.103e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 138.318 Tflops/s, hfu: 138.318 Tflops/s, 1073.487 iter/s, 9.315e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 151.534 Tflops/s, hfu: 151.534 Tflops/s, 1176.061 iter/s, 8.503e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 119.774 Tflops/s, hfu: 119.774 Tflops/s, 929.568 iter/s, 1.076e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 143.679 Tflops/s, hfu: 143.679 Tflops/s, 1115.096 iter/s, 8.968e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 159.989 Tflops/s, hfu: 159.989 Tflops/s, 1241.681 iter/s, 8.054e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 148.925 Tflops/s, hfu: 148.925 Tflops/s, 1155.813 iter/s, 8.652e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(163840,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.87 Tflops/s, hfu: 27.87 Tflops/s, 370.793 iter/s, 2.697e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.774 Tflops/s, hfu: 49.774 Tflops/s, 662.220 iter/s, 1.510e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.279 Tflops/s, hfu: 24.279 Tflops/s, 323.023 iter/s, 3.096e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 127.216 Tflops/s, hfu: 127.216 Tflops/s, 846.281 iter/s, 1.182e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 130.873 Tflops/s, hfu: 130.873 Tflops/s, 870.607 iter/s, 1.149e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 132.0 Tflops/s, hfu: 132.0 Tflops/s, 878.105 iter/s, 1.139e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 154.126 Tflops/s, hfu: 154.126 Tflops/s, 1025.296 iter/s, 9.753e-04 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 128.918 Tflops/s, hfu: 128.918 Tflops/s, 857.604 iter/s, 1.166e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 151.121 Tflops/s, hfu: 151.121 Tflops/s, 1005.300 iter/s, 9.947e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 164.609 Tflops/s, hfu: 164.609 Tflops/s, 1095.031 iter/s, 9.132e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 150.642 Tflops/s, hfu: 150.642 Tflops/s, 1002.116 iter/s, 9.979e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(163840,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.865 Tflops/s, hfu: 31.865 Tflops/s, 370.959 iter/s, 2.696e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 56.35 Tflops/s, hfu: 56.35 Tflops/s, 655.995 iter/s, 1.524e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 27.639 Tflops/s, hfu: 27.639 Tflops/s, 321.756 iter/s, 3.108e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 126.196 Tflops/s, hfu: 126.196 Tflops/s, 734.555 iter/s, 1.361e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 134.64 Tflops/s, hfu: 134.64 Tflops/s, 783.709 iter/s, 1.276e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 120.387 Tflops/s, hfu: 120.387 Tflops/s, 700.743 iter/s, 1.427e-03 s/iter, (0.074, 0.000, 0.006) sec
mfu: 151.873 Tflops/s, hfu: 151.873 Tflops/s, 884.017 iter/s, 1.131e-03 s/iter, (0.076, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 136.683 Tflops/s, hfu: 136.683 Tflops/s, 795.601 iter/s, 1.257e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 157.844 Tflops/s, hfu: 157.844 Tflops/s, 918.773 iter/s, 1.088e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 169.852 Tflops/s, hfu: 169.852 Tflops/s, 988.666 iter/s, 1.011e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 150.766 Tflops/s, hfu: 150.766 Tflops/s, 877.575 iter/s, 1.140e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(163840,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 39.556 Tflops/s, hfu: 39.556 Tflops/s, 368.390 iter/s, 2.715e-03 s/iter, (0.044, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.687 Tflops/s, hfu: 69.687 Tflops/s, 649.007 iter/s, 1.541e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 33.419 Tflops/s, hfu: 33.419 Tflops/s, 311.241 iter/s, 3.213e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 130.345 Tflops/s, hfu: 130.345 Tflops/s, 606.964 iter/s, 1.648e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 139.393 Tflops/s, hfu: 139.393 Tflops/s, 649.098 iter/s, 1.541e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 156.245 Tflops/s, hfu: 156.245 Tflops/s, 727.573 iter/s, 1.374e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 158.82 Tflops/s, hfu: 158.82 Tflops/s, 739.562 iter/s, 1.352e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 148.419 Tflops/s, hfu: 148.419 Tflops/s, 691.131 iter/s, 1.447e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 168.329 Tflops/s, hfu: 168.329 Tflops/s, 783.842 iter/s, 1.276e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 177.607 Tflops/s, hfu: 177.607 Tflops/s, 827.048 iter/s, 1.209e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 153.195 Tflops/s, hfu: 153.195 Tflops/s, 713.368 iter/s, 1.402e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(163840,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.625 Tflops/s, hfu: 47.625 Tflops/s, 369.622 iter/s, 2.705e-03 s/iter, (0.036, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 79.001 Tflops/s, hfu: 79.001 Tflops/s, 613.126 iter/s, 1.631e-03 s/iter, (0.022, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 40.171 Tflops/s, hfu: 40.171 Tflops/s, 311.767 iter/s, 3.208e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 135.629 Tflops/s, hfu: 135.629 Tflops/s, 526.309 iter/s, 1.900e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 148.466 Tflops/s, hfu: 148.466 Tflops/s, 576.124 iter/s, 1.736e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 157.752 Tflops/s, hfu: 157.752 Tflops/s, 612.157 iter/s, 1.634e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 161.048 Tflops/s, hfu: 161.048 Tflops/s, 624.950 iter/s, 1.600e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 158.455 Tflops/s, hfu: 158.455 Tflops/s, 614.888 iter/s, 1.626e-03 s/iter, (0.127, 0.000, 0.007) sec
mfu: 175.74 Tflops/s, hfu: 175.74 Tflops/s, 681.961 iter/s, 1.466e-03 s/iter, (0.080, 0.000, 0.006) sec
mfu: 184.206 Tflops/s, hfu: 184.206 Tflops/s, 714.813 iter/s, 1.399e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 155.084 Tflops/s, hfu: 155.084 Tflops/s, 601.806 iter/s, 1.662e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(163840,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.147 Tflops/s, hfu: 55.147 Tflops/s, 366.853 iter/s, 2.726e-03 s/iter, (0.045, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 79.342 Tflops/s, hfu: 79.342 Tflops/s, 527.804 iter/s, 1.895e-03 s/iter, (0.024, 0.000, 0.038) sec
# stripe_flash_attn_func, fwd
mfu: 46.519 Tflops/s, hfu: 46.519 Tflops/s, 309.459 iter/s, 3.231e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 139.038 Tflops/s, hfu: 139.038 Tflops/s, 462.461 iter/s, 2.162e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 134.716 Tflops/s, hfu: 134.716 Tflops/s, 448.086 iter/s, 2.232e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 159.314 Tflops/s, hfu: 159.314 Tflops/s, 529.901 iter/s, 1.887e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 161.993 Tflops/s, hfu: 161.993 Tflops/s, 538.814 iter/s, 1.856e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 165.754 Tflops/s, hfu: 165.754 Tflops/s, 551.321 iter/s, 1.814e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 181.331 Tflops/s, hfu: 181.331 Tflops/s, 603.133 iter/s, 1.658e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 188.127 Tflops/s, hfu: 188.127 Tflops/s, 625.738 iter/s, 1.598e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 155.565 Tflops/s, hfu: 155.565 Tflops/s, 517.431 iter/s, 1.933e-03 s/iter, (0.081, 0.000, 0.008) sec
SP=(1,8),S=(163840,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.863 Tflops/s, hfu: 61.863 Tflops/s, 360.088 iter/s, 2.777e-03 s/iter, (0.039, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 75.598 Tflops/s, hfu: 75.598 Tflops/s, 440.037 iter/s, 2.273e-03 s/iter, (0.027, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 53.282 Tflops/s, hfu: 53.282 Tflops/s, 310.142 iter/s, 3.224e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 136.843 Tflops/s, hfu: 136.843 Tflops/s, 398.265 iter/s, 2.511e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 145.724 Tflops/s, hfu: 145.724 Tflops/s, 424.114 iter/s, 2.358e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 149.496 Tflops/s, hfu: 149.496 Tflops/s, 435.091 iter/s, 2.298e-03 s/iter, (0.083, 0.000, 0.009) sec
mfu: 162.641 Tflops/s, hfu: 162.641 Tflops/s, 473.347 iter/s, 2.113e-03 s/iter, (0.079, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 171.181 Tflops/s, hfu: 171.181 Tflops/s, 498.202 iter/s, 2.007e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 186.29 Tflops/s, hfu: 186.29 Tflops/s, 542.175 iter/s, 1.844e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 191.415 Tflops/s, hfu: 191.415 Tflops/s, 557.091 iter/s, 1.795e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 153.961 Tflops/s, hfu: 153.961 Tflops/s, 448.086 iter/s, 2.232e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(163840,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.051 Tflops/s, hfu: 69.051 Tflops/s, 321.544 iter/s, 3.110e-03 s/iter, (0.041, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 83.803 Tflops/s, hfu: 83.803 Tflops/s, 390.240 iter/s, 2.563e-03 s/iter, (0.031, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 68.692 Tflops/s, hfu: 68.692 Tflops/s, 319.873 iter/s, 3.126e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 136.908 Tflops/s, hfu: 136.908 Tflops/s, 318.765 iter/s, 3.137e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 139.896 Tflops/s, hfu: 139.896 Tflops/s, 325.722 iter/s, 3.070e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 151.403 Tflops/s, hfu: 151.403 Tflops/s, 352.512 iter/s, 2.837e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 163.889 Tflops/s, hfu: 163.889 Tflops/s, 381.584 iter/s, 2.621e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 181.143 Tflops/s, hfu: 181.143 Tflops/s, 421.756 iter/s, 2.371e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 193.164 Tflops/s, hfu: 193.164 Tflops/s, 449.745 iter/s, 2.223e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 195.673 Tflops/s, hfu: 195.673 Tflops/s, 455.586 iter/s, 2.195e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 154.957 Tflops/s, hfu: 154.957 Tflops/s, 360.788 iter/s, 2.772e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(163840,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.894 Tflops/s, hfu: 71.894 Tflops/s, 278.987 iter/s, 3.584e-03 s/iter, (0.045, 0.000, 0.072) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.368 Tflops/s, hfu: 81.368 Tflops/s, 315.751 iter/s, 3.167e-03 s/iter, (0.039, 0.000, 0.063) sec
# stripe_flash_attn_func, fwd
mfu: 81.869 Tflops/s, hfu: 81.869 Tflops/s, 317.693 iter/s, 3.148e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 140.637 Tflops/s, hfu: 140.637 Tflops/s, 272.872 iter/s, 3.665e-03 s/iter, (0.083, 0.000, 0.015) sec
mfu: 137.566 Tflops/s, hfu: 137.566 Tflops/s, 266.914 iter/s, 3.747e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 150.985 Tflops/s, hfu: 150.985 Tflops/s, 292.950 iter/s, 3.414e-03 s/iter, (0.088, 0.000, 0.014) sec
mfu: 164.446 Tflops/s, hfu: 164.446 Tflops/s, 319.067 iter/s, 3.134e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 187.467 Tflops/s, hfu: 187.467 Tflops/s, 363.735 iter/s, 2.749e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 198.107 Tflops/s, hfu: 198.107 Tflops/s, 384.379 iter/s, 2.602e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 199.254 Tflops/s, hfu: 199.254 Tflops/s, 386.604 iter/s, 2.587e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 156.308 Tflops/s, hfu: 156.308 Tflops/s, 303.278 iter/s, 3.297e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(163840,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.637 Tflops/s, hfu: 73.637 Tflops/s, 244.927 iter/s, 4.083e-03 s/iter, (0.050, 0.000, 0.082) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 85.366 Tflops/s, hfu: 85.366 Tflops/s, 283.941 iter/s, 3.522e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 94.609 Tflops/s, hfu: 94.609 Tflops/s, 314.683 iter/s, 3.178e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 149.394 Tflops/s, hfu: 149.394 Tflops/s, 248.454 iter/s, 4.025e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 137.932 Tflops/s, hfu: 137.932 Tflops/s, 229.391 iter/s, 4.359e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 153.243 Tflops/s, hfu: 153.243 Tflops/s, 254.855 iter/s, 3.924e-03 s/iter, (0.088, 0.000, 0.016) sec
mfu: 165.339 Tflops/s, hfu: 165.339 Tflops/s, 274.971 iter/s, 3.637e-03 s/iter, (0.088, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 192.148 Tflops/s, hfu: 192.148 Tflops/s, 319.557 iter/s, 3.129e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 200.911 Tflops/s, hfu: 200.911 Tflops/s, 334.131 iter/s, 2.993e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 200.553 Tflops/s, hfu: 200.553 Tflops/s, 333.535 iter/s, 2.998e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 156.189 Tflops/s, hfu: 156.189 Tflops/s, 259.754 iter/s, 3.850e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(163840,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.419 Tflops/s, hfu: 75.419 Tflops/s, 219.499 iter/s, 4.556e-03 s/iter, (0.056, 0.000, 0.091) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 83.817 Tflops/s, hfu: 83.817 Tflops/s, 243.939 iter/s, 4.099e-03 s/iter, (0.049, 0.000, 0.082) sec
# stripe_flash_attn_func, fwd
mfu: 86.615 Tflops/s, hfu: 86.615 Tflops/s, 252.082 iter/s, 3.967e-03 s/iter, (0.042, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 137.812 Tflops/s, hfu: 137.812 Tflops/s, 200.543 iter/s, 4.986e-03 s/iter, (0.092, 0.000, 0.020) sec
mfu: 156.54 Tflops/s, hfu: 156.54 Tflops/s, 227.795 iter/s, 4.390e-03 s/iter, (0.090, 0.000, 0.018) sec
mfu: 152.592 Tflops/s, hfu: 152.592 Tflops/s, 222.050 iter/s, 4.503e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 163.151 Tflops/s, hfu: 163.151 Tflops/s, 237.416 iter/s, 4.212e-03 s/iter, (0.086, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 196.363 Tflops/s, hfu: 196.363 Tflops/s, 285.746 iter/s, 3.500e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 203.359 Tflops/s, hfu: 203.359 Tflops/s, 295.927 iter/s, 3.379e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 202.439 Tflops/s, hfu: 202.439 Tflops/s, 294.587 iter/s, 3.395e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 157.093 Tflops/s, hfu: 157.093 Tflops/s, 228.600 iter/s, 4.374e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(163840,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.157 Tflops/s, hfu: 78.157 Tflops/s, 181.974 iter/s, 5.495e-03 s/iter, (0.065, 0.000, 0.110) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 85.066 Tflops/s, hfu: 85.066 Tflops/s, 198.061 iter/s, 5.049e-03 s/iter, (0.060, 0.000, 0.101) sec
# stripe_flash_attn_func, fwd
mfu: 106.325 Tflops/s, hfu: 106.325 Tflops/s, 247.557 iter/s, 4.039e-03 s/iter, (0.047, 0.000, 0.081) sec
# orchestrated_attn_func
mfu: 142.5 Tflops/s, hfu: 142.5 Tflops/s, 165.891 iter/s, 6.028e-03 s/iter, (0.092, 0.000, 0.024) sec
mfu: 151.066 Tflops/s, hfu: 151.066 Tflops/s, 175.864 iter/s, 5.686e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 165.637 Tflops/s, hfu: 165.637 Tflops/s, 192.827 iter/s, 5.186e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 166.512 Tflops/s, hfu: 166.512 Tflops/s, 193.846 iter/s, 5.159e-03 s/iter, (0.093, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 202.299 Tflops/s, hfu: 202.299 Tflops/s, 235.507 iter/s, 4.246e-03 s/iter, (0.089, 0.000, 0.017) sec
mfu: 207.913 Tflops/s, hfu: 207.913 Tflops/s, 242.043 iter/s, 4.132e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 205.099 Tflops/s, hfu: 205.099 Tflops/s, 238.767 iter/s, 4.188e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 158.18 Tflops/s, hfu: 158.18 Tflops/s, 184.146 iter/s, 5.430e-03 s/iter, (0.092, 0.000, 0.022) sec
SP=(1,8),S=(163840,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.882 Tflops/s, hfu: 79.882 Tflops/s, 154.992 iter/s, 6.452e-03 s/iter, (0.078, 0.000, 0.129) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.469 Tflops/s, hfu: 99.469 Tflops/s, 192.996 iter/s, 5.181e-03 s/iter, (0.062, 0.000, 0.104) sec
# stripe_flash_attn_func, fwd
mfu: 98.535 Tflops/s, hfu: 98.535 Tflops/s, 191.183 iter/s, 5.231e-03 s/iter, (0.059, 0.000, 0.105) sec
# orchestrated_attn_func
mfu: 153.776 Tflops/s, hfu: 153.776 Tflops/s, 149.182 iter/s, 6.703e-03 s/iter, (0.096, 0.000, 0.027) sec
mfu: 151.519 Tflops/s, hfu: 151.519 Tflops/s, 146.993 iter/s, 6.803e-03 s/iter, (0.095, 0.000, 0.027) sec
mfu: 166.14 Tflops/s, hfu: 166.14 Tflops/s, 161.177 iter/s, 6.204e-03 s/iter, (0.097, 0.000, 0.025) sec
mfu: 166.951 Tflops/s, hfu: 166.951 Tflops/s, 161.964 iter/s, 6.174e-03 s/iter, (0.095, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 206.413 Tflops/s, hfu: 206.413 Tflops/s, 200.247 iter/s, 4.994e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 210.241 Tflops/s, hfu: 210.241 Tflops/s, 203.961 iter/s, 4.903e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 207.141 Tflops/s, hfu: 207.141 Tflops/s, 200.953 iter/s, 4.976e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 158.891 Tflops/s, hfu: 158.891 Tflops/s, 154.145 iter/s, 6.487e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(163840,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.084 Tflops/s, hfu: 81.084 Tflops/s, 134.848 iter/s, 7.416e-03 s/iter, (0.086, 0.000, 0.148) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.812 Tflops/s, hfu: 113.812 Tflops/s, 189.277 iter/s, 5.283e-03 s/iter, (0.063, 0.000, 0.106) sec
# stripe_flash_attn_func, fwd
mfu: 108.628 Tflops/s, hfu: 108.628 Tflops/s, 180.657 iter/s, 5.535e-03 s/iter, (0.066, 0.000, 0.111) sec
# orchestrated_attn_func
mfu: 155.764 Tflops/s, hfu: 155.764 Tflops/s, 129.523 iter/s, 7.721e-03 s/iter, (0.105, 0.000, 0.031) sec
mfu: 160.94 Tflops/s, hfu: 160.94 Tflops/s, 133.828 iter/s, 7.472e-03 s/iter, (0.110, 0.000, 0.030) sec
mfu: 166.527 Tflops/s, hfu: 166.527 Tflops/s, 138.474 iter/s, 7.222e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 167.329 Tflops/s, hfu: 167.329 Tflops/s, 139.140 iter/s, 7.187e-03 s/iter, (0.101, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 209.596 Tflops/s, hfu: 209.596 Tflops/s, 174.287 iter/s, 5.738e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 211.893 Tflops/s, hfu: 211.893 Tflops/s, 176.197 iter/s, 5.675e-03 s/iter, (0.094, 0.000, 0.023) sec
mfu: 208.15 Tflops/s, hfu: 208.15 Tflops/s, 173.084 iter/s, 5.778e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 158.879 Tflops/s, hfu: 158.879 Tflops/s, 132.114 iter/s, 7.569e-03 s/iter, (0.100, 0.000, 0.030) sec
SP=(1,8),S=(163840,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.327 Tflops/s, hfu: 81.327 Tflops/s, 118.347 iter/s, 8.450e-03 s/iter, (0.098, 0.000, 0.169) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 126.318 Tflops/s, hfu: 126.318 Tflops/s, 183.816 iter/s, 5.440e-03 s/iter, (0.064, 0.000, 0.109) sec
# stripe_flash_attn_func, fwd
mfu: 104.144 Tflops/s, hfu: 104.144 Tflops/s, 151.549 iter/s, 6.599e-03 s/iter, (0.077, 0.000, 0.132) sec
# orchestrated_attn_func
mfu: 153.746 Tflops/s, hfu: 153.746 Tflops/s, 111.865 iter/s, 8.939e-03 s/iter, (0.108, 0.000, 0.036) sec
mfu: 163.092 Tflops/s, hfu: 163.092 Tflops/s, 118.665 iter/s, 8.427e-03 s/iter, (0.102, 0.000, 0.034) sec
mfu: 166.993 Tflops/s, hfu: 166.993 Tflops/s, 121.503 iter/s, 8.230e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 167.504 Tflops/s, hfu: 167.504 Tflops/s, 121.875 iter/s, 8.205e-03 s/iter, (0.103, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 211.9 Tflops/s, hfu: 211.9 Tflops/s, 154.178 iter/s, 6.486e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 213.667 Tflops/s, hfu: 213.667 Tflops/s, 155.463 iter/s, 6.432e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 209.334 Tflops/s, hfu: 209.334 Tflops/s, 152.311 iter/s, 6.566e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 159.51 Tflops/s, hfu: 159.51 Tflops/s, 116.059 iter/s, 8.616e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(163840,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 82.355 Tflops/s, hfu: 82.355 Tflops/s, 95.874 iter/s, 1.043e-02 s/iter, (0.123, 0.000, 0.209) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 151.518 Tflops/s, hfu: 151.518 Tflops/s, 176.391 iter/s, 5.669e-03 s/iter, (0.069, 0.000, 0.113) sec
# stripe_flash_attn_func, fwd
mfu: 100.374 Tflops/s, hfu: 100.374 Tflops/s, 116.851 iter/s, 8.558e-03 s/iter, (0.100, 0.000, 0.171) sec
# orchestrated_attn_func
mfu: 144.41 Tflops/s, hfu: 144.41 Tflops/s, 84.058 iter/s, 1.190e-02 s/iter, (0.116, 0.000, 0.048) sec
mfu: 164.079 Tflops/s, hfu: 164.079 Tflops/s, 95.506 iter/s, 1.047e-02 s/iter, (0.114, 0.000, 0.042) sec
mfu: 167.641 Tflops/s, hfu: 167.641 Tflops/s, 97.580 iter/s, 1.025e-02 s/iter, (0.123, 0.000, 0.041) sec
mfu: 167.95 Tflops/s, hfu: 167.95 Tflops/s, 97.760 iter/s, 1.023e-02 s/iter, (0.111, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 215.311 Tflops/s, hfu: 215.311 Tflops/s, 125.327 iter/s, 7.979e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 215.67 Tflops/s, hfu: 215.67 Tflops/s, 125.536 iter/s, 7.966e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 210.594 Tflops/s, hfu: 210.594 Tflops/s, 122.582 iter/s, 8.158e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 159.544 Tflops/s, hfu: 159.544 Tflops/s, 92.867 iter/s, 1.077e-02 s/iter, (0.113, 0.000, 0.043) sec
SP=(1,8),S=(163840,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 82.691 Tflops/s, hfu: 82.691 Tflops/s, 80.221 iter/s, 1.247e-02 s/iter, (0.145, 0.000, 0.249) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 155.601 Tflops/s, hfu: 155.601 Tflops/s, 150.953 iter/s, 6.625e-03 s/iter, (0.078, 0.000, 0.132) sec
# stripe_flash_attn_func, fwd
mfu: 95.753 Tflops/s, hfu: 95.753 Tflops/s, 92.893 iter/s, 1.077e-02 s/iter, (0.122, 0.000, 0.215) sec
# orchestrated_attn_func
mfu: 157.67 Tflops/s, hfu: 157.67 Tflops/s, 76.480 iter/s, 1.308e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 164.516 Tflops/s, hfu: 164.516 Tflops/s, 79.801 iter/s, 1.253e-02 s/iter, (0.121, 0.000, 0.050) sec
mfu: 167.716 Tflops/s, hfu: 167.716 Tflops/s, 81.353 iter/s, 1.229e-02 s/iter, (0.118, 0.000, 0.049) sec
mfu: 167.997 Tflops/s, hfu: 167.997 Tflops/s, 81.489 iter/s, 1.227e-02 s/iter, (0.122, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 217.806 Tflops/s, hfu: 217.806 Tflops/s, 105.650 iter/s, 9.465e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 217.476 Tflops/s, hfu: 217.476 Tflops/s, 105.490 iter/s, 9.480e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 211.443 Tflops/s, hfu: 211.443 Tflops/s, 102.563 iter/s, 9.750e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 160.158 Tflops/s, hfu: 160.158 Tflops/s, 77.687 iter/s, 1.287e-02 s/iter, (0.122, 0.000, 0.051) sec
SP=(1,8),S=(163840,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.549 Tflops/s, hfu: 83.549 Tflops/s, 69.474 iter/s, 1.439e-02 s/iter, (0.166, 0.000, 0.288) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.071 Tflops/s, hfu: 156.071 Tflops/s, 129.779 iter/s, 7.705e-03 s/iter, (0.091, 0.000, 0.154) sec
# stripe_flash_attn_func, fwd
mfu: 93.471 Tflops/s, hfu: 93.471 Tflops/s, 77.725 iter/s, 1.287e-02 s/iter, (0.144, 0.000, 0.257) sec
# orchestrated_attn_func
mfu: 155.422 Tflops/s, hfu: 155.422 Tflops/s, 64.620 iter/s, 1.548e-02 s/iter, (0.130, 0.000, 0.062) sec
mfu: 160.324 Tflops/s, hfu: 160.324 Tflops/s, 66.658 iter/s, 1.500e-02 s/iter, (0.133, 0.000, 0.060) sec
mfu: 167.929 Tflops/s, hfu: 167.929 Tflops/s, 69.820 iter/s, 1.432e-02 s/iter, (0.128, 0.000, 0.057) sec
mfu: 168.208 Tflops/s, hfu: 168.208 Tflops/s, 69.936 iter/s, 1.430e-02 s/iter, (0.128, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 218.642 Tflops/s, hfu: 218.642 Tflops/s, 90.904 iter/s, 1.100e-02 s/iter, (0.117, 0.000, 0.044) sec
mfu: 217.923 Tflops/s, hfu: 217.923 Tflops/s, 90.605 iter/s, 1.104e-02 s/iter, (0.117, 0.000, 0.044) sec
mfu: 212.145 Tflops/s, hfu: 212.145 Tflops/s, 88.203 iter/s, 1.134e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 159.908 Tflops/s, hfu: 159.908 Tflops/s, 66.485 iter/s, 1.504e-02 s/iter, (0.133, 0.000, 0.060) sec
SP=(1,8),S=(163840,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.551 Tflops/s, hfu: 83.551 Tflops/s, 60.791 iter/s, 1.645e-02 s/iter, (0.191, 0.000, 0.329) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.253 Tflops/s, hfu: 156.253 Tflops/s, 113.689 iter/s, 8.796e-03 s/iter, (0.102, 0.000, 0.176) sec
# stripe_flash_attn_func, fwd
mfu: 92.328 Tflops/s, hfu: 92.328 Tflops/s, 67.177 iter/s, 1.489e-02 s/iter, (0.168, 0.000, 0.298) sec
# orchestrated_attn_func
mfu: 158.447 Tflops/s, hfu: 158.447 Tflops/s, 57.643 iter/s, 1.735e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 164.951 Tflops/s, hfu: 164.951 Tflops/s, 60.009 iter/s, 1.666e-02 s/iter, (0.140, 0.000, 0.067) sec
mfu: 167.978 Tflops/s, hfu: 167.978 Tflops/s, 61.110 iter/s, 1.636e-02 s/iter, (0.138, 0.000, 0.065) sec
mfu: 168.222 Tflops/s, hfu: 168.222 Tflops/s, 61.199 iter/s, 1.634e-02 s/iter, (0.136, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 220.286 Tflops/s, hfu: 220.286 Tflops/s, 80.139 iter/s, 1.248e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 218.633 Tflops/s, hfu: 218.633 Tflops/s, 79.538 iter/s, 1.257e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 212.293 Tflops/s, hfu: 212.293 Tflops/s, 77.232 iter/s, 1.295e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 159.952 Tflops/s, hfu: 159.952 Tflops/s, 58.190 iter/s, 1.718e-02 s/iter, (0.140, 0.000, 0.069) sec
SP=(1,8),S=(163840,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.947 Tflops/s, hfu: 83.947 Tflops/s, 48.864 iter/s, 2.047e-02 s/iter, (0.233, 0.000, 0.409) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 155.89 Tflops/s, hfu: 155.89 Tflops/s, 90.740 iter/s, 1.102e-02 s/iter, (0.126, 0.000, 0.220) sec
# stripe_flash_attn_func, fwd
mfu: 90.645 Tflops/s, hfu: 90.645 Tflops/s, 52.762 iter/s, 1.895e-02 s/iter, (0.212, 0.000, 0.379) sec
# orchestrated_attn_func
mfu: 158.757 Tflops/s, hfu: 158.757 Tflops/s, 46.204 iter/s, 2.164e-02 s/iter, (0.153, 0.000, 0.087) sec
mfu: 164.898 Tflops/s, hfu: 164.898 Tflops/s, 47.991 iter/s, 2.084e-02 s/iter, (0.167, 0.000, 0.083) sec
mfu: 168.238 Tflops/s, hfu: 168.238 Tflops/s, 48.964 iter/s, 2.042e-02 s/iter, (0.152, 0.000, 0.082) sec
mfu: 168.42 Tflops/s, hfu: 168.42 Tflops/s, 49.017 iter/s, 2.040e-02 s/iter, (0.155, 0.000, 0.082) sec
# orchestrated_attn_func fused
mfu: 221.929 Tflops/s, hfu: 221.929 Tflops/s, 64.590 iter/s, 1.548e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 220.505 Tflops/s, hfu: 220.505 Tflops/s, 64.175 iter/s, 1.558e-02 s/iter, (0.133, 0.000, 0.062) sec
mfu: 213.387 Tflops/s, hfu: 213.387 Tflops/s, 62.104 iter/s, 1.610e-02 s/iter, (0.135, 0.000, 0.064) sec
mfu: 160.369 Tflops/s, hfu: 160.369 Tflops/s, 46.674 iter/s, 2.143e-02 s/iter, (0.169, 0.000, 0.086) sec
SP=(1,8),S=(163840,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.065 Tflops/s, hfu: 84.065 Tflops/s, 40.777 iter/s, 2.452e-02 s/iter, (0.277, 0.000, 0.490) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.928 Tflops/s, hfu: 156.928 Tflops/s, 76.120 iter/s, 1.314e-02 s/iter, (0.149, 0.000, 0.263) sec
# stripe_flash_attn_func, fwd
mfu: 88.566 Tflops/s, hfu: 88.566 Tflops/s, 42.960 iter/s, 2.328e-02 s/iter, (0.252, 0.000, 0.466) sec
# orchestrated_attn_func
mfu: 152.65 Tflops/s, hfu: 152.65 Tflops/s, 37.022 iter/s, 2.701e-02 s/iter, (0.177, 0.000, 0.108) sec
mfu: 150.008 Tflops/s, hfu: 150.008 Tflops/s, 36.382 iter/s, 2.749e-02 s/iter, (0.172, 0.000, 0.110) sec
mfu: 168.455 Tflops/s, hfu: 168.455 Tflops/s, 40.856 iter/s, 2.448e-02 s/iter, (0.171, 0.000, 0.098) sec
mfu: 168.535 Tflops/s, hfu: 168.535 Tflops/s, 40.875 iter/s, 2.446e-02 s/iter, (0.169, 0.000, 0.098) sec
# orchestrated_attn_func fused
mfu: 223.294 Tflops/s, hfu: 223.294 Tflops/s, 54.156 iter/s, 1.847e-02 s/iter, (0.146, 0.000, 0.074) sec
mfu: 221.59 Tflops/s, hfu: 221.59 Tflops/s, 53.743 iter/s, 1.861e-02 s/iter, (0.149, 0.000, 0.074) sec
mfu: 213.933 Tflops/s, hfu: 213.933 Tflops/s, 51.886 iter/s, 1.927e-02 s/iter, (0.151, 0.000, 0.077) sec
mfu: 160.665 Tflops/s, hfu: 160.665 Tflops/s, 38.966 iter/s, 2.566e-02 s/iter, (0.181, 0.000, 0.103) sec
SP=(1,8),S=(163840,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.227 Tflops/s, hfu: 84.227 Tflops/s, 35.019 iter/s, 2.856e-02 s/iter, (0.322, 0.000, 0.571) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.994 Tflops/s, hfu: 156.994 Tflops/s, 65.273 iter/s, 1.532e-02 s/iter, (0.173, 0.000, 0.306) sec
# stripe_flash_attn_func, fwd
mfu: 87.773 Tflops/s, hfu: 87.773 Tflops/s, 36.493 iter/s, 2.740e-02 s/iter, (0.296, 0.000, 0.548) sec
# orchestrated_attn_func
mfu: 158.515 Tflops/s, hfu: 158.515 Tflops/s, 32.953 iter/s, 3.035e-02 s/iter, (0.188, 0.000, 0.121) sec
mfu: 146.415 Tflops/s, hfu: 146.415 Tflops/s, 30.437 iter/s, 3.285e-02 s/iter, (0.198, 0.000, 0.131) sec
mfu: 168.634 Tflops/s, hfu: 168.634 Tflops/s, 35.056 iter/s, 2.853e-02 s/iter, (0.209, 0.000, 0.114) sec
mfu: 168.726 Tflops/s, hfu: 168.726 Tflops/s, 35.076 iter/s, 2.851e-02 s/iter, (0.186, 0.000, 0.114) sec
# orchestrated_attn_func fused
mfu: 224.444 Tflops/s, hfu: 224.444 Tflops/s, 46.658 iter/s, 2.143e-02 s/iter, (0.161, 0.000, 0.086) sec
mfu: 222.077 Tflops/s, hfu: 222.077 Tflops/s, 46.166 iter/s, 2.166e-02 s/iter, (0.157, 0.000, 0.087) sec
mfu: 214.269 Tflops/s, hfu: 214.269 Tflops/s, 44.543 iter/s, 2.245e-02 s/iter, (0.160, 0.000, 0.090) sec
mfu: 160.514 Tflops/s, hfu: 160.514 Tflops/s, 33.368 iter/s, 2.997e-02 s/iter, (0.191, 0.000, 0.120) sec
SP=(1,8),S=(163840,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.67 Tflops/s, hfu: 84.67 Tflops/s, 30.803 iter/s, 3.246e-02 s/iter, (0.365, 0.000, 0.649) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 157.695 Tflops/s, hfu: 157.695 Tflops/s, 57.369 iter/s, 1.743e-02 s/iter, (0.196, 0.000, 0.349) sec
# stripe_flash_attn_func, fwd
mfu: 87.987 Tflops/s, hfu: 87.987 Tflops/s, 32.009 iter/s, 3.124e-02 s/iter, (0.340, 0.000, 0.625) sec
# orchestrated_attn_func
mfu: 153.492 Tflops/s, hfu: 153.492 Tflops/s, 27.920 iter/s, 3.582e-02 s/iter, (0.211, 0.000, 0.143) sec
mfu: 159.277 Tflops/s, hfu: 159.277 Tflops/s, 28.972 iter/s, 3.452e-02 s/iter, (0.213, 0.000, 0.138) sec
mfu: 168.697 Tflops/s, hfu: 168.697 Tflops/s, 30.686 iter/s, 3.259e-02 s/iter, (0.203, 0.000, 0.130) sec
mfu: 168.6 Tflops/s, hfu: 168.6 Tflops/s, 30.668 iter/s, 3.261e-02 s/iter, (0.205, 0.000, 0.130) sec
# orchestrated_attn_func fused
mfu: 225.302 Tflops/s, hfu: 225.302 Tflops/s, 40.982 iter/s, 2.440e-02 s/iter, (0.171, 0.000, 0.098) sec
mfu: 222.745 Tflops/s, hfu: 222.745 Tflops/s, 40.517 iter/s, 2.468e-02 s/iter, (0.170, 0.000, 0.099) sec
mfu: 214.643 Tflops/s, hfu: 214.643 Tflops/s, 39.043 iter/s, 2.561e-02 s/iter, (0.176, 0.000, 0.102) sec
mfu: 160.738 Tflops/s, hfu: 160.738 Tflops/s, 29.238 iter/s, 3.420e-02 s/iter, (0.208, 0.000, 0.137) sec
SP=(1,8),S=(196608,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.814 Tflops/s, hfu: 4.814 Tflops/s, 373.591 iter/s, 2.677e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.977 Tflops/s, hfu: 8.977 Tflops/s, 696.717 iter/s, 1.435e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 4.213 Tflops/s, hfu: 4.213 Tflops/s, 327.008 iter/s, 3.058e-03 s/iter, (0.035, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 30.082 Tflops/s, hfu: 30.082 Tflops/s, 1167.352 iter/s, 8.566e-04 s/iter, (0.079, 0.000, 0.003) sec
mfu: 54.945 Tflops/s, hfu: 54.945 Tflops/s, 2132.160 iter/s, 4.690e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 68.9 Tflops/s, hfu: 68.9 Tflops/s, 2673.683 iter/s, 3.740e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 97.371 Tflops/s, hfu: 97.371 Tflops/s, 3778.490 iter/s, 2.647e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 37.002 Tflops/s, hfu: 37.002 Tflops/s, 1435.857 iter/s, 6.964e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 55.211 Tflops/s, hfu: 55.211 Tflops/s, 2142.465 iter/s, 4.668e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 76.809 Tflops/s, hfu: 76.809 Tflops/s, 2980.590 iter/s, 3.355e-04 s/iter, (0.072, 0.000, 0.001) sec
mfu: 138.197 Tflops/s, hfu: 138.197 Tflops/s, 5362.736 iter/s, 1.865e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(196608,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.661 Tflops/s, hfu: 9.661 Tflops/s, 374.903 iter/s, 2.667e-03 s/iter, (0.033, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.954 Tflops/s, hfu: 17.954 Tflops/s, 696.711 iter/s, 1.435e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 8.4 Tflops/s, hfu: 8.4 Tflops/s, 325.965 iter/s, 3.068e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 55.956 Tflops/s, hfu: 55.956 Tflops/s, 1085.691 iter/s, 9.211e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 84.983 Tflops/s, hfu: 84.983 Tflops/s, 1648.881 iter/s, 6.065e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 95.256 Tflops/s, hfu: 95.256 Tflops/s, 1848.210 iter/s, 5.411e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 142.397 Tflops/s, hfu: 142.397 Tflops/s, 2762.858 iter/s, 3.619e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 63.197 Tflops/s, hfu: 63.197 Tflops/s, 1226.175 iter/s, 8.155e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 87.07 Tflops/s, hfu: 87.07 Tflops/s, 1689.372 iter/s, 5.919e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 110.291 Tflops/s, hfu: 110.291 Tflops/s, 2139.935 iter/s, 4.673e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 157.321 Tflops/s, hfu: 157.321 Tflops/s, 3052.429 iter/s, 3.276e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(196608,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 14.443 Tflops/s, hfu: 14.443 Tflops/s, 373.631 iter/s, 2.676e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.796 Tflops/s, hfu: 26.796 Tflops/s, 693.216 iter/s, 1.443e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 12.615 Tflops/s, hfu: 12.615 Tflops/s, 326.358 iter/s, 3.064e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 76.113 Tflops/s, hfu: 76.113 Tflops/s, 984.523 iter/s, 1.016e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 104.479 Tflops/s, hfu: 104.479 Tflops/s, 1351.439 iter/s, 7.400e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 108.543 Tflops/s, hfu: 108.543 Tflops/s, 1404.005 iter/s, 7.122e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 160.438 Tflops/s, hfu: 160.438 Tflops/s, 2075.274 iter/s, 4.819e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 83.993 Tflops/s, hfu: 83.993 Tflops/s, 1086.446 iter/s, 9.204e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 107.881 Tflops/s, hfu: 107.881 Tflops/s, 1395.448 iter/s, 7.166e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 130.597 Tflops/s, hfu: 130.597 Tflops/s, 1689.280 iter/s, 5.920e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 164.511 Tflops/s, hfu: 164.511 Tflops/s, 2127.949 iter/s, 4.699e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(196608,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.18 Tflops/s, hfu: 19.18 Tflops/s, 372.149 iter/s, 2.687e-03 s/iter, (0.036, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.882 Tflops/s, hfu: 35.882 Tflops/s, 696.208 iter/s, 1.436e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 16.751 Tflops/s, hfu: 16.751 Tflops/s, 325.018 iter/s, 3.077e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 96.434 Tflops/s, hfu: 96.434 Tflops/s, 935.531 iter/s, 1.069e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 112.923 Tflops/s, hfu: 112.923 Tflops/s, 1095.501 iter/s, 9.128e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 115.931 Tflops/s, hfu: 115.931 Tflops/s, 1124.677 iter/s, 8.891e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 167.635 Tflops/s, hfu: 167.635 Tflops/s, 1626.270 iter/s, 6.149e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 98.946 Tflops/s, hfu: 98.946 Tflops/s, 959.907 iter/s, 1.042e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 121.121 Tflops/s, hfu: 121.121 Tflops/s, 1175.033 iter/s, 8.510e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 137.514 Tflops/s, hfu: 137.514 Tflops/s, 1334.059 iter/s, 7.496e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 170.41 Tflops/s, hfu: 170.41 Tflops/s, 1653.199 iter/s, 6.049e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(196608,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.94 Tflops/s, hfu: 23.94 Tflops/s, 371.603 iter/s, 2.691e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.145 Tflops/s, hfu: 44.145 Tflops/s, 685.215 iter/s, 1.459e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 20.795 Tflops/s, hfu: 20.795 Tflops/s, 322.779 iter/s, 3.098e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 122.697 Tflops/s, hfu: 122.697 Tflops/s, 952.258 iter/s, 1.050e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 121.252 Tflops/s, hfu: 121.252 Tflops/s, 941.038 iter/s, 1.063e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 119.239 Tflops/s, hfu: 119.239 Tflops/s, 925.419 iter/s, 1.081e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 173.177 Tflops/s, hfu: 173.177 Tflops/s, 1344.028 iter/s, 7.440e-04 s/iter, (0.076, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 110.856 Tflops/s, hfu: 110.856 Tflops/s, 860.354 iter/s, 1.162e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 128.879 Tflops/s, hfu: 128.879 Tflops/s, 1000.232 iter/s, 9.998e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 147.763 Tflops/s, hfu: 147.763 Tflops/s, 1146.789 iter/s, 8.720e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 176.268 Tflops/s, hfu: 176.268 Tflops/s, 1368.019 iter/s, 7.310e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(196608,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 28.363 Tflops/s, hfu: 28.363 Tflops/s, 366.882 iter/s, 2.726e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 52.965 Tflops/s, hfu: 52.965 Tflops/s, 685.103 iter/s, 1.460e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 24.95 Tflops/s, hfu: 24.95 Tflops/s, 322.733 iter/s, 3.099e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 134.65 Tflops/s, hfu: 134.65 Tflops/s, 870.850 iter/s, 1.148e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 122.669 Tflops/s, hfu: 122.669 Tflops/s, 793.364 iter/s, 1.260e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.002 Tflops/s, hfu: 123.002 Tflops/s, 795.515 iter/s, 1.257e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 178.724 Tflops/s, hfu: 178.724 Tflops/s, 1155.898 iter/s, 8.651e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 122.123 Tflops/s, hfu: 122.123 Tflops/s, 789.835 iter/s, 1.266e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 137.345 Tflops/s, hfu: 137.345 Tflops/s, 888.283 iter/s, 1.126e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 153.858 Tflops/s, hfu: 153.858 Tflops/s, 995.080 iter/s, 1.005e-03 s/iter, (0.077, 0.000, 0.004) sec
mfu: 177.702 Tflops/s, hfu: 177.702 Tflops/s, 1149.288 iter/s, 8.701e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(196608,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.085 Tflops/s, hfu: 33.085 Tflops/s, 366.815 iter/s, 2.726e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 61.513 Tflops/s, hfu: 61.513 Tflops/s, 682.001 iter/s, 1.466e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 29.093 Tflops/s, hfu: 29.093 Tflops/s, 322.562 iter/s, 3.100e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 134.589 Tflops/s, hfu: 134.589 Tflops/s, 746.104 iter/s, 1.340e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 125.739 Tflops/s, hfu: 125.739 Tflops/s, 697.043 iter/s, 1.435e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 125.718 Tflops/s, hfu: 125.718 Tflops/s, 696.930 iter/s, 1.435e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 177.226 Tflops/s, hfu: 177.226 Tflops/s, 982.465 iter/s, 1.018e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 130.665 Tflops/s, hfu: 130.665 Tflops/s, 724.352 iter/s, 1.381e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 145.843 Tflops/s, hfu: 145.843 Tflops/s, 808.491 iter/s, 1.237e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 160.07 Tflops/s, hfu: 160.07 Tflops/s, 887.362 iter/s, 1.127e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 180.691 Tflops/s, hfu: 180.691 Tflops/s, 1001.675 iter/s, 9.983e-04 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(196608,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.687 Tflops/s, hfu: 37.687 Tflops/s, 365.614 iter/s, 2.735e-03 s/iter, (0.036, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.898 Tflops/s, hfu: 69.898 Tflops/s, 678.103 iter/s, 1.475e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 33.173 Tflops/s, hfu: 33.173 Tflops/s, 321.819 iter/s, 3.107e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 139.425 Tflops/s, hfu: 139.425 Tflops/s, 676.301 iter/s, 1.479e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 129.76 Tflops/s, hfu: 129.76 Tflops/s, 629.419 iter/s, 1.589e-03 s/iter, (0.128, 0.000, 0.006) sec
mfu: 128.081 Tflops/s, hfu: 128.081 Tflops/s, 621.272 iter/s, 1.610e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 183.377 Tflops/s, hfu: 183.377 Tflops/s, 889.496 iter/s, 1.124e-03 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 136.813 Tflops/s, hfu: 136.813 Tflops/s, 663.630 iter/s, 1.507e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 151.411 Tflops/s, hfu: 151.411 Tflops/s, 734.439 iter/s, 1.362e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 163.594 Tflops/s, hfu: 163.594 Tflops/s, 793.535 iter/s, 1.260e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 180.781 Tflops/s, hfu: 180.781 Tflops/s, 876.904 iter/s, 1.140e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(196608,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 46.748 Tflops/s, hfu: 46.748 Tflops/s, 362.809 iter/s, 2.756e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.577 Tflops/s, hfu: 88.577 Tflops/s, 687.450 iter/s, 1.455e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 41.574 Tflops/s, hfu: 41.574 Tflops/s, 322.659 iter/s, 3.099e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 143.103 Tflops/s, hfu: 143.103 Tflops/s, 555.311 iter/s, 1.801e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 131.77 Tflops/s, hfu: 131.77 Tflops/s, 511.333 iter/s, 1.956e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 131.712 Tflops/s, hfu: 131.712 Tflops/s, 511.112 iter/s, 1.957e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 188.599 Tflops/s, hfu: 188.599 Tflops/s, 731.859 iter/s, 1.366e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 148.983 Tflops/s, hfu: 148.983 Tflops/s, 578.128 iter/s, 1.730e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 159.231 Tflops/s, hfu: 159.231 Tflops/s, 617.897 iter/s, 1.618e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 170.251 Tflops/s, hfu: 170.251 Tflops/s, 660.663 iter/s, 1.514e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 183.076 Tflops/s, hfu: 183.076 Tflops/s, 710.429 iter/s, 1.408e-03 s/iter, (0.078, 0.000, 0.006) sec
SP=(1,8),S=(196608,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.276 Tflops/s, hfu: 56.276 Tflops/s, 363.966 iter/s, 2.748e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.757 Tflops/s, hfu: 92.757 Tflops/s, 599.906 iter/s, 1.667e-03 s/iter, (0.023, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 49.917 Tflops/s, hfu: 49.917 Tflops/s, 322.840 iter/s, 3.098e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 139.889 Tflops/s, hfu: 139.889 Tflops/s, 452.366 iter/s, 2.211e-03 s/iter, (0.162, 0.000, 0.009) sec
mfu: 134.554 Tflops/s, hfu: 134.554 Tflops/s, 435.116 iter/s, 2.298e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 133.543 Tflops/s, hfu: 133.543 Tflops/s, 431.846 iter/s, 2.316e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 191.487 Tflops/s, hfu: 191.487 Tflops/s, 619.223 iter/s, 1.615e-03 s/iter, (0.077, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 157.466 Tflops/s, hfu: 157.466 Tflops/s, 509.209 iter/s, 1.964e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 166.421 Tflops/s, hfu: 166.421 Tflops/s, 538.164 iter/s, 1.858e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 175.367 Tflops/s, hfu: 175.367 Tflops/s, 567.094 iter/s, 1.763e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 185.123 Tflops/s, hfu: 185.123 Tflops/s, 598.645 iter/s, 1.670e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(196608,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.9 Tflops/s, hfu: 64.9 Tflops/s, 359.777 iter/s, 2.779e-03 s/iter, (0.039, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 85.228 Tflops/s, hfu: 85.228 Tflops/s, 472.470 iter/s, 2.117e-03 s/iter, (0.025, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 57.781 Tflops/s, hfu: 57.781 Tflops/s, 320.312 iter/s, 3.122e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 142.859 Tflops/s, hfu: 142.859 Tflops/s, 395.974 iter/s, 2.525e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 134.646 Tflops/s, hfu: 134.646 Tflops/s, 373.211 iter/s, 2.679e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 134.855 Tflops/s, hfu: 134.855 Tflops/s, 373.790 iter/s, 2.675e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 191.538 Tflops/s, hfu: 191.538 Tflops/s, 530.903 iter/s, 1.884e-03 s/iter, (0.080, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 164.541 Tflops/s, hfu: 164.541 Tflops/s, 456.075 iter/s, 2.193e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 170.85 Tflops/s, hfu: 170.85 Tflops/s, 473.562 iter/s, 2.112e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 178.174 Tflops/s, hfu: 178.174 Tflops/s, 493.860 iter/s, 2.025e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 186.057 Tflops/s, hfu: 186.057 Tflops/s, 515.713 iter/s, 1.939e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(196608,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.932 Tflops/s, hfu: 74.932 Tflops/s, 363.469 iter/s, 2.751e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 87.565 Tflops/s, hfu: 87.565 Tflops/s, 424.748 iter/s, 2.354e-03 s/iter, (0.028, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 65.774 Tflops/s, hfu: 65.774 Tflops/s, 319.048 iter/s, 3.134e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 142.083 Tflops/s, hfu: 142.083 Tflops/s, 344.597 iter/s, 2.902e-03 s/iter, (0.083, 0.000, 0.012) sec
mfu: 136.213 Tflops/s, hfu: 136.213 Tflops/s, 330.359 iter/s, 3.027e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 135.869 Tflops/s, hfu: 135.869 Tflops/s, 329.526 iter/s, 3.035e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 192.239 Tflops/s, hfu: 192.239 Tflops/s, 466.240 iter/s, 2.145e-03 s/iter, (0.078, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 170.58 Tflops/s, hfu: 170.58 Tflops/s, 413.710 iter/s, 2.417e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 174.54 Tflops/s, hfu: 174.54 Tflops/s, 423.314 iter/s, 2.362e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 181.292 Tflops/s, hfu: 181.292 Tflops/s, 439.692 iter/s, 2.274e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 184.714 Tflops/s, hfu: 184.714 Tflops/s, 447.990 iter/s, 2.232e-03 s/iter, (0.082, 0.000, 0.009) sec
SP=(1,8),S=(196608,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.189 Tflops/s, hfu: 80.189 Tflops/s, 311.174 iter/s, 3.214e-03 s/iter, (0.041, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.342 Tflops/s, hfu: 91.342 Tflops/s, 354.452 iter/s, 2.821e-03 s/iter, (0.033, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 83.156 Tflops/s, hfu: 83.156 Tflops/s, 322.690 iter/s, 3.099e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 141.336 Tflops/s, hfu: 141.336 Tflops/s, 274.228 iter/s, 3.647e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 135.844 Tflops/s, hfu: 135.844 Tflops/s, 263.572 iter/s, 3.794e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 133.915 Tflops/s, hfu: 133.915 Tflops/s, 259.830 iter/s, 3.849e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 196.086 Tflops/s, hfu: 196.086 Tflops/s, 380.456 iter/s, 2.628e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 178.557 Tflops/s, hfu: 178.557 Tflops/s, 346.446 iter/s, 2.886e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 179.554 Tflops/s, hfu: 179.554 Tflops/s, 348.381 iter/s, 2.870e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 183.509 Tflops/s, hfu: 183.509 Tflops/s, 356.054 iter/s, 2.809e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 185.983 Tflops/s, hfu: 185.983 Tflops/s, 360.855 iter/s, 2.771e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(196608,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 83.941 Tflops/s, hfu: 83.941 Tflops/s, 271.445 iter/s, 3.684e-03 s/iter, (0.050, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.11 Tflops/s, hfu: 99.11 Tflops/s, 320.496 iter/s, 3.120e-03 s/iter, (0.038, 0.000, 0.062) sec
# stripe_flash_attn_func, fwd
mfu: 90.639 Tflops/s, hfu: 90.639 Tflops/s, 293.104 iter/s, 3.412e-03 s/iter, (0.040, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 140.654 Tflops/s, hfu: 140.654 Tflops/s, 227.421 iter/s, 4.397e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 136.621 Tflops/s, hfu: 136.621 Tflops/s, 220.899 iter/s, 4.527e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 134.97 Tflops/s, hfu: 134.97 Tflops/s, 218.230 iter/s, 4.582e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 196.71 Tflops/s, hfu: 196.71 Tflops/s, 318.056 iter/s, 3.144e-03 s/iter, (0.086, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 184.234 Tflops/s, hfu: 184.234 Tflops/s, 297.884 iter/s, 3.357e-03 s/iter, (0.088, 0.000, 0.013) sec
mfu: 183.936 Tflops/s, hfu: 183.936 Tflops/s, 297.402 iter/s, 3.362e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 186.403 Tflops/s, hfu: 186.403 Tflops/s, 301.391 iter/s, 3.318e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 187.758 Tflops/s, hfu: 187.758 Tflops/s, 303.582 iter/s, 3.294e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(196608,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 86.697 Tflops/s, hfu: 86.697 Tflops/s, 240.305 iter/s, 4.161e-03 s/iter, (0.052, 0.000, 0.083) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.059 Tflops/s, hfu: 98.059 Tflops/s, 271.801 iter/s, 3.679e-03 s/iter, (0.045, 0.000, 0.074) sec
# stripe_flash_attn_func, fwd
mfu: 96.163 Tflops/s, hfu: 96.163 Tflops/s, 266.543 iter/s, 3.752e-03 s/iter, (0.041, 0.000, 0.075) sec
# orchestrated_attn_func
mfu: 138.562 Tflops/s, hfu: 138.562 Tflops/s, 192.032 iter/s, 5.207e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 136.227 Tflops/s, hfu: 136.227 Tflops/s, 188.797 iter/s, 5.297e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 132.958 Tflops/s, hfu: 132.958 Tflops/s, 184.266 iter/s, 5.427e-03 s/iter, (0.169, 0.000, 0.022) sec
mfu: 197.42 Tflops/s, hfu: 197.42 Tflops/s, 273.604 iter/s, 3.655e-03 s/iter, (0.085, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 188.776 Tflops/s, hfu: 188.776 Tflops/s, 261.623 iter/s, 3.822e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 186.303 Tflops/s, hfu: 186.303 Tflops/s, 258.197 iter/s, 3.873e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 188.279 Tflops/s, hfu: 188.279 Tflops/s, 260.936 iter/s, 3.832e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 187.643 Tflops/s, hfu: 187.643 Tflops/s, 260.054 iter/s, 3.845e-03 s/iter, (0.086, 0.000, 0.015) sec
SP=(1,8),S=(196608,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 88.371 Tflops/s, hfu: 88.371 Tflops/s, 214.328 iter/s, 4.666e-03 s/iter, (0.057, 0.000, 0.093) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 101.5 Tflops/s, hfu: 101.5 Tflops/s, 246.171 iter/s, 4.062e-03 s/iter, (0.048, 0.000, 0.081) sec
# stripe_flash_attn_func, fwd
mfu: 103.095 Tflops/s, hfu: 103.095 Tflops/s, 250.039 iter/s, 3.999e-03 s/iter, (0.043, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 141.154 Tflops/s, hfu: 141.154 Tflops/s, 171.172 iter/s, 5.842e-03 s/iter, (0.096, 0.000, 0.023) sec
mfu: 136.032 Tflops/s, hfu: 136.032 Tflops/s, 164.961 iter/s, 6.062e-03 s/iter, (0.097, 0.000, 0.024) sec
mfu: 133.731 Tflops/s, hfu: 133.731 Tflops/s, 162.170 iter/s, 6.166e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 198.736 Tflops/s, hfu: 198.736 Tflops/s, 240.999 iter/s, 4.149e-03 s/iter, (0.089, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 192.58 Tflops/s, hfu: 192.58 Tflops/s, 233.534 iter/s, 4.282e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 188.874 Tflops/s, hfu: 188.874 Tflops/s, 229.040 iter/s, 4.366e-03 s/iter, (0.089, 0.000, 0.017) sec
mfu: 189.686 Tflops/s, hfu: 189.686 Tflops/s, 230.025 iter/s, 4.347e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 188.33 Tflops/s, hfu: 188.33 Tflops/s, 228.381 iter/s, 4.379e-03 s/iter, (0.091, 0.000, 0.018) sec
SP=(1,8),S=(196608,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 91.268 Tflops/s, hfu: 91.268 Tflops/s, 177.084 iter/s, 5.647e-03 s/iter, (0.073, 0.000, 0.113) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.588 Tflops/s, hfu: 102.588 Tflops/s, 199.047 iter/s, 5.024e-03 s/iter, (0.061, 0.000, 0.100) sec
# stripe_flash_attn_func, fwd
mfu: 109.696 Tflops/s, hfu: 109.696 Tflops/s, 212.838 iter/s, 4.698e-03 s/iter, (0.051, 0.000, 0.094) sec
# orchestrated_attn_func
mfu: 144.082 Tflops/s, hfu: 144.082 Tflops/s, 139.778 iter/s, 7.154e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 135.904 Tflops/s, hfu: 135.904 Tflops/s, 131.844 iter/s, 7.585e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 133.594 Tflops/s, hfu: 133.594 Tflops/s, 129.603 iter/s, 7.716e-03 s/iter, (0.100, 0.000, 0.031) sec
mfu: 199.386 Tflops/s, hfu: 199.386 Tflops/s, 193.430 iter/s, 5.170e-03 s/iter, (0.091, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 197.718 Tflops/s, hfu: 197.718 Tflops/s, 191.812 iter/s, 5.213e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 192.016 Tflops/s, hfu: 192.016 Tflops/s, 186.280 iter/s, 5.368e-03 s/iter, (0.095, 0.000, 0.021) sec
mfu: 191.275 Tflops/s, hfu: 191.275 Tflops/s, 185.561 iter/s, 5.389e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 189.92 Tflops/s, hfu: 189.92 Tflops/s, 184.246 iter/s, 5.428e-03 s/iter, (0.092, 0.000, 0.022) sec
SP=(1,8),S=(196608,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 94.113 Tflops/s, hfu: 94.113 Tflops/s, 152.170 iter/s, 6.572e-03 s/iter, (0.081, 0.000, 0.131) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.225 Tflops/s, hfu: 103.225 Tflops/s, 166.903 iter/s, 5.992e-03 s/iter, (0.073, 0.000, 0.120) sec
# stripe_flash_attn_func, fwd
mfu: 116.669 Tflops/s, hfu: 116.669 Tflops/s, 188.640 iter/s, 5.301e-03 s/iter, (0.060, 0.000, 0.106) sec
# orchestrated_attn_func
mfu: 140.411 Tflops/s, hfu: 140.411 Tflops/s, 113.514 iter/s, 8.809e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 137.549 Tflops/s, hfu: 137.549 Tflops/s, 111.200 iter/s, 8.993e-03 s/iter, (0.109, 0.000, 0.036) sec
mfu: 133.572 Tflops/s, hfu: 133.572 Tflops/s, 107.985 iter/s, 9.261e-03 s/iter, (0.106, 0.000, 0.037) sec
mfu: 200.247 Tflops/s, hfu: 200.247 Tflops/s, 161.888 iter/s, 6.177e-03 s/iter, (0.099, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 201.361 Tflops/s, hfu: 201.361 Tflops/s, 162.788 iter/s, 6.143e-03 s/iter, (0.094, 0.000, 0.025) sec
mfu: 193.746 Tflops/s, hfu: 193.746 Tflops/s, 156.632 iter/s, 6.384e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 192.772 Tflops/s, hfu: 192.772 Tflops/s, 155.844 iter/s, 6.417e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 190.714 Tflops/s, hfu: 190.714 Tflops/s, 154.181 iter/s, 6.486e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(196608,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 95.36 Tflops/s, hfu: 95.36 Tflops/s, 132.160 iter/s, 7.567e-03 s/iter, (0.090, 0.000, 0.151) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.711 Tflops/s, hfu: 116.711 Tflops/s, 161.749 iter/s, 6.182e-03 s/iter, (0.074, 0.000, 0.124) sec
# stripe_flash_attn_func, fwd
mfu: 122.289 Tflops/s, hfu: 122.289 Tflops/s, 169.480 iter/s, 5.900e-03 s/iter, (0.068, 0.000, 0.118) sec
# orchestrated_attn_func
mfu: 141.323 Tflops/s, hfu: 141.323 Tflops/s, 97.930 iter/s, 1.021e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 135.764 Tflops/s, hfu: 135.764 Tflops/s, 94.078 iter/s, 1.063e-02 s/iter, (0.116, 0.000, 0.043) sec
mfu: 134.174 Tflops/s, hfu: 134.174 Tflops/s, 92.976 iter/s, 1.076e-02 s/iter, (0.113, 0.000, 0.043) sec
mfu: 200.803 Tflops/s, hfu: 200.803 Tflops/s, 139.146 iter/s, 7.187e-03 s/iter, (0.099, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 204.542 Tflops/s, hfu: 204.542 Tflops/s, 141.737 iter/s, 7.055e-03 s/iter, (0.101, 0.000, 0.028) sec
mfu: 195.478 Tflops/s, hfu: 195.478 Tflops/s, 135.456 iter/s, 7.382e-03 s/iter, (0.102, 0.000, 0.030) sec
mfu: 194.339 Tflops/s, hfu: 194.339 Tflops/s, 134.667 iter/s, 7.426e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 190.644 Tflops/s, hfu: 190.644 Tflops/s, 132.106 iter/s, 7.570e-03 s/iter, (0.104, 0.000, 0.030) sec
SP=(1,8),S=(196608,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 96.824 Tflops/s, hfu: 96.824 Tflops/s, 117.415 iter/s, 8.517e-03 s/iter, (0.100, 0.000, 0.170) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.024 Tflops/s, hfu: 131.024 Tflops/s, 158.887 iter/s, 6.294e-03 s/iter, (0.076, 0.000, 0.126) sec
# stripe_flash_attn_func, fwd
mfu: 122.113 Tflops/s, hfu: 122.113 Tflops/s, 148.081 iter/s, 6.753e-03 s/iter, (0.078, 0.000, 0.135) sec
# orchestrated_attn_func
mfu: 140.105 Tflops/s, hfu: 140.105 Tflops/s, 84.950 iter/s, 1.177e-02 s/iter, (0.117, 0.000, 0.047) sec
mfu: 136.355 Tflops/s, hfu: 136.355 Tflops/s, 82.676 iter/s, 1.210e-02 s/iter, (0.118, 0.000, 0.048) sec
mfu: 134.299 Tflops/s, hfu: 134.299 Tflops/s, 81.430 iter/s, 1.228e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 200.836 Tflops/s, hfu: 200.836 Tflops/s, 121.773 iter/s, 8.212e-03 s/iter, (0.103, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 206.581 Tflops/s, hfu: 206.581 Tflops/s, 125.256 iter/s, 7.984e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 196.555 Tflops/s, hfu: 196.555 Tflops/s, 119.177 iter/s, 8.391e-03 s/iter, (0.105, 0.000, 0.034) sec
mfu: 195.084 Tflops/s, hfu: 195.084 Tflops/s, 118.285 iter/s, 8.454e-03 s/iter, (0.108, 0.000, 0.034) sec
mfu: 191.068 Tflops/s, hfu: 191.068 Tflops/s, 115.850 iter/s, 8.632e-03 s/iter, (0.105, 0.000, 0.035) sec
SP=(1,8),S=(196608,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 97.87 Tflops/s, hfu: 97.87 Tflops/s, 94.946 iter/s, 1.053e-02 s/iter, (0.123, 0.000, 0.211) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 155.198 Tflops/s, hfu: 155.198 Tflops/s, 150.562 iter/s, 6.642e-03 s/iter, (0.077, 0.000, 0.133) sec
# stripe_flash_attn_func, fwd
mfu: 118.259 Tflops/s, hfu: 118.259 Tflops/s, 114.727 iter/s, 8.716e-03 s/iter, (0.101, 0.000, 0.174) sec
# orchestrated_attn_func
mfu: 144.793 Tflops/s, hfu: 144.793 Tflops/s, 70.234 iter/s, 1.424e-02 s/iter, (0.130, 0.000, 0.057) sec
mfu: 134.048 Tflops/s, hfu: 134.048 Tflops/s, 65.022 iter/s, 1.538e-02 s/iter, (0.130, 0.000, 0.062) sec
mfu: 134.654 Tflops/s, hfu: 134.654 Tflops/s, 65.316 iter/s, 1.531e-02 s/iter, (0.131, 0.000, 0.061) sec
mfu: 201.268 Tflops/s, hfu: 201.268 Tflops/s, 97.628 iter/s, 1.024e-02 s/iter, (0.112, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 209.73 Tflops/s, hfu: 209.73 Tflops/s, 101.732 iter/s, 9.830e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 198.461 Tflops/s, hfu: 198.461 Tflops/s, 96.266 iter/s, 1.039e-02 s/iter, (0.113, 0.000, 0.042) sec
mfu: 196.017 Tflops/s, hfu: 196.017 Tflops/s, 95.081 iter/s, 1.052e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 191.443 Tflops/s, hfu: 191.443 Tflops/s, 92.862 iter/s, 1.077e-02 s/iter, (0.113, 0.000, 0.043) sec
SP=(1,8),S=(196608,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 98.769 Tflops/s, hfu: 98.769 Tflops/s, 79.849 iter/s, 1.252e-02 s/iter, (0.144, 0.000, 0.250) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 161.002 Tflops/s, hfu: 161.002 Tflops/s, 130.160 iter/s, 7.683e-03 s/iter, (0.088, 0.000, 0.154) sec
# stripe_flash_attn_func, fwd
mfu: 113.853 Tflops/s, hfu: 113.853 Tflops/s, 92.043 iter/s, 1.086e-02 s/iter, (0.124, 0.000, 0.217) sec
# orchestrated_attn_func
mfu: 142.279 Tflops/s, hfu: 142.279 Tflops/s, 57.512 iter/s, 1.739e-02 s/iter, (0.141, 0.000, 0.070) sec
mfu: 137.36 Tflops/s, hfu: 137.36 Tflops/s, 55.524 iter/s, 1.801e-02 s/iter, (0.144, 0.000, 0.072) sec
mfu: 134.406 Tflops/s, hfu: 134.406 Tflops/s, 54.330 iter/s, 1.841e-02 s/iter, (0.143, 0.000, 0.074) sec
mfu: 201.39 Tflops/s, hfu: 201.39 Tflops/s, 81.406 iter/s, 1.228e-02 s/iter, (0.123, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 211.649 Tflops/s, hfu: 211.649 Tflops/s, 85.553 iter/s, 1.169e-02 s/iter, (0.117, 0.000, 0.047) sec
mfu: 199.387 Tflops/s, hfu: 199.387 Tflops/s, 80.596 iter/s, 1.241e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 196.804 Tflops/s, hfu: 196.804 Tflops/s, 79.552 iter/s, 1.257e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 192.051 Tflops/s, hfu: 192.051 Tflops/s, 77.631 iter/s, 1.288e-02 s/iter, (0.122, 0.000, 0.052) sec
SP=(1,8),S=(196608,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.376 Tflops/s, hfu: 99.376 Tflops/s, 68.863 iter/s, 1.452e-02 s/iter, (0.167, 0.000, 0.290) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 163.089 Tflops/s, hfu: 163.089 Tflops/s, 113.013 iter/s, 8.849e-03 s/iter, (0.102, 0.000, 0.177) sec
# stripe_flash_attn_func, fwd
mfu: 109.914 Tflops/s, hfu: 109.914 Tflops/s, 76.164 iter/s, 1.313e-02 s/iter, (0.146, 0.000, 0.263) sec
# orchestrated_attn_func
mfu: 141.772 Tflops/s, hfu: 141.772 Tflops/s, 49.120 iter/s, 2.036e-02 s/iter, (0.152, 0.000, 0.081) sec
mfu: 137.625 Tflops/s, hfu: 137.625 Tflops/s, 47.683 iter/s, 2.097e-02 s/iter, (0.155, 0.000, 0.084) sec
mfu: 134.586 Tflops/s, hfu: 134.586 Tflops/s, 46.630 iter/s, 2.145e-02 s/iter, (0.156, 0.000, 0.086) sec
mfu: 201.754 Tflops/s, hfu: 201.754 Tflops/s, 69.903 iter/s, 1.431e-02 s/iter, (0.131, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 213.32 Tflops/s, hfu: 213.32 Tflops/s, 73.910 iter/s, 1.353e-02 s/iter, (0.125, 0.000, 0.054) sec
mfu: 200.537 Tflops/s, hfu: 200.537 Tflops/s, 69.481 iter/s, 1.439e-02 s/iter, (0.133, 0.000, 0.058) sec
mfu: 197.054 Tflops/s, hfu: 197.054 Tflops/s, 68.274 iter/s, 1.465e-02 s/iter, (0.129, 0.000, 0.059) sec
mfu: 192.305 Tflops/s, hfu: 192.305 Tflops/s, 66.629 iter/s, 1.501e-02 s/iter, (0.134, 0.000, 0.060) sec
SP=(1,8),S=(196608,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.853 Tflops/s, hfu: 99.853 Tflops/s, 60.544 iter/s, 1.652e-02 s/iter, (0.189, 0.000, 0.330) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 162.241 Tflops/s, hfu: 162.241 Tflops/s, 98.372 iter/s, 1.017e-02 s/iter, (0.115, 0.000, 0.203) sec
# stripe_flash_attn_func, fwd
mfu: 107.51 Tflops/s, hfu: 107.51 Tflops/s, 65.187 iter/s, 1.534e-02 s/iter, (0.170, 0.000, 0.307) sec
# orchestrated_attn_func
mfu: 142.921 Tflops/s, hfu: 142.921 Tflops/s, 43.329 iter/s, 2.308e-02 s/iter, (0.166, 0.000, 0.092) sec
mfu: 135.933 Tflops/s, hfu: 135.933 Tflops/s, 41.210 iter/s, 2.427e-02 s/iter, (0.168, 0.000, 0.097) sec
mfu: 134.661 Tflops/s, hfu: 134.661 Tflops/s, 40.824 iter/s, 2.450e-02 s/iter, (0.168, 0.000, 0.098) sec
mfu: 201.66 Tflops/s, hfu: 201.66 Tflops/s, 61.136 iter/s, 1.636e-02 s/iter, (0.137, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 214.308 Tflops/s, hfu: 214.308 Tflops/s, 64.971 iter/s, 1.539e-02 s/iter, (0.134, 0.000, 0.062) sec
mfu: 201.197 Tflops/s, hfu: 201.197 Tflops/s, 60.996 iter/s, 1.639e-02 s/iter, (0.139, 0.000, 0.066) sec
mfu: 197.476 Tflops/s, hfu: 197.476 Tflops/s, 59.868 iter/s, 1.670e-02 s/iter, (0.140, 0.000, 0.067) sec
mfu: 192.253 Tflops/s, hfu: 192.253 Tflops/s, 58.284 iter/s, 1.716e-02 s/iter, (0.140, 0.000, 0.069) sec
SP=(1,8),S=(196608,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.847 Tflops/s, hfu: 99.847 Tflops/s, 48.432 iter/s, 2.065e-02 s/iter, (0.234, 0.000, 0.413) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 160.378 Tflops/s, hfu: 160.378 Tflops/s, 77.794 iter/s, 1.285e-02 s/iter, (0.143, 0.000, 0.257) sec
# stripe_flash_attn_func, fwd
mfu: 103.279 Tflops/s, hfu: 103.279 Tflops/s, 50.097 iter/s, 1.996e-02 s/iter, (0.216, 0.000, 0.399) sec
# orchestrated_attn_func
mfu: 140.366 Tflops/s, hfu: 140.366 Tflops/s, 34.043 iter/s, 2.937e-02 s/iter, (0.191, 0.000, 0.117) sec
mfu: 140.06 Tflops/s, hfu: 140.06 Tflops/s, 33.969 iter/s, 2.944e-02 s/iter, (0.192, 0.000, 0.118) sec
mfu: 134.83 Tflops/s, hfu: 134.83 Tflops/s, 32.701 iter/s, 3.058e-02 s/iter, (0.196, 0.000, 0.122) sec
mfu: 201.847 Tflops/s, hfu: 201.847 Tflops/s, 48.954 iter/s, 2.043e-02 s/iter, (0.163, 0.000, 0.082) sec
# orchestrated_attn_func fused
mfu: 215.987 Tflops/s, hfu: 215.987 Tflops/s, 52.384 iter/s, 1.909e-02 s/iter, (0.146, 0.000, 0.076) sec
mfu: 202.183 Tflops/s, hfu: 202.183 Tflops/s, 49.036 iter/s, 2.039e-02 s/iter, (0.152, 0.000, 0.082) sec
mfu: 198.258 Tflops/s, hfu: 198.258 Tflops/s, 48.084 iter/s, 2.080e-02 s/iter, (0.156, 0.000, 0.083) sec
mfu: 192.58 Tflops/s, hfu: 192.58 Tflops/s, 46.707 iter/s, 2.141e-02 s/iter, (0.156, 0.000, 0.086) sec
SP=(1,8),S=(196608,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 100.691 Tflops/s, hfu: 100.691 Tflops/s, 40.701 iter/s, 2.457e-02 s/iter, (0.278, 0.000, 0.491) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 161.434 Tflops/s, hfu: 161.434 Tflops/s, 65.255 iter/s, 1.532e-02 s/iter, (0.171, 0.000, 0.306) sec
# stripe_flash_attn_func, fwd
mfu: 101.671 Tflops/s, hfu: 101.671 Tflops/s, 41.097 iter/s, 2.433e-02 s/iter, (0.254, 0.000, 0.487) sec
# orchestrated_attn_func
mfu: 145.251 Tflops/s, hfu: 145.251 Tflops/s, 29.357 iter/s, 3.406e-02 s/iter, (0.215, 0.000, 0.136) sec
mfu: 137.375 Tflops/s, hfu: 137.375 Tflops/s, 27.765 iter/s, 3.602e-02 s/iter, (0.216, 0.000, 0.144) sec
mfu: 135.074 Tflops/s, hfu: 135.074 Tflops/s, 27.300 iter/s, 3.663e-02 s/iter, (0.217, 0.000, 0.147) sec
mfu: 202.283 Tflops/s, hfu: 202.283 Tflops/s, 40.883 iter/s, 2.446e-02 s/iter, (0.169, 0.000, 0.098) sec
# orchestrated_attn_func fused
mfu: 217.175 Tflops/s, hfu: 217.175 Tflops/s, 43.893 iter/s, 2.278e-02 s/iter, (0.165, 0.000, 0.091) sec
mfu: 202.871 Tflops/s, hfu: 202.871 Tflops/s, 41.002 iter/s, 2.439e-02 s/iter, (0.168, 0.000, 0.098) sec
mfu: 198.666 Tflops/s, hfu: 198.666 Tflops/s, 40.152 iter/s, 2.491e-02 s/iter, (0.191, 0.000, 0.100) sec
mfu: 192.925 Tflops/s, hfu: 192.925 Tflops/s, 38.992 iter/s, 2.565e-02 s/iter, (0.176, 0.000, 0.103) sec
SP=(1,8),S=(196608,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 100.843 Tflops/s, hfu: 100.843 Tflops/s, 34.939 iter/s, 2.862e-02 s/iter, (0.322, 0.000, 0.572) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 162.112 Tflops/s, hfu: 162.112 Tflops/s, 56.168 iter/s, 1.780e-02 s/iter, (0.199, 0.000, 0.356) sec
# stripe_flash_attn_func, fwd
mfu: 100.427 Tflops/s, hfu: 100.427 Tflops/s, 34.795 iter/s, 2.874e-02 s/iter, (0.298, 0.000, 0.575) sec
# orchestrated_attn_func
mfu: 142.672 Tflops/s, hfu: 142.672 Tflops/s, 24.716 iter/s, 4.046e-02 s/iter, (0.235, 0.000, 0.162) sec
mfu: 137.613 Tflops/s, hfu: 137.613 Tflops/s, 23.840 iter/s, 4.195e-02 s/iter, (0.241, 0.000, 0.168) sec
mfu: 135.176 Tflops/s, hfu: 135.176 Tflops/s, 23.418 iter/s, 4.270e-02 s/iter, (0.240, 0.000, 0.171) sec
mfu: 202.555 Tflops/s, hfu: 202.555 Tflops/s, 35.090 iter/s, 2.850e-02 s/iter, (0.188, 0.000, 0.114) sec
# orchestrated_attn_func fused
mfu: 217.67 Tflops/s, hfu: 217.67 Tflops/s, 37.709 iter/s, 2.652e-02 s/iter, (0.176, 0.000, 0.106) sec
mfu: 203.389 Tflops/s, hfu: 203.389 Tflops/s, 35.235 iter/s, 2.838e-02 s/iter, (0.184, 0.000, 0.114) sec
mfu: 198.953 Tflops/s, hfu: 198.953 Tflops/s, 34.466 iter/s, 2.901e-02 s/iter, (0.187, 0.000, 0.116) sec
mfu: 192.83 Tflops/s, hfu: 192.83 Tflops/s, 33.405 iter/s, 2.994e-02 s/iter, (0.191, 0.000, 0.120) sec
SP=(1,8),S=(196608,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 101.216 Tflops/s, hfu: 101.216 Tflops/s, 30.685 iter/s, 3.259e-02 s/iter, (0.368, 0.000, 0.652) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 161.831 Tflops/s, hfu: 161.831 Tflops/s, 49.062 iter/s, 2.038e-02 s/iter, (0.226, 0.000, 0.408) sec
# stripe_flash_attn_func, fwd
mfu: 99.356 Tflops/s, hfu: 99.356 Tflops/s, 30.121 iter/s, 3.320e-02 s/iter, (0.343, 0.000, 0.664) sec
# orchestrated_attn_func
mfu: 141.633 Tflops/s, hfu: 141.633 Tflops/s, 21.469 iter/s, 4.658e-02 s/iter, (0.264, 0.000, 0.186) sec
mfu: 136.65 Tflops/s, hfu: 136.65 Tflops/s, 20.714 iter/s, 4.828e-02 s/iter, (0.265, 0.000, 0.193) sec
mfu: 135.25 Tflops/s, hfu: 135.25 Tflops/s, 20.502 iter/s, 4.878e-02 s/iter, (0.266, 0.000, 0.195) sec
mfu: 202.652 Tflops/s, hfu: 202.652 Tflops/s, 30.718 iter/s, 3.255e-02 s/iter, (0.213, 0.000, 0.130) sec
# orchestrated_attn_func fused
mfu: 218.31 Tflops/s, hfu: 218.31 Tflops/s, 33.092 iter/s, 3.022e-02 s/iter, (0.191, 0.000, 0.121) sec
mfu: 203.637 Tflops/s, hfu: 203.637 Tflops/s, 30.868 iter/s, 3.240e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 199.318 Tflops/s, hfu: 199.318 Tflops/s, 30.213 iter/s, 3.310e-02 s/iter, (0.203, 0.000, 0.132) sec
mfu: 193.118 Tflops/s, hfu: 193.118 Tflops/s, 29.273 iter/s, 3.416e-02 s/iter, (0.208, 0.000, 0.137) sec
SP=(1,8),S=(229376,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 5.663 Tflops/s, hfu: 5.663 Tflops/s, 376.711 iter/s, 2.655e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.242 Tflops/s, hfu: 10.242 Tflops/s, 681.353 iter/s, 1.468e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 4.781 Tflops/s, hfu: 4.781 Tflops/s, 318.070 iter/s, 3.144e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 28.096 Tflops/s, hfu: 28.096 Tflops/s, 934.503 iter/s, 1.070e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 56.924 Tflops/s, hfu: 56.924 Tflops/s, 1893.394 iter/s, 5.282e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 71.09 Tflops/s, hfu: 71.09 Tflops/s, 2364.558 iter/s, 4.229e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 92.409 Tflops/s, hfu: 92.409 Tflops/s, 3073.670 iter/s, 3.253e-04 s/iter, (0.071, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 36.5 Tflops/s, hfu: 36.5 Tflops/s, 1214.040 iter/s, 8.237e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 56.756 Tflops/s, hfu: 56.756 Tflops/s, 1887.790 iter/s, 5.297e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 81.105 Tflops/s, hfu: 81.105 Tflops/s, 2697.687 iter/s, 3.707e-04 s/iter, (0.076, 0.000, 0.001) sec
mfu: 116.784 Tflops/s, hfu: 116.784 Tflops/s, 3884.400 iter/s, 2.574e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(229376,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.381 Tflops/s, hfu: 11.381 Tflops/s, 378.564 iter/s, 2.642e-03 s/iter, (0.033, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.331 Tflops/s, hfu: 20.331 Tflops/s, 676.239 iter/s, 1.479e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 9.513 Tflops/s, hfu: 9.513 Tflops/s, 316.422 iter/s, 3.160e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 53.451 Tflops/s, hfu: 53.451 Tflops/s, 888.933 iter/s, 1.125e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 87.594 Tflops/s, hfu: 87.594 Tflops/s, 1456.758 iter/s, 6.865e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 101.318 Tflops/s, hfu: 101.318 Tflops/s, 1685.000 iter/s, 5.935e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 119.826 Tflops/s, hfu: 119.826 Tflops/s, 1992.794 iter/s, 5.018e-04 s/iter, (0.071, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 63.403 Tflops/s, hfu: 63.403 Tflops/s, 1054.443 iter/s, 9.484e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 88.447 Tflops/s, hfu: 88.447 Tflops/s, 1470.934 iter/s, 6.798e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 110.456 Tflops/s, hfu: 110.456 Tflops/s, 1836.966 iter/s, 5.444e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 131.214 Tflops/s, hfu: 131.214 Tflops/s, 2182.186 iter/s, 4.583e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(229376,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.858 Tflops/s, hfu: 16.858 Tflops/s, 373.821 iter/s, 2.675e-03 s/iter, (0.034, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 31.078 Tflops/s, hfu: 31.078 Tflops/s, 689.144 iter/s, 1.451e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 14.348 Tflops/s, hfu: 14.348 Tflops/s, 318.158 iter/s, 3.143e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 70.507 Tflops/s, hfu: 70.507 Tflops/s, 781.724 iter/s, 1.279e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 106.654 Tflops/s, hfu: 106.654 Tflops/s, 1182.492 iter/s, 8.457e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 115.951 Tflops/s, hfu: 115.951 Tflops/s, 1285.572 iter/s, 7.779e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 132.019 Tflops/s, hfu: 132.019 Tflops/s, 1463.717 iter/s, 6.832e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 83.378 Tflops/s, hfu: 83.378 Tflops/s, 924.426 iter/s, 1.082e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.354 Tflops/s, hfu: 110.354 Tflops/s, 1223.511 iter/s, 8.173e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 128.271 Tflops/s, hfu: 128.271 Tflops/s, 1422.168 iter/s, 7.032e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 136.334 Tflops/s, hfu: 136.334 Tflops/s, 1511.561 iter/s, 6.616e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(229376,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.397 Tflops/s, hfu: 22.397 Tflops/s, 372.473 iter/s, 2.685e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.191 Tflops/s, hfu: 41.191 Tflops/s, 685.030 iter/s, 1.460e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 19.377 Tflops/s, hfu: 19.377 Tflops/s, 322.255 iter/s, 3.103e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 86.543 Tflops/s, hfu: 86.543 Tflops/s, 719.640 iter/s, 1.390e-03 s/iter, (0.074, 0.000, 0.006) sec
mfu: 118.193 Tflops/s, hfu: 118.193 Tflops/s, 982.820 iter/s, 1.017e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 124.838 Tflops/s, hfu: 124.838 Tflops/s, 1038.077 iter/s, 9.633e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 137.681 Tflops/s, hfu: 137.681 Tflops/s, 1144.867 iter/s, 8.735e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 99.0 Tflops/s, hfu: 99.0 Tflops/s, 823.224 iter/s, 1.215e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 124.969 Tflops/s, hfu: 124.969 Tflops/s, 1039.164 iter/s, 9.623e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 135.068 Tflops/s, hfu: 135.068 Tflops/s, 1123.141 iter/s, 8.904e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 140.978 Tflops/s, hfu: 140.978 Tflops/s, 1172.289 iter/s, 8.530e-04 s/iter, (0.077, 0.000, 0.003) sec
SP=(1,8),S=(229376,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 27.908 Tflops/s, hfu: 27.908 Tflops/s, 371.301 iter/s, 2.693e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.857 Tflops/s, hfu: 50.857 Tflops/s, 676.626 iter/s, 1.478e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.035 Tflops/s, hfu: 24.035 Tflops/s, 319.783 iter/s, 3.127e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 99.855 Tflops/s, hfu: 99.855 Tflops/s, 664.265 iter/s, 1.505e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 127.786 Tflops/s, hfu: 127.786 Tflops/s, 850.074 iter/s, 1.176e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 131.708 Tflops/s, hfu: 131.708 Tflops/s, 876.160 iter/s, 1.141e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 142.137 Tflops/s, hfu: 142.137 Tflops/s, 945.537 iter/s, 1.058e-03 s/iter, (0.077, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 111.708 Tflops/s, hfu: 111.708 Tflops/s, 743.114 iter/s, 1.346e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 133.406 Tflops/s, hfu: 133.406 Tflops/s, 887.456 iter/s, 1.127e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 143.94 Tflops/s, hfu: 143.94 Tflops/s, 957.531 iter/s, 1.044e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 142.657 Tflops/s, hfu: 142.657 Tflops/s, 948.997 iter/s, 1.054e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(229376,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.576 Tflops/s, hfu: 33.576 Tflops/s, 372.260 iter/s, 2.686e-03 s/iter, (0.035, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 61.909 Tflops/s, hfu: 61.909 Tflops/s, 686.398 iter/s, 1.457e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 29.45 Tflops/s, hfu: 29.45 Tflops/s, 326.519 iter/s, 3.063e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 121.142 Tflops/s, hfu: 121.142 Tflops/s, 671.563 iter/s, 1.489e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 132.568 Tflops/s, hfu: 132.568 Tflops/s, 734.901 iter/s, 1.361e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 135.735 Tflops/s, hfu: 135.735 Tflops/s, 752.459 iter/s, 1.329e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 144.574 Tflops/s, hfu: 144.574 Tflops/s, 801.457 iter/s, 1.248e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 122.546 Tflops/s, hfu: 122.546 Tflops/s, 679.344 iter/s, 1.472e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 143.366 Tflops/s, hfu: 143.366 Tflops/s, 794.761 iter/s, 1.258e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 148.975 Tflops/s, hfu: 148.975 Tflops/s, 825.857 iter/s, 1.211e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 143.447 Tflops/s, hfu: 143.447 Tflops/s, 795.211 iter/s, 1.258e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(229376,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.934 Tflops/s, hfu: 38.934 Tflops/s, 369.997 iter/s, 2.703e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 71.039 Tflops/s, hfu: 71.039 Tflops/s, 675.101 iter/s, 1.481e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 34.366 Tflops/s, hfu: 34.366 Tflops/s, 326.593 iter/s, 3.062e-03 s/iter, (0.037, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 128.852 Tflops/s, hfu: 128.852 Tflops/s, 612.259 iter/s, 1.633e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 136.21 Tflops/s, hfu: 136.21 Tflops/s, 647.222 iter/s, 1.545e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 139.493 Tflops/s, hfu: 139.493 Tflops/s, 662.821 iter/s, 1.509e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 145.953 Tflops/s, hfu: 145.953 Tflops/s, 693.516 iter/s, 1.442e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 131.124 Tflops/s, hfu: 131.124 Tflops/s, 623.053 iter/s, 1.605e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 151.348 Tflops/s, hfu: 151.348 Tflops/s, 719.151 iter/s, 1.391e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 154.02 Tflops/s, hfu: 154.02 Tflops/s, 731.850 iter/s, 1.366e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 144.441 Tflops/s, hfu: 144.441 Tflops/s, 686.330 iter/s, 1.457e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(229376,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.169 Tflops/s, hfu: 44.169 Tflops/s, 367.283 iter/s, 2.723e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 75.685 Tflops/s, hfu: 75.685 Tflops/s, 629.345 iter/s, 1.589e-03 s/iter, (0.022, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 38.984 Tflops/s, hfu: 38.984 Tflops/s, 324.164 iter/s, 3.085e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 135.266 Tflops/s, hfu: 135.266 Tflops/s, 562.394 iter/s, 1.778e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 139.743 Tflops/s, hfu: 139.743 Tflops/s, 581.006 iter/s, 1.721e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 142.964 Tflops/s, hfu: 142.964 Tflops/s, 594.400 iter/s, 1.682e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 147.704 Tflops/s, hfu: 147.704 Tflops/s, 614.109 iter/s, 1.628e-03 s/iter, (0.080, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 138.932 Tflops/s, hfu: 138.932 Tflops/s, 577.637 iter/s, 1.731e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 156.95 Tflops/s, hfu: 156.95 Tflops/s, 652.551 iter/s, 1.532e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 157.341 Tflops/s, hfu: 157.341 Tflops/s, 654.176 iter/s, 1.529e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 145.229 Tflops/s, hfu: 145.229 Tflops/s, 603.815 iter/s, 1.656e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(229376,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.87 Tflops/s, hfu: 54.87 Tflops/s, 365.011 iter/s, 2.740e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 77.301 Tflops/s, hfu: 77.301 Tflops/s, 514.232 iter/s, 1.945e-03 s/iter, (0.025, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 48.21 Tflops/s, hfu: 48.21 Tflops/s, 320.711 iter/s, 3.118e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 141.889 Tflops/s, hfu: 141.889 Tflops/s, 471.944 iter/s, 2.119e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 142.78 Tflops/s, hfu: 142.78 Tflops/s, 474.908 iter/s, 2.106e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 146.824 Tflops/s, hfu: 146.824 Tflops/s, 488.358 iter/s, 2.048e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 148.723 Tflops/s, hfu: 148.723 Tflops/s, 494.675 iter/s, 2.022e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 150.312 Tflops/s, hfu: 150.312 Tflops/s, 499.960 iter/s, 2.000e-03 s/iter, (0.083, 0.000, 0.008) sec
mfu: 164.539 Tflops/s, hfu: 164.539 Tflops/s, 547.281 iter/s, 1.827e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 163.464 Tflops/s, hfu: 163.464 Tflops/s, 543.705 iter/s, 1.839e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 146.763 Tflops/s, hfu: 146.763 Tflops/s, 488.155 iter/s, 2.049e-03 s/iter, (0.081, 0.000, 0.008) sec
SP=(1,8),S=(229376,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.822 Tflops/s, hfu: 58.822 Tflops/s, 326.084 iter/s, 3.067e-03 s/iter, (0.041, 0.000, 0.061) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 77.888 Tflops/s, hfu: 77.888 Tflops/s, 431.779 iter/s, 2.316e-03 s/iter, (0.029, 0.000, 0.046) sec
# stripe_flash_attn_func, fwd
mfu: 57.299 Tflops/s, hfu: 57.299 Tflops/s, 317.641 iter/s, 3.148e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 142.328 Tflops/s, hfu: 142.328 Tflops/s, 394.505 iter/s, 2.535e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 145.74 Tflops/s, hfu: 145.74 Tflops/s, 403.962 iter/s, 2.475e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 148.176 Tflops/s, hfu: 148.176 Tflops/s, 410.713 iter/s, 2.435e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 150.856 Tflops/s, hfu: 150.856 Tflops/s, 418.143 iter/s, 2.392e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 159.828 Tflops/s, hfu: 159.828 Tflops/s, 443.009 iter/s, 2.257e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 172.538 Tflops/s, hfu: 172.538 Tflops/s, 478.240 iter/s, 2.091e-03 s/iter, (0.136, 0.000, 0.008) sec
mfu: 166.877 Tflops/s, hfu: 166.877 Tflops/s, 462.548 iter/s, 2.162e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 147.699 Tflops/s, hfu: 147.699 Tflops/s, 409.390 iter/s, 2.443e-03 s/iter, (0.083, 0.000, 0.010) sec
SP=(1,8),S=(229376,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.725 Tflops/s, hfu: 61.725 Tflops/s, 293.294 iter/s, 3.410e-03 s/iter, (0.045, 0.000, 0.068) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.286 Tflops/s, hfu: 78.286 Tflops/s, 371.987 iter/s, 2.688e-03 s/iter, (0.033, 0.000, 0.054) sec
# stripe_flash_attn_func, fwd
mfu: 66.441 Tflops/s, hfu: 66.441 Tflops/s, 315.705 iter/s, 3.168e-03 s/iter, (0.048, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 144.891 Tflops/s, hfu: 144.891 Tflops/s, 344.235 iter/s, 2.905e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 146.343 Tflops/s, hfu: 146.343 Tflops/s, 347.684 iter/s, 2.876e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 149.293 Tflops/s, hfu: 149.293 Tflops/s, 354.694 iter/s, 2.819e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 151.531 Tflops/s, hfu: 151.531 Tflops/s, 360.011 iter/s, 2.778e-03 s/iter, (0.083, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 167.41 Tflops/s, hfu: 167.41 Tflops/s, 397.737 iter/s, 2.514e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 177.132 Tflops/s, hfu: 177.132 Tflops/s, 420.834 iter/s, 2.376e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 170.124 Tflops/s, hfu: 170.124 Tflops/s, 404.184 iter/s, 2.474e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 147.788 Tflops/s, hfu: 147.788 Tflops/s, 351.118 iter/s, 2.848e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(229376,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.899 Tflops/s, hfu: 63.899 Tflops/s, 265.673 iter/s, 3.764e-03 s/iter, (0.049, 0.000, 0.075) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 79.127 Tflops/s, hfu: 79.127 Tflops/s, 328.984 iter/s, 3.040e-03 s/iter, (0.037, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 75.674 Tflops/s, hfu: 75.674 Tflops/s, 314.629 iter/s, 3.178e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 142.876 Tflops/s, hfu: 142.876 Tflops/s, 297.017 iter/s, 3.367e-03 s/iter, (0.085, 0.000, 0.013) sec
mfu: 146.962 Tflops/s, hfu: 146.962 Tflops/s, 305.511 iter/s, 3.273e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 150.019 Tflops/s, hfu: 150.019 Tflops/s, 311.867 iter/s, 3.206e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 152.349 Tflops/s, hfu: 152.349 Tflops/s, 316.709 iter/s, 3.157e-03 s/iter, (0.082, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 172.535 Tflops/s, hfu: 172.535 Tflops/s, 358.674 iter/s, 2.788e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 181.231 Tflops/s, hfu: 181.231 Tflops/s, 376.751 iter/s, 2.654e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 171.857 Tflops/s, hfu: 171.857 Tflops/s, 357.264 iter/s, 2.799e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 147.349 Tflops/s, hfu: 147.349 Tflops/s, 306.316 iter/s, 3.265e-03 s/iter, (0.093, 0.000, 0.013) sec
SP=(1,8),S=(229376,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.947 Tflops/s, hfu: 66.947 Tflops/s, 222.676 iter/s, 4.491e-03 s/iter, (0.055, 0.000, 0.090) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 79.448 Tflops/s, hfu: 79.448 Tflops/s, 264.256 iter/s, 3.784e-03 s/iter, (0.045, 0.000, 0.076) sec
# stripe_flash_attn_func, fwd
mfu: 89.224 Tflops/s, hfu: 89.224 Tflops/s, 296.774 iter/s, 3.370e-03 s/iter, (0.041, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 145.728 Tflops/s, hfu: 145.728 Tflops/s, 242.357 iter/s, 4.126e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 149.182 Tflops/s, hfu: 149.182 Tflops/s, 248.102 iter/s, 4.031e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 151.581 Tflops/s, hfu: 151.581 Tflops/s, 252.091 iter/s, 3.967e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 153.273 Tflops/s, hfu: 153.273 Tflops/s, 254.904 iter/s, 3.923e-03 s/iter, (0.085, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 181.506 Tflops/s, hfu: 181.506 Tflops/s, 301.858 iter/s, 3.313e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 186.626 Tflops/s, hfu: 186.626 Tflops/s, 310.374 iter/s, 3.222e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 174.753 Tflops/s, hfu: 174.753 Tflops/s, 290.628 iter/s, 3.441e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 147.618 Tflops/s, hfu: 147.618 Tflops/s, 245.500 iter/s, 4.073e-03 s/iter, (0.087, 0.000, 0.016) sec
SP=(1,8),S=(229376,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.414 Tflops/s, hfu: 69.414 Tflops/s, 192.401 iter/s, 5.197e-03 s/iter, (0.062, 0.000, 0.104) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.329 Tflops/s, hfu: 80.329 Tflops/s, 222.655 iter/s, 4.491e-03 s/iter, (0.053, 0.000, 0.090) sec
# stripe_flash_attn_func, fwd
mfu: 95.089 Tflops/s, hfu: 95.089 Tflops/s, 263.566 iter/s, 3.794e-03 s/iter, (0.045, 0.000, 0.076) sec
# orchestrated_attn_func
mfu: 146.648 Tflops/s, hfu: 146.648 Tflops/s, 203.238 iter/s, 4.920e-03 s/iter, (0.089, 0.000, 0.020) sec
mfu: 149.575 Tflops/s, hfu: 149.575 Tflops/s, 207.296 iter/s, 4.824e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 152.617 Tflops/s, hfu: 152.617 Tflops/s, 211.511 iter/s, 4.728e-03 s/iter, (0.088, 0.000, 0.019) sec
mfu: 153.841 Tflops/s, hfu: 153.841 Tflops/s, 213.207 iter/s, 4.690e-03 s/iter, (0.091, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 188.02 Tflops/s, hfu: 188.02 Tflops/s, 260.576 iter/s, 3.838e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 190.319 Tflops/s, hfu: 190.319 Tflops/s, 263.762 iter/s, 3.791e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 176.88 Tflops/s, hfu: 176.88 Tflops/s, 245.137 iter/s, 4.079e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 148.726 Tflops/s, hfu: 148.726 Tflops/s, 206.119 iter/s, 4.852e-03 s/iter, (0.089, 0.000, 0.019) sec
SP=(1,8),S=(229376,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.782 Tflops/s, hfu: 70.782 Tflops/s, 168.164 iter/s, 5.947e-03 s/iter, (0.071, 0.000, 0.119) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.396 Tflops/s, hfu: 80.396 Tflops/s, 191.007 iter/s, 5.235e-03 s/iter, (0.061, 0.000, 0.105) sec
# stripe_flash_attn_func, fwd
mfu: 99.01 Tflops/s, hfu: 99.01 Tflops/s, 235.229 iter/s, 4.251e-03 s/iter, (0.050, 0.000, 0.085) sec
# orchestrated_attn_func
mfu: 147.883 Tflops/s, hfu: 147.883 Tflops/s, 175.672 iter/s, 5.692e-03 s/iter, (0.097, 0.000, 0.023) sec
mfu: 150.856 Tflops/s, hfu: 150.856 Tflops/s, 179.204 iter/s, 5.580e-03 s/iter, (0.095, 0.000, 0.022) sec
mfu: 152.46 Tflops/s, hfu: 152.46 Tflops/s, 181.110 iter/s, 5.522e-03 s/iter, (0.091, 0.000, 0.022) sec
mfu: 154.197 Tflops/s, hfu: 154.197 Tflops/s, 183.172 iter/s, 5.459e-03 s/iter, (0.092, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 192.929 Tflops/s, hfu: 192.929 Tflops/s, 229.183 iter/s, 4.363e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 193.253 Tflops/s, hfu: 193.253 Tflops/s, 229.568 iter/s, 4.356e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 178.63 Tflops/s, hfu: 178.63 Tflops/s, 212.196 iter/s, 4.713e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 149.258 Tflops/s, hfu: 149.258 Tflops/s, 177.305 iter/s, 5.640e-03 s/iter, (0.093, 0.000, 0.023) sec
SP=(1,8),S=(229376,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.316 Tflops/s, hfu: 72.316 Tflops/s, 150.334 iter/s, 6.652e-03 s/iter, (0.076, 0.000, 0.133) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.632 Tflops/s, hfu: 80.632 Tflops/s, 167.622 iter/s, 5.966e-03 s/iter, (0.068, 0.000, 0.119) sec
# stripe_flash_attn_func, fwd
mfu: 103.682 Tflops/s, hfu: 103.682 Tflops/s, 215.539 iter/s, 4.640e-03 s/iter, (0.055, 0.000, 0.093) sec
# orchestrated_attn_func
mfu: 148.386 Tflops/s, hfu: 148.386 Tflops/s, 154.235 iter/s, 6.484e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 151.038 Tflops/s, hfu: 151.038 Tflops/s, 156.992 iter/s, 6.370e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 153.228 Tflops/s, hfu: 153.228 Tflops/s, 159.269 iter/s, 6.279e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 154.676 Tflops/s, hfu: 154.676 Tflops/s, 160.774 iter/s, 6.220e-03 s/iter, (0.095, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 196.514 Tflops/s, hfu: 196.514 Tflops/s, 204.261 iter/s, 4.896e-03 s/iter, (0.089, 0.000, 0.020) sec
mfu: 195.688 Tflops/s, hfu: 195.688 Tflops/s, 203.402 iter/s, 4.916e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 179.468 Tflops/s, hfu: 179.468 Tflops/s, 186.543 iter/s, 5.361e-03 s/iter, (0.092, 0.000, 0.021) sec
mfu: 149.719 Tflops/s, hfu: 149.719 Tflops/s, 155.621 iter/s, 6.426e-03 s/iter, (0.100, 0.000, 0.026) sec
SP=(1,8),S=(229376,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.161 Tflops/s, hfu: 74.161 Tflops/s, 123.335 iter/s, 8.108e-03 s/iter, (0.092, 0.000, 0.162) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.194 Tflops/s, hfu: 81.194 Tflops/s, 135.031 iter/s, 7.406e-03 s/iter, (0.084, 0.000, 0.148) sec
# stripe_flash_attn_func, fwd
mfu: 109.0 Tflops/s, hfu: 109.0 Tflops/s, 181.275 iter/s, 5.516e-03 s/iter, (0.064, 0.000, 0.110) sec
# orchestrated_attn_func
mfu: 150.542 Tflops/s, hfu: 150.542 Tflops/s, 125.182 iter/s, 7.988e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 152.421 Tflops/s, hfu: 152.421 Tflops/s, 126.744 iter/s, 7.890e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 153.403 Tflops/s, hfu: 153.403 Tflops/s, 127.560 iter/s, 7.839e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 155.166 Tflops/s, hfu: 155.166 Tflops/s, 129.026 iter/s, 7.750e-03 s/iter, (0.101, 0.000, 0.031) sec
# orchestrated_attn_func fused
mfu: 202.139 Tflops/s, hfu: 202.139 Tflops/s, 168.086 iter/s, 5.949e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 198.647 Tflops/s, hfu: 198.647 Tflops/s, 165.182 iter/s, 6.054e-03 s/iter, (0.098, 0.000, 0.024) sec
mfu: 181.109 Tflops/s, hfu: 181.109 Tflops/s, 150.599 iter/s, 6.640e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 150.328 Tflops/s, hfu: 150.328 Tflops/s, 125.003 iter/s, 8.000e-03 s/iter, (0.102, 0.000, 0.032) sec
SP=(1,8),S=(229376,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.472 Tflops/s, hfu: 75.472 Tflops/s, 104.597 iter/s, 9.561e-03 s/iter, (0.108, 0.000, 0.191) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.269 Tflops/s, hfu: 81.269 Tflops/s, 112.631 iter/s, 8.879e-03 s/iter, (0.100, 0.000, 0.178) sec
# stripe_flash_attn_func, fwd
mfu: 111.973 Tflops/s, hfu: 111.973 Tflops/s, 155.183 iter/s, 6.444e-03 s/iter, (0.076, 0.000, 0.129) sec
# orchestrated_attn_func
mfu: 149.904 Tflops/s, hfu: 149.904 Tflops/s, 103.876 iter/s, 9.627e-03 s/iter, (0.108, 0.000, 0.039) sec
mfu: 152.405 Tflops/s, hfu: 152.405 Tflops/s, 105.609 iter/s, 9.469e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 153.731 Tflops/s, hfu: 153.731 Tflops/s, 106.527 iter/s, 9.387e-03 s/iter, (0.107, 0.000, 0.038) sec
mfu: 155.499 Tflops/s, hfu: 155.499 Tflops/s, 107.752 iter/s, 9.281e-03 s/iter, (0.107, 0.000, 0.037) sec
# orchestrated_attn_func fused
mfu: 206.109 Tflops/s, hfu: 206.109 Tflops/s, 142.823 iter/s, 7.002e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 201.508 Tflops/s, hfu: 201.508 Tflops/s, 139.634 iter/s, 7.162e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 182.578 Tflops/s, hfu: 182.578 Tflops/s, 126.517 iter/s, 7.904e-03 s/iter, (0.104, 0.000, 0.032) sec
mfu: 150.798 Tflops/s, hfu: 150.798 Tflops/s, 104.495 iter/s, 9.570e-03 s/iter, (0.108, 0.000, 0.038) sec
SP=(1,8),S=(229376,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.424 Tflops/s, hfu: 76.424 Tflops/s, 90.785 iter/s, 1.101e-02 s/iter, (0.123, 0.000, 0.220) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.505 Tflops/s, hfu: 81.505 Tflops/s, 96.821 iter/s, 1.033e-02 s/iter, (0.116, 0.000, 0.207) sec
# stripe_flash_attn_func, fwd
mfu: 112.899 Tflops/s, hfu: 112.899 Tflops/s, 134.114 iter/s, 7.456e-03 s/iter, (0.085, 0.000, 0.149) sec
# orchestrated_attn_func
mfu: 151.336 Tflops/s, hfu: 151.336 Tflops/s, 89.887 iter/s, 1.113e-02 s/iter, (0.117, 0.000, 0.045) sec
mfu: 151.898 Tflops/s, hfu: 151.898 Tflops/s, 90.221 iter/s, 1.108e-02 s/iter, (0.116, 0.000, 0.044) sec
mfu: 153.829 Tflops/s, hfu: 153.829 Tflops/s, 91.367 iter/s, 1.094e-02 s/iter, (0.113, 0.000, 0.044) sec
mfu: 155.752 Tflops/s, hfu: 155.752 Tflops/s, 92.510 iter/s, 1.081e-02 s/iter, (0.113, 0.000, 0.043) sec
# orchestrated_attn_func fused
mfu: 209.05 Tflops/s, hfu: 209.05 Tflops/s, 124.166 iter/s, 8.054e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 202.722 Tflops/s, hfu: 202.722 Tflops/s, 120.408 iter/s, 8.305e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 183.281 Tflops/s, hfu: 183.281 Tflops/s, 108.861 iter/s, 9.186e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 150.632 Tflops/s, hfu: 150.632 Tflops/s, 89.468 iter/s, 1.118e-02 s/iter, (0.115, 0.000, 0.045) sec
SP=(1,8),S=(229376,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.407 Tflops/s, hfu: 77.407 Tflops/s, 80.459 iter/s, 1.243e-02 s/iter, (0.140, 0.000, 0.249) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.288 Tflops/s, hfu: 92.288 Tflops/s, 95.927 iter/s, 1.042e-02 s/iter, (0.117, 0.000, 0.208) sec
# stripe_flash_attn_func, fwd
mfu: 119.741 Tflops/s, hfu: 119.741 Tflops/s, 124.461 iter/s, 8.035e-03 s/iter, (0.092, 0.000, 0.161) sec
# orchestrated_attn_func
mfu: 152.71 Tflops/s, hfu: 152.71 Tflops/s, 79.365 iter/s, 1.260e-02 s/iter, (0.124, 0.000, 0.050) sec
mfu: 152.973 Tflops/s, hfu: 152.973 Tflops/s, 79.502 iter/s, 1.258e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 154.681 Tflops/s, hfu: 154.681 Tflops/s, 80.390 iter/s, 1.244e-02 s/iter, (0.119, 0.000, 0.050) sec
mfu: 155.984 Tflops/s, hfu: 155.984 Tflops/s, 81.067 iter/s, 1.234e-02 s/iter, (0.119, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 211.55 Tflops/s, hfu: 211.55 Tflops/s, 109.945 iter/s, 9.095e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 204.325 Tflops/s, hfu: 204.325 Tflops/s, 106.190 iter/s, 9.417e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 183.704 Tflops/s, hfu: 183.704 Tflops/s, 95.473 iter/s, 1.047e-02 s/iter, (0.115, 0.000, 0.042) sec
mfu: 150.849 Tflops/s, hfu: 150.849 Tflops/s, 78.398 iter/s, 1.276e-02 s/iter, (0.121, 0.000, 0.051) sec
SP=(1,8),S=(229376,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.762 Tflops/s, hfu: 78.762 Tflops/s, 65.494 iter/s, 1.527e-02 s/iter, (0.174, 0.000, 0.305) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.854 Tflops/s, hfu: 112.854 Tflops/s, 93.843 iter/s, 1.066e-02 s/iter, (0.121, 0.000, 0.213) sec
# stripe_flash_attn_func, fwd
mfu: 124.62 Tflops/s, hfu: 124.62 Tflops/s, 103.627 iter/s, 9.650e-03 s/iter, (0.111, 0.000, 0.193) sec
# orchestrated_attn_func
mfu: 151.79 Tflops/s, hfu: 151.79 Tflops/s, 63.110 iter/s, 1.585e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 153.281 Tflops/s, hfu: 153.281 Tflops/s, 63.729 iter/s, 1.569e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 154.757 Tflops/s, hfu: 154.757 Tflops/s, 64.343 iter/s, 1.554e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 156.221 Tflops/s, hfu: 156.221 Tflops/s, 64.952 iter/s, 1.540e-02 s/iter, (0.132, 0.000, 0.062) sec
# orchestrated_attn_func fused
mfu: 214.664 Tflops/s, hfu: 214.664 Tflops/s, 89.250 iter/s, 1.120e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 205.59 Tflops/s, hfu: 205.59 Tflops/s, 85.478 iter/s, 1.170e-02 s/iter, (0.117, 0.000, 0.047) sec
mfu: 184.657 Tflops/s, hfu: 184.657 Tflops/s, 76.775 iter/s, 1.303e-02 s/iter, (0.123, 0.000, 0.052) sec
mfu: 151.291 Tflops/s, hfu: 151.291 Tflops/s, 62.902 iter/s, 1.590e-02 s/iter, (0.134, 0.000, 0.064) sec
SP=(1,8),S=(229376,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.535 Tflops/s, hfu: 79.535 Tflops/s, 55.113 iter/s, 1.814e-02 s/iter, (0.206, 0.000, 0.363) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 120.38 Tflops/s, hfu: 120.38 Tflops/s, 83.417 iter/s, 1.199e-02 s/iter, (0.139, 0.000, 0.240) sec
# stripe_flash_attn_func, fwd
mfu: 126.813 Tflops/s, hfu: 126.813 Tflops/s, 87.875 iter/s, 1.138e-02 s/iter, (0.135, 0.000, 0.228) sec
# orchestrated_attn_func
mfu: 151.189 Tflops/s, hfu: 151.189 Tflops/s, 52.383 iter/s, 1.909e-02 s/iter, (0.149, 0.000, 0.076) sec
mfu: 153.563 Tflops/s, hfu: 153.563 Tflops/s, 53.206 iter/s, 1.880e-02 s/iter, (0.146, 0.000, 0.075) sec
mfu: 154.72 Tflops/s, hfu: 154.72 Tflops/s, 53.607 iter/s, 1.865e-02 s/iter, (0.145, 0.000, 0.075) sec
mfu: 156.423 Tflops/s, hfu: 156.423 Tflops/s, 54.197 iter/s, 1.845e-02 s/iter, (0.147, 0.000, 0.074) sec
# orchestrated_attn_func fused
mfu: 216.592 Tflops/s, hfu: 216.592 Tflops/s, 75.044 iter/s, 1.333e-02 s/iter, (0.244, 0.000, 0.053) sec
mfu: 206.772 Tflops/s, hfu: 206.772 Tflops/s, 71.641 iter/s, 1.396e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 185.418 Tflops/s, hfu: 185.418 Tflops/s, 64.242 iter/s, 1.557e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 151.736 Tflops/s, hfu: 151.736 Tflops/s, 52.573 iter/s, 1.902e-02 s/iter, (0.146, 0.000, 0.076) sec
SP=(1,8),S=(229376,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.997 Tflops/s, hfu: 78.997 Tflops/s, 46.921 iter/s, 2.131e-02 s/iter, (0.238, 0.000, 0.426) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.623 Tflops/s, hfu: 117.623 Tflops/s, 69.863 iter/s, 1.431e-02 s/iter, (0.161, 0.000, 0.286) sec
# stripe_flash_attn_func, fwd
mfu: 109.153 Tflops/s, hfu: 109.153 Tflops/s, 64.832 iter/s, 1.542e-02 s/iter, (0.173, 0.000, 0.308) sec
# orchestrated_attn_func
mfu: 151.877 Tflops/s, hfu: 151.877 Tflops/s, 45.104 iter/s, 2.217e-02 s/iter, (0.158, 0.000, 0.089) sec
mfu: 153.866 Tflops/s, hfu: 153.866 Tflops/s, 45.695 iter/s, 2.188e-02 s/iter, (0.157, 0.000, 0.088) sec
mfu: 154.869 Tflops/s, hfu: 154.869 Tflops/s, 45.993 iter/s, 2.174e-02 s/iter, (0.156, 0.000, 0.087) sec
mfu: 156.429 Tflops/s, hfu: 156.429 Tflops/s, 46.456 iter/s, 2.153e-02 s/iter, (0.156, 0.000, 0.086) sec
# orchestrated_attn_func fused
mfu: 218.253 Tflops/s, hfu: 218.253 Tflops/s, 64.816 iter/s, 1.543e-02 s/iter, (0.131, 0.000, 0.062) sec
mfu: 207.887 Tflops/s, hfu: 207.887 Tflops/s, 61.738 iter/s, 1.620e-02 s/iter, (0.135, 0.001, 0.065) sec
mfu: 185.966 Tflops/s, hfu: 185.966 Tflops/s, 55.228 iter/s, 1.811e-02 s/iter, (0.145, 0.000, 0.072) sec
mfu: 151.738 Tflops/s, hfu: 151.738 Tflops/s, 45.063 iter/s, 2.219e-02 s/iter, (0.159, 0.000, 0.089) sec
SP=(1,8),S=(229376,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.638 Tflops/s, hfu: 79.638 Tflops/s, 41.389 iter/s, 2.416e-02 s/iter, (0.271, 0.000, 0.483) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.597 Tflops/s, hfu: 118.597 Tflops/s, 61.636 iter/s, 1.622e-02 s/iter, (0.183, 0.000, 0.324) sec
# stripe_flash_attn_func, fwd
mfu: 102.148 Tflops/s, hfu: 102.148 Tflops/s, 53.088 iter/s, 1.884e-02 s/iter, (0.212, 0.000, 0.377) sec
# orchestrated_attn_func
mfu: 152.899 Tflops/s, hfu: 152.899 Tflops/s, 39.732 iter/s, 2.517e-02 s/iter, (0.172, 0.000, 0.101) sec
mfu: 153.563 Tflops/s, hfu: 153.563 Tflops/s, 39.904 iter/s, 2.506e-02 s/iter, (0.170, 0.000, 0.100) sec
mfu: 154.965 Tflops/s, hfu: 154.965 Tflops/s, 40.268 iter/s, 2.483e-02 s/iter, (0.169, 0.000, 0.099) sec
mfu: 156.559 Tflops/s, hfu: 156.559 Tflops/s, 40.683 iter/s, 2.458e-02 s/iter, (0.172, 0.000, 0.098) sec
# orchestrated_attn_func fused
mfu: 219.522 Tflops/s, hfu: 219.522 Tflops/s, 57.044 iter/s, 1.753e-02 s/iter, (0.140, 0.000, 0.070) sec
mfu: 208.322 Tflops/s, hfu: 208.322 Tflops/s, 54.134 iter/s, 1.847e-02 s/iter, (0.145, 0.000, 0.074) sec
mfu: 186.11 Tflops/s, hfu: 186.11 Tflops/s, 48.362 iter/s, 2.068e-02 s/iter, (0.153, 0.000, 0.083) sec
mfu: 151.717 Tflops/s, hfu: 151.717 Tflops/s, 39.425 iter/s, 2.536e-02 s/iter, (0.172, 0.000, 0.101) sec
SP=(1,8),S=(229376,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.646 Tflops/s, hfu: 79.646 Tflops/s, 33.114 iter/s, 3.020e-02 s/iter, (0.334, 0.000, 0.604) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.627 Tflops/s, hfu: 117.627 Tflops/s, 48.906 iter/s, 2.045e-02 s/iter, (0.228, 0.000, 0.409) sec
# stripe_flash_attn_func, fwd
mfu: 104.953 Tflops/s, hfu: 104.953 Tflops/s, 43.636 iter/s, 2.292e-02 s/iter, (0.245, 0.000, 0.458) sec
# orchestrated_attn_func
mfu: 153.219 Tflops/s, hfu: 153.219 Tflops/s, 31.852 iter/s, 3.140e-02 s/iter, (0.200, 0.000, 0.126) sec
mfu: 154.443 Tflops/s, hfu: 154.443 Tflops/s, 32.106 iter/s, 3.115e-02 s/iter, (0.197, 0.000, 0.125) sec
mfu: 154.926 Tflops/s, hfu: 154.926 Tflops/s, 32.207 iter/s, 3.105e-02 s/iter, (0.194, 0.000, 0.124) sec
mfu: 156.737 Tflops/s, hfu: 156.737 Tflops/s, 32.583 iter/s, 3.069e-02 s/iter, (0.193, 0.000, 0.123) sec
# orchestrated_attn_func fused
mfu: 221.444 Tflops/s, hfu: 221.444 Tflops/s, 46.035 iter/s, 2.172e-02 s/iter, (0.157, 0.000, 0.087) sec
mfu: 209.432 Tflops/s, hfu: 209.432 Tflops/s, 43.538 iter/s, 2.297e-02 s/iter, (0.162, 0.000, 0.092) sec
mfu: 186.734 Tflops/s, hfu: 186.734 Tflops/s, 38.819 iter/s, 2.576e-02 s/iter, (0.173, 0.000, 0.103) sec
mfu: 151.843 Tflops/s, hfu: 151.843 Tflops/s, 31.566 iter/s, 3.168e-02 s/iter, (0.197, 0.000, 0.127) sec
SP=(1,8),S=(229376,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.651 Tflops/s, hfu: 79.651 Tflops/s, 27.597 iter/s, 3.624e-02 s/iter, (0.400, 0.000, 0.725) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.617 Tflops/s, hfu: 116.617 Tflops/s, 40.405 iter/s, 2.475e-02 s/iter, (0.274, 0.000, 0.495) sec
# stripe_flash_attn_func, fwd
mfu: 100.463 Tflops/s, hfu: 100.463 Tflops/s, 34.808 iter/s, 2.873e-02 s/iter, (0.314, 0.000, 0.575) sec
# orchestrated_attn_func
mfu: 152.449 Tflops/s, hfu: 152.449 Tflops/s, 26.410 iter/s, 3.786e-02 s/iter, (0.234, 0.000, 0.151) sec
mfu: 153.45 Tflops/s, hfu: 153.45 Tflops/s, 26.583 iter/s, 3.762e-02 s/iter, (0.222, 0.000, 0.150) sec
mfu: 155.254 Tflops/s, hfu: 155.254 Tflops/s, 26.896 iter/s, 3.718e-02 s/iter, (0.218, 0.000, 0.149) sec
mfu: 156.818 Tflops/s, hfu: 156.818 Tflops/s, 27.167 iter/s, 3.681e-02 s/iter, (0.217, 0.000, 0.147) sec
# orchestrated_attn_func fused
mfu: 222.857 Tflops/s, hfu: 222.857 Tflops/s, 38.607 iter/s, 2.590e-02 s/iter, (0.176, 0.000, 0.104) sec
mfu: 210.292 Tflops/s, hfu: 210.292 Tflops/s, 36.430 iter/s, 2.745e-02 s/iter, (0.180, 0.000, 0.110) sec
mfu: 187.088 Tflops/s, hfu: 187.088 Tflops/s, 32.411 iter/s, 3.085e-02 s/iter, (0.193, 0.000, 0.123) sec
mfu: 152.111 Tflops/s, hfu: 152.111 Tflops/s, 26.351 iter/s, 3.795e-02 s/iter, (0.222, 0.000, 0.152) sec
SP=(1,8),S=(229376,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.653 Tflops/s, hfu: 79.653 Tflops/s, 23.655 iter/s, 4.227e-02 s/iter, (0.467, 0.000, 0.845) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.909 Tflops/s, hfu: 115.909 Tflops/s, 34.422 iter/s, 2.905e-02 s/iter, (0.321, 0.000, 0.581) sec
# stripe_flash_attn_func, fwd
mfu: 97.108 Tflops/s, hfu: 97.108 Tflops/s, 28.839 iter/s, 3.468e-02 s/iter, (0.383, 0.000, 0.694) sec
# orchestrated_attn_func
mfu: 152.618 Tflops/s, hfu: 152.618 Tflops/s, 22.662 iter/s, 4.413e-02 s/iter, (0.247, 0.000, 0.177) sec
mfu: 154.782 Tflops/s, hfu: 154.782 Tflops/s, 22.983 iter/s, 4.351e-02 s/iter, (0.248, 0.000, 0.174) sec
mfu: 155.314 Tflops/s, hfu: 155.314 Tflops/s, 23.062 iter/s, 4.336e-02 s/iter, (0.244, 0.000, 0.173) sec
mfu: 156.943 Tflops/s, hfu: 156.943 Tflops/s, 23.304 iter/s, 4.291e-02 s/iter, (0.245, 0.000, 0.172) sec
# orchestrated_attn_func fused
mfu: 223.543 Tflops/s, hfu: 223.543 Tflops/s, 33.194 iter/s, 3.013e-02 s/iter, (0.191, 0.000, 0.121) sec
mfu: 210.85 Tflops/s, hfu: 210.85 Tflops/s, 31.309 iter/s, 3.194e-02 s/iter, (0.202, 0.000, 0.128) sec
mfu: 187.38 Tflops/s, hfu: 187.38 Tflops/s, 27.824 iter/s, 3.594e-02 s/iter, (0.215, 0.000, 0.144) sec
mfu: 152.043 Tflops/s, hfu: 152.043 Tflops/s, 22.577 iter/s, 4.429e-02 s/iter, (0.248, 0.000, 0.177) sec
SP=(1,8),S=(229376,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.508 Tflops/s, hfu: 79.508 Tflops/s, 20.661 iter/s, 4.840e-02 s/iter, (0.534, 0.000, 0.968) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.397 Tflops/s, hfu: 115.397 Tflops/s, 29.987 iter/s, 3.335e-02 s/iter, (0.368, 0.000, 0.667) sec
# stripe_flash_attn_func, fwd
mfu: 94.043 Tflops/s, hfu: 94.043 Tflops/s, 24.438 iter/s, 4.092e-02 s/iter, (0.451, 0.000, 0.818) sec
# orchestrated_attn_func
mfu: 152.397 Tflops/s, hfu: 152.397 Tflops/s, 19.801 iter/s, 5.050e-02 s/iter, (0.278, 0.000, 0.202) sec
mfu: 153.218 Tflops/s, hfu: 153.218 Tflops/s, 19.907 iter/s, 5.023e-02 s/iter, (0.274, 0.000, 0.201) sec
mfu: 155.225 Tflops/s, hfu: 155.225 Tflops/s, 20.168 iter/s, 4.958e-02 s/iter, (0.271, 0.000, 0.198) sec
mfu: 156.956 Tflops/s, hfu: 156.956 Tflops/s, 20.393 iter/s, 4.904e-02 s/iter, (0.269, 0.000, 0.196) sec
# orchestrated_attn_func fused
mfu: 224.276 Tflops/s, hfu: 224.276 Tflops/s, 29.140 iter/s, 3.432e-02 s/iter, (0.207, 0.000, 0.137) sec
mfu: 211.201 Tflops/s, hfu: 211.201 Tflops/s, 27.441 iter/s, 3.644e-02 s/iter, (0.217, 0.000, 0.146) sec
mfu: 187.676 Tflops/s, hfu: 187.676 Tflops/s, 24.384 iter/s, 4.101e-02 s/iter, (0.235, 0.000, 0.164) sec
mfu: 152.222 Tflops/s, hfu: 152.222 Tflops/s, 19.778 iter/s, 5.056e-02 s/iter, (0.274, 0.000, 0.202) sec
SP=(1,8),S=(262144,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.508 Tflops/s, hfu: 6.508 Tflops/s, 378.831 iter/s, 2.640e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 12.016 Tflops/s, hfu: 12.016 Tflops/s, 699.395 iter/s, 1.430e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 5.591 Tflops/s, hfu: 5.591 Tflops/s, 325.443 iter/s, 3.073e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 30.556 Tflops/s, hfu: 30.556 Tflops/s, 889.306 iter/s, 1.124e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 60.091 Tflops/s, hfu: 60.091 Tflops/s, 1748.888 iter/s, 5.718e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 76.648 Tflops/s, hfu: 76.648 Tflops/s, 2230.749 iter/s, 4.483e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 102.096 Tflops/s, hfu: 102.096 Tflops/s, 2971.380 iter/s, 3.365e-04 s/iter, (0.070, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 38.766 Tflops/s, hfu: 38.766 Tflops/s, 1128.250 iter/s, 8.863e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 60.657 Tflops/s, hfu: 60.657 Tflops/s, 1765.362 iter/s, 5.665e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 89.581 Tflops/s, hfu: 89.581 Tflops/s, 2607.154 iter/s, 3.836e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 132.647 Tflops/s, hfu: 132.647 Tflops/s, 3860.527 iter/s, 2.590e-04 s/iter, (0.071, 0.000, 0.001) sec
SP=(1,8),S=(262144,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 13.018 Tflops/s, hfu: 13.018 Tflops/s, 378.879 iter/s, 2.639e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.834 Tflops/s, hfu: 23.834 Tflops/s, 693.675 iter/s, 1.442e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 11.134 Tflops/s, hfu: 11.134 Tflops/s, 324.041 iter/s, 3.086e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 56.14 Tflops/s, hfu: 56.14 Tflops/s, 816.945 iter/s, 1.224e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 91.917 Tflops/s, hfu: 91.917 Tflops/s, 1337.571 iter/s, 7.476e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.215 Tflops/s, hfu: 103.215 Tflops/s, 1501.971 iter/s, 6.658e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 137.215 Tflops/s, hfu: 137.215 Tflops/s, 1996.741 iter/s, 5.008e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 66.578 Tflops/s, hfu: 66.578 Tflops/s, 968.842 iter/s, 1.032e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 92.71 Tflops/s, hfu: 92.71 Tflops/s, 1349.105 iter/s, 7.412e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 124.051 Tflops/s, hfu: 124.051 Tflops/s, 1805.184 iter/s, 5.540e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 151.477 Tflops/s, hfu: 151.477 Tflops/s, 2204.274 iter/s, 4.537e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(262144,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.36 Tflops/s, hfu: 19.36 Tflops/s, 375.640 iter/s, 2.662e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.435 Tflops/s, hfu: 35.435 Tflops/s, 687.523 iter/s, 1.454e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 16.667 Tflops/s, hfu: 16.667 Tflops/s, 323.388 iter/s, 3.092e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 74.715 Tflops/s, hfu: 74.715 Tflops/s, 724.835 iter/s, 1.380e-03 s/iter, (0.083, 0.000, 0.006) sec
mfu: 110.592 Tflops/s, hfu: 110.592 Tflops/s, 1072.888 iter/s, 9.321e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 116.932 Tflops/s, hfu: 116.932 Tflops/s, 1134.394 iter/s, 8.815e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 149.501 Tflops/s, hfu: 149.501 Tflops/s, 1450.352 iter/s, 6.895e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 87.895 Tflops/s, hfu: 87.895 Tflops/s, 852.695 iter/s, 1.173e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 116.704 Tflops/s, hfu: 116.704 Tflops/s, 1132.175 iter/s, 8.833e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 143.568 Tflops/s, hfu: 143.568 Tflops/s, 1392.789 iter/s, 7.180e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 155.258 Tflops/s, hfu: 155.258 Tflops/s, 1506.206 iter/s, 6.639e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(262144,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.859 Tflops/s, hfu: 25.859 Tflops/s, 376.304 iter/s, 2.657e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.947 Tflops/s, hfu: 46.947 Tflops/s, 683.173 iter/s, 1.464e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 22.165 Tflops/s, hfu: 22.165 Tflops/s, 322.540 iter/s, 3.100e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 93.667 Tflops/s, hfu: 93.667 Tflops/s, 681.518 iter/s, 1.467e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 121.857 Tflops/s, hfu: 121.857 Tflops/s, 886.625 iter/s, 1.128e-03 s/iter, (0.073, 0.000, 0.005) sec
mfu: 122.552 Tflops/s, hfu: 122.552 Tflops/s, 891.685 iter/s, 1.121e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 156.378 Tflops/s, hfu: 156.378 Tflops/s, 1137.801 iter/s, 8.789e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 104.078 Tflops/s, hfu: 104.078 Tflops/s, 757.268 iter/s, 1.321e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 132.009 Tflops/s, hfu: 132.009 Tflops/s, 960.489 iter/s, 1.041e-03 s/iter, (0.128, 0.000, 0.004) sec
mfu: 152.57 Tflops/s, hfu: 152.57 Tflops/s, 1110.095 iter/s, 9.008e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 159.194 Tflops/s, hfu: 159.194 Tflops/s, 1158.287 iter/s, 8.633e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(262144,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.353 Tflops/s, hfu: 32.353 Tflops/s, 376.639 iter/s, 2.655e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 58.965 Tflops/s, hfu: 58.965 Tflops/s, 686.437 iter/s, 1.457e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 27.762 Tflops/s, hfu: 27.762 Tflops/s, 323.188 iter/s, 3.094e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 106.261 Tflops/s, hfu: 106.261 Tflops/s, 618.521 iter/s, 1.617e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 128.634 Tflops/s, hfu: 128.634 Tflops/s, 748.750 iter/s, 1.336e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 125.401 Tflops/s, hfu: 125.401 Tflops/s, 729.931 iter/s, 1.370e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 161.324 Tflops/s, hfu: 161.324 Tflops/s, 939.031 iter/s, 1.065e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 117.197 Tflops/s, hfu: 117.197 Tflops/s, 682.177 iter/s, 1.466e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 140.692 Tflops/s, hfu: 140.692 Tflops/s, 818.936 iter/s, 1.221e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 161.801 Tflops/s, hfu: 161.801 Tflops/s, 941.804 iter/s, 1.062e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 162.574 Tflops/s, hfu: 162.574 Tflops/s, 946.303 iter/s, 1.057e-03 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(262144,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.568 Tflops/s, hfu: 38.568 Tflops/s, 374.157 iter/s, 2.673e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 70.344 Tflops/s, hfu: 70.344 Tflops/s, 682.428 iter/s, 1.465e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 33.249 Tflops/s, hfu: 33.249 Tflops/s, 322.559 iter/s, 3.100e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 127.732 Tflops/s, hfu: 127.732 Tflops/s, 619.582 iter/s, 1.614e-03 s/iter, (0.084, 0.000, 0.006) sec
mfu: 133.41 Tflops/s, hfu: 133.41 Tflops/s, 647.122 iter/s, 1.545e-03 s/iter, (0.081, 0.000, 0.006) sec
mfu: 130.675 Tflops/s, hfu: 130.675 Tflops/s, 633.858 iter/s, 1.578e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 164.411 Tflops/s, hfu: 164.411 Tflops/s, 797.499 iter/s, 1.254e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 128.131 Tflops/s, hfu: 128.131 Tflops/s, 621.519 iter/s, 1.609e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 150.158 Tflops/s, hfu: 150.158 Tflops/s, 728.362 iter/s, 1.373e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 168.838 Tflops/s, hfu: 168.838 Tflops/s, 818.974 iter/s, 1.221e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 163.09 Tflops/s, hfu: 163.09 Tflops/s, 791.089 iter/s, 1.264e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(262144,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.936 Tflops/s, hfu: 44.936 Tflops/s, 373.662 iter/s, 2.676e-03 s/iter, (0.036, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.944 Tflops/s, hfu: 80.944 Tflops/s, 673.081 iter/s, 1.486e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 38.58 Tflops/s, hfu: 38.58 Tflops/s, 320.808 iter/s, 3.117e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 138.048 Tflops/s, hfu: 138.048 Tflops/s, 573.961 iter/s, 1.742e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 138.846 Tflops/s, hfu: 138.846 Tflops/s, 577.279 iter/s, 1.732e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 131.84 Tflops/s, hfu: 131.84 Tflops/s, 548.152 iter/s, 1.824e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 164.091 Tflops/s, hfu: 164.091 Tflops/s, 682.240 iter/s, 1.466e-03 s/iter, (0.076, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 137.068 Tflops/s, hfu: 137.068 Tflops/s, 569.886 iter/s, 1.755e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 158.319 Tflops/s, hfu: 158.319 Tflops/s, 658.241 iter/s, 1.519e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 174.1 Tflops/s, hfu: 174.1 Tflops/s, 723.853 iter/s, 1.381e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 165.366 Tflops/s, hfu: 165.366 Tflops/s, 687.539 iter/s, 1.454e-03 s/iter, (0.080, 0.000, 0.006) sec
SP=(1,8),S=(262144,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 51.059 Tflops/s, hfu: 51.059 Tflops/s, 371.506 iter/s, 2.692e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 83.359 Tflops/s, hfu: 83.359 Tflops/s, 606.516 iter/s, 1.649e-03 s/iter, (0.022, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 43.994 Tflops/s, hfu: 43.994 Tflops/s, 320.100 iter/s, 3.124e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 147.223 Tflops/s, hfu: 147.223 Tflops/s, 535.593 iter/s, 1.867e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 137.311 Tflops/s, hfu: 137.311 Tflops/s, 499.534 iter/s, 2.002e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 134.674 Tflops/s, hfu: 134.674 Tflops/s, 489.941 iter/s, 2.041e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 167.015 Tflops/s, hfu: 167.015 Tflops/s, 607.598 iter/s, 1.646e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 144.228 Tflops/s, hfu: 144.228 Tflops/s, 524.699 iter/s, 1.906e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 164.072 Tflops/s, hfu: 164.072 Tflops/s, 596.889 iter/s, 1.675e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 178.575 Tflops/s, hfu: 178.575 Tflops/s, 649.651 iter/s, 1.539e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 165.352 Tflops/s, hfu: 165.352 Tflops/s, 601.549 iter/s, 1.662e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(262144,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.597 Tflops/s, hfu: 62.597 Tflops/s, 364.362 iter/s, 2.745e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 87.411 Tflops/s, hfu: 87.411 Tflops/s, 508.801 iter/s, 1.965e-03 s/iter, (0.026, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 54.72 Tflops/s, hfu: 54.72 Tflops/s, 318.514 iter/s, 3.140e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 153.83 Tflops/s, hfu: 153.83 Tflops/s, 447.703 iter/s, 2.234e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 140.684 Tflops/s, hfu: 140.684 Tflops/s, 409.445 iter/s, 2.442e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 134.97 Tflops/s, hfu: 134.97 Tflops/s, 392.815 iter/s, 2.546e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 170.353 Tflops/s, hfu: 170.353 Tflops/s, 495.794 iter/s, 2.017e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 156.285 Tflops/s, hfu: 156.285 Tflops/s, 454.848 iter/s, 2.199e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 171.823 Tflops/s, hfu: 171.823 Tflops/s, 500.070 iter/s, 2.000e-03 s/iter, (0.093, 0.000, 0.008) sec
mfu: 185.448 Tflops/s, hfu: 185.448 Tflops/s, 539.726 iter/s, 1.853e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 167.335 Tflops/s, hfu: 167.335 Tflops/s, 487.009 iter/s, 2.053e-03 s/iter, (0.079, 0.000, 0.008) sec
SP=(1,8),S=(262144,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.209 Tflops/s, hfu: 66.209 Tflops/s, 321.158 iter/s, 3.114e-03 s/iter, (0.042, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 87.376 Tflops/s, hfu: 87.376 Tflops/s, 423.828 iter/s, 2.359e-03 s/iter, (0.030, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 65.15 Tflops/s, hfu: 65.15 Tflops/s, 316.021 iter/s, 3.164e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 153.282 Tflops/s, hfu: 153.282 Tflops/s, 371.758 iter/s, 2.690e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 140.513 Tflops/s, hfu: 140.513 Tflops/s, 340.788 iter/s, 2.934e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 136.814 Tflops/s, hfu: 136.814 Tflops/s, 331.817 iter/s, 3.014e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 171.906 Tflops/s, hfu: 171.906 Tflops/s, 416.927 iter/s, 2.399e-03 s/iter, (0.084, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 166.147 Tflops/s, hfu: 166.147 Tflops/s, 402.961 iter/s, 2.482e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 179.125 Tflops/s, hfu: 179.125 Tflops/s, 434.435 iter/s, 2.302e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 189.752 Tflops/s, hfu: 189.752 Tflops/s, 460.209 iter/s, 2.173e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 168.654 Tflops/s, hfu: 168.654 Tflops/s, 409.041 iter/s, 2.445e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(262144,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.392 Tflops/s, hfu: 69.392 Tflops/s, 288.511 iter/s, 3.466e-03 s/iter, (0.051, 0.000, 0.069) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.081 Tflops/s, hfu: 88.081 Tflops/s, 366.214 iter/s, 2.731e-03 s/iter, (0.034, 0.000, 0.055) sec
# stripe_flash_attn_func, fwd
mfu: 75.434 Tflops/s, hfu: 75.434 Tflops/s, 313.633 iter/s, 3.188e-03 s/iter, (0.041, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 152.304 Tflops/s, hfu: 152.304 Tflops/s, 316.617 iter/s, 3.158e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 144.825 Tflops/s, hfu: 144.825 Tflops/s, 301.069 iter/s, 3.321e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 139.526 Tflops/s, hfu: 139.526 Tflops/s, 290.052 iter/s, 3.448e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 172.624 Tflops/s, hfu: 172.624 Tflops/s, 358.858 iter/s, 2.787e-03 s/iter, (0.081, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 173.299 Tflops/s, hfu: 173.299 Tflops/s, 360.263 iter/s, 2.776e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 184.478 Tflops/s, hfu: 184.478 Tflops/s, 383.501 iter/s, 2.608e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 193.768 Tflops/s, hfu: 193.768 Tflops/s, 402.814 iter/s, 2.483e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 169.067 Tflops/s, hfu: 169.067 Tflops/s, 351.463 iter/s, 2.845e-03 s/iter, (0.082, 0.000, 0.011) sec
SP=(1,8),S=(262144,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.866 Tflops/s, hfu: 71.866 Tflops/s, 261.447 iter/s, 3.825e-03 s/iter, (0.050, 0.000, 0.076) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 89.749 Tflops/s, hfu: 89.749 Tflops/s, 326.505 iter/s, 3.063e-03 s/iter, (0.038, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 85.757 Tflops/s, hfu: 85.757 Tflops/s, 311.981 iter/s, 3.205e-03 s/iter, (0.042, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 149.513 Tflops/s, hfu: 149.513 Tflops/s, 271.963 iter/s, 3.677e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 140.832 Tflops/s, hfu: 140.832 Tflops/s, 256.171 iter/s, 3.904e-03 s/iter, (0.089, 0.000, 0.016) sec
mfu: 135.045 Tflops/s, hfu: 135.045 Tflops/s, 245.646 iter/s, 4.071e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 173.312 Tflops/s, hfu: 173.312 Tflops/s, 315.253 iter/s, 3.172e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 178.944 Tflops/s, hfu: 178.944 Tflops/s, 325.498 iter/s, 3.072e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 187.477 Tflops/s, hfu: 187.477 Tflops/s, 341.019 iter/s, 2.932e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 195.118 Tflops/s, hfu: 195.118 Tflops/s, 354.917 iter/s, 2.818e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 168.134 Tflops/s, hfu: 168.134 Tflops/s, 305.834 iter/s, 3.270e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(262144,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.908 Tflops/s, hfu: 75.908 Tflops/s, 220.923 iter/s, 4.526e-03 s/iter, (0.056, 0.000, 0.091) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.587 Tflops/s, hfu: 91.587 Tflops/s, 266.552 iter/s, 3.752e-03 s/iter, (0.044, 0.000, 0.075) sec
# stripe_flash_attn_func, fwd
mfu: 96.656 Tflops/s, hfu: 96.656 Tflops/s, 281.306 iter/s, 3.555e-03 s/iter, (0.044, 0.000, 0.071) sec
# orchestrated_attn_func
mfu: 149.357 Tflops/s, hfu: 149.357 Tflops/s, 217.343 iter/s, 4.601e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 145.995 Tflops/s, hfu: 145.995 Tflops/s, 212.450 iter/s, 4.707e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 138.39 Tflops/s, hfu: 138.39 Tflops/s, 201.383 iter/s, 4.966e-03 s/iter, (0.092, 0.000, 0.020) sec
mfu: 174.503 Tflops/s, hfu: 174.503 Tflops/s, 253.935 iter/s, 3.938e-03 s/iter, (0.085, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 187.222 Tflops/s, hfu: 187.222 Tflops/s, 272.444 iter/s, 3.670e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 192.99 Tflops/s, hfu: 192.99 Tflops/s, 280.837 iter/s, 3.561e-03 s/iter, (0.087, 0.000, 0.014) sec
mfu: 198.503 Tflops/s, hfu: 198.503 Tflops/s, 288.860 iter/s, 3.462e-03 s/iter, (0.087, 0.000, 0.014) sec
mfu: 168.267 Tflops/s, hfu: 168.267 Tflops/s, 244.861 iter/s, 4.084e-03 s/iter, (0.087, 0.000, 0.016) sec
SP=(1,8),S=(262144,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.102 Tflops/s, hfu: 79.102 Tflops/s, 191.848 iter/s, 5.212e-03 s/iter, (0.063, 0.000, 0.104) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.563 Tflops/s, hfu: 91.563 Tflops/s, 222.068 iter/s, 4.503e-03 s/iter, (0.054, 0.000, 0.090) sec
# stripe_flash_attn_func, fwd
mfu: 102.718 Tflops/s, hfu: 102.718 Tflops/s, 249.124 iter/s, 4.014e-03 s/iter, (0.050, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 157.276 Tflops/s, hfu: 157.276 Tflops/s, 190.722 iter/s, 5.243e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 144.768 Tflops/s, hfu: 144.768 Tflops/s, 175.554 iter/s, 5.696e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 138.109 Tflops/s, hfu: 138.109 Tflops/s, 167.480 iter/s, 5.971e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 175.112 Tflops/s, hfu: 175.112 Tflops/s, 212.351 iter/s, 4.709e-03 s/iter, (0.089, 0.000, 0.019) sec
# orchestrated_attn_func fused
mfu: 193.366 Tflops/s, hfu: 193.366 Tflops/s, 234.487 iter/s, 4.265e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 197.07 Tflops/s, hfu: 197.07 Tflops/s, 238.979 iter/s, 4.184e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 200.343 Tflops/s, hfu: 200.343 Tflops/s, 242.948 iter/s, 4.116e-03 s/iter, (0.087, 0.000, 0.016) sec
mfu: 169.732 Tflops/s, hfu: 169.732 Tflops/s, 205.827 iter/s, 4.858e-03 s/iter, (0.090, 0.000, 0.019) sec
SP=(1,8),S=(262144,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.3 Tflops/s, hfu: 81.3 Tflops/s, 169.011 iter/s, 5.917e-03 s/iter, (0.070, 0.000, 0.118) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.826 Tflops/s, hfu: 92.826 Tflops/s, 192.972 iter/s, 5.182e-03 s/iter, (0.062, 0.000, 0.104) sec
# stripe_flash_attn_func, fwd
mfu: 107.122 Tflops/s, hfu: 107.122 Tflops/s, 222.690 iter/s, 4.491e-03 s/iter, (0.053, 0.000, 0.090) sec
# orchestrated_attn_func
mfu: 150.945 Tflops/s, hfu: 150.945 Tflops/s, 156.896 iter/s, 6.374e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 145.226 Tflops/s, hfu: 145.226 Tflops/s, 150.952 iter/s, 6.625e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 135.548 Tflops/s, hfu: 135.548 Tflops/s, 140.892 iter/s, 7.098e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 175.785 Tflops/s, hfu: 175.785 Tflops/s, 182.715 iter/s, 5.473e-03 s/iter, (0.094, 0.000, 0.022) sec
# orchestrated_attn_func fused
mfu: 198.44 Tflops/s, hfu: 198.44 Tflops/s, 206.263 iter/s, 4.848e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 200.131 Tflops/s, hfu: 200.131 Tflops/s, 208.021 iter/s, 4.807e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 202.607 Tflops/s, hfu: 202.607 Tflops/s, 210.594 iter/s, 4.748e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 169.861 Tflops/s, hfu: 169.861 Tflops/s, 176.557 iter/s, 5.664e-03 s/iter, (0.093, 0.000, 0.023) sec
SP=(1,8),S=(262144,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 82.555 Tflops/s, hfu: 82.555 Tflops/s, 150.167 iter/s, 6.659e-03 s/iter, (0.078, 0.000, 0.133) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.021 Tflops/s, hfu: 93.021 Tflops/s, 169.204 iter/s, 5.910e-03 s/iter, (0.068, 0.000, 0.118) sec
# stripe_flash_attn_func, fwd
mfu: 110.962 Tflops/s, hfu: 110.962 Tflops/s, 201.839 iter/s, 4.954e-03 s/iter, (0.058, 0.000, 0.099) sec
# orchestrated_attn_func
mfu: 155.634 Tflops/s, hfu: 155.634 Tflops/s, 141.548 iter/s, 7.065e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 144.501 Tflops/s, hfu: 144.501 Tflops/s, 131.423 iter/s, 7.609e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 135.995 Tflops/s, hfu: 135.995 Tflops/s, 123.687 iter/s, 8.085e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 174.767 Tflops/s, hfu: 174.767 Tflops/s, 158.949 iter/s, 6.291e-03 s/iter, (0.095, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 202.009 Tflops/s, hfu: 202.009 Tflops/s, 183.726 iter/s, 5.443e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 201.722 Tflops/s, hfu: 201.722 Tflops/s, 183.465 iter/s, 5.451e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 203.162 Tflops/s, hfu: 203.162 Tflops/s, 184.774 iter/s, 5.412e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 170.266 Tflops/s, hfu: 170.266 Tflops/s, 154.856 iter/s, 6.458e-03 s/iter, (0.099, 0.000, 0.026) sec
SP=(1,8),S=(262144,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.929 Tflops/s, hfu: 84.929 Tflops/s, 123.588 iter/s, 8.091e-03 s/iter, (0.095, 0.000, 0.162) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.027 Tflops/s, hfu: 92.027 Tflops/s, 133.917 iter/s, 7.467e-03 s/iter, (0.086, 0.000, 0.149) sec
# stripe_flash_attn_func, fwd
mfu: 118.758 Tflops/s, hfu: 118.758 Tflops/s, 172.816 iter/s, 5.787e-03 s/iter, (0.067, 0.000, 0.116) sec
# orchestrated_attn_func
mfu: 150.331 Tflops/s, hfu: 150.331 Tflops/s, 109.380 iter/s, 9.142e-03 s/iter, (0.105, 0.000, 0.037) sec
mfu: 138.844 Tflops/s, hfu: 138.844 Tflops/s, 101.022 iter/s, 9.899e-03 s/iter, (0.108, 0.000, 0.040) sec
mfu: 138.161 Tflops/s, hfu: 138.161 Tflops/s, 100.526 iter/s, 9.948e-03 s/iter, (0.110, 0.000, 0.040) sec
mfu: 176.812 Tflops/s, hfu: 176.812 Tflops/s, 128.648 iter/s, 7.773e-03 s/iter, (0.105, 0.000, 0.031) sec
# orchestrated_attn_func fused
mfu: 207.638 Tflops/s, hfu: 207.638 Tflops/s, 151.076 iter/s, 6.619e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 205.508 Tflops/s, hfu: 205.508 Tflops/s, 149.527 iter/s, 6.688e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 206.038 Tflops/s, hfu: 206.038 Tflops/s, 149.912 iter/s, 6.671e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 171.306 Tflops/s, hfu: 171.306 Tflops/s, 124.642 iter/s, 8.023e-03 s/iter, (0.103, 0.000, 0.032) sec
SP=(1,8),S=(262144,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 86.29 Tflops/s, hfu: 86.29 Tflops/s, 104.641 iter/s, 9.556e-03 s/iter, (0.112, 0.000, 0.191) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.203 Tflops/s, hfu: 93.203 Tflops/s, 113.023 iter/s, 8.848e-03 s/iter, (0.102, 0.000, 0.177) sec
# stripe_flash_attn_func, fwd
mfu: 124.249 Tflops/s, hfu: 124.249 Tflops/s, 150.671 iter/s, 6.637e-03 s/iter, (0.078, 0.000, 0.133) sec
# orchestrated_attn_func
mfu: 155.467 Tflops/s, hfu: 155.467 Tflops/s, 94.264 iter/s, 1.061e-02 s/iter, (0.111, 0.000, 0.042) sec
mfu: 142.818 Tflops/s, hfu: 142.818 Tflops/s, 86.595 iter/s, 1.155e-02 s/iter, (0.115, 0.000, 0.046) sec
mfu: 136.891 Tflops/s, hfu: 136.891 Tflops/s, 83.001 iter/s, 1.205e-02 s/iter, (0.117, 0.000, 0.048) sec
mfu: 177.194 Tflops/s, hfu: 177.194 Tflops/s, 107.438 iter/s, 9.308e-03 s/iter, (0.110, 0.000, 0.037) sec
# orchestrated_attn_func fused
mfu: 211.62 Tflops/s, hfu: 211.62 Tflops/s, 128.311 iter/s, 7.794e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 207.674 Tflops/s, hfu: 207.674 Tflops/s, 125.919 iter/s, 7.942e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 207.499 Tflops/s, hfu: 207.499 Tflops/s, 125.813 iter/s, 7.948e-03 s/iter, (0.102, 0.001, 0.032) sec
mfu: 171.692 Tflops/s, hfu: 171.692 Tflops/s, 104.102 iter/s, 9.606e-03 s/iter, (0.109, 0.000, 0.038) sec
SP=(1,8),S=(262144,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 87.484 Tflops/s, hfu: 87.484 Tflops/s, 90.932 iter/s, 1.100e-02 s/iter, (0.126, 0.000, 0.220) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.319 Tflops/s, hfu: 93.319 Tflops/s, 96.998 iter/s, 1.031e-02 s/iter, (0.118, 0.000, 0.206) sec
# stripe_flash_attn_func, fwd
mfu: 126.54 Tflops/s, hfu: 126.54 Tflops/s, 131.528 iter/s, 7.603e-03 s/iter, (0.088, 0.000, 0.152) sec
# orchestrated_attn_func
mfu: 159.292 Tflops/s, hfu: 159.292 Tflops/s, 82.786 iter/s, 1.208e-02 s/iter, (0.124, 0.000, 0.048) sec
mfu: 143.77 Tflops/s, hfu: 143.77 Tflops/s, 74.719 iter/s, 1.338e-02 s/iter, (0.122, 0.000, 0.054) sec
mfu: 136.997 Tflops/s, hfu: 136.997 Tflops/s, 71.199 iter/s, 1.405e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 177.513 Tflops/s, hfu: 177.513 Tflops/s, 92.255 iter/s, 1.084e-02 s/iter, (0.114, 0.000, 0.043) sec
# orchestrated_attn_func fused
mfu: 214.332 Tflops/s, hfu: 214.332 Tflops/s, 111.391 iter/s, 8.977e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 209.287 Tflops/s, hfu: 209.287 Tflops/s, 108.769 iter/s, 9.194e-03 s/iter, (0.108, 0.000, 0.037) sec
mfu: 208.53 Tflops/s, hfu: 208.53 Tflops/s, 108.375 iter/s, 9.227e-03 s/iter, (0.107, 0.000, 0.037) sec
mfu: 171.631 Tflops/s, hfu: 171.631 Tflops/s, 89.199 iter/s, 1.121e-02 s/iter, (0.118, 0.000, 0.045) sec
SP=(1,8),S=(262144,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 88.282 Tflops/s, hfu: 88.282 Tflops/s, 80.292 iter/s, 1.245e-02 s/iter, (0.144, 0.000, 0.249) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.572 Tflops/s, hfu: 93.572 Tflops/s, 85.104 iter/s, 1.175e-02 s/iter, (0.134, 0.000, 0.235) sec
# stripe_flash_attn_func, fwd
mfu: 128.838 Tflops/s, hfu: 128.838 Tflops/s, 117.177 iter/s, 8.534e-03 s/iter, (0.098, 0.000, 0.171) sec
# orchestrated_attn_func
mfu: 157.307 Tflops/s, hfu: 157.307 Tflops/s, 71.535 iter/s, 1.398e-02 s/iter, (0.131, 0.000, 0.056) sec
mfu: 145.472 Tflops/s, hfu: 145.472 Tflops/s, 66.153 iter/s, 1.512e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 138.638 Tflops/s, hfu: 138.638 Tflops/s, 63.045 iter/s, 1.586e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 177.616 Tflops/s, hfu: 177.616 Tflops/s, 80.770 iter/s, 1.238e-02 s/iter, (0.123, 0.000, 0.050) sec
# orchestrated_attn_func fused
mfu: 216.753 Tflops/s, hfu: 216.753 Tflops/s, 98.568 iter/s, 1.015e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 210.666 Tflops/s, hfu: 210.666 Tflops/s, 95.800 iter/s, 1.044e-02 s/iter, (0.115, 0.000, 0.042) sec
mfu: 209.029 Tflops/s, hfu: 209.029 Tflops/s, 95.055 iter/s, 1.052e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 172.07 Tflops/s, hfu: 172.07 Tflops/s, 78.248 iter/s, 1.278e-02 s/iter, (0.121, 0.000, 0.051) sec
SP=(1,8),S=(262144,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.628 Tflops/s, hfu: 89.628 Tflops/s, 65.213 iter/s, 1.533e-02 s/iter, (0.175, 0.000, 0.307) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.226 Tflops/s, hfu: 115.226 Tflops/s, 83.838 iter/s, 1.193e-02 s/iter, (0.136, 0.000, 0.239) sec
# stripe_flash_attn_func, fwd
mfu: 131.311 Tflops/s, hfu: 131.311 Tflops/s, 95.541 iter/s, 1.047e-02 s/iter, (0.121, 0.000, 0.209) sec
# orchestrated_attn_func
mfu: 155.858 Tflops/s, hfu: 155.858 Tflops/s, 56.701 iter/s, 1.764e-02 s/iter, (0.143, 0.000, 0.071) sec
mfu: 144.494 Tflops/s, hfu: 144.494 Tflops/s, 52.567 iter/s, 1.902e-02 s/iter, (0.147, 0.000, 0.076) sec
mfu: 138.83 Tflops/s, hfu: 138.83 Tflops/s, 50.506 iter/s, 1.980e-02 s/iter, (0.150, 0.000, 0.079) sec
mfu: 178.006 Tflops/s, hfu: 178.006 Tflops/s, 64.758 iter/s, 1.544e-02 s/iter, (0.136, 0.000, 0.062) sec
# orchestrated_attn_func fused
mfu: 219.267 Tflops/s, hfu: 219.267 Tflops/s, 79.769 iter/s, 1.254e-02 s/iter, (0.123, 0.000, 0.050) sec
mfu: 212.19 Tflops/s, hfu: 212.19 Tflops/s, 77.194 iter/s, 1.295e-02 s/iter, (0.125, 0.000, 0.052) sec
mfu: 209.805 Tflops/s, hfu: 209.805 Tflops/s, 76.327 iter/s, 1.310e-02 s/iter, (0.126, 0.000, 0.052) sec
mfu: 172.414 Tflops/s, hfu: 172.414 Tflops/s, 62.724 iter/s, 1.594e-02 s/iter, (0.134, 0.000, 0.064) sec
SP=(1,8),S=(262144,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.896 Tflops/s, hfu: 89.896 Tflops/s, 54.507 iter/s, 1.835e-02 s/iter, (0.207, 0.000, 0.367) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 133.251 Tflops/s, hfu: 133.251 Tflops/s, 80.794 iter/s, 1.238e-02 s/iter, (0.140, 0.000, 0.248) sec
# stripe_flash_attn_func, fwd
mfu: 130.579 Tflops/s, hfu: 130.579 Tflops/s, 79.174 iter/s, 1.263e-02 s/iter, (0.146, 0.000, 0.253) sec
# orchestrated_attn_func
mfu: 154.463 Tflops/s, hfu: 154.463 Tflops/s, 46.828 iter/s, 2.135e-02 s/iter, (0.155, 0.000, 0.085) sec
mfu: 141.892 Tflops/s, hfu: 141.892 Tflops/s, 43.017 iter/s, 2.325e-02 s/iter, (0.164, 0.000, 0.093) sec
mfu: 138.298 Tflops/s, hfu: 138.298 Tflops/s, 41.927 iter/s, 2.385e-02 s/iter, (0.165, 0.000, 0.095) sec
mfu: 178.19 Tflops/s, hfu: 178.19 Tflops/s, 54.021 iter/s, 1.851e-02 s/iter, (0.145, 0.000, 0.074) sec
# orchestrated_attn_func fused
mfu: 221.945 Tflops/s, hfu: 221.945 Tflops/s, 67.286 iter/s, 1.486e-02 s/iter, (0.129, 0.000, 0.059) sec
mfu: 213.319 Tflops/s, hfu: 213.319 Tflops/s, 64.671 iter/s, 1.546e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 210.732 Tflops/s, hfu: 210.732 Tflops/s, 63.887 iter/s, 1.565e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 172.873 Tflops/s, hfu: 172.873 Tflops/s, 52.409 iter/s, 1.908e-02 s/iter, (0.151, 0.000, 0.076) sec
SP=(1,8),S=(262144,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.664 Tflops/s, hfu: 89.664 Tflops/s, 46.600 iter/s, 2.146e-02 s/iter, (0.242, 0.000, 0.429) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 134.147 Tflops/s, hfu: 134.147 Tflops/s, 69.718 iter/s, 1.434e-02 s/iter, (0.162, 0.000, 0.287) sec
# stripe_flash_attn_func, fwd
mfu: 123.638 Tflops/s, hfu: 123.638 Tflops/s, 64.256 iter/s, 1.556e-02 s/iter, (0.175, 0.000, 0.311) sec
# orchestrated_attn_func
mfu: 162.11 Tflops/s, hfu: 162.11 Tflops/s, 42.125 iter/s, 2.374e-02 s/iter, (0.170, 0.000, 0.095) sec
mfu: 144.873 Tflops/s, hfu: 144.873 Tflops/s, 37.646 iter/s, 2.656e-02 s/iter, (0.179, 0.000, 0.106) sec
mfu: 138.452 Tflops/s, hfu: 138.452 Tflops/s, 35.978 iter/s, 2.780e-02 s/iter, (0.176, 0.000, 0.111) sec
mfu: 178.4 Tflops/s, hfu: 178.4 Tflops/s, 46.358 iter/s, 2.157e-02 s/iter, (0.157, 0.000, 0.086) sec
# orchestrated_attn_func fused
mfu: 223.198 Tflops/s, hfu: 223.198 Tflops/s, 57.999 iter/s, 1.724e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 214.24 Tflops/s, hfu: 214.24 Tflops/s, 55.671 iter/s, 1.796e-02 s/iter, (0.143, 0.000, 0.072) sec
mfu: 211.462 Tflops/s, hfu: 211.462 Tflops/s, 54.950 iter/s, 1.820e-02 s/iter, (0.143, 0.000, 0.073) sec
mfu: 172.746 Tflops/s, hfu: 172.746 Tflops/s, 44.889 iter/s, 2.228e-02 s/iter, (0.160, 0.000, 0.089) sec
SP=(1,8),S=(262144,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.868 Tflops/s, hfu: 89.868 Tflops/s, 40.867 iter/s, 2.447e-02 s/iter, (0.276, 0.000, 0.489) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 133.006 Tflops/s, hfu: 133.006 Tflops/s, 60.484 iter/s, 1.653e-02 s/iter, (0.185, 0.000, 0.331) sec
# stripe_flash_attn_func, fwd
mfu: 115.087 Tflops/s, hfu: 115.087 Tflops/s, 52.335 iter/s, 1.911e-02 s/iter, (0.214, 0.000, 0.382) sec
# orchestrated_attn_func
mfu: 161.286 Tflops/s, hfu: 161.286 Tflops/s, 36.672 iter/s, 2.727e-02 s/iter, (0.181, 0.000, 0.109) sec
mfu: 143.207 Tflops/s, hfu: 143.207 Tflops/s, 32.561 iter/s, 3.071e-02 s/iter, (0.191, 0.000, 0.123) sec
mfu: 137.971 Tflops/s, hfu: 137.971 Tflops/s, 31.371 iter/s, 3.188e-02 s/iter, (0.197, 0.000, 0.128) sec
mfu: 178.462 Tflops/s, hfu: 178.462 Tflops/s, 40.578 iter/s, 2.464e-02 s/iter, (0.170, 0.000, 0.099) sec
# orchestrated_attn_func fused
mfu: 224.742 Tflops/s, hfu: 224.742 Tflops/s, 51.100 iter/s, 1.957e-02 s/iter, (0.149, 0.000, 0.078) sec
mfu: 214.849 Tflops/s, hfu: 214.849 Tflops/s, 48.851 iter/s, 2.047e-02 s/iter, (0.155, 0.000, 0.082) sec
mfu: 211.858 Tflops/s, hfu: 211.858 Tflops/s, 48.171 iter/s, 2.076e-02 s/iter, (0.153, 0.000, 0.083) sec
mfu: 172.847 Tflops/s, hfu: 172.847 Tflops/s, 39.301 iter/s, 2.544e-02 s/iter, (0.176, 0.000, 0.102) sec
SP=(1,8),S=(262144,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.674 Tflops/s, hfu: 89.674 Tflops/s, 32.623 iter/s, 3.065e-02 s/iter, (0.341, 0.000, 0.613) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.268 Tflops/s, hfu: 131.268 Tflops/s, 47.755 iter/s, 2.094e-02 s/iter, (0.233, 0.000, 0.419) sec
# stripe_flash_attn_func, fwd
mfu: 104.959 Tflops/s, hfu: 104.959 Tflops/s, 38.184 iter/s, 2.619e-02 s/iter, (0.291, 0.000, 0.524) sec
# orchestrated_attn_func
mfu: 156.576 Tflops/s, hfu: 156.576 Tflops/s, 28.481 iter/s, 3.511e-02 s/iter, (0.216, 0.000, 0.140) sec
mfu: 145.636 Tflops/s, hfu: 145.636 Tflops/s, 26.491 iter/s, 3.775e-02 s/iter, (0.223, 0.000, 0.151) sec
mfu: 138.692 Tflops/s, hfu: 138.692 Tflops/s, 25.228 iter/s, 3.964e-02 s/iter, (0.229, 0.000, 0.159) sec
mfu: 178.651 Tflops/s, hfu: 178.651 Tflops/s, 32.496 iter/s, 3.077e-02 s/iter, (0.195, 0.000, 0.123) sec
# orchestrated_attn_func fused
mfu: 226.443 Tflops/s, hfu: 226.443 Tflops/s, 41.190 iter/s, 2.428e-02 s/iter, (0.167, 0.000, 0.097) sec
mfu: 215.83 Tflops/s, hfu: 215.83 Tflops/s, 39.259 iter/s, 2.547e-02 s/iter, (0.173, 0.000, 0.102) sec
mfu: 212.401 Tflops/s, hfu: 212.401 Tflops/s, 38.636 iter/s, 2.588e-02 s/iter, (0.173, 0.000, 0.104) sec
mfu: 172.983 Tflops/s, hfu: 172.983 Tflops/s, 31.465 iter/s, 3.178e-02 s/iter, (0.198, 0.000, 0.127) sec
SP=(1,8),S=(262144,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.432 Tflops/s, hfu: 89.432 Tflops/s, 27.113 iter/s, 3.688e-02 s/iter, (0.410, 0.000, 0.738) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 130.062 Tflops/s, hfu: 130.062 Tflops/s, 39.430 iter/s, 2.536e-02 s/iter, (0.282, 0.000, 0.507) sec
# stripe_flash_attn_func, fwd
mfu: 98.785 Tflops/s, hfu: 98.785 Tflops/s, 29.948 iter/s, 3.339e-02 s/iter, (0.370, 0.000, 0.668) sec
# orchestrated_attn_func
mfu: 154.99 Tflops/s, hfu: 154.99 Tflops/s, 23.494 iter/s, 4.256e-02 s/iter, (0.239, 0.000, 0.170) sec
mfu: 145.08 Tflops/s, hfu: 145.08 Tflops/s, 21.992 iter/s, 4.547e-02 s/iter, (0.248, 0.000, 0.182) sec
mfu: 138.901 Tflops/s, hfu: 138.901 Tflops/s, 21.055 iter/s, 4.749e-02 s/iter, (0.259, 0.000, 0.190) sec
mfu: 178.754 Tflops/s, hfu: 178.754 Tflops/s, 27.096 iter/s, 3.691e-02 s/iter, (0.222, 0.000, 0.148) sec
# orchestrated_attn_func fused
mfu: 227.917 Tflops/s, hfu: 227.917 Tflops/s, 34.548 iter/s, 2.895e-02 s/iter, (0.189, 0.000, 0.116) sec
mfu: 216.55 Tflops/s, hfu: 216.55 Tflops/s, 32.825 iter/s, 3.046e-02 s/iter, (0.193, 0.000, 0.122) sec
mfu: 212.948 Tflops/s, hfu: 212.948 Tflops/s, 32.279 iter/s, 3.098e-02 s/iter, (0.195, 0.000, 0.124) sec
mfu: 173.239 Tflops/s, hfu: 173.239 Tflops/s, 26.260 iter/s, 3.808e-02 s/iter, (0.223, 0.000, 0.152) sec
SP=(1,8),S=(262144,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.245 Tflops/s, hfu: 89.245 Tflops/s, 23.191 iter/s, 4.312e-02 s/iter, (0.478, 0.000, 0.862) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 129.224 Tflops/s, hfu: 129.224 Tflops/s, 33.580 iter/s, 2.978e-02 s/iter, (0.330, 0.000, 0.596) sec
# stripe_flash_attn_func, fwd
mfu: 94.288 Tflops/s, hfu: 94.288 Tflops/s, 24.501 iter/s, 4.081e-02 s/iter, (0.451, 0.000, 0.816) sec
# orchestrated_attn_func
mfu: 158.973 Tflops/s, hfu: 158.973 Tflops/s, 20.655 iter/s, 4.841e-02 s/iter, (0.281, 0.000, 0.194) sec
mfu: 147.99 Tflops/s, hfu: 147.99 Tflops/s, 19.228 iter/s, 5.201e-02 s/iter, (0.285, 0.000, 0.208) sec
mfu: 138.998 Tflops/s, hfu: 138.998 Tflops/s, 18.060 iter/s, 5.537e-02 s/iter, (0.292, 0.000, 0.221) sec
mfu: 178.842 Tflops/s, hfu: 178.842 Tflops/s, 23.237 iter/s, 4.304e-02 s/iter, (0.244, 0.000, 0.172) sec
# orchestrated_attn_func fused
mfu: 228.848 Tflops/s, hfu: 228.848 Tflops/s, 29.734 iter/s, 3.363e-02 s/iter, (0.205, 0.000, 0.135) sec
mfu: 217.052 Tflops/s, hfu: 217.052 Tflops/s, 28.201 iter/s, 3.546e-02 s/iter, (0.213, 0.000, 0.142) sec
mfu: 213.162 Tflops/s, hfu: 213.162 Tflops/s, 27.696 iter/s, 3.611e-02 s/iter, (0.220, 0.000, 0.144) sec
mfu: 173.143 Tflops/s, hfu: 173.143 Tflops/s, 22.496 iter/s, 4.445e-02 s/iter, (0.249, 0.000, 0.178) sec
SP=(1,8),S=(262144,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 90.541 Tflops/s, hfu: 90.541 Tflops/s, 20.587 iter/s, 4.858e-02 s/iter, (0.537, 0.000, 0.972) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 131.471 Tflops/s, hfu: 131.471 Tflops/s, 29.893 iter/s, 3.345e-02 s/iter, (0.369, 0.000, 0.669) sec
# stripe_flash_attn_func, fwd
mfu: 103.373 Tflops/s, hfu: 103.373 Tflops/s, 23.504 iter/s, 4.255e-02 s/iter, (0.459, 0.000, 0.851) sec
# orchestrated_attn_func
mfu: 153.897 Tflops/s, hfu: 153.897 Tflops/s, 17.496 iter/s, 5.716e-02 s/iter, (0.300, 0.000, 0.229) sec
mfu: 146.055 Tflops/s, hfu: 146.055 Tflops/s, 16.604 iter/s, 6.022e-02 s/iter, (0.314, 0.000, 0.241) sec
mfu: 138.372 Tflops/s, hfu: 138.372 Tflops/s, 15.731 iter/s, 6.357e-02 s/iter, (0.326, 0.000, 0.254) sec
mfu: 178.92 Tflops/s, hfu: 178.92 Tflops/s, 20.341 iter/s, 4.916e-02 s/iter, (0.272, 0.000, 0.197) sec
# orchestrated_attn_func fused
mfu: 229.569 Tflops/s, hfu: 229.569 Tflops/s, 26.099 iter/s, 3.832e-02 s/iter, (0.224, 0.000, 0.153) sec
mfu: 217.402 Tflops/s, hfu: 217.402 Tflops/s, 24.716 iter/s, 4.046e-02 s/iter, (0.233, 0.000, 0.162) sec
mfu: 213.51 Tflops/s, hfu: 213.51 Tflops/s, 24.273 iter/s, 4.120e-02 s/iter, (0.236, 0.000, 0.165) sec
mfu: 173.386 Tflops/s, hfu: 173.386 Tflops/s, 19.712 iter/s, 5.073e-02 s/iter, (0.274, 0.000, 0.203) sec
SP=(1,8),S=(327680,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.152 Tflops/s, hfu: 8.152 Tflops/s, 379.620 iter/s, 2.634e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 15.102 Tflops/s, hfu: 15.102 Tflops/s, 703.253 iter/s, 1.422e-03 s/iter, (0.017, 0.000, 0.028) sec
# stripe_flash_attn_func, fwd
mfu: 7.081 Tflops/s, hfu: 7.081 Tflops/s, 329.714 iter/s, 3.033e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 29.22 Tflops/s, hfu: 29.22 Tflops/s, 680.320 iter/s, 1.470e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 63.174 Tflops/s, hfu: 63.174 Tflops/s, 1470.882 iter/s, 6.799e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 82.95 Tflops/s, hfu: 82.95 Tflops/s, 1931.337 iter/s, 5.178e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 124.279 Tflops/s, hfu: 124.279 Tflops/s, 2893.586 iter/s, 3.456e-04 s/iter, (0.074, 0.000, 0.001) sec
# orchestrated_attn_func fused
mfu: 39.252 Tflops/s, hfu: 39.252 Tflops/s, 913.910 iter/s, 1.094e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 62.487 Tflops/s, hfu: 62.487 Tflops/s, 1454.892 iter/s, 6.873e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 93.762 Tflops/s, hfu: 93.762 Tflops/s, 2183.063 iter/s, 4.581e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 168.647 Tflops/s, hfu: 168.647 Tflops/s, 3926.619 iter/s, 2.547e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(327680,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 16.355 Tflops/s, hfu: 16.355 Tflops/s, 380.798 iter/s, 2.626e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 30.236 Tflops/s, hfu: 30.236 Tflops/s, 703.979 iter/s, 1.420e-03 s/iter, (0.017, 0.000, 0.028) sec
# stripe_flash_attn_func, fwd
mfu: 14.248 Tflops/s, hfu: 14.248 Tflops/s, 331.746 iter/s, 3.014e-03 s/iter, (0.036, 0.000, 0.060) sec
# orchestrated_attn_func
mfu: 57.831 Tflops/s, hfu: 57.831 Tflops/s, 673.241 iter/s, 1.485e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 94.812 Tflops/s, hfu: 94.812 Tflops/s, 1103.753 iter/s, 9.060e-04 s/iter, (0.077, 0.000, 0.004) sec
mfu: 106.501 Tflops/s, hfu: 106.501 Tflops/s, 1239.833 iter/s, 8.066e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 156.554 Tflops/s, hfu: 156.554 Tflops/s, 1822.529 iter/s, 5.487e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 67.66 Tflops/s, hfu: 67.66 Tflops/s, 787.670 iter/s, 1.270e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 97.189 Tflops/s, hfu: 97.189 Tflops/s, 1131.426 iter/s, 8.838e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 132.579 Tflops/s, hfu: 132.579 Tflops/s, 1543.419 iter/s, 6.479e-04 s/iter, (0.077, 0.000, 0.003) sec
mfu: 189.236 Tflops/s, hfu: 189.236 Tflops/s, 2202.993 iter/s, 4.539e-04 s/iter, (0.075, 0.000, 0.002) sec
SP=(1,8),S=(327680,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.461 Tflops/s, hfu: 24.461 Tflops/s, 379.692 iter/s, 2.634e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.917 Tflops/s, hfu: 44.917 Tflops/s, 697.197 iter/s, 1.434e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 21.171 Tflops/s, hfu: 21.171 Tflops/s, 328.611 iter/s, 3.043e-03 s/iter, (0.036, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 73.66 Tflops/s, hfu: 73.66 Tflops/s, 571.677 iter/s, 1.749e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 109.336 Tflops/s, hfu: 109.336 Tflops/s, 848.562 iter/s, 1.178e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 121.015 Tflops/s, hfu: 121.015 Tflops/s, 939.200 iter/s, 1.065e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 169.935 Tflops/s, hfu: 169.935 Tflops/s, 1318.871 iter/s, 7.582e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 88.571 Tflops/s, hfu: 88.571 Tflops/s, 687.402 iter/s, 1.455e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 122.483 Tflops/s, hfu: 122.483 Tflops/s, 950.592 iter/s, 1.052e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 155.202 Tflops/s, hfu: 155.202 Tflops/s, 1204.529 iter/s, 8.302e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 194.263 Tflops/s, hfu: 194.263 Tflops/s, 1507.677 iter/s, 6.633e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(327680,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.311 Tflops/s, hfu: 32.311 Tflops/s, 376.147 iter/s, 2.659e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.294 Tflops/s, hfu: 59.294 Tflops/s, 690.278 iter/s, 1.449e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 28.06 Tflops/s, hfu: 28.06 Tflops/s, 326.657 iter/s, 3.061e-03 s/iter, (0.037, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 92.682 Tflops/s, hfu: 92.682 Tflops/s, 539.479 iter/s, 1.854e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 124.682 Tflops/s, hfu: 124.682 Tflops/s, 725.744 iter/s, 1.378e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 124.748 Tflops/s, hfu: 124.748 Tflops/s, 726.128 iter/s, 1.377e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 182.51 Tflops/s, hfu: 182.51 Tflops/s, 1062.347 iter/s, 9.413e-04 s/iter, (0.076, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 104.38 Tflops/s, hfu: 104.38 Tflops/s, 607.572 iter/s, 1.646e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 137.056 Tflops/s, hfu: 137.056 Tflops/s, 797.769 iter/s, 1.253e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 162.491 Tflops/s, hfu: 162.491 Tflops/s, 945.823 iter/s, 1.057e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 197.688 Tflops/s, hfu: 197.688 Tflops/s, 1150.695 iter/s, 8.690e-04 s/iter, (0.076, 0.000, 0.003) sec
SP=(1,8),S=(327680,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 40.339 Tflops/s, hfu: 40.339 Tflops/s, 375.687 iter/s, 2.662e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 72.353 Tflops/s, hfu: 72.353 Tflops/s, 673.838 iter/s, 1.484e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 34.343 Tflops/s, hfu: 34.343 Tflops/s, 319.844 iter/s, 3.127e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 105.386 Tflops/s, hfu: 105.386 Tflops/s, 490.743 iter/s, 2.038e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 134.83 Tflops/s, hfu: 134.83 Tflops/s, 627.850 iter/s, 1.593e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 132.509 Tflops/s, hfu: 132.509 Tflops/s, 617.043 iter/s, 1.621e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 183.531 Tflops/s, hfu: 183.531 Tflops/s, 854.631 iter/s, 1.170e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 117.766 Tflops/s, hfu: 117.766 Tflops/s, 548.390 iter/s, 1.824e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 146.914 Tflops/s, hfu: 146.914 Tflops/s, 684.122 iter/s, 1.462e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 172.376 Tflops/s, hfu: 172.376 Tflops/s, 802.687 iter/s, 1.246e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 201.881 Tflops/s, hfu: 201.881 Tflops/s, 940.083 iter/s, 1.064e-03 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(327680,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.335 Tflops/s, hfu: 48.335 Tflops/s, 375.126 iter/s, 2.666e-03 s/iter, (0.036, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 84.884 Tflops/s, hfu: 84.884 Tflops/s, 658.788 iter/s, 1.518e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 41.484 Tflops/s, hfu: 41.484 Tflops/s, 321.959 iter/s, 3.106e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 119.674 Tflops/s, hfu: 119.674 Tflops/s, 464.396 iter/s, 2.153e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 138.175 Tflops/s, hfu: 138.175 Tflops/s, 536.191 iter/s, 1.865e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 135.588 Tflops/s, hfu: 135.588 Tflops/s, 526.152 iter/s, 1.901e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 191.114 Tflops/s, hfu: 191.114 Tflops/s, 741.620 iter/s, 1.348e-03 s/iter, (0.075, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 128.114 Tflops/s, hfu: 128.114 Tflops/s, 497.146 iter/s, 2.011e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 157.499 Tflops/s, hfu: 157.499 Tflops/s, 611.178 iter/s, 1.636e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 179.597 Tflops/s, hfu: 179.597 Tflops/s, 696.926 iter/s, 1.435e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 203.976 Tflops/s, hfu: 203.976 Tflops/s, 791.530 iter/s, 1.263e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(327680,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.715 Tflops/s, hfu: 55.715 Tflops/s, 370.636 iter/s, 2.698e-03 s/iter, (0.039, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 89.822 Tflops/s, hfu: 89.822 Tflops/s, 597.522 iter/s, 1.674e-03 s/iter, (0.021, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 48.146 Tflops/s, hfu: 48.146 Tflops/s, 320.282 iter/s, 3.122e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 131.26 Tflops/s, hfu: 131.26 Tflops/s, 436.590 iter/s, 2.290e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 140.591 Tflops/s, hfu: 140.591 Tflops/s, 467.627 iter/s, 2.138e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 145.139 Tflops/s, hfu: 145.139 Tflops/s, 482.756 iter/s, 2.071e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 189.745 Tflops/s, hfu: 189.745 Tflops/s, 631.122 iter/s, 1.584e-03 s/iter, (0.078, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 136.81 Tflops/s, hfu: 136.81 Tflops/s, 455.052 iter/s, 2.198e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 165.115 Tflops/s, hfu: 165.115 Tflops/s, 549.197 iter/s, 1.821e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 185.685 Tflops/s, hfu: 185.685 Tflops/s, 617.616 iter/s, 1.619e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 206.895 Tflops/s, hfu: 206.895 Tflops/s, 688.163 iter/s, 1.453e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(327680,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.338 Tflops/s, hfu: 63.338 Tflops/s, 368.675 iter/s, 2.712e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 91.553 Tflops/s, hfu: 91.553 Tflops/s, 532.911 iter/s, 1.876e-03 s/iter, (0.025, 0.000, 0.038) sec
# stripe_flash_attn_func, fwd
mfu: 54.598 Tflops/s, hfu: 54.598 Tflops/s, 317.800 iter/s, 3.147e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 137.779 Tflops/s, hfu: 137.779 Tflops/s, 400.989 iter/s, 2.494e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 141.895 Tflops/s, hfu: 141.895 Tflops/s, 412.969 iter/s, 2.421e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 138.846 Tflops/s, hfu: 138.846 Tflops/s, 404.094 iter/s, 2.475e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 185.695 Tflops/s, hfu: 185.695 Tflops/s, 540.442 iter/s, 1.850e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 144.503 Tflops/s, hfu: 144.503 Tflops/s, 420.560 iter/s, 2.378e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 170.714 Tflops/s, hfu: 170.714 Tflops/s, 496.844 iter/s, 2.013e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 189.681 Tflops/s, hfu: 189.681 Tflops/s, 552.045 iter/s, 1.811e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 207.351 Tflops/s, hfu: 207.351 Tflops/s, 603.471 iter/s, 1.657e-03 s/iter, (0.080, 0.000, 0.007) sec
SP=(1,8),S=(327680,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.75 Tflops/s, hfu: 71.75 Tflops/s, 334.113 iter/s, 2.993e-03 s/iter, (0.042, 0.000, 0.060) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 97.437 Tflops/s, hfu: 97.437 Tflops/s, 453.728 iter/s, 2.204e-03 s/iter, (0.026, 0.000, 0.044) sec
# stripe_flash_attn_func, fwd
mfu: 68.842 Tflops/s, hfu: 68.842 Tflops/s, 320.569 iter/s, 3.119e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 150.012 Tflops/s, hfu: 150.012 Tflops/s, 349.273 iter/s, 2.863e-03 s/iter, (0.091, 0.000, 0.011) sec
mfu: 139.741 Tflops/s, hfu: 139.741 Tflops/s, 325.359 iter/s, 3.074e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 150.578 Tflops/s, hfu: 150.578 Tflops/s, 350.593 iter/s, 2.852e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 195.819 Tflops/s, hfu: 195.819 Tflops/s, 455.927 iter/s, 2.193e-03 s/iter, (0.078, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 156.461 Tflops/s, hfu: 156.461 Tflops/s, 364.289 iter/s, 2.745e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 180.246 Tflops/s, hfu: 180.246 Tflops/s, 419.667 iter/s, 2.383e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 195.964 Tflops/s, hfu: 195.964 Tflops/s, 456.264 iter/s, 2.192e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 208.856 Tflops/s, hfu: 208.856 Tflops/s, 486.281 iter/s, 2.056e-03 s/iter, (0.079, 0.000, 0.008) sec
SP=(1,8),S=(327680,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.866 Tflops/s, hfu: 76.866 Tflops/s, 298.279 iter/s, 3.353e-03 s/iter, (0.046, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.993 Tflops/s, hfu: 100.993 Tflops/s, 391.905 iter/s, 2.552e-03 s/iter, (0.030, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 82.183 Tflops/s, hfu: 82.183 Tflops/s, 318.912 iter/s, 3.136e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 157.019 Tflops/s, hfu: 157.019 Tflops/s, 304.657 iter/s, 3.282e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 153.584 Tflops/s, hfu: 153.584 Tflops/s, 297.993 iter/s, 3.356e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 143.889 Tflops/s, hfu: 143.889 Tflops/s, 279.182 iter/s, 3.582e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 198.304 Tflops/s, hfu: 198.304 Tflops/s, 384.760 iter/s, 2.599e-03 s/iter, (0.080, 0.000, 0.010) sec
# orchestrated_attn_func fused
mfu: 165.599 Tflops/s, hfu: 165.599 Tflops/s, 321.304 iter/s, 3.112e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 187.374 Tflops/s, hfu: 187.374 Tflops/s, 363.554 iter/s, 2.751e-03 s/iter, (0.091, 0.000, 0.011) sec
mfu: 200.593 Tflops/s, hfu: 200.593 Tflops/s, 389.201 iter/s, 2.569e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 210.38 Tflops/s, hfu: 210.38 Tflops/s, 408.191 iter/s, 2.450e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(327680,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.197 Tflops/s, hfu: 81.197 Tflops/s, 270.072 iter/s, 3.703e-03 s/iter, (0.057, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.674 Tflops/s, hfu: 108.674 Tflops/s, 361.467 iter/s, 2.767e-03 s/iter, (0.034, 0.000, 0.055) sec
# stripe_flash_attn_func, fwd
mfu: 95.199 Tflops/s, hfu: 95.199 Tflops/s, 316.646 iter/s, 3.158e-03 s/iter, (0.041, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 167.452 Tflops/s, hfu: 167.452 Tflops/s, 278.485 iter/s, 3.591e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 151.662 Tflops/s, hfu: 151.662 Tflops/s, 252.225 iter/s, 3.965e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 141.911 Tflops/s, hfu: 141.911 Tflops/s, 236.009 iter/s, 4.237e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 202.146 Tflops/s, hfu: 202.146 Tflops/s, 336.184 iter/s, 2.975e-03 s/iter, (0.082, 0.000, 0.012) sec
# orchestrated_attn_func fused
mfu: 172.747 Tflops/s, hfu: 172.747 Tflops/s, 287.291 iter/s, 3.481e-03 s/iter, (0.088, 0.000, 0.014) sec
mfu: 192.154 Tflops/s, hfu: 192.154 Tflops/s, 319.567 iter/s, 3.129e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 202.925 Tflops/s, hfu: 202.925 Tflops/s, 337.479 iter/s, 2.963e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 210.724 Tflops/s, hfu: 210.724 Tflops/s, 350.449 iter/s, 2.853e-03 s/iter, (0.086, 0.000, 0.011) sec
SP=(1,8),S=(327680,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.752 Tflops/s, hfu: 84.752 Tflops/s, 246.662 iter/s, 4.054e-03 s/iter, (0.054, 0.000, 0.081) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.385 Tflops/s, hfu: 108.385 Tflops/s, 315.442 iter/s, 3.170e-03 s/iter, (0.038, 0.000, 0.063) sec
# stripe_flash_attn_func, fwd
mfu: 105.526 Tflops/s, hfu: 105.526 Tflops/s, 307.122 iter/s, 3.256e-03 s/iter, (0.043, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 172.731 Tflops/s, hfu: 172.731 Tflops/s, 251.356 iter/s, 3.978e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 157.32 Tflops/s, hfu: 157.32 Tflops/s, 228.931 iter/s, 4.368e-03 s/iter, (0.091, 0.000, 0.017) sec
mfu: 153.631 Tflops/s, hfu: 153.631 Tflops/s, 223.563 iter/s, 4.473e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 202.323 Tflops/s, hfu: 202.323 Tflops/s, 294.418 iter/s, 3.397e-03 s/iter, (0.083, 0.000, 0.014) sec
# orchestrated_attn_func fused
mfu: 178.271 Tflops/s, hfu: 178.271 Tflops/s, 259.418 iter/s, 3.855e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 196.112 Tflops/s, hfu: 196.112 Tflops/s, 285.380 iter/s, 3.504e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 206.015 Tflops/s, hfu: 206.015 Tflops/s, 299.791 iter/s, 3.336e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 209.497 Tflops/s, hfu: 209.497 Tflops/s, 304.858 iter/s, 3.280e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(327680,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 90.833 Tflops/s, hfu: 90.833 Tflops/s, 211.487 iter/s, 4.728e-03 s/iter, (0.060, 0.000, 0.095) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.232 Tflops/s, hfu: 111.232 Tflops/s, 258.981 iter/s, 3.861e-03 s/iter, (0.045, 0.000, 0.077) sec
# stripe_flash_attn_func, fwd
mfu: 115.467 Tflops/s, hfu: 115.467 Tflops/s, 268.842 iter/s, 3.720e-03 s/iter, (0.045, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 169.937 Tflops/s, hfu: 169.937 Tflops/s, 197.833 iter/s, 5.055e-03 s/iter, (0.089, 0.000, 0.020) sec
mfu: 164.082 Tflops/s, hfu: 164.082 Tflops/s, 191.017 iter/s, 5.235e-03 s/iter, (0.095, 0.000, 0.021) sec
mfu: 153.951 Tflops/s, hfu: 153.951 Tflops/s, 179.223 iter/s, 5.580e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 200.9 Tflops/s, hfu: 200.9 Tflops/s, 233.878 iter/s, 4.276e-03 s/iter, (0.087, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 186.958 Tflops/s, hfu: 186.958 Tflops/s, 217.648 iter/s, 4.595e-03 s/iter, (0.091, 0.000, 0.018) sec
mfu: 201.893 Tflops/s, hfu: 201.893 Tflops/s, 235.034 iter/s, 4.255e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 209.424 Tflops/s, hfu: 209.424 Tflops/s, 243.801 iter/s, 4.102e-03 s/iter, (0.090, 0.000, 0.016) sec
mfu: 209.558 Tflops/s, hfu: 209.558 Tflops/s, 243.958 iter/s, 4.099e-03 s/iter, (0.086, 0.000, 0.016) sec
SP=(1,8),S=(327680,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 94.602 Tflops/s, hfu: 94.602 Tflops/s, 183.551 iter/s, 5.448e-03 s/iter, (0.067, 0.000, 0.109) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.08 Tflops/s, hfu: 114.08 Tflops/s, 221.345 iter/s, 4.518e-03 s/iter, (0.054, 0.000, 0.090) sec
# stripe_flash_attn_func, fwd
mfu: 123.17 Tflops/s, hfu: 123.17 Tflops/s, 238.981 iter/s, 4.184e-03 s/iter, (0.051, 0.000, 0.084) sec
# orchestrated_attn_func
mfu: 185.403 Tflops/s, hfu: 185.403 Tflops/s, 179.864 iter/s, 5.560e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 159.216 Tflops/s, hfu: 159.216 Tflops/s, 154.460 iter/s, 6.474e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 140.861 Tflops/s, hfu: 140.861 Tflops/s, 136.653 iter/s, 7.318e-03 s/iter, (0.098, 0.000, 0.029) sec
mfu: 196.431 Tflops/s, hfu: 196.431 Tflops/s, 190.563 iter/s, 5.248e-03 s/iter, (0.094, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 193.275 Tflops/s, hfu: 193.275 Tflops/s, 187.502 iter/s, 5.333e-03 s/iter, (0.094, 0.000, 0.021) sec
mfu: 205.958 Tflops/s, hfu: 205.958 Tflops/s, 199.805 iter/s, 5.005e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 211.845 Tflops/s, hfu: 211.845 Tflops/s, 205.517 iter/s, 4.866e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 211.657 Tflops/s, hfu: 211.657 Tflops/s, 205.334 iter/s, 4.870e-03 s/iter, (0.090, 0.000, 0.019) sec
SP=(1,8),S=(327680,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 97.695 Tflops/s, hfu: 97.695 Tflops/s, 162.475 iter/s, 6.155e-03 s/iter, (0.075, 0.000, 0.123) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.494 Tflops/s, hfu: 113.494 Tflops/s, 188.750 iter/s, 5.298e-03 s/iter, (0.062, 0.000, 0.106) sec
# stripe_flash_attn_func, fwd
mfu: 128.736 Tflops/s, hfu: 128.736 Tflops/s, 214.098 iter/s, 4.671e-03 s/iter, (0.055, 0.000, 0.093) sec
# orchestrated_attn_func
mfu: 192.267 Tflops/s, hfu: 192.267 Tflops/s, 159.878 iter/s, 6.255e-03 s/iter, (0.097, 0.000, 0.025) sec
mfu: 160.189 Tflops/s, hfu: 160.189 Tflops/s, 133.203 iter/s, 7.507e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 152.223 Tflops/s, hfu: 152.223 Tflops/s, 126.579 iter/s, 7.900e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 207.261 Tflops/s, hfu: 207.261 Tflops/s, 172.346 iter/s, 5.802e-03 s/iter, (0.096, 0.000, 0.023) sec
# orchestrated_attn_func fused
mfu: 197.126 Tflops/s, hfu: 197.126 Tflops/s, 163.917 iter/s, 6.101e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 208.801 Tflops/s, hfu: 208.801 Tflops/s, 173.626 iter/s, 5.759e-03 s/iter, (0.094, 0.000, 0.023) sec
mfu: 213.068 Tflops/s, hfu: 213.068 Tflops/s, 177.175 iter/s, 5.644e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 211.732 Tflops/s, hfu: 211.732 Tflops/s, 176.063 iter/s, 5.680e-03 s/iter, (0.093, 0.000, 0.023) sec
SP=(1,8),S=(327680,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.915 Tflops/s, hfu: 99.915 Tflops/s, 145.395 iter/s, 6.878e-03 s/iter, (0.084, 0.000, 0.138) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.126 Tflops/s, hfu: 114.126 Tflops/s, 166.075 iter/s, 6.021e-03 s/iter, (0.070, 0.000, 0.120) sec
# stripe_flash_attn_func, fwd
mfu: 133.977 Tflops/s, hfu: 133.977 Tflops/s, 194.962 iter/s, 5.129e-03 s/iter, (0.060, 0.000, 0.103) sec
# orchestrated_attn_func
mfu: 175.342 Tflops/s, hfu: 175.342 Tflops/s, 127.578 iter/s, 7.838e-03 s/iter, (0.103, 0.000, 0.031) sec
mfu: 158.325 Tflops/s, hfu: 158.325 Tflops/s, 115.196 iter/s, 8.681e-03 s/iter, (0.106, 0.000, 0.035) sec
mfu: 152.375 Tflops/s, hfu: 152.375 Tflops/s, 110.868 iter/s, 9.020e-03 s/iter, (0.105, 0.000, 0.036) sec
mfu: 202.011 Tflops/s, hfu: 202.011 Tflops/s, 146.983 iter/s, 6.804e-03 s/iter, (0.097, 0.000, 0.027) sec
# orchestrated_attn_func fused
mfu: 201.333 Tflops/s, hfu: 201.333 Tflops/s, 146.489 iter/s, 6.826e-03 s/iter, (0.100, 0.000, 0.027) sec
mfu: 211.023 Tflops/s, hfu: 211.023 Tflops/s, 153.540 iter/s, 6.513e-03 s/iter, (0.101, 0.000, 0.026) sec
mfu: 214.937 Tflops/s, hfu: 214.937 Tflops/s, 156.387 iter/s, 6.394e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 212.76 Tflops/s, hfu: 212.76 Tflops/s, 154.804 iter/s, 6.460e-03 s/iter, (0.099, 0.000, 0.026) sec
SP=(1,8),S=(327680,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 103.41 Tflops/s, hfu: 103.41 Tflops/s, 120.385 iter/s, 8.307e-03 s/iter, (0.098, 0.000, 0.166) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.641 Tflops/s, hfu: 116.641 Tflops/s, 135.789 iter/s, 7.364e-03 s/iter, (0.088, 0.000, 0.147) sec
# stripe_flash_attn_func, fwd
mfu: 141.005 Tflops/s, hfu: 141.005 Tflops/s, 164.152 iter/s, 6.092e-03 s/iter, (0.071, 0.000, 0.122) sec
# orchestrated_attn_func
mfu: 173.81 Tflops/s, hfu: 173.81 Tflops/s, 101.171 iter/s, 9.884e-03 s/iter, (0.115, 0.000, 0.040) sec
mfu: 155.644 Tflops/s, hfu: 155.644 Tflops/s, 90.597 iter/s, 1.104e-02 s/iter, (0.117, 0.000, 0.044) sec
mfu: 148.68 Tflops/s, hfu: 148.68 Tflops/s, 86.543 iter/s, 1.155e-02 s/iter, (0.115, 0.000, 0.046) sec
mfu: 207.475 Tflops/s, hfu: 207.475 Tflops/s, 120.766 iter/s, 8.280e-03 s/iter, (0.107, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 206.8 Tflops/s, hfu: 206.8 Tflops/s, 120.374 iter/s, 8.307e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 214.555 Tflops/s, hfu: 214.555 Tflops/s, 124.887 iter/s, 8.007e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 216.593 Tflops/s, hfu: 216.593 Tflops/s, 126.074 iter/s, 7.932e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 213.552 Tflops/s, hfu: 213.552 Tflops/s, 124.304 iter/s, 8.045e-03 s/iter, (0.103, 0.000, 0.032) sec
SP=(1,8),S=(327680,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.443 Tflops/s, hfu: 104.443 Tflops/s, 101.323 iter/s, 9.869e-03 s/iter, (0.117, 0.000, 0.197) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.004 Tflops/s, hfu: 117.004 Tflops/s, 113.508 iter/s, 8.810e-03 s/iter, (0.101, 0.000, 0.176) sec
# stripe_flash_attn_func, fwd
mfu: 146.086 Tflops/s, hfu: 146.086 Tflops/s, 141.722 iter/s, 7.056e-03 s/iter, (0.082, 0.000, 0.141) sec
# orchestrated_attn_func
mfu: 167.646 Tflops/s, hfu: 167.646 Tflops/s, 81.319 iter/s, 1.230e-02 s/iter, (0.119, 0.000, 0.049) sec
mfu: 154.373 Tflops/s, hfu: 154.373 Tflops/s, 74.881 iter/s, 1.335e-02 s/iter, (0.125, 0.000, 0.053) sec
mfu: 142.425 Tflops/s, hfu: 142.425 Tflops/s, 69.085 iter/s, 1.447e-02 s/iter, (0.125, 0.000, 0.058) sec
mfu: 208.183 Tflops/s, hfu: 208.183 Tflops/s, 100.982 iter/s, 9.903e-03 s/iter, (0.113, 0.000, 0.040) sec
# orchestrated_attn_func fused
mfu: 210.824 Tflops/s, hfu: 210.824 Tflops/s, 102.263 iter/s, 9.779e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 216.827 Tflops/s, hfu: 216.827 Tflops/s, 105.175 iter/s, 9.508e-03 s/iter, (0.109, 0.000, 0.038) sec
mfu: 218.268 Tflops/s, hfu: 218.268 Tflops/s, 105.874 iter/s, 9.445e-03 s/iter, (0.107, 0.000, 0.038) sec
mfu: 214.329 Tflops/s, hfu: 214.329 Tflops/s, 103.963 iter/s, 9.619e-03 s/iter, (0.109, 0.000, 0.038) sec
SP=(1,8),S=(327680,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 106.493 Tflops/s, hfu: 106.493 Tflops/s, 88.553 iter/s, 1.129e-02 s/iter, (0.131, 0.000, 0.226) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.527 Tflops/s, hfu: 116.527 Tflops/s, 96.896 iter/s, 1.032e-02 s/iter, (0.119, 0.000, 0.206) sec
# stripe_flash_attn_func, fwd
mfu: 148.225 Tflops/s, hfu: 148.225 Tflops/s, 123.254 iter/s, 8.113e-03 s/iter, (0.093, 0.000, 0.162) sec
# orchestrated_attn_func
mfu: 167.299 Tflops/s, hfu: 167.299 Tflops/s, 69.558 iter/s, 1.438e-02 s/iter, (0.128, 0.000, 0.058) sec
mfu: 153.739 Tflops/s, hfu: 153.739 Tflops/s, 63.920 iter/s, 1.564e-02 s/iter, (0.129, 0.000, 0.063) sec
mfu: 150.676 Tflops/s, hfu: 150.676 Tflops/s, 62.646 iter/s, 1.596e-02 s/iter, (0.135, 0.000, 0.064) sec
mfu: 207.722 Tflops/s, hfu: 207.722 Tflops/s, 86.364 iter/s, 1.158e-02 s/iter, (0.119, 0.000, 0.046) sec
# orchestrated_attn_func fused
mfu: 213.457 Tflops/s, hfu: 213.457 Tflops/s, 88.749 iter/s, 1.127e-02 s/iter, (0.115, 0.000, 0.045) sec
mfu: 218.189 Tflops/s, hfu: 218.189 Tflops/s, 90.716 iter/s, 1.102e-02 s/iter, (0.115, 0.000, 0.044) sec
mfu: 218.315 Tflops/s, hfu: 218.315 Tflops/s, 90.769 iter/s, 1.102e-02 s/iter, (0.114, 0.000, 0.044) sec
mfu: 213.987 Tflops/s, hfu: 213.987 Tflops/s, 88.969 iter/s, 1.124e-02 s/iter, (0.118, 0.000, 0.045) sec
SP=(1,8),S=(327680,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 107.587 Tflops/s, hfu: 107.587 Tflops/s, 78.280 iter/s, 1.277e-02 s/iter, (0.145, 0.000, 0.255) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.408 Tflops/s, hfu: 116.408 Tflops/s, 84.698 iter/s, 1.181e-02 s/iter, (0.137, 0.000, 0.236) sec
# stripe_flash_attn_func, fwd
mfu: 150.324 Tflops/s, hfu: 150.324 Tflops/s, 109.375 iter/s, 9.143e-03 s/iter, (0.105, 0.000, 0.183) sec
# orchestrated_attn_func
mfu: 168.358 Tflops/s, hfu: 168.358 Tflops/s, 61.248 iter/s, 1.633e-02 s/iter, (0.138, 0.000, 0.065) sec
mfu: 162.488 Tflops/s, hfu: 162.488 Tflops/s, 59.113 iter/s, 1.692e-02 s/iter, (0.140, 0.000, 0.068) sec
mfu: 157.327 Tflops/s, hfu: 157.327 Tflops/s, 57.235 iter/s, 1.747e-02 s/iter, (0.139, 0.000, 0.070) sec
mfu: 209.887 Tflops/s, hfu: 209.887 Tflops/s, 76.356 iter/s, 1.310e-02 s/iter, (0.123, 0.000, 0.052) sec
# orchestrated_attn_func fused
mfu: 215.549 Tflops/s, hfu: 215.549 Tflops/s, 78.416 iter/s, 1.275e-02 s/iter, (0.122, 0.000, 0.051) sec
mfu: 219.285 Tflops/s, hfu: 219.285 Tflops/s, 79.775 iter/s, 1.254e-02 s/iter, (0.121, 0.000, 0.050) sec
mfu: 219.784 Tflops/s, hfu: 219.784 Tflops/s, 79.957 iter/s, 1.251e-02 s/iter, (0.121, 0.000, 0.050) sec
mfu: 214.538 Tflops/s, hfu: 214.538 Tflops/s, 78.049 iter/s, 1.281e-02 s/iter, (0.122, 0.000, 0.051) sec
SP=(1,8),S=(327680,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 108.6 Tflops/s, hfu: 108.6 Tflops/s, 63.213 iter/s, 1.582e-02 s/iter, (0.180, 0.000, 0.316) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.797 Tflops/s, hfu: 115.797 Tflops/s, 67.403 iter/s, 1.484e-02 s/iter, (0.166, 0.000, 0.297) sec
# stripe_flash_attn_func, fwd
mfu: 155.782 Tflops/s, hfu: 155.782 Tflops/s, 90.677 iter/s, 1.103e-02 s/iter, (0.128, 0.000, 0.221) sec
# orchestrated_attn_func
mfu: 167.964 Tflops/s, hfu: 167.964 Tflops/s, 48.884 iter/s, 2.046e-02 s/iter, (0.153, 0.000, 0.082) sec
mfu: 160.688 Tflops/s, hfu: 160.688 Tflops/s, 46.766 iter/s, 2.138e-02 s/iter, (0.157, 0.000, 0.086) sec
mfu: 148.202 Tflops/s, hfu: 148.202 Tflops/s, 43.132 iter/s, 2.318e-02 s/iter, (0.162, 0.000, 0.093) sec
mfu: 211.047 Tflops/s, hfu: 211.047 Tflops/s, 61.423 iter/s, 1.628e-02 s/iter, (0.142, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 218.76 Tflops/s, hfu: 218.76 Tflops/s, 63.668 iter/s, 1.571e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 221.354 Tflops/s, hfu: 221.354 Tflops/s, 64.423 iter/s, 1.552e-02 s/iter, (0.133, 0.000, 0.062) sec
mfu: 221.01 Tflops/s, hfu: 221.01 Tflops/s, 64.322 iter/s, 1.555e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 214.819 Tflops/s, hfu: 214.819 Tflops/s, 62.520 iter/s, 1.599e-02 s/iter, (0.134, 0.000, 0.064) sec
SP=(1,8),S=(327680,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 110.064 Tflops/s, hfu: 110.064 Tflops/s, 53.388 iter/s, 1.873e-02 s/iter, (0.210, 0.000, 0.375) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 136.79 Tflops/s, hfu: 136.79 Tflops/s, 66.352 iter/s, 1.507e-02 s/iter, (0.170, 0.000, 0.301) sec
# stripe_flash_attn_func, fwd
mfu: 156.677 Tflops/s, hfu: 156.677 Tflops/s, 75.999 iter/s, 1.316e-02 s/iter, (0.150, 0.000, 0.263) sec
# orchestrated_attn_func
mfu: 166.862 Tflops/s, hfu: 166.862 Tflops/s, 40.469 iter/s, 2.471e-02 s/iter, (0.175, 0.000, 0.099) sec
mfu: 162.839 Tflops/s, hfu: 162.839 Tflops/s, 39.494 iter/s, 2.532e-02 s/iter, (0.176, 0.000, 0.101) sec
mfu: 150.885 Tflops/s, hfu: 150.885 Tflops/s, 36.594 iter/s, 2.733e-02 s/iter, (0.173, 0.000, 0.109) sec
mfu: 208.273 Tflops/s, hfu: 208.273 Tflops/s, 50.513 iter/s, 1.980e-02 s/iter, (0.152, 0.000, 0.079) sec
# orchestrated_attn_func fused
mfu: 220.247 Tflops/s, hfu: 220.247 Tflops/s, 53.417 iter/s, 1.872e-02 s/iter, (0.149, 0.000, 0.075) sec
mfu: 222.454 Tflops/s, hfu: 222.454 Tflops/s, 53.952 iter/s, 1.853e-02 s/iter, (0.145, 0.000, 0.074) sec
mfu: 221.367 Tflops/s, hfu: 221.367 Tflops/s, 53.689 iter/s, 1.863e-02 s/iter, (0.145, 0.000, 0.075) sec
mfu: 215.421 Tflops/s, hfu: 215.421 Tflops/s, 52.246 iter/s, 1.914e-02 s/iter, (0.148, 0.000, 0.077) sec
SP=(1,8),S=(327680,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 110.007 Tflops/s, hfu: 110.007 Tflops/s, 45.737 iter/s, 2.186e-02 s/iter, (0.246, 0.000, 0.437) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 154.085 Tflops/s, hfu: 154.085 Tflops/s, 64.064 iter/s, 1.561e-02 s/iter, (0.174, 0.000, 0.312) sec
# stripe_flash_attn_func, fwd
mfu: 151.919 Tflops/s, hfu: 151.919 Tflops/s, 63.163 iter/s, 1.583e-02 s/iter, (0.178, 0.000, 0.317) sec
# orchestrated_attn_func
mfu: 170.719 Tflops/s, hfu: 170.719 Tflops/s, 35.490 iter/s, 2.818e-02 s/iter, (0.193, 0.000, 0.113) sec
mfu: 156.156 Tflops/s, hfu: 156.156 Tflops/s, 32.462 iter/s, 3.080e-02 s/iter, (0.193, 0.000, 0.123) sec
mfu: 152.346 Tflops/s, hfu: 152.346 Tflops/s, 31.670 iter/s, 3.158e-02 s/iter, (0.207, 0.000, 0.126) sec
mfu: 213.004 Tflops/s, hfu: 213.004 Tflops/s, 44.280 iter/s, 2.258e-02 s/iter, (0.166, 0.000, 0.090) sec
# orchestrated_attn_func fused
mfu: 222.223 Tflops/s, hfu: 222.223 Tflops/s, 46.197 iter/s, 2.165e-02 s/iter, (0.160, 0.000, 0.087) sec
mfu: 223.625 Tflops/s, hfu: 223.625 Tflops/s, 46.488 iter/s, 2.151e-02 s/iter, (0.157, 0.000, 0.086) sec
mfu: 222.172 Tflops/s, hfu: 222.172 Tflops/s, 46.186 iter/s, 2.165e-02 s/iter, (0.157, 0.000, 0.087) sec
mfu: 215.593 Tflops/s, hfu: 215.593 Tflops/s, 44.818 iter/s, 2.231e-02 s/iter, (0.163, 0.000, 0.089) sec
SP=(1,8),S=(327680,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 109.227 Tflops/s, hfu: 109.227 Tflops/s, 39.737 iter/s, 2.517e-02 s/iter, (0.282, 0.000, 0.503) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 165.248 Tflops/s, hfu: 165.248 Tflops/s, 60.117 iter/s, 1.663e-02 s/iter, (0.185, 0.000, 0.333) sec
# stripe_flash_attn_func, fwd
mfu: 142.411 Tflops/s, hfu: 142.411 Tflops/s, 51.809 iter/s, 1.930e-02 s/iter, (0.216, 0.000, 0.386) sec
# orchestrated_attn_func
mfu: 166.409 Tflops/s, hfu: 166.409 Tflops/s, 30.270 iter/s, 3.304e-02 s/iter, (0.208, 0.000, 0.132) sec
mfu: 162.63 Tflops/s, hfu: 162.63 Tflops/s, 29.582 iter/s, 3.380e-02 s/iter, (0.208, 0.000, 0.135) sec
mfu: 161.088 Tflops/s, hfu: 161.088 Tflops/s, 29.302 iter/s, 3.413e-02 s/iter, (0.207, 0.000, 0.137) sec
mfu: 221.889 Tflops/s, hfu: 221.889 Tflops/s, 40.361 iter/s, 2.478e-02 s/iter, (0.175, 0.000, 0.099) sec
# orchestrated_attn_func fused
mfu: 223.287 Tflops/s, hfu: 223.287 Tflops/s, 40.616 iter/s, 2.462e-02 s/iter, (0.169, 0.000, 0.098) sec
mfu: 224.307 Tflops/s, hfu: 224.307 Tflops/s, 40.801 iter/s, 2.451e-02 s/iter, (0.172, 0.000, 0.098) sec
mfu: 222.752 Tflops/s, hfu: 222.752 Tflops/s, 40.518 iter/s, 2.468e-02 s/iter, (0.170, 0.000, 0.099) sec
mfu: 215.505 Tflops/s, hfu: 215.505 Tflops/s, 39.200 iter/s, 2.551e-02 s/iter, (0.172, 0.000, 0.102) sec
SP=(1,8),S=(327680,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 108.917 Tflops/s, hfu: 108.917 Tflops/s, 31.699 iter/s, 3.155e-02 s/iter, (0.345, 0.000, 0.631) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 163.239 Tflops/s, hfu: 163.239 Tflops/s, 47.509 iter/s, 2.105e-02 s/iter, (0.234, 0.000, 0.421) sec
# stripe_flash_attn_func, fwd
mfu: 129.985 Tflops/s, hfu: 129.985 Tflops/s, 37.831 iter/s, 2.643e-02 s/iter, (0.294, 0.000, 0.529) sec
# orchestrated_attn_func
mfu: 166.024 Tflops/s, hfu: 166.024 Tflops/s, 24.160 iter/s, 4.139e-02 s/iter, (0.232, 0.000, 0.166) sec
mfu: 160.048 Tflops/s, hfu: 160.048 Tflops/s, 23.290 iter/s, 4.294e-02 s/iter, (0.239, 0.000, 0.172) sec
mfu: 165.796 Tflops/s, hfu: 165.796 Tflops/s, 24.126 iter/s, 4.145e-02 s/iter, (0.248, 0.000, 0.166) sec
mfu: 222.249 Tflops/s, hfu: 222.249 Tflops/s, 32.342 iter/s, 3.092e-02 s/iter, (0.204, 0.000, 0.124) sec
# orchestrated_attn_func fused
mfu: 225.295 Tflops/s, hfu: 225.295 Tflops/s, 32.785 iter/s, 3.050e-02 s/iter, (0.192, 0.000, 0.122) sec
mfu: 225.448 Tflops/s, hfu: 225.448 Tflops/s, 32.807 iter/s, 3.048e-02 s/iter, (0.193, 0.000, 0.122) sec
mfu: 223.408 Tflops/s, hfu: 223.408 Tflops/s, 32.510 iter/s, 3.076e-02 s/iter, (0.193, 0.000, 0.123) sec
mfu: 215.854 Tflops/s, hfu: 215.854 Tflops/s, 31.411 iter/s, 3.184e-02 s/iter, (0.198, 0.000, 0.127) sec
SP=(1,8),S=(327680,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 108.298 Tflops/s, hfu: 108.298 Tflops/s, 26.266 iter/s, 3.807e-02 s/iter, (0.412, 0.000, 0.761) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 160.486 Tflops/s, hfu: 160.486 Tflops/s, 38.923 iter/s, 2.569e-02 s/iter, (0.282, 0.000, 0.514) sec
# stripe_flash_attn_func, fwd
mfu: 122.709 Tflops/s, hfu: 122.709 Tflops/s, 29.761 iter/s, 3.360e-02 s/iter, (0.372, 0.000, 0.672) sec
# orchestrated_attn_func
mfu: 172.455 Tflops/s, hfu: 172.455 Tflops/s, 20.913 iter/s, 4.782e-02 s/iter, (0.298, 0.000, 0.191) sec
mfu: 161.486 Tflops/s, hfu: 161.486 Tflops/s, 19.583 iter/s, 5.107e-02 s/iter, (0.283, 0.000, 0.204) sec
mfu: 161.29 Tflops/s, hfu: 161.29 Tflops/s, 19.559 iter/s, 5.113e-02 s/iter, (0.306, 0.000, 0.205) sec
mfu: 216.071 Tflops/s, hfu: 216.071 Tflops/s, 26.202 iter/s, 3.817e-02 s/iter, (0.226, 0.000, 0.153) sec
# orchestrated_attn_func fused
mfu: 226.379 Tflops/s, hfu: 226.379 Tflops/s, 27.452 iter/s, 3.643e-02 s/iter, (0.220, 0.000, 0.146) sec
mfu: 226.183 Tflops/s, hfu: 226.183 Tflops/s, 27.428 iter/s, 3.646e-02 s/iter, (0.217, 0.000, 0.146) sec
mfu: 223.832 Tflops/s, hfu: 223.832 Tflops/s, 27.143 iter/s, 3.684e-02 s/iter, (0.221, 0.000, 0.147) sec
mfu: 216.096 Tflops/s, hfu: 216.096 Tflops/s, 26.205 iter/s, 3.816e-02 s/iter, (0.225, 0.000, 0.153) sec
SP=(1,8),S=(327680,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 107.203 Tflops/s, hfu: 107.203 Tflops/s, 22.286 iter/s, 4.487e-02 s/iter, (0.482, 0.000, 0.897) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 160.909 Tflops/s, hfu: 160.909 Tflops/s, 33.451 iter/s, 2.989e-02 s/iter, (0.331, 0.000, 0.598) sec
# stripe_flash_attn_func, fwd
mfu: 118.629 Tflops/s, hfu: 118.629 Tflops/s, 24.661 iter/s, 4.055e-02 s/iter, (0.447, 0.000, 0.811) sec
# orchestrated_attn_func
mfu: 166.75 Tflops/s, hfu: 166.75 Tflops/s, 17.332 iter/s, 5.770e-02 s/iter, (0.300, 0.000, 0.231) sec
mfu: 164.476 Tflops/s, hfu: 164.476 Tflops/s, 17.096 iter/s, 5.849e-02 s/iter, (0.317, 0.000, 0.234) sec
mfu: 159.48 Tflops/s, hfu: 159.48 Tflops/s, 16.577 iter/s, 6.033e-02 s/iter, (0.347, 0.000, 0.241) sec
mfu: 215.76 Tflops/s, hfu: 215.76 Tflops/s, 22.427 iter/s, 4.459e-02 s/iter, (0.253, 0.000, 0.178) sec
# orchestrated_attn_func fused
mfu: 226.881 Tflops/s, hfu: 226.881 Tflops/s, 23.583 iter/s, 4.240e-02 s/iter, (0.243, 0.000, 0.170) sec
mfu: 226.596 Tflops/s, hfu: 226.596 Tflops/s, 23.553 iter/s, 4.246e-02 s/iter, (0.240, 0.000, 0.170) sec
mfu: 223.928 Tflops/s, hfu: 223.928 Tflops/s, 23.276 iter/s, 4.296e-02 s/iter, (0.245, 0.000, 0.172) sec
mfu: 215.926 Tflops/s, hfu: 215.926 Tflops/s, 22.444 iter/s, 4.456e-02 s/iter, (0.250, 0.000, 0.178) sec
SP=(1,8),S=(327680,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 108.61 Tflops/s, hfu: 108.61 Tflops/s, 19.756 iter/s, 5.062e-02 s/iter, (0.549, 0.000, 1.012) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 160.813 Tflops/s, hfu: 160.813 Tflops/s, 29.252 iter/s, 3.419e-02 s/iter, (0.380, 0.000, 0.684) sec
# stripe_flash_attn_func, fwd
mfu: 115.354 Tflops/s, hfu: 115.354 Tflops/s, 20.983 iter/s, 4.766e-02 s/iter, (0.526, 0.000, 0.953) sec
# orchestrated_attn_func
mfu: 165.297 Tflops/s, hfu: 165.297 Tflops/s, 15.034 iter/s, 6.652e-02 s/iter, (0.339, 0.000, 0.266) sec
mfu: 162.473 Tflops/s, hfu: 162.473 Tflops/s, 14.777 iter/s, 6.767e-02 s/iter, (0.344, 0.000, 0.271) sec
mfu: 149.343 Tflops/s, hfu: 149.343 Tflops/s, 13.583 iter/s, 7.362e-02 s/iter, (0.338, 0.000, 0.294) sec
mfu: 214.069 Tflops/s, hfu: 214.069 Tflops/s, 19.470 iter/s, 5.136e-02 s/iter, (0.277, 0.000, 0.205) sec
# orchestrated_attn_func fused
mfu: 227.822 Tflops/s, hfu: 227.822 Tflops/s, 20.720 iter/s, 4.826e-02 s/iter, (0.266, 0.000, 0.193) sec
mfu: 227.034 Tflops/s, hfu: 227.034 Tflops/s, 20.649 iter/s, 4.843e-02 s/iter, (0.265, 0.000, 0.194) sec
mfu: 224.374 Tflops/s, hfu: 224.374 Tflops/s, 20.407 iter/s, 4.900e-02 s/iter, (0.268, 0.000, 0.196) sec
mfu: 216.293 Tflops/s, hfu: 216.293 Tflops/s, 19.672 iter/s, 5.083e-02 s/iter, (0.274, 0.000, 0.203) sec
SP=(1,8),S=(393216,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.789 Tflops/s, hfu: 9.789 Tflops/s, 379.862 iter/s, 2.633e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.713 Tflops/s, hfu: 17.713 Tflops/s, 687.371 iter/s, 1.455e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 8.29 Tflops/s, hfu: 8.29 Tflops/s, 321.703 iter/s, 3.108e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 30.525 Tflops/s, hfu: 30.525 Tflops/s, 592.257 iter/s, 1.688e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 64.561 Tflops/s, hfu: 64.561 Tflops/s, 1252.656 iter/s, 7.983e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 85.833 Tflops/s, hfu: 85.833 Tflops/s, 1665.379 iter/s, 6.005e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 126.867 Tflops/s, hfu: 126.867 Tflops/s, 2461.551 iter/s, 4.062e-04 s/iter, (0.074, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 42.147 Tflops/s, hfu: 42.147 Tflops/s, 817.769 iter/s, 1.223e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 66.819 Tflops/s, hfu: 66.819 Tflops/s, 1296.465 iter/s, 7.713e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 95.605 Tflops/s, hfu: 95.605 Tflops/s, 1854.985 iter/s, 5.391e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 162.123 Tflops/s, hfu: 162.123 Tflops/s, 3145.604 iter/s, 3.179e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(393216,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.471 Tflops/s, hfu: 19.471 Tflops/s, 377.780 iter/s, 2.647e-03 s/iter, (0.034, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.412 Tflops/s, hfu: 35.412 Tflops/s, 687.078 iter/s, 1.455e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 16.573 Tflops/s, hfu: 16.573 Tflops/s, 321.559 iter/s, 3.110e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 54.722 Tflops/s, hfu: 54.722 Tflops/s, 530.871 iter/s, 1.884e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 99.21 Tflops/s, hfu: 99.21 Tflops/s, 962.464 iter/s, 1.039e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 111.38 Tflops/s, hfu: 111.38 Tflops/s, 1080.530 iter/s, 9.255e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 160.452 Tflops/s, hfu: 160.452 Tflops/s, 1556.585 iter/s, 6.424e-04 s/iter, (0.072, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 71.631 Tflops/s, hfu: 71.631 Tflops/s, 694.908 iter/s, 1.439e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 100.765 Tflops/s, hfu: 100.765 Tflops/s, 977.548 iter/s, 1.023e-03 s/iter, (0.079, 0.000, 0.004) sec
mfu: 129.386 Tflops/s, hfu: 129.386 Tflops/s, 1255.209 iter/s, 7.967e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 177.222 Tflops/s, hfu: 177.222 Tflops/s, 1719.277 iter/s, 5.816e-04 s/iter, (0.076, 0.000, 0.002) sec
SP=(1,8),S=(393216,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 29.334 Tflops/s, hfu: 29.334 Tflops/s, 379.433 iter/s, 2.636e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 53.848 Tflops/s, hfu: 53.848 Tflops/s, 696.532 iter/s, 1.436e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 25.099 Tflops/s, hfu: 25.099 Tflops/s, 324.659 iter/s, 3.080e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 78.403 Tflops/s, hfu: 78.403 Tflops/s, 507.075 iter/s, 1.972e-03 s/iter, (0.082, 0.000, 0.008) sec
mfu: 120.667 Tflops/s, hfu: 120.667 Tflops/s, 780.416 iter/s, 1.281e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 131.051 Tflops/s, hfu: 131.051 Tflops/s, 847.573 iter/s, 1.180e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 175.612 Tflops/s, hfu: 175.612 Tflops/s, 1135.775 iter/s, 8.805e-04 s/iter, (0.073, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 92.521 Tflops/s, hfu: 92.521 Tflops/s, 598.381 iter/s, 1.671e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 124.055 Tflops/s, hfu: 124.055 Tflops/s, 802.326 iter/s, 1.246e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 147.143 Tflops/s, hfu: 147.143 Tflops/s, 951.649 iter/s, 1.051e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 183.41 Tflops/s, hfu: 183.41 Tflops/s, 1186.206 iter/s, 8.430e-04 s/iter, (0.074, 0.000, 0.003) sec
SP=(1,8),S=(393216,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.964 Tflops/s, hfu: 37.964 Tflops/s, 368.298 iter/s, 2.715e-03 s/iter, (0.039, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 71.518 Tflops/s, hfu: 71.518 Tflops/s, 693.818 iter/s, 1.441e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 33.434 Tflops/s, hfu: 33.434 Tflops/s, 324.352 iter/s, 3.083e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 96.582 Tflops/s, hfu: 96.582 Tflops/s, 468.486 iter/s, 2.135e-03 s/iter, (0.077, 0.000, 0.009) sec
mfu: 132.986 Tflops/s, hfu: 132.986 Tflops/s, 645.068 iter/s, 1.550e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 135.678 Tflops/s, hfu: 135.678 Tflops/s, 658.127 iter/s, 1.519e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 182.529 Tflops/s, hfu: 182.529 Tflops/s, 885.382 iter/s, 1.129e-03 s/iter, (0.077, 0.000, 0.005) sec
# orchestrated_attn_func fused
mfu: 108.888 Tflops/s, hfu: 108.888 Tflops/s, 528.175 iter/s, 1.893e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 138.862 Tflops/s, hfu: 138.862 Tflops/s, 673.571 iter/s, 1.485e-03 s/iter, (0.081, 0.000, 0.006) sec
mfu: 155.909 Tflops/s, hfu: 155.909 Tflops/s, 756.260 iter/s, 1.322e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 187.574 Tflops/s, hfu: 187.574 Tflops/s, 909.852 iter/s, 1.099e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(393216,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.473 Tflops/s, hfu: 47.473 Tflops/s, 368.440 iter/s, 2.714e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.154 Tflops/s, hfu: 88.154 Tflops/s, 684.164 iter/s, 1.462e-03 s/iter, (0.020, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 41.412 Tflops/s, hfu: 41.412 Tflops/s, 321.398 iter/s, 3.111e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 114.281 Tflops/s, hfu: 114.281 Tflops/s, 443.467 iter/s, 2.255e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 138.838 Tflops/s, hfu: 138.838 Tflops/s, 538.761 iter/s, 1.856e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 141.708 Tflops/s, hfu: 141.708 Tflops/s, 549.898 iter/s, 1.819e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 185.149 Tflops/s, hfu: 185.149 Tflops/s, 718.473 iter/s, 1.392e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 121.861 Tflops/s, hfu: 121.861 Tflops/s, 472.883 iter/s, 2.115e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 148.236 Tflops/s, hfu: 148.236 Tflops/s, 575.231 iter/s, 1.738e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 163.963 Tflops/s, hfu: 163.963 Tflops/s, 636.262 iter/s, 1.572e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 189.555 Tflops/s, hfu: 189.555 Tflops/s, 735.571 iter/s, 1.359e-03 s/iter, (0.079, 0.000, 0.005) sec
SP=(1,8),S=(393216,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.958 Tflops/s, hfu: 56.958 Tflops/s, 368.374 iter/s, 2.715e-03 s/iter, (0.041, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.243 Tflops/s, hfu: 93.243 Tflops/s, 603.050 iter/s, 1.658e-03 s/iter, (0.023, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 49.52 Tflops/s, hfu: 49.52 Tflops/s, 320.274 iter/s, 3.122e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 126.979 Tflops/s, hfu: 126.979 Tflops/s, 410.620 iter/s, 2.435e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 149.989 Tflops/s, hfu: 149.989 Tflops/s, 485.028 iter/s, 2.062e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 144.118 Tflops/s, hfu: 144.118 Tflops/s, 466.044 iter/s, 2.146e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 189.452 Tflops/s, hfu: 189.452 Tflops/s, 612.643 iter/s, 1.632e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 132.613 Tflops/s, hfu: 132.613 Tflops/s, 428.839 iter/s, 2.332e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 156.818 Tflops/s, hfu: 156.818 Tflops/s, 507.112 iter/s, 1.972e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 170.247 Tflops/s, hfu: 170.247 Tflops/s, 550.537 iter/s, 1.816e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 191.909 Tflops/s, hfu: 191.909 Tflops/s, 620.588 iter/s, 1.611e-03 s/iter, (0.077, 0.000, 0.006) sec
SP=(1,8),S=(393216,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.129 Tflops/s, hfu: 61.129 Tflops/s, 338.875 iter/s, 2.951e-03 s/iter, (0.044, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 97.949 Tflops/s, hfu: 97.949 Tflops/s, 542.991 iter/s, 1.842e-03 s/iter, (0.026, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 57.155 Tflops/s, hfu: 57.155 Tflops/s, 316.844 iter/s, 3.156e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 133.926 Tflops/s, hfu: 133.926 Tflops/s, 371.215 iter/s, 2.694e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 153.38 Tflops/s, hfu: 153.38 Tflops/s, 425.138 iter/s, 2.352e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 144.778 Tflops/s, hfu: 144.778 Tflops/s, 401.294 iter/s, 2.492e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 192.699 Tflops/s, hfu: 192.699 Tflops/s, 534.122 iter/s, 1.872e-03 s/iter, (0.080, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 141.213 Tflops/s, hfu: 141.213 Tflops/s, 391.414 iter/s, 2.555e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 164.746 Tflops/s, hfu: 164.746 Tflops/s, 456.643 iter/s, 2.190e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 174.239 Tflops/s, hfu: 174.239 Tflops/s, 482.954 iter/s, 2.071e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 192.66 Tflops/s, hfu: 192.66 Tflops/s, 534.015 iter/s, 1.873e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(393216,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.989 Tflops/s, hfu: 64.989 Tflops/s, 315.240 iter/s, 3.172e-03 s/iter, (0.046, 0.000, 0.063) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 96.445 Tflops/s, hfu: 96.445 Tflops/s, 467.819 iter/s, 2.138e-03 s/iter, (0.029, 0.000, 0.043) sec
# stripe_flash_attn_func, fwd
mfu: 65.084 Tflops/s, hfu: 65.084 Tflops/s, 315.697 iter/s, 3.168e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 152.769 Tflops/s, hfu: 152.769 Tflops/s, 370.514 iter/s, 2.699e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 158.492 Tflops/s, hfu: 158.492 Tflops/s, 384.393 iter/s, 2.602e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 140.804 Tflops/s, hfu: 140.804 Tflops/s, 341.496 iter/s, 2.928e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 188.848 Tflops/s, hfu: 188.848 Tflops/s, 458.016 iter/s, 2.183e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 148.426 Tflops/s, hfu: 148.426 Tflops/s, 359.982 iter/s, 2.778e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 170.315 Tflops/s, hfu: 170.315 Tflops/s, 413.067 iter/s, 2.421e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 177.639 Tflops/s, hfu: 177.639 Tflops/s, 430.832 iter/s, 2.321e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 193.667 Tflops/s, hfu: 193.667 Tflops/s, 469.704 iter/s, 2.129e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(393216,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.908 Tflops/s, hfu: 70.908 Tflops/s, 275.161 iter/s, 3.634e-03 s/iter, (0.049, 0.000, 0.073) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.557 Tflops/s, hfu: 99.557 Tflops/s, 386.333 iter/s, 2.588e-03 s/iter, (0.032, 0.000, 0.052) sec
# stripe_flash_attn_func, fwd
mfu: 80.565 Tflops/s, hfu: 80.565 Tflops/s, 312.633 iter/s, 3.199e-03 s/iter, (0.041, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 163.059 Tflops/s, hfu: 163.059 Tflops/s, 316.376 iter/s, 3.161e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 163.396 Tflops/s, hfu: 163.396 Tflops/s, 317.030 iter/s, 3.154e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 154.813 Tflops/s, hfu: 154.813 Tflops/s, 300.376 iter/s, 3.329e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 194.52 Tflops/s, hfu: 194.52 Tflops/s, 377.419 iter/s, 2.650e-03 s/iter, (0.080, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 159.984 Tflops/s, hfu: 159.984 Tflops/s, 310.410 iter/s, 3.222e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 177.651 Tflops/s, hfu: 177.651 Tflops/s, 344.689 iter/s, 2.901e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 182.223 Tflops/s, hfu: 182.223 Tflops/s, 353.559 iter/s, 2.828e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 194.702 Tflops/s, hfu: 194.702 Tflops/s, 377.772 iter/s, 2.647e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(393216,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.678 Tflops/s, hfu: 75.678 Tflops/s, 244.723 iter/s, 4.086e-03 s/iter, (0.054, 0.000, 0.082) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 101.433 Tflops/s, hfu: 101.433 Tflops/s, 328.009 iter/s, 3.049e-03 s/iter, (0.037, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 97.305 Tflops/s, hfu: 97.305 Tflops/s, 314.662 iter/s, 3.178e-03 s/iter, (0.041, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 175.415 Tflops/s, hfu: 175.415 Tflops/s, 283.625 iter/s, 3.526e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 158.54 Tflops/s, hfu: 158.54 Tflops/s, 256.339 iter/s, 3.901e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 153.54 Tflops/s, hfu: 153.54 Tflops/s, 248.256 iter/s, 4.028e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 197.712 Tflops/s, hfu: 197.712 Tflops/s, 319.676 iter/s, 3.128e-03 s/iter, (0.083, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 168.652 Tflops/s, hfu: 168.652 Tflops/s, 272.690 iter/s, 3.667e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 184.335 Tflops/s, hfu: 184.335 Tflops/s, 298.047 iter/s, 3.355e-03 s/iter, (0.088, 0.000, 0.013) sec
mfu: 185.874 Tflops/s, hfu: 185.874 Tflops/s, 300.536 iter/s, 3.327e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 195.628 Tflops/s, hfu: 195.628 Tflops/s, 316.307 iter/s, 3.161e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(393216,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.449 Tflops/s, hfu: 79.449 Tflops/s, 220.217 iter/s, 4.541e-03 s/iter, (0.060, 0.000, 0.091) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.914 Tflops/s, hfu: 102.914 Tflops/s, 285.256 iter/s, 3.506e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 108.898 Tflops/s, hfu: 108.898 Tflops/s, 301.844 iter/s, 3.313e-03 s/iter, (0.043, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 182.583 Tflops/s, hfu: 182.583 Tflops/s, 253.042 iter/s, 3.952e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 161.686 Tflops/s, hfu: 161.686 Tflops/s, 224.081 iter/s, 4.463e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 162.015 Tflops/s, hfu: 162.015 Tflops/s, 224.536 iter/s, 4.454e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 198.941 Tflops/s, hfu: 198.941 Tflops/s, 275.712 iter/s, 3.627e-03 s/iter, (0.085, 0.000, 0.015) sec
# orchestrated_attn_func fused
mfu: 175.221 Tflops/s, hfu: 175.221 Tflops/s, 242.838 iter/s, 4.118e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 188.768 Tflops/s, hfu: 188.768 Tflops/s, 261.612 iter/s, 3.822e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 188.24 Tflops/s, hfu: 188.24 Tflops/s, 260.881 iter/s, 3.833e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 195.384 Tflops/s, hfu: 195.384 Tflops/s, 270.783 iter/s, 3.693e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(393216,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 82.31 Tflops/s, hfu: 82.31 Tflops/s, 199.629 iter/s, 5.009e-03 s/iter, (0.063, 0.000, 0.100) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.523 Tflops/s, hfu: 103.523 Tflops/s, 251.077 iter/s, 3.983e-03 s/iter, (0.046, 0.000, 0.080) sec
# stripe_flash_attn_func, fwd
mfu: 117.34 Tflops/s, hfu: 117.34 Tflops/s, 284.586 iter/s, 3.514e-03 s/iter, (0.045, 0.000, 0.070) sec
# orchestrated_attn_func
mfu: 182.222 Tflops/s, hfu: 182.222 Tflops/s, 220.973 iter/s, 4.525e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 151.614 Tflops/s, hfu: 151.614 Tflops/s, 183.856 iter/s, 5.439e-03 s/iter, (0.099, 0.000, 0.022) sec
mfu: 145.703 Tflops/s, hfu: 145.703 Tflops/s, 176.688 iter/s, 5.660e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 199.498 Tflops/s, hfu: 199.498 Tflops/s, 241.923 iter/s, 4.134e-03 s/iter, (0.087, 0.000, 0.017) sec
# orchestrated_attn_func fused
mfu: 180.438 Tflops/s, hfu: 180.438 Tflops/s, 218.810 iter/s, 4.570e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 192.399 Tflops/s, hfu: 192.399 Tflops/s, 233.314 iter/s, 4.286e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 190.169 Tflops/s, hfu: 190.169 Tflops/s, 230.610 iter/s, 4.336e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 195.028 Tflops/s, hfu: 195.028 Tflops/s, 236.503 iter/s, 4.228e-03 s/iter, (0.088, 0.000, 0.017) sec
SP=(1,8),S=(393216,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 87.552 Tflops/s, hfu: 87.552 Tflops/s, 169.873 iter/s, 5.887e-03 s/iter, (0.074, 0.000, 0.118) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 105.753 Tflops/s, hfu: 105.753 Tflops/s, 205.189 iter/s, 4.874e-03 s/iter, (0.057, 0.000, 0.097) sec
# stripe_flash_attn_func, fwd
mfu: 130.505 Tflops/s, hfu: 130.505 Tflops/s, 253.213 iter/s, 3.949e-03 s/iter, (0.049, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 178.84 Tflops/s, hfu: 178.84 Tflops/s, 173.497 iter/s, 5.764e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 161.817 Tflops/s, hfu: 161.817 Tflops/s, 156.983 iter/s, 6.370e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 156.484 Tflops/s, hfu: 156.484 Tflops/s, 151.810 iter/s, 6.587e-03 s/iter, (0.097, 0.000, 0.026) sec
mfu: 200.871 Tflops/s, hfu: 200.871 Tflops/s, 194.871 iter/s, 5.132e-03 s/iter, (0.095, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 188.855 Tflops/s, hfu: 188.855 Tflops/s, 183.214 iter/s, 5.458e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 197.845 Tflops/s, hfu: 197.845 Tflops/s, 191.935 iter/s, 5.210e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 193.213 Tflops/s, hfu: 193.213 Tflops/s, 187.441 iter/s, 5.335e-03 s/iter, (0.096, 0.000, 0.021) sec
mfu: 195.626 Tflops/s, hfu: 195.626 Tflops/s, 189.782 iter/s, 5.269e-03 s/iter, (0.092, 0.000, 0.021) sec
SP=(1,8),S=(393216,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 90.902 Tflops/s, hfu: 90.902 Tflops/s, 146.978 iter/s, 6.804e-03 s/iter, (0.081, 0.000, 0.136) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 107.813 Tflops/s, hfu: 107.813 Tflops/s, 174.321 iter/s, 5.737e-03 s/iter, (0.068, 0.000, 0.115) sec
# stripe_flash_attn_func, fwd
mfu: 138.556 Tflops/s, hfu: 138.556 Tflops/s, 224.028 iter/s, 4.464e-03 s/iter, (0.054, 0.000, 0.089) sec
# orchestrated_attn_func
mfu: 177.058 Tflops/s, hfu: 177.058 Tflops/s, 143.141 iter/s, 6.986e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 165.184 Tflops/s, hfu: 165.184 Tflops/s, 133.541 iter/s, 7.488e-03 s/iter, (0.101, 0.000, 0.030) sec
mfu: 147.391 Tflops/s, hfu: 147.391 Tflops/s, 119.157 iter/s, 8.392e-03 s/iter, (0.102, 0.000, 0.034) sec
mfu: 201.328 Tflops/s, hfu: 201.328 Tflops/s, 162.762 iter/s, 6.144e-03 s/iter, (0.095, 0.000, 0.025) sec
# orchestrated_attn_func fused
mfu: 194.223 Tflops/s, hfu: 194.223 Tflops/s, 157.018 iter/s, 6.369e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 201.101 Tflops/s, hfu: 201.101 Tflops/s, 162.578 iter/s, 6.151e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 195.13 Tflops/s, hfu: 195.13 Tflops/s, 157.751 iter/s, 6.339e-03 s/iter, (0.096, 0.000, 0.025) sec
mfu: 197.039 Tflops/s, hfu: 197.039 Tflops/s, 159.294 iter/s, 6.278e-03 s/iter, (0.098, 0.000, 0.025) sec
SP=(1,8),S=(393216,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 93.559 Tflops/s, hfu: 93.559 Tflops/s, 129.663 iter/s, 7.712e-03 s/iter, (0.091, 0.000, 0.154) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.078 Tflops/s, hfu: 108.078 Tflops/s, 149.785 iter/s, 6.676e-03 s/iter, (0.079, 0.000, 0.134) sec
# stripe_flash_attn_func, fwd
mfu: 147.644 Tflops/s, hfu: 147.644 Tflops/s, 204.619 iter/s, 4.887e-03 s/iter, (0.058, 0.000, 0.098) sec
# orchestrated_attn_func
mfu: 175.182 Tflops/s, hfu: 175.182 Tflops/s, 121.392 iter/s, 8.238e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 161.778 Tflops/s, hfu: 161.778 Tflops/s, 112.104 iter/s, 8.920e-03 s/iter, (0.107, 0.000, 0.036) sec
mfu: 151.469 Tflops/s, hfu: 151.469 Tflops/s, 104.960 iter/s, 9.527e-03 s/iter, (0.106, 0.000, 0.038) sec
mfu: 200.075 Tflops/s, hfu: 200.075 Tflops/s, 138.642 iter/s, 7.213e-03 s/iter, (0.103, 0.000, 0.029) sec
# orchestrated_attn_func fused
mfu: 199.155 Tflops/s, hfu: 199.155 Tflops/s, 138.004 iter/s, 7.246e-03 s/iter, (0.218, 0.000, 0.029) sec
mfu: 203.862 Tflops/s, hfu: 203.862 Tflops/s, 141.266 iter/s, 7.079e-03 s/iter, (0.099, 0.000, 0.028) sec
mfu: 196.499 Tflops/s, hfu: 196.499 Tflops/s, 136.164 iter/s, 7.344e-03 s/iter, (0.100, 0.000, 0.029) sec
mfu: 197.135 Tflops/s, hfu: 197.135 Tflops/s, 136.604 iter/s, 7.320e-03 s/iter, (0.100, 0.000, 0.029) sec
SP=(1,8),S=(393216,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 95.556 Tflops/s, hfu: 95.556 Tflops/s, 115.877 iter/s, 8.630e-03 s/iter, (0.100, 0.000, 0.173) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.756 Tflops/s, hfu: 108.756 Tflops/s, 131.884 iter/s, 7.582e-03 s/iter, (0.087, 0.000, 0.152) sec
# stripe_flash_attn_func, fwd
mfu: 151.722 Tflops/s, hfu: 151.722 Tflops/s, 183.987 iter/s, 5.435e-03 s/iter, (0.064, 0.000, 0.109) sec
# orchestrated_attn_func
mfu: 174.961 Tflops/s, hfu: 174.961 Tflops/s, 106.084 iter/s, 9.426e-03 s/iter, (0.107, 0.000, 0.038) sec
mfu: 160.459 Tflops/s, hfu: 160.459 Tflops/s, 97.291 iter/s, 1.028e-02 s/iter, (0.113, 0.000, 0.041) sec
mfu: 142.545 Tflops/s, hfu: 142.545 Tflops/s, 86.429 iter/s, 1.157e-02 s/iter, (0.117, 0.000, 0.046) sec
mfu: 202.45 Tflops/s, hfu: 202.45 Tflops/s, 122.751 iter/s, 8.147e-03 s/iter, (0.105, 0.000, 0.033) sec
# orchestrated_attn_func fused
mfu: 202.259 Tflops/s, hfu: 202.259 Tflops/s, 122.635 iter/s, 8.154e-03 s/iter, (0.102, 0.000, 0.033) sec
mfu: 205.915 Tflops/s, hfu: 205.915 Tflops/s, 124.852 iter/s, 8.009e-03 s/iter, (0.105, 0.000, 0.032) sec
mfu: 197.488 Tflops/s, hfu: 197.488 Tflops/s, 119.743 iter/s, 8.351e-03 s/iter, (0.104, 0.000, 0.033) sec
mfu: 197.487 Tflops/s, hfu: 197.487 Tflops/s, 119.742 iter/s, 8.351e-03 s/iter, (0.104, 0.000, 0.033) sec
SP=(1,8),S=(393216,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 98.633 Tflops/s, hfu: 98.633 Tflops/s, 95.687 iter/s, 1.045e-02 s/iter, (0.120, 0.000, 0.209) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.416 Tflops/s, hfu: 109.416 Tflops/s, 106.147 iter/s, 9.421e-03 s/iter, (0.108, 0.000, 0.188) sec
# stripe_flash_attn_func, fwd
mfu: 161.403 Tflops/s, hfu: 161.403 Tflops/s, 156.582 iter/s, 6.386e-03 s/iter, (0.075, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 170.563 Tflops/s, hfu: 170.563 Tflops/s, 82.734 iter/s, 1.209e-02 s/iter, (0.121, 0.000, 0.048) sec
mfu: 160.145 Tflops/s, hfu: 160.145 Tflops/s, 77.680 iter/s, 1.287e-02 s/iter, (0.121, 0.000, 0.051) sec
mfu: 157.056 Tflops/s, hfu: 157.056 Tflops/s, 76.182 iter/s, 1.313e-02 s/iter, (0.130, 0.000, 0.053) sec
mfu: 202.962 Tflops/s, hfu: 202.962 Tflops/s, 98.450 iter/s, 1.016e-02 s/iter, (0.112, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 207.811 Tflops/s, hfu: 207.811 Tflops/s, 100.801 iter/s, 9.920e-03 s/iter, (0.109, 0.000, 0.040) sec
mfu: 209.022 Tflops/s, hfu: 209.022 Tflops/s, 101.389 iter/s, 9.863e-03 s/iter, (0.113, 0.000, 0.039) sec
mfu: 199.206 Tflops/s, hfu: 199.206 Tflops/s, 96.627 iter/s, 1.035e-02 s/iter, (0.112, 0.000, 0.041) sec
mfu: 198.296 Tflops/s, hfu: 198.296 Tflops/s, 96.186 iter/s, 1.040e-02 s/iter, (0.112, 0.000, 0.042) sec
SP=(1,8),S=(393216,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 100.447 Tflops/s, hfu: 100.447 Tflops/s, 81.205 iter/s, 1.231e-02 s/iter, (0.145, 0.000, 0.246) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.403 Tflops/s, hfu: 109.403 Tflops/s, 88.445 iter/s, 1.131e-02 s/iter, (0.128, 0.000, 0.226) sec
# stripe_flash_attn_func, fwd
mfu: 167.98 Tflops/s, hfu: 167.98 Tflops/s, 135.802 iter/s, 7.364e-03 s/iter, (0.086, 0.000, 0.147) sec
# orchestrated_attn_func
mfu: 175.029 Tflops/s, hfu: 175.029 Tflops/s, 70.750 iter/s, 1.413e-02 s/iter, (0.127, 0.000, 0.057) sec
mfu: 161.684 Tflops/s, hfu: 161.684 Tflops/s, 65.356 iter/s, 1.530e-02 s/iter, (0.133, 0.000, 0.061) sec
mfu: 158.868 Tflops/s, hfu: 158.868 Tflops/s, 64.218 iter/s, 1.557e-02 s/iter, (0.134, 0.000, 0.062) sec
mfu: 203.404 Tflops/s, hfu: 203.404 Tflops/s, 82.220 iter/s, 1.216e-02 s/iter, (0.119, 0.000, 0.049) sec
# orchestrated_attn_func fused
mfu: 210.862 Tflops/s, hfu: 210.862 Tflops/s, 85.235 iter/s, 1.173e-02 s/iter, (0.122, 0.000, 0.047) sec
mfu: 210.85 Tflops/s, hfu: 210.85 Tflops/s, 85.230 iter/s, 1.173e-02 s/iter, (0.121, 0.000, 0.047) sec
mfu: 200.039 Tflops/s, hfu: 200.039 Tflops/s, 80.860 iter/s, 1.237e-02 s/iter, (0.122, 0.000, 0.049) sec
mfu: 198.46 Tflops/s, hfu: 198.46 Tflops/s, 80.222 iter/s, 1.247e-02 s/iter, (0.122, 0.000, 0.050) sec
SP=(1,8),S=(393216,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 101.688 Tflops/s, hfu: 101.688 Tflops/s, 70.464 iter/s, 1.419e-02 s/iter, (0.162, 0.000, 0.284) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 110.225 Tflops/s, hfu: 110.225 Tflops/s, 76.380 iter/s, 1.309e-02 s/iter, (0.150, 0.000, 0.262) sec
# stripe_flash_attn_func, fwd
mfu: 172.974 Tflops/s, hfu: 172.974 Tflops/s, 119.862 iter/s, 8.343e-03 s/iter, (0.096, 0.000, 0.167) sec
# orchestrated_attn_func
mfu: 175.704 Tflops/s, hfu: 175.704 Tflops/s, 60.877 iter/s, 1.643e-02 s/iter, (0.137, 0.000, 0.066) sec
mfu: 167.55 Tflops/s, hfu: 167.55 Tflops/s, 58.052 iter/s, 1.723e-02 s/iter, (0.143, 0.000, 0.069) sec
mfu: 159.035 Tflops/s, hfu: 159.035 Tflops/s, 55.101 iter/s, 1.815e-02 s/iter, (0.152, 0.000, 0.073) sec
mfu: 203.838 Tflops/s, hfu: 203.838 Tflops/s, 70.625 iter/s, 1.416e-02 s/iter, (0.127, 0.000, 0.057) sec
# orchestrated_attn_func fused
mfu: 213.889 Tflops/s, hfu: 213.889 Tflops/s, 74.107 iter/s, 1.349e-02 s/iter, (0.126, 0.000, 0.054) sec
mfu: 212.13 Tflops/s, hfu: 212.13 Tflops/s, 73.498 iter/s, 1.361e-02 s/iter, (0.128, 0.000, 0.054) sec
mfu: 200.937 Tflops/s, hfu: 200.937 Tflops/s, 69.619 iter/s, 1.436e-02 s/iter, (0.128, 0.000, 0.057) sec
mfu: 198.924 Tflops/s, hfu: 198.924 Tflops/s, 68.922 iter/s, 1.451e-02 s/iter, (0.128, 0.000, 0.058) sec
SP=(1,8),S=(393216,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 102.671 Tflops/s, hfu: 102.671 Tflops/s, 62.253 iter/s, 1.606e-02 s/iter, (0.181, 0.000, 0.321) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 110.003 Tflops/s, hfu: 110.003 Tflops/s, 66.698 iter/s, 1.499e-02 s/iter, (0.172, 0.000, 0.300) sec
# stripe_flash_attn_func, fwd
mfu: 175.401 Tflops/s, hfu: 175.401 Tflops/s, 106.351 iter/s, 9.403e-03 s/iter, (0.109, 0.000, 0.188) sec
# orchestrated_attn_func
mfu: 169.412 Tflops/s, hfu: 169.412 Tflops/s, 51.360 iter/s, 1.947e-02 s/iter, (0.146, 0.000, 0.078) sec
mfu: 151.182 Tflops/s, hfu: 151.182 Tflops/s, 45.833 iter/s, 2.182e-02 s/iter, (0.157, 0.000, 0.087) sec
mfu: 160.642 Tflops/s, hfu: 160.642 Tflops/s, 48.701 iter/s, 2.053e-02 s/iter, (0.156, 0.000, 0.082) sec
mfu: 203.957 Tflops/s, hfu: 203.957 Tflops/s, 61.833 iter/s, 1.617e-02 s/iter, (0.139, 0.000, 0.065) sec
# orchestrated_attn_func fused
mfu: 215.885 Tflops/s, hfu: 215.885 Tflops/s, 65.449 iter/s, 1.528e-02 s/iter, (0.131, 0.000, 0.061) sec
mfu: 213.502 Tflops/s, hfu: 213.502 Tflops/s, 64.726 iter/s, 1.545e-02 s/iter, (0.132, 0.000, 0.062) sec
mfu: 201.724 Tflops/s, hfu: 201.724 Tflops/s, 61.156 iter/s, 1.635e-02 s/iter, (0.136, 0.000, 0.065) sec
mfu: 199.264 Tflops/s, hfu: 199.264 Tflops/s, 60.410 iter/s, 1.655e-02 s/iter, (0.137, 0.000, 0.066) sec
SP=(1,8),S=(393216,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.233 Tflops/s, hfu: 104.233 Tflops/s, 50.560 iter/s, 1.978e-02 s/iter, (0.225, 0.000, 0.396) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.001 Tflops/s, hfu: 109.001 Tflops/s, 52.872 iter/s, 1.891e-02 s/iter, (0.212, 0.000, 0.378) sec
# stripe_flash_attn_func, fwd
mfu: 180.734 Tflops/s, hfu: 180.734 Tflops/s, 87.668 iter/s, 1.141e-02 s/iter, (0.130, 0.000, 0.228) sec
# orchestrated_attn_func
mfu: 173.237 Tflops/s, hfu: 173.237 Tflops/s, 42.016 iter/s, 2.380e-02 s/iter, (0.169, 0.000, 0.095) sec
mfu: 164.374 Tflops/s, hfu: 164.374 Tflops/s, 39.866 iter/s, 2.508e-02 s/iter, (0.180, 0.000, 0.100) sec
mfu: 154.426 Tflops/s, hfu: 154.426 Tflops/s, 37.453 iter/s, 2.670e-02 s/iter, (0.183, 0.000, 0.107) sec
mfu: 204.275 Tflops/s, hfu: 204.275 Tflops/s, 49.543 iter/s, 2.018e-02 s/iter, (0.154, 0.000, 0.081) sec
# orchestrated_attn_func fused
mfu: 218.503 Tflops/s, hfu: 218.503 Tflops/s, 52.994 iter/s, 1.887e-02 s/iter, (0.145, 0.000, 0.075) sec
mfu: 215.209 Tflops/s, hfu: 215.209 Tflops/s, 52.195 iter/s, 1.916e-02 s/iter, (0.147, 0.000, 0.077) sec
mfu: 202.492 Tflops/s, hfu: 202.492 Tflops/s, 49.111 iter/s, 2.036e-02 s/iter, (0.153, 0.000, 0.081) sec
mfu: 199.512 Tflops/s, hfu: 199.512 Tflops/s, 48.388 iter/s, 2.067e-02 s/iter, (0.154, 0.000, 0.083) sec
SP=(1,8),S=(393216,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.496 Tflops/s, hfu: 104.496 Tflops/s, 42.239 iter/s, 2.367e-02 s/iter, (0.266, 0.000, 0.473) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.836 Tflops/s, hfu: 108.836 Tflops/s, 43.994 iter/s, 2.273e-02 s/iter, (0.254, 0.000, 0.455) sec
# stripe_flash_attn_func, fwd
mfu: 181.92 Tflops/s, hfu: 181.92 Tflops/s, 73.536 iter/s, 1.360e-02 s/iter, (0.154, 0.000, 0.272) sec
# orchestrated_attn_func
mfu: 174.519 Tflops/s, hfu: 174.519 Tflops/s, 35.272 iter/s, 2.835e-02 s/iter, (0.188, 0.000, 0.113) sec
mfu: 166.23 Tflops/s, hfu: 166.23 Tflops/s, 33.597 iter/s, 2.976e-02 s/iter, (0.194, 0.000, 0.119) sec
mfu: 159.065 Tflops/s, hfu: 159.065 Tflops/s, 32.149 iter/s, 3.111e-02 s/iter, (0.198, 0.000, 0.124) sec
mfu: 204.394 Tflops/s, hfu: 204.394 Tflops/s, 41.310 iter/s, 2.421e-02 s/iter, (0.168, 0.000, 0.097) sec
# orchestrated_attn_func fused
mfu: 220.565 Tflops/s, hfu: 220.565 Tflops/s, 44.578 iter/s, 2.243e-02 s/iter, (0.162, 0.000, 0.090) sec
mfu: 216.207 Tflops/s, hfu: 216.207 Tflops/s, 43.698 iter/s, 2.288e-02 s/iter, (0.163, 0.000, 0.092) sec
mfu: 203.044 Tflops/s, hfu: 203.044 Tflops/s, 41.037 iter/s, 2.437e-02 s/iter, (0.167, 0.000, 0.097) sec
mfu: 199.867 Tflops/s, hfu: 199.867 Tflops/s, 40.395 iter/s, 2.476e-02 s/iter, (0.170, 0.000, 0.099) sec
SP=(1,8),S=(393216,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.04 Tflops/s, hfu: 104.04 Tflops/s, 36.047 iter/s, 2.774e-02 s/iter, (0.310, 0.000, 0.555) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.559 Tflops/s, hfu: 124.559 Tflops/s, 43.156 iter/s, 2.317e-02 s/iter, (0.256, 0.000, 0.463) sec
# stripe_flash_attn_func, fwd
mfu: 178.561 Tflops/s, hfu: 178.561 Tflops/s, 61.867 iter/s, 1.616e-02 s/iter, (0.179, 0.000, 0.323) sec
# orchestrated_attn_func
mfu: 173.024 Tflops/s, hfu: 173.024 Tflops/s, 29.974 iter/s, 3.336e-02 s/iter, (0.203, 0.000, 0.133) sec
mfu: 163.429 Tflops/s, hfu: 163.429 Tflops/s, 28.312 iter/s, 3.532e-02 s/iter, (0.218, 0.000, 0.141) sec
mfu: 158.075 Tflops/s, hfu: 158.075 Tflops/s, 27.384 iter/s, 3.652e-02 s/iter, (0.223, 0.000, 0.146) sec
mfu: 204.59 Tflops/s, hfu: 204.59 Tflops/s, 35.443 iter/s, 2.821e-02 s/iter, (0.185, 0.000, 0.113) sec
# orchestrated_attn_func fused
mfu: 221.852 Tflops/s, hfu: 221.852 Tflops/s, 38.433 iter/s, 2.602e-02 s/iter, (0.174, 0.000, 0.104) sec
mfu: 216.851 Tflops/s, hfu: 216.851 Tflops/s, 37.567 iter/s, 2.662e-02 s/iter, (0.178, 0.000, 0.106) sec
mfu: 203.57 Tflops/s, hfu: 203.57 Tflops/s, 35.266 iter/s, 2.836e-02 s/iter, (0.184, 0.000, 0.113) sec
mfu: 199.878 Tflops/s, hfu: 199.878 Tflops/s, 34.626 iter/s, 2.888e-02 s/iter, (0.186, 0.000, 0.116) sec
SP=(1,8),S=(393216,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 103.904 Tflops/s, hfu: 103.904 Tflops/s, 31.500 iter/s, 3.175e-02 s/iter, (0.361, 0.000, 0.635) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 139.327 Tflops/s, hfu: 139.327 Tflops/s, 42.239 iter/s, 2.367e-02 s/iter, (0.258, 0.000, 0.473) sec
# stripe_flash_attn_func, fwd
mfu: 167.885 Tflops/s, hfu: 167.885 Tflops/s, 50.897 iter/s, 1.965e-02 s/iter, (0.219, 0.000, 0.393) sec
# orchestrated_attn_func
mfu: 171.663 Tflops/s, hfu: 171.663 Tflops/s, 26.021 iter/s, 3.843e-02 s/iter, (0.222, 0.000, 0.154) sec
mfu: 167.507 Tflops/s, hfu: 167.507 Tflops/s, 25.391 iter/s, 3.938e-02 s/iter, (0.237, 0.000, 0.158) sec
mfu: 159.568 Tflops/s, hfu: 159.568 Tflops/s, 24.188 iter/s, 4.134e-02 s/iter, (0.257, 0.000, 0.165) sec
mfu: 204.599 Tflops/s, hfu: 204.599 Tflops/s, 31.014 iter/s, 3.224e-02 s/iter, (0.201, 0.000, 0.129) sec
# orchestrated_attn_func fused
mfu: 223.043 Tflops/s, hfu: 223.043 Tflops/s, 33.809 iter/s, 2.958e-02 s/iter, (0.189, 0.000, 0.118) sec
mfu: 217.633 Tflops/s, hfu: 217.633 Tflops/s, 32.989 iter/s, 3.031e-02 s/iter, (0.194, 0.000, 0.121) sec
mfu: 203.721 Tflops/s, hfu: 203.721 Tflops/s, 30.881 iter/s, 3.238e-02 s/iter, (0.200, 0.000, 0.130) sec
mfu: 199.835 Tflops/s, hfu: 199.835 Tflops/s, 30.291 iter/s, 3.301e-02 s/iter, (0.203, 0.000, 0.132) sec
SP=(1,8),S=(393216,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.605 Tflops/s, hfu: 104.605 Tflops/s, 25.370 iter/s, 3.942e-02 s/iter, (0.438, 0.000, 0.788) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 167.541 Tflops/s, hfu: 167.541 Tflops/s, 40.634 iter/s, 2.461e-02 s/iter, (0.271, 0.000, 0.492) sec
# stripe_flash_attn_func, fwd
mfu: 153.808 Tflops/s, hfu: 153.808 Tflops/s, 37.303 iter/s, 2.681e-02 s/iter, (0.295, 0.000, 0.536) sec
# orchestrated_attn_func
mfu: 172.836 Tflops/s, hfu: 172.836 Tflops/s, 20.959 iter/s, 4.771e-02 s/iter, (0.257, 0.000, 0.191) sec
mfu: 165.513 Tflops/s, hfu: 165.513 Tflops/s, 20.071 iter/s, 4.982e-02 s/iter, (0.283, 0.000, 0.199) sec
mfu: 149.828 Tflops/s, hfu: 149.828 Tflops/s, 18.169 iter/s, 5.504e-02 s/iter, (0.287, 0.000, 0.220) sec
mfu: 204.813 Tflops/s, hfu: 204.813 Tflops/s, 24.837 iter/s, 4.026e-02 s/iter, (0.239, 0.000, 0.161) sec
# orchestrated_attn_func fused
mfu: 224.767 Tflops/s, hfu: 224.767 Tflops/s, 27.257 iter/s, 3.669e-02 s/iter, (0.220, 0.000, 0.147) sec
mfu: 218.272 Tflops/s, hfu: 218.272 Tflops/s, 26.469 iter/s, 3.778e-02 s/iter, (0.224, 0.000, 0.151) sec
mfu: 204.172 Tflops/s, hfu: 204.172 Tflops/s, 24.759 iter/s, 4.039e-02 s/iter, (0.232, 0.000, 0.162) sec
mfu: 200.078 Tflops/s, hfu: 200.078 Tflops/s, 24.263 iter/s, 4.122e-02 s/iter, (0.237, 0.000, 0.165) sec
SP=(1,8),S=(393216,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.747 Tflops/s, hfu: 104.747 Tflops/s, 21.170 iter/s, 4.724e-02 s/iter, (0.522, 0.000, 0.945) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 191.408 Tflops/s, hfu: 191.408 Tflops/s, 38.685 iter/s, 2.585e-02 s/iter, (0.285, 0.000, 0.517) sec
# stripe_flash_attn_func, fwd
mfu: 143.63 Tflops/s, hfu: 143.63 Tflops/s, 29.029 iter/s, 3.445e-02 s/iter, (0.373, 0.000, 0.689) sec
# orchestrated_attn_func
mfu: 163.646 Tflops/s, hfu: 163.646 Tflops/s, 16.537 iter/s, 6.047e-02 s/iter, (0.308, 0.000, 0.242) sec
mfu: 162.227 Tflops/s, hfu: 162.227 Tflops/s, 16.394 iter/s, 6.100e-02 s/iter, (0.313, 0.000, 0.244) sec
mfu: 151.741 Tflops/s, hfu: 151.741 Tflops/s, 15.334 iter/s, 6.521e-02 s/iter, (0.319, 0.000, 0.261) sec
mfu: 205.031 Tflops/s, hfu: 205.031 Tflops/s, 20.719 iter/s, 4.826e-02 s/iter, (0.267, 0.000, 0.193) sec
# orchestrated_attn_func fused
mfu: 225.66 Tflops/s, hfu: 225.66 Tflops/s, 22.804 iter/s, 4.385e-02 s/iter, (0.249, 0.000, 0.175) sec
mfu: 218.891 Tflops/s, hfu: 218.891 Tflops/s, 22.120 iter/s, 4.521e-02 s/iter, (0.252, 0.000, 0.181) sec
mfu: 204.598 Tflops/s, hfu: 204.598 Tflops/s, 20.676 iter/s, 4.837e-02 s/iter, (0.265, 0.000, 0.193) sec
mfu: 200.2 Tflops/s, hfu: 200.2 Tflops/s, 20.231 iter/s, 4.943e-02 s/iter, (0.269, 0.000, 0.198) sec
SP=(1,8),S=(393216,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 103.616 Tflops/s, hfu: 103.616 Tflops/s, 17.950 iter/s, 5.571e-02 s/iter, (0.609, 0.000, 1.114) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 190.281 Tflops/s, hfu: 190.281 Tflops/s, 32.964 iter/s, 3.034e-02 s/iter, (0.333, 0.000, 0.607) sec
# stripe_flash_attn_func, fwd
mfu: 138.424 Tflops/s, hfu: 138.424 Tflops/s, 23.980 iter/s, 4.170e-02 s/iter, (0.453, 0.000, 0.834) sec
# orchestrated_attn_func
mfu: 176.981 Tflops/s, hfu: 176.981 Tflops/s, 15.330 iter/s, 6.523e-02 s/iter, (0.346, 0.000, 0.261) sec
mfu: 168.237 Tflops/s, hfu: 168.237 Tflops/s, 14.572 iter/s, 6.862e-02 s/iter, (0.353, 0.000, 0.274) sec
mfu: 150.038 Tflops/s, hfu: 150.038 Tflops/s, 12.996 iter/s, 7.695e-02 s/iter, (0.373, 0.000, 0.308) sec
mfu: 205.129 Tflops/s, hfu: 205.129 Tflops/s, 17.768 iter/s, 5.628e-02 s/iter, (0.294, 0.000, 0.225) sec
# orchestrated_attn_func fused
mfu: 226.655 Tflops/s, hfu: 226.655 Tflops/s, 19.633 iter/s, 5.094e-02 s/iter, (0.274, 0.000, 0.204) sec
mfu: 219.588 Tflops/s, hfu: 219.588 Tflops/s, 19.020 iter/s, 5.258e-02 s/iter, (0.284, 0.000, 0.210) sec
mfu: 204.747 Tflops/s, hfu: 204.747 Tflops/s, 17.735 iter/s, 5.639e-02 s/iter, (0.296, 0.000, 0.226) sec
mfu: 200.155 Tflops/s, hfu: 200.155 Tflops/s, 17.337 iter/s, 5.768e-02 s/iter, (0.302, 0.000, 0.231) sec
SP=(1,8),S=(393216,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 104.092 Tflops/s, hfu: 104.092 Tflops/s, 15.779 iter/s, 6.338e-02 s/iter, (0.697, 0.000, 1.268) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 191.092 Tflops/s, hfu: 191.092 Tflops/s, 28.966 iter/s, 3.452e-02 s/iter, (0.380, 0.000, 0.690) sec
# stripe_flash_attn_func, fwd
mfu: 134.465 Tflops/s, hfu: 134.465 Tflops/s, 20.383 iter/s, 4.906e-02 s/iter, (0.529, 0.000, 0.981) sec
# orchestrated_attn_func
mfu: 174.817 Tflops/s, hfu: 174.817 Tflops/s, 13.250 iter/s, 7.547e-02 s/iter, (0.383, 0.000, 0.302) sec
mfu: 164.574 Tflops/s, hfu: 164.574 Tflops/s, 12.473 iter/s, 8.017e-02 s/iter, (0.401, 0.000, 0.321) sec
mfu: 160.016 Tflops/s, hfu: 160.016 Tflops/s, 12.128 iter/s, 8.246e-02 s/iter, (0.415, 0.000, 0.330) sec
mfu: 205.201 Tflops/s, hfu: 205.201 Tflops/s, 15.552 iter/s, 6.430e-02 s/iter, (0.335, 0.000, 0.257) sec
# orchestrated_attn_func fused
mfu: 227.146 Tflops/s, hfu: 227.146 Tflops/s, 17.216 iter/s, 5.809e-02 s/iter, (0.306, 0.000, 0.232) sec
mfu: 219.638 Tflops/s, hfu: 219.638 Tflops/s, 16.647 iter/s, 6.007e-02 s/iter, (0.311, 0.000, 0.240) sec
mfu: 204.822 Tflops/s, hfu: 204.822 Tflops/s, 15.524 iter/s, 6.442e-02 s/iter, (0.328, 0.000, 0.258) sec
mfu: 200.376 Tflops/s, hfu: 200.376 Tflops/s, 15.187 iter/s, 6.585e-02 s/iter, (0.335, 0.000, 0.263) sec
SP=(1,8),S=(458752,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 11.37 Tflops/s, hfu: 11.37 Tflops/s, 378.185 iter/s, 2.644e-03 s/iter, (0.035, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.93 Tflops/s, hfu: 20.93 Tflops/s, 696.150 iter/s, 1.436e-03 s/iter, (0.017, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 9.773 Tflops/s, hfu: 9.773 Tflops/s, 325.055 iter/s, 3.076e-03 s/iter, (0.037, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 30.031 Tflops/s, hfu: 30.031 Tflops/s, 499.443 iter/s, 2.002e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 67.822 Tflops/s, hfu: 67.822 Tflops/s, 1127.935 iter/s, 8.866e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 91.466 Tflops/s, hfu: 91.466 Tflops/s, 1521.144 iter/s, 6.574e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 125.494 Tflops/s, hfu: 125.494 Tflops/s, 2087.055 iter/s, 4.791e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 42.219 Tflops/s, hfu: 42.219 Tflops/s, 702.129 iter/s, 1.424e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 68.099 Tflops/s, hfu: 68.099 Tflops/s, 1132.534 iter/s, 8.830e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 99.539 Tflops/s, hfu: 99.539 Tflops/s, 1655.410 iter/s, 6.041e-04 s/iter, (0.073, 0.000, 0.002) sec
mfu: 155.963 Tflops/s, hfu: 155.963 Tflops/s, 2593.792 iter/s, 3.855e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(458752,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.75 Tflops/s, hfu: 22.75 Tflops/s, 378.348 iter/s, 2.643e-03 s/iter, (0.041, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.48 Tflops/s, hfu: 41.48 Tflops/s, 689.841 iter/s, 1.450e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 19.563 Tflops/s, hfu: 19.563 Tflops/s, 325.353 iter/s, 3.074e-03 s/iter, (0.038, 0.000, 0.061) sec
# orchestrated_attn_func
mfu: 57.859 Tflops/s, hfu: 57.859 Tflops/s, 481.119 iter/s, 2.078e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 104.434 Tflops/s, hfu: 104.434 Tflops/s, 868.405 iter/s, 1.152e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 120.162 Tflops/s, hfu: 120.162 Tflops/s, 999.193 iter/s, 1.001e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 155.655 Tflops/s, hfu: 155.655 Tflops/s, 1294.331 iter/s, 7.726e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 71.338 Tflops/s, hfu: 71.338 Tflops/s, 593.201 iter/s, 1.686e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 104.443 Tflops/s, hfu: 104.443 Tflops/s, 868.484 iter/s, 1.151e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 135.424 Tflops/s, hfu: 135.424 Tflops/s, 1126.106 iter/s, 8.880e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 170.953 Tflops/s, hfu: 170.953 Tflops/s, 1421.537 iter/s, 7.035e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(458752,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.759 Tflops/s, hfu: 33.759 Tflops/s, 374.291 iter/s, 2.672e-03 s/iter, (0.040, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 61.745 Tflops/s, hfu: 61.745 Tflops/s, 684.578 iter/s, 1.461e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 29.102 Tflops/s, hfu: 29.102 Tflops/s, 322.659 iter/s, 3.099e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 80.495 Tflops/s, hfu: 80.495 Tflops/s, 446.229 iter/s, 2.241e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 122.502 Tflops/s, hfu: 122.502 Tflops/s, 679.101 iter/s, 1.473e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 131.364 Tflops/s, hfu: 131.364 Tflops/s, 728.226 iter/s, 1.373e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 167.5 Tflops/s, hfu: 167.5 Tflops/s, 928.553 iter/s, 1.077e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 92.671 Tflops/s, hfu: 92.671 Tflops/s, 513.731 iter/s, 1.947e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 126.617 Tflops/s, hfu: 126.617 Tflops/s, 701.912 iter/s, 1.425e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 155.159 Tflops/s, hfu: 155.159 Tflops/s, 860.135 iter/s, 1.163e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 174.287 Tflops/s, hfu: 174.287 Tflops/s, 966.176 iter/s, 1.035e-03 s/iter, (0.075, 0.000, 0.004) sec
SP=(1,8),S=(458752,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.72 Tflops/s, hfu: 44.72 Tflops/s, 371.860 iter/s, 2.689e-03 s/iter, (0.038, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 82.517 Tflops/s, hfu: 82.517 Tflops/s, 686.162 iter/s, 1.457e-03 s/iter, (0.020, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 38.744 Tflops/s, hfu: 38.744 Tflops/s, 322.168 iter/s, 3.104e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 92.846 Tflops/s, hfu: 92.846 Tflops/s, 386.025 iter/s, 2.591e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 135.561 Tflops/s, hfu: 135.561 Tflops/s, 563.619 iter/s, 1.774e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 140.171 Tflops/s, hfu: 140.171 Tflops/s, 582.786 iter/s, 1.716e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 173.181 Tflops/s, hfu: 173.181 Tflops/s, 720.034 iter/s, 1.389e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 109.266 Tflops/s, hfu: 109.266 Tflops/s, 454.293 iter/s, 2.201e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 141.454 Tflops/s, hfu: 141.454 Tflops/s, 588.122 iter/s, 1.700e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 163.608 Tflops/s, hfu: 163.608 Tflops/s, 680.231 iter/s, 1.470e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 177.713 Tflops/s, hfu: 177.713 Tflops/s, 738.876 iter/s, 1.353e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(458752,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 51.292 Tflops/s, hfu: 51.292 Tflops/s, 341.211 iter/s, 2.931e-03 s/iter, (0.042, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.758 Tflops/s, hfu: 88.758 Tflops/s, 590.448 iter/s, 1.694e-03 s/iter, (0.023, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 48.453 Tflops/s, hfu: 48.453 Tflops/s, 322.325 iter/s, 3.102e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 109.093 Tflops/s, hfu: 109.093 Tflops/s, 362.862 iter/s, 2.756e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 142.628 Tflops/s, hfu: 142.628 Tflops/s, 474.403 iter/s, 2.108e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 145.319 Tflops/s, hfu: 145.319 Tflops/s, 483.353 iter/s, 2.069e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 176.146 Tflops/s, hfu: 176.146 Tflops/s, 585.889 iter/s, 1.707e-03 s/iter, (0.077, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 122.011 Tflops/s, hfu: 122.011 Tflops/s, 405.828 iter/s, 2.464e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 151.884 Tflops/s, hfu: 151.884 Tflops/s, 505.189 iter/s, 1.979e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 170.952 Tflops/s, hfu: 170.952 Tflops/s, 568.611 iter/s, 1.759e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 180.63 Tflops/s, hfu: 180.63 Tflops/s, 600.803 iter/s, 1.664e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(458752,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.48 Tflops/s, hfu: 56.48 Tflops/s, 313.102 iter/s, 3.194e-03 s/iter, (0.043, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.149 Tflops/s, hfu: 92.149 Tflops/s, 510.834 iter/s, 1.958e-03 s/iter, (0.026, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 57.961 Tflops/s, hfu: 57.961 Tflops/s, 321.310 iter/s, 3.112e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 119.27 Tflops/s, hfu: 119.27 Tflops/s, 330.591 iter/s, 3.025e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 147.947 Tflops/s, hfu: 147.947 Tflops/s, 410.078 iter/s, 2.439e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 151.96 Tflops/s, hfu: 151.96 Tflops/s, 421.202 iter/s, 2.374e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 179.573 Tflops/s, hfu: 179.573 Tflops/s, 497.740 iter/s, 2.009e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 132.689 Tflops/s, hfu: 132.689 Tflops/s, 367.786 iter/s, 2.719e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 162.14 Tflops/s, hfu: 162.14 Tflops/s, 449.419 iter/s, 2.225e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 177.226 Tflops/s, hfu: 177.226 Tflops/s, 491.232 iter/s, 2.036e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 181.449 Tflops/s, hfu: 181.449 Tflops/s, 502.939 iter/s, 1.988e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(458752,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.393 Tflops/s, hfu: 60.393 Tflops/s, 286.968 iter/s, 3.485e-03 s/iter, (0.047, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.604 Tflops/s, hfu: 93.604 Tflops/s, 444.771 iter/s, 2.248e-03 s/iter, (0.030, 0.000, 0.045) sec
# stripe_flash_attn_func, fwd
mfu: 67.754 Tflops/s, hfu: 67.754 Tflops/s, 321.944 iter/s, 3.106e-03 s/iter, (0.040, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 133.212 Tflops/s, hfu: 133.212 Tflops/s, 316.487 iter/s, 3.160e-03 s/iter, (0.085, 0.000, 0.013) sec
mfu: 152.827 Tflops/s, hfu: 152.827 Tflops/s, 363.090 iter/s, 2.754e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 156.81 Tflops/s, hfu: 156.81 Tflops/s, 372.553 iter/s, 2.684e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 181.157 Tflops/s, hfu: 181.157 Tflops/s, 430.398 iter/s, 2.323e-03 s/iter, (0.079, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 141.158 Tflops/s, hfu: 141.158 Tflops/s, 335.366 iter/s, 2.982e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 169.662 Tflops/s, hfu: 169.662 Tflops/s, 403.087 iter/s, 2.481e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 181.993 Tflops/s, hfu: 181.993 Tflops/s, 432.384 iter/s, 2.313e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 182.493 Tflops/s, hfu: 182.493 Tflops/s, 433.572 iter/s, 2.306e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(458752,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.774 Tflops/s, hfu: 63.774 Tflops/s, 265.153 iter/s, 3.771e-03 s/iter, (0.049, 0.000, 0.075) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 95.067 Tflops/s, hfu: 95.067 Tflops/s, 395.258 iter/s, 2.530e-03 s/iter, (0.032, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 75.814 Tflops/s, hfu: 75.814 Tflops/s, 315.211 iter/s, 3.172e-03 s/iter, (0.041, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 135.69 Tflops/s, hfu: 135.69 Tflops/s, 282.078 iter/s, 3.545e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 155.117 Tflops/s, hfu: 155.117 Tflops/s, 322.463 iter/s, 3.101e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 150.885 Tflops/s, hfu: 150.885 Tflops/s, 313.666 iter/s, 3.188e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 181.043 Tflops/s, hfu: 181.043 Tflops/s, 376.360 iter/s, 2.657e-03 s/iter, (0.083, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 148.061 Tflops/s, hfu: 148.061 Tflops/s, 307.796 iter/s, 3.249e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 175.265 Tflops/s, hfu: 175.265 Tflops/s, 364.350 iter/s, 2.745e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 185.55 Tflops/s, hfu: 185.55 Tflops/s, 385.730 iter/s, 2.592e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 182.986 Tflops/s, hfu: 182.986 Tflops/s, 380.399 iter/s, 2.629e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(458752,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.475 Tflops/s, hfu: 69.475 Tflops/s, 231.086 iter/s, 4.327e-03 s/iter, (0.056, 0.000, 0.087) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 96.532 Tflops/s, hfu: 96.532 Tflops/s, 321.082 iter/s, 3.114e-03 s/iter, (0.038, 0.000, 0.062) sec
# stripe_flash_attn_func, fwd
mfu: 94.294 Tflops/s, hfu: 94.294 Tflops/s, 313.636 iter/s, 3.188e-03 s/iter, (0.041, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 156.607 Tflops/s, hfu: 156.607 Tflops/s, 260.449 iter/s, 3.840e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 161.109 Tflops/s, hfu: 161.109 Tflops/s, 267.937 iter/s, 3.732e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 155.185 Tflops/s, hfu: 155.185 Tflops/s, 258.084 iter/s, 3.875e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 184.675 Tflops/s, hfu: 184.675 Tflops/s, 307.128 iter/s, 3.256e-03 s/iter, (0.086, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 159.556 Tflops/s, hfu: 159.556 Tflops/s, 265.354 iter/s, 3.769e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 182.134 Tflops/s, hfu: 182.134 Tflops/s, 302.903 iter/s, 3.301e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 190.14 Tflops/s, hfu: 190.14 Tflops/s, 316.217 iter/s, 3.162e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 184.15 Tflops/s, hfu: 184.15 Tflops/s, 306.255 iter/s, 3.265e-03 s/iter, (0.085, 0.000, 0.013) sec
SP=(1,8),S=(458752,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.018 Tflops/s, hfu: 74.018 Tflops/s, 205.162 iter/s, 4.874e-03 s/iter, (0.062, 0.000, 0.097) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.705 Tflops/s, hfu: 98.705 Tflops/s, 273.591 iter/s, 3.655e-03 s/iter, (0.044, 0.000, 0.073) sec
# stripe_flash_attn_func, fwd
mfu: 103.673 Tflops/s, hfu: 103.673 Tflops/s, 287.359 iter/s, 3.480e-03 s/iter, (0.043, 0.000, 0.070) sec
# orchestrated_attn_func
mfu: 170.078 Tflops/s, hfu: 170.078 Tflops/s, 235.711 iter/s, 4.242e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 162.47 Tflops/s, hfu: 162.47 Tflops/s, 225.167 iter/s, 4.441e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 157.292 Tflops/s, hfu: 157.292 Tflops/s, 217.990 iter/s, 4.587e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 185.76 Tflops/s, hfu: 185.76 Tflops/s, 257.445 iter/s, 3.884e-03 s/iter, (0.085, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 168.091 Tflops/s, hfu: 168.091 Tflops/s, 232.957 iter/s, 4.293e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 190.042 Tflops/s, hfu: 190.042 Tflops/s, 263.379 iter/s, 3.797e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 193.324 Tflops/s, hfu: 193.324 Tflops/s, 267.926 iter/s, 3.732e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 184.134 Tflops/s, hfu: 184.134 Tflops/s, 255.191 iter/s, 3.919e-03 s/iter, (0.086, 0.000, 0.016) sec
SP=(1,8),S=(458752,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.204 Tflops/s, hfu: 77.204 Tflops/s, 183.423 iter/s, 5.452e-03 s/iter, (0.068, 0.000, 0.109) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.43 Tflops/s, hfu: 99.43 Tflops/s, 236.228 iter/s, 4.233e-03 s/iter, (0.050, 0.000, 0.085) sec
# stripe_flash_attn_func, fwd
mfu: 119.7 Tflops/s, hfu: 119.7 Tflops/s, 284.387 iter/s, 3.516e-03 s/iter, (0.045, 0.000, 0.070) sec
# orchestrated_attn_func
mfu: 173.88 Tflops/s, hfu: 173.88 Tflops/s, 206.554 iter/s, 4.841e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 162.873 Tflops/s, hfu: 162.873 Tflops/s, 193.478 iter/s, 5.169e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 158.986 Tflops/s, hfu: 158.986 Tflops/s, 188.861 iter/s, 5.295e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 186.661 Tflops/s, hfu: 186.661 Tflops/s, 221.736 iter/s, 4.510e-03 s/iter, (0.090, 0.000, 0.018) sec
# orchestrated_attn_func fused
mfu: 174.882 Tflops/s, hfu: 174.882 Tflops/s, 207.744 iter/s, 4.814e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 194.396 Tflops/s, hfu: 194.396 Tflops/s, 230.925 iter/s, 4.330e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 195.969 Tflops/s, hfu: 195.969 Tflops/s, 232.794 iter/s, 4.296e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 184.7 Tflops/s, hfu: 184.7 Tflops/s, 219.407 iter/s, 4.558e-03 s/iter, (0.088, 0.000, 0.018) sec
SP=(1,8),S=(458752,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.087 Tflops/s, hfu: 80.087 Tflops/s, 166.488 iter/s, 6.006e-03 s/iter, (0.074, 0.000, 0.120) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.99 Tflops/s, hfu: 99.99 Tflops/s, 207.863 iter/s, 4.811e-03 s/iter, (0.056, 0.000, 0.096) sec
# stripe_flash_attn_func, fwd
mfu: 127.862 Tflops/s, hfu: 127.862 Tflops/s, 265.805 iter/s, 3.762e-03 s/iter, (0.047, 0.000, 0.075) sec
# orchestrated_attn_func
mfu: 176.48 Tflops/s, hfu: 176.48 Tflops/s, 183.438 iter/s, 5.451e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 162.033 Tflops/s, hfu: 162.033 Tflops/s, 168.420 iter/s, 5.938e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 159.891 Tflops/s, hfu: 159.891 Tflops/s, 166.194 iter/s, 6.017e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 186.18 Tflops/s, hfu: 186.18 Tflops/s, 193.519 iter/s, 5.167e-03 s/iter, (0.090, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 180.344 Tflops/s, hfu: 180.344 Tflops/s, 187.454 iter/s, 5.335e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 197.965 Tflops/s, hfu: 197.965 Tflops/s, 205.769 iter/s, 4.860e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 198.051 Tflops/s, hfu: 198.051 Tflops/s, 205.859 iter/s, 4.858e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 183.931 Tflops/s, hfu: 183.931 Tflops/s, 191.182 iter/s, 5.231e-03 s/iter, (0.094, 0.000, 0.021) sec
SP=(1,8),S=(458752,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 84.263 Tflops/s, hfu: 84.263 Tflops/s, 140.136 iter/s, 7.136e-03 s/iter, (0.085, 0.000, 0.143) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 101.106 Tflops/s, hfu: 101.106 Tflops/s, 168.146 iter/s, 5.947e-03 s/iter, (0.069, 0.000, 0.119) sec
# stripe_flash_attn_func, fwd
mfu: 142.236 Tflops/s, hfu: 142.236 Tflops/s, 236.549 iter/s, 4.227e-03 s/iter, (0.052, 0.000, 0.085) sec
# orchestrated_attn_func
mfu: 177.298 Tflops/s, hfu: 177.298 Tflops/s, 147.430 iter/s, 6.783e-03 s/iter, (0.100, 0.000, 0.027) sec
mfu: 163.919 Tflops/s, hfu: 163.919 Tflops/s, 136.305 iter/s, 7.336e-03 s/iter, (0.103, 0.000, 0.029) sec
mfu: 159.518 Tflops/s, hfu: 159.518 Tflops/s, 132.646 iter/s, 7.539e-03 s/iter, (0.102, 0.000, 0.030) sec
mfu: 188.191 Tflops/s, hfu: 188.191 Tflops/s, 156.488 iter/s, 6.390e-03 s/iter, (0.100, 0.000, 0.026) sec
# orchestrated_attn_func fused
mfu: 188.436 Tflops/s, hfu: 188.436 Tflops/s, 156.691 iter/s, 6.382e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 203.366 Tflops/s, hfu: 203.366 Tflops/s, 169.107 iter/s, 5.913e-03 s/iter, (0.095, 0.000, 0.024) sec
mfu: 200.528 Tflops/s, hfu: 200.528 Tflops/s, 166.747 iter/s, 5.997e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 184.755 Tflops/s, hfu: 184.755 Tflops/s, 153.631 iter/s, 6.509e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(458752,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 87.262 Tflops/s, hfu: 87.262 Tflops/s, 120.936 iter/s, 8.269e-03 s/iter, (0.096, 0.000, 0.165) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 101.734 Tflops/s, hfu: 101.734 Tflops/s, 140.993 iter/s, 7.093e-03 s/iter, (0.081, 0.000, 0.142) sec
# stripe_flash_attn_func, fwd
mfu: 153.136 Tflops/s, hfu: 153.136 Tflops/s, 212.231 iter/s, 4.712e-03 s/iter, (0.056, 0.000, 0.094) sec
# orchestrated_attn_func
mfu: 178.614 Tflops/s, hfu: 178.614 Tflops/s, 123.770 iter/s, 8.080e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 164.356 Tflops/s, hfu: 164.356 Tflops/s, 113.890 iter/s, 8.780e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 158.458 Tflops/s, hfu: 158.458 Tflops/s, 109.803 iter/s, 9.107e-03 s/iter, (0.106, 0.000, 0.036) sec
mfu: 188.919 Tflops/s, hfu: 188.919 Tflops/s, 130.911 iter/s, 7.639e-03 s/iter, (0.104, 0.000, 0.031) sec
# orchestrated_attn_func fused
mfu: 194.514 Tflops/s, hfu: 194.514 Tflops/s, 134.788 iter/s, 7.419e-03 s/iter, (0.099, 0.000, 0.030) sec
mfu: 206.478 Tflops/s, hfu: 206.478 Tflops/s, 143.078 iter/s, 6.989e-03 s/iter, (0.098, 0.000, 0.028) sec
mfu: 202.659 Tflops/s, hfu: 202.659 Tflops/s, 140.432 iter/s, 7.121e-03 s/iter, (0.099, 0.000, 0.028) sec
mfu: 185.753 Tflops/s, hfu: 185.753 Tflops/s, 128.717 iter/s, 7.769e-03 s/iter, (0.101, 0.000, 0.031) sec
SP=(1,8),S=(458752,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.692 Tflops/s, hfu: 89.692 Tflops/s, 106.546 iter/s, 9.386e-03 s/iter, (0.109, 0.000, 0.188) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.467 Tflops/s, hfu: 102.467 Tflops/s, 121.721 iter/s, 8.215e-03 s/iter, (0.094, 0.000, 0.164) sec
# stripe_flash_attn_func, fwd
mfu: 162.445 Tflops/s, hfu: 162.445 Tflops/s, 192.971 iter/s, 5.182e-03 s/iter, (0.061, 0.000, 0.104) sec
# orchestrated_attn_func
mfu: 177.406 Tflops/s, hfu: 177.406 Tflops/s, 105.371 iter/s, 9.490e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 166.141 Tflops/s, hfu: 166.141 Tflops/s, 98.681 iter/s, 1.013e-02 s/iter, (0.112, 0.000, 0.041) sec
mfu: 159.68 Tflops/s, hfu: 159.68 Tflops/s, 94.843 iter/s, 1.054e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 188.45 Tflops/s, hfu: 188.45 Tflops/s, 111.931 iter/s, 8.934e-03 s/iter, (0.105, 0.000, 0.036) sec
# orchestrated_attn_func fused
mfu: 198.9 Tflops/s, hfu: 198.9 Tflops/s, 118.138 iter/s, 8.465e-03 s/iter, (0.104, 0.000, 0.034) sec
mfu: 210.039 Tflops/s, hfu: 210.039 Tflops/s, 124.754 iter/s, 8.016e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 203.892 Tflops/s, hfu: 203.892 Tflops/s, 121.103 iter/s, 8.257e-03 s/iter, (0.105, 0.000, 0.033) sec
mfu: 186.045 Tflops/s, hfu: 186.045 Tflops/s, 110.503 iter/s, 9.050e-03 s/iter, (0.107, 0.000, 0.036) sec
SP=(1,8),S=(458752,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 91.57 Tflops/s, hfu: 91.57 Tflops/s, 95.180 iter/s, 1.051e-02 s/iter, (0.121, 0.000, 0.210) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.772 Tflops/s, hfu: 102.772 Tflops/s, 106.824 iter/s, 9.361e-03 s/iter, (0.106, 0.000, 0.187) sec
# stripe_flash_attn_func, fwd
mfu: 170.359 Tflops/s, hfu: 170.359 Tflops/s, 177.075 iter/s, 5.647e-03 s/iter, (0.066, 0.000, 0.113) sec
# orchestrated_attn_func
mfu: 177.588 Tflops/s, hfu: 177.588 Tflops/s, 92.294 iter/s, 1.083e-02 s/iter, (0.116, 0.000, 0.043) sec
mfu: 164.755 Tflops/s, hfu: 164.755 Tflops/s, 85.625 iter/s, 1.168e-02 s/iter, (0.116, 0.000, 0.047) sec
mfu: 159.187 Tflops/s, hfu: 159.187 Tflops/s, 82.731 iter/s, 1.209e-02 s/iter, (0.118, 0.000, 0.048) sec
mfu: 189.669 Tflops/s, hfu: 189.669 Tflops/s, 98.573 iter/s, 1.014e-02 s/iter, (0.111, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 202.485 Tflops/s, hfu: 202.485 Tflops/s, 105.234 iter/s, 9.503e-03 s/iter, (0.109, 0.000, 0.038) sec
mfu: 212.054 Tflops/s, hfu: 212.054 Tflops/s, 110.207 iter/s, 9.074e-03 s/iter, (0.107, 0.000, 0.036) sec
mfu: 205.336 Tflops/s, hfu: 205.336 Tflops/s, 106.715 iter/s, 9.371e-03 s/iter, (0.108, 0.000, 0.037) sec
mfu: 186.301 Tflops/s, hfu: 186.301 Tflops/s, 96.823 iter/s, 1.033e-02 s/iter, (0.112, 0.000, 0.041) sec
SP=(1,8),S=(458752,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 94.177 Tflops/s, hfu: 94.177 Tflops/s, 78.312 iter/s, 1.277e-02 s/iter, (0.146, 0.000, 0.255) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.189 Tflops/s, hfu: 103.189 Tflops/s, 85.805 iter/s, 1.165e-02 s/iter, (0.132, 0.000, 0.233) sec
# stripe_flash_attn_func, fwd
mfu: 180.589 Tflops/s, hfu: 180.589 Tflops/s, 150.167 iter/s, 6.659e-03 s/iter, (0.077, 0.000, 0.133) sec
# orchestrated_attn_func
mfu: 175.26 Tflops/s, hfu: 175.26 Tflops/s, 72.868 iter/s, 1.372e-02 s/iter, (0.124, 0.000, 0.055) sec
mfu: 166.692 Tflops/s, hfu: 166.692 Tflops/s, 69.305 iter/s, 1.443e-02 s/iter, (0.128, 0.000, 0.058) sec
mfu: 159.684 Tflops/s, hfu: 159.684 Tflops/s, 66.392 iter/s, 1.506e-02 s/iter, (0.129, 0.000, 0.060) sec
mfu: 190.203 Tflops/s, hfu: 190.203 Tflops/s, 79.080 iter/s, 1.265e-02 s/iter, (0.124, 0.000, 0.051) sec
# orchestrated_attn_func fused
mfu: 207.321 Tflops/s, hfu: 207.321 Tflops/s, 86.198 iter/s, 1.160e-02 s/iter, (0.121, 0.000, 0.046) sec
mfu: 214.882 Tflops/s, hfu: 214.882 Tflops/s, 89.341 iter/s, 1.119e-02 s/iter, (0.118, 0.000, 0.045) sec
mfu: 206.696 Tflops/s, hfu: 206.696 Tflops/s, 85.938 iter/s, 1.164e-02 s/iter, (0.118, 0.000, 0.047) sec
mfu: 186.817 Tflops/s, hfu: 186.817 Tflops/s, 77.673 iter/s, 1.287e-02 s/iter, (0.122, 0.000, 0.051) sec
SP=(1,8),S=(458752,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 95.712 Tflops/s, hfu: 95.712 Tflops/s, 66.323 iter/s, 1.508e-02 s/iter, (0.173, 0.000, 0.302) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.919 Tflops/s, hfu: 103.919 Tflops/s, 72.010 iter/s, 1.389e-02 s/iter, (0.157, 0.000, 0.278) sec
# stripe_flash_attn_func, fwd
mfu: 189.638 Tflops/s, hfu: 189.638 Tflops/s, 131.409 iter/s, 7.610e-03 s/iter, (0.088, 0.000, 0.152) sec
# orchestrated_attn_func
mfu: 177.03 Tflops/s, hfu: 177.03 Tflops/s, 61.336 iter/s, 1.630e-02 s/iter, (0.135, 0.000, 0.065) sec
mfu: 164.725 Tflops/s, hfu: 164.725 Tflops/s, 57.073 iter/s, 1.752e-02 s/iter, (0.143, 0.000, 0.070) sec
mfu: 160.036 Tflops/s, hfu: 160.036 Tflops/s, 55.448 iter/s, 1.803e-02 s/iter, (0.144, 0.000, 0.072) sec
mfu: 190.54 Tflops/s, hfu: 190.54 Tflops/s, 66.017 iter/s, 1.515e-02 s/iter, (0.135, 0.000, 0.061) sec
# orchestrated_attn_func fused
mfu: 210.798 Tflops/s, hfu: 210.798 Tflops/s, 73.036 iter/s, 1.369e-02 s/iter, (0.128, 0.000, 0.055) sec
mfu: 216.717 Tflops/s, hfu: 216.717 Tflops/s, 75.087 iter/s, 1.332e-02 s/iter, (0.124, 0.000, 0.053) sec
mfu: 207.92 Tflops/s, hfu: 207.92 Tflops/s, 72.039 iter/s, 1.388e-02 s/iter, (0.126, 0.000, 0.056) sec
mfu: 187.212 Tflops/s, hfu: 187.212 Tflops/s, 64.864 iter/s, 1.542e-02 s/iter, (0.132, 0.000, 0.062) sec
SP=(1,8),S=(458752,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 97.024 Tflops/s, hfu: 97.024 Tflops/s, 57.628 iter/s, 1.735e-02 s/iter, (0.196, 0.000, 0.347) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.807 Tflops/s, hfu: 103.807 Tflops/s, 61.657 iter/s, 1.622e-02 s/iter, (0.185, 0.000, 0.324) sec
# stripe_flash_attn_func, fwd
mfu: 195.674 Tflops/s, hfu: 195.674 Tflops/s, 116.221 iter/s, 8.604e-03 s/iter, (0.098, 0.000, 0.172) sec
# orchestrated_attn_func
mfu: 177.652 Tflops/s, hfu: 177.652 Tflops/s, 52.759 iter/s, 1.895e-02 s/iter, (0.146, 0.000, 0.076) sec
mfu: 163.631 Tflops/s, hfu: 163.631 Tflops/s, 48.595 iter/s, 2.058e-02 s/iter, (0.155, 0.000, 0.082) sec
mfu: 160.17 Tflops/s, hfu: 160.17 Tflops/s, 47.567 iter/s, 2.102e-02 s/iter, (0.156, 0.000, 0.084) sec
mfu: 190.729 Tflops/s, hfu: 190.729 Tflops/s, 56.642 iter/s, 1.765e-02 s/iter, (0.141, 0.000, 0.071) sec
# orchestrated_attn_func fused
mfu: 213.521 Tflops/s, hfu: 213.521 Tflops/s, 63.411 iter/s, 1.577e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 218.085 Tflops/s, hfu: 218.085 Tflops/s, 64.767 iter/s, 1.544e-02 s/iter, (0.133, 0.000, 0.062) sec
mfu: 208.673 Tflops/s, hfu: 208.673 Tflops/s, 61.971 iter/s, 1.614e-02 s/iter, (0.139, 0.000, 0.065) sec
mfu: 187.281 Tflops/s, hfu: 187.281 Tflops/s, 55.618 iter/s, 1.798e-02 s/iter, (0.143, 0.000, 0.072) sec
SP=(1,8),S=(458752,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 97.855 Tflops/s, hfu: 97.855 Tflops/s, 50.856 iter/s, 1.966e-02 s/iter, (0.221, 0.000, 0.393) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.476 Tflops/s, hfu: 103.476 Tflops/s, 53.778 iter/s, 1.860e-02 s/iter, (0.208, 0.000, 0.372) sec
# stripe_flash_attn_func, fwd
mfu: 200.135 Tflops/s, hfu: 200.135 Tflops/s, 104.012 iter/s, 9.614e-03 s/iter, (0.110, 0.000, 0.192) sec
# orchestrated_attn_func
mfu: 176.216 Tflops/s, hfu: 176.216 Tflops/s, 45.791 iter/s, 2.184e-02 s/iter, (0.159, 0.000, 0.087) sec
mfu: 166.06 Tflops/s, hfu: 166.06 Tflops/s, 43.152 iter/s, 2.317e-02 s/iter, (0.165, 0.000, 0.093) sec
mfu: 160.325 Tflops/s, hfu: 160.325 Tflops/s, 41.661 iter/s, 2.400e-02 s/iter, (0.166, 0.000, 0.096) sec
mfu: 190.909 Tflops/s, hfu: 190.909 Tflops/s, 49.609 iter/s, 2.016e-02 s/iter, (0.153, 0.000, 0.081) sec
# orchestrated_attn_func fused
mfu: 215.45 Tflops/s, hfu: 215.45 Tflops/s, 55.986 iter/s, 1.786e-02 s/iter, (0.142, 0.000, 0.071) sec
mfu: 219.609 Tflops/s, hfu: 219.609 Tflops/s, 57.067 iter/s, 1.752e-02 s/iter, (0.141, 0.000, 0.070) sec
mfu: 209.227 Tflops/s, hfu: 209.227 Tflops/s, 54.369 iter/s, 1.839e-02 s/iter, (0.147, 0.000, 0.074) sec
mfu: 187.597 Tflops/s, hfu: 187.597 Tflops/s, 48.748 iter/s, 2.051e-02 s/iter, (0.153, 0.000, 0.082) sec
SP=(1,8),S=(458752,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 98.889 Tflops/s, hfu: 98.889 Tflops/s, 41.115 iter/s, 2.432e-02 s/iter, (0.276, 0.000, 0.486) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.495 Tflops/s, hfu: 103.495 Tflops/s, 43.030 iter/s, 2.324e-02 s/iter, (0.259, 0.000, 0.465) sec
# stripe_flash_attn_func, fwd
mfu: 206.878 Tflops/s, hfu: 206.878 Tflops/s, 86.014 iter/s, 1.163e-02 s/iter, (0.134, 0.000, 0.233) sec
# orchestrated_attn_func
mfu: 174.105 Tflops/s, hfu: 174.105 Tflops/s, 36.194 iter/s, 2.763e-02 s/iter, (0.180, 0.000, 0.111) sec
mfu: 166.534 Tflops/s, hfu: 166.534 Tflops/s, 34.620 iter/s, 2.889e-02 s/iter, (0.186, 0.000, 0.116) sec
mfu: 160.627 Tflops/s, hfu: 160.627 Tflops/s, 33.392 iter/s, 2.995e-02 s/iter, (0.190, 0.000, 0.120) sec
mfu: 191.111 Tflops/s, hfu: 191.111 Tflops/s, 39.729 iter/s, 2.517e-02 s/iter, (0.172, 0.000, 0.101) sec
# orchestrated_attn_func fused
mfu: 218.306 Tflops/s, hfu: 218.306 Tflops/s, 45.382 iter/s, 2.203e-02 s/iter, (0.158, 0.000, 0.088) sec
mfu: 221.291 Tflops/s, hfu: 221.291 Tflops/s, 46.003 iter/s, 2.174e-02 s/iter, (0.160, 0.000, 0.087) sec
mfu: 209.942 Tflops/s, hfu: 209.942 Tflops/s, 43.644 iter/s, 2.291e-02 s/iter, (0.164, 0.000, 0.092) sec
mfu: 187.757 Tflops/s, hfu: 187.757 Tflops/s, 39.032 iter/s, 2.562e-02 s/iter, (0.174, 0.000, 0.102) sec
SP=(1,8),S=(458752,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.885 Tflops/s, hfu: 99.885 Tflops/s, 34.608 iter/s, 2.890e-02 s/iter, (0.323, 0.000, 0.578) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.493 Tflops/s, hfu: 103.493 Tflops/s, 35.858 iter/s, 2.789e-02 s/iter, (0.311, 0.000, 0.558) sec
# stripe_flash_attn_func, fwd
mfu: 209.085 Tflops/s, hfu: 209.085 Tflops/s, 72.442 iter/s, 1.380e-02 s/iter, (0.156, 0.000, 0.276) sec
# orchestrated_attn_func
mfu: 177.375 Tflops/s, hfu: 177.375 Tflops/s, 30.728 iter/s, 3.254e-02 s/iter, (0.199, 0.000, 0.130) sec
mfu: 168.343 Tflops/s, hfu: 168.343 Tflops/s, 29.163 iter/s, 3.429e-02 s/iter, (0.208, 0.000, 0.137) sec
mfu: 160.746 Tflops/s, hfu: 160.746 Tflops/s, 27.847 iter/s, 3.591e-02 s/iter, (0.214, 0.000, 0.144) sec
mfu: 191.319 Tflops/s, hfu: 191.319 Tflops/s, 33.144 iter/s, 3.017e-02 s/iter, (0.194, 0.000, 0.121) sec
# orchestrated_attn_func fused
mfu: 220.219 Tflops/s, hfu: 220.219 Tflops/s, 38.150 iter/s, 2.621e-02 s/iter, (0.175, 0.000, 0.105) sec
mfu: 222.197 Tflops/s, hfu: 222.197 Tflops/s, 38.493 iter/s, 2.598e-02 s/iter, (0.177, 0.000, 0.104) sec
mfu: 210.726 Tflops/s, hfu: 210.726 Tflops/s, 36.506 iter/s, 2.739e-02 s/iter, (0.181, 0.000, 0.110) sec
mfu: 188.039 Tflops/s, hfu: 188.039 Tflops/s, 32.575 iter/s, 3.070e-02 s/iter, (0.193, 0.000, 0.123) sec
SP=(1,8),S=(458752,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.943 Tflops/s, hfu: 99.943 Tflops/s, 29.681 iter/s, 3.369e-02 s/iter, (0.379, 0.000, 0.674) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.684 Tflops/s, hfu: 103.684 Tflops/s, 30.792 iter/s, 3.248e-02 s/iter, (0.363, 0.000, 0.650) sec
# stripe_flash_attn_func, fwd
mfu: 208.709 Tflops/s, hfu: 208.709 Tflops/s, 61.982 iter/s, 1.613e-02 s/iter, (0.181, 0.000, 0.323) sec
# orchestrated_attn_func
mfu: 177.218 Tflops/s, hfu: 177.218 Tflops/s, 26.315 iter/s, 3.800e-02 s/iter, (0.226, 0.000, 0.152) sec
mfu: 167.695 Tflops/s, hfu: 167.695 Tflops/s, 24.901 iter/s, 4.016e-02 s/iter, (0.235, 0.000, 0.161) sec
mfu: 160.718 Tflops/s, hfu: 160.718 Tflops/s, 23.865 iter/s, 4.190e-02 s/iter, (0.234, 0.000, 0.168) sec
mfu: 191.468 Tflops/s, hfu: 191.468 Tflops/s, 28.431 iter/s, 3.517e-02 s/iter, (0.211, 0.000, 0.141) sec
# orchestrated_attn_func fused
mfu: 221.575 Tflops/s, hfu: 221.575 Tflops/s, 32.901 iter/s, 3.039e-02 s/iter, (0.192, 0.000, 0.122) sec
mfu: 223.2 Tflops/s, hfu: 223.2 Tflops/s, 33.143 iter/s, 3.017e-02 s/iter, (0.192, 0.000, 0.121) sec
mfu: 211.096 Tflops/s, hfu: 211.096 Tflops/s, 31.345 iter/s, 3.190e-02 s/iter, (0.198, 0.000, 0.128) sec
mfu: 188.066 Tflops/s, hfu: 188.066 Tflops/s, 27.926 iter/s, 3.581e-02 s/iter, (0.223, 0.000, 0.143) sec
SP=(1,8),S=(458752,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 100.029 Tflops/s, hfu: 100.029 Tflops/s, 25.993 iter/s, 3.847e-02 s/iter, (0.432, 0.000, 0.769) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.195 Tflops/s, hfu: 116.195 Tflops/s, 30.194 iter/s, 3.312e-02 s/iter, (0.364, 0.000, 0.662) sec
# stripe_flash_attn_func, fwd
mfu: 196.463 Tflops/s, hfu: 196.463 Tflops/s, 51.052 iter/s, 1.959e-02 s/iter, (0.219, 0.000, 0.392) sec
# orchestrated_attn_func
mfu: 175.298 Tflops/s, hfu: 175.298 Tflops/s, 22.776 iter/s, 4.391e-02 s/iter, (0.256, 0.000, 0.176) sec
mfu: 167.235 Tflops/s, hfu: 167.235 Tflops/s, 21.728 iter/s, 4.602e-02 s/iter, (0.257, 0.000, 0.184) sec
mfu: 161.147 Tflops/s, hfu: 161.147 Tflops/s, 20.937 iter/s, 4.776e-02 s/iter, (0.260, 0.000, 0.191) sec
mfu: 191.611 Tflops/s, hfu: 191.611 Tflops/s, 24.896 iter/s, 4.017e-02 s/iter, (0.232, 0.000, 0.161) sec
# orchestrated_attn_func fused
mfu: 222.718 Tflops/s, hfu: 222.718 Tflops/s, 28.937 iter/s, 3.456e-02 s/iter, (0.209, 0.000, 0.138) sec
mfu: 223.753 Tflops/s, hfu: 223.753 Tflops/s, 29.072 iter/s, 3.440e-02 s/iter, (0.209, 0.000, 0.138) sec
mfu: 211.452 Tflops/s, hfu: 211.452 Tflops/s, 27.473 iter/s, 3.640e-02 s/iter, (0.220, 0.000, 0.146) sec
mfu: 187.986 Tflops/s, hfu: 187.986 Tflops/s, 24.425 iter/s, 4.094e-02 s/iter, (0.235, 0.000, 0.164) sec
SP=(1,8),S=(458752,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.627 Tflops/s, hfu: 99.627 Tflops/s, 20.711 iter/s, 4.828e-02 s/iter, (0.534, 0.000, 0.966) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 141.642 Tflops/s, hfu: 141.642 Tflops/s, 29.445 iter/s, 3.396e-02 s/iter, (0.374, 0.000, 0.679) sec
# stripe_flash_attn_func, fwd
mfu: 179.172 Tflops/s, hfu: 179.172 Tflops/s, 37.247 iter/s, 2.685e-02 s/iter, (0.295, 0.000, 0.537) sec
# orchestrated_attn_func
mfu: 178.269 Tflops/s, hfu: 178.269 Tflops/s, 18.530 iter/s, 5.397e-02 s/iter, (0.289, 0.000, 0.216) sec
mfu: 167.052 Tflops/s, hfu: 167.052 Tflops/s, 17.364 iter/s, 5.759e-02 s/iter, (0.300, 0.000, 0.230) sec
mfu: 161.366 Tflops/s, hfu: 161.366 Tflops/s, 16.773 iter/s, 5.962e-02 s/iter, (0.306, 0.000, 0.238) sec
mfu: 191.859 Tflops/s, hfu: 191.859 Tflops/s, 19.942 iter/s, 5.014e-02 s/iter, (0.277, 0.000, 0.201) sec
# orchestrated_attn_func fused
mfu: 224.073 Tflops/s, hfu: 224.073 Tflops/s, 23.291 iter/s, 4.294e-02 s/iter, (0.245, 0.000, 0.172) sec
mfu: 224.543 Tflops/s, hfu: 224.543 Tflops/s, 23.339 iter/s, 4.285e-02 s/iter, (0.244, 0.000, 0.171) sec
mfu: 211.85 Tflops/s, hfu: 211.85 Tflops/s, 22.020 iter/s, 4.541e-02 s/iter, (0.252, 0.000, 0.182) sec
mfu: 188.257 Tflops/s, hfu: 188.257 Tflops/s, 19.568 iter/s, 5.110e-02 s/iter, (0.279, 0.000, 0.204) sec
SP=(1,8),S=(458752,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.903 Tflops/s, hfu: 99.903 Tflops/s, 17.307 iter/s, 5.778e-02 s/iter, (0.640, 0.000, 1.156) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 158.739 Tflops/s, hfu: 158.739 Tflops/s, 27.499 iter/s, 3.636e-02 s/iter, (0.403, 0.000, 0.727) sec
# stripe_flash_attn_func, fwd
mfu: 167.418 Tflops/s, hfu: 167.418 Tflops/s, 29.003 iter/s, 3.448e-02 s/iter, (0.378, 0.000, 0.690) sec
# orchestrated_attn_func
mfu: 178.695 Tflops/s, hfu: 178.695 Tflops/s, 15.478 iter/s, 6.461e-02 s/iter, (0.330, 0.000, 0.258) sec
mfu: 168.131 Tflops/s, hfu: 168.131 Tflops/s, 14.563 iter/s, 6.867e-02 s/iter, (0.354, 0.000, 0.275) sec
mfu: 160.986 Tflops/s, hfu: 160.986 Tflops/s, 13.944 iter/s, 7.171e-02 s/iter, (0.354, 0.000, 0.287) sec
mfu: 191.98 Tflops/s, hfu: 191.98 Tflops/s, 16.629 iter/s, 6.014e-02 s/iter, (0.318, 0.000, 0.241) sec
# orchestrated_attn_func fused
mfu: 225.563 Tflops/s, hfu: 225.563 Tflops/s, 19.538 iter/s, 5.118e-02 s/iter, (0.275, 0.000, 0.205) sec
mfu: 225.25 Tflops/s, hfu: 225.25 Tflops/s, 19.511 iter/s, 5.125e-02 s/iter, (0.279, 0.000, 0.205) sec
mfu: 212.363 Tflops/s, hfu: 212.363 Tflops/s, 18.395 iter/s, 5.436e-02 s/iter, (0.291, 0.000, 0.217) sec
mfu: 188.244 Tflops/s, hfu: 188.244 Tflops/s, 16.305 iter/s, 6.133e-02 s/iter, (0.320, 0.000, 0.245) sec
SP=(1,8),S=(458752,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.631 Tflops/s, hfu: 99.631 Tflops/s, 14.794 iter/s, 6.759e-02 s/iter, (0.748, 0.000, 1.352) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.78 Tflops/s, hfu: 156.78 Tflops/s, 23.280 iter/s, 4.296e-02 s/iter, (0.474, 0.000, 0.859) sec
# stripe_flash_attn_func, fwd
mfu: 154.743 Tflops/s, hfu: 154.743 Tflops/s, 22.978 iter/s, 4.352e-02 s/iter, (0.475, 0.000, 0.870) sec
# orchestrated_attn_func
mfu: 179.267 Tflops/s, hfu: 179.267 Tflops/s, 13.310 iter/s, 7.513e-02 s/iter, (0.375, 0.000, 0.301) sec
mfu: 166.288 Tflops/s, hfu: 166.288 Tflops/s, 12.346 iter/s, 8.100e-02 s/iter, (0.396, 0.000, 0.324) sec
mfu: 161.166 Tflops/s, hfu: 161.166 Tflops/s, 11.966 iter/s, 8.357e-02 s/iter, (0.404, 0.000, 0.334) sec
mfu: 192.01 Tflops/s, hfu: 192.01 Tflops/s, 14.256 iter/s, 7.015e-02 s/iter, (0.357, 0.000, 0.281) sec
# orchestrated_attn_func fused
mfu: 226.31 Tflops/s, hfu: 226.31 Tflops/s, 16.802 iter/s, 5.952e-02 s/iter, (0.309, 0.000, 0.238) sec
mfu: 225.582 Tflops/s, hfu: 225.582 Tflops/s, 16.748 iter/s, 5.971e-02 s/iter, (0.311, 0.000, 0.239) sec
mfu: 212.481 Tflops/s, hfu: 212.481 Tflops/s, 15.776 iter/s, 6.339e-02 s/iter, (0.328, 0.000, 0.254) sec
mfu: 188.398 Tflops/s, hfu: 188.398 Tflops/s, 13.987 iter/s, 7.149e-02 s/iter, (0.357, 0.000, 0.286) sec
SP=(1,8),S=(458752,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 99.56 Tflops/s, hfu: 99.56 Tflops/s, 12.936 iter/s, 7.731e-02 s/iter, (0.854, 0.000, 1.546) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 156.189 Tflops/s, hfu: 156.189 Tflops/s, 20.293 iter/s, 4.928e-02 s/iter, (0.543, 0.000, 0.986) sec
# stripe_flash_attn_func, fwd
mfu: 147.107 Tflops/s, hfu: 147.107 Tflops/s, 19.113 iter/s, 5.232e-02 s/iter, (0.553, 0.000, 1.046) sec
# orchestrated_attn_func
mfu: 176.47 Tflops/s, hfu: 176.47 Tflops/s, 11.464 iter/s, 8.723e-02 s/iter, (0.424, 0.000, 0.349) sec
mfu: 168.187 Tflops/s, hfu: 168.187 Tflops/s, 10.926 iter/s, 9.152e-02 s/iter, (0.439, 0.000, 0.366) sec
mfu: 161.245 Tflops/s, hfu: 161.245 Tflops/s, 10.475 iter/s, 9.546e-02 s/iter, (0.455, 0.000, 0.382) sec
mfu: 192.054 Tflops/s, hfu: 192.054 Tflops/s, 12.477 iter/s, 8.015e-02 s/iter, (0.400, 0.000, 0.321) sec
# orchestrated_attn_func fused
mfu: 226.481 Tflops/s, hfu: 226.481 Tflops/s, 14.713 iter/s, 6.797e-02 s/iter, (0.342, 0.000, 0.272) sec
mfu: 225.984 Tflops/s, hfu: 225.984 Tflops/s, 14.681 iter/s, 6.812e-02 s/iter, (0.345, 0.000, 0.272) sec
mfu: 212.585 Tflops/s, hfu: 212.585 Tflops/s, 13.810 iter/s, 7.241e-02 s/iter, (0.361, 0.000, 0.290) sec
mfu: 188.281 Tflops/s, hfu: 188.281 Tflops/s, 12.231 iter/s, 8.176e-02 s/iter, (0.398, 0.000, 0.327) sec
SP=(1,8),S=(524288,2048),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.831 Tflops/s, hfu: 12.831 Tflops/s, 373.438 iter/s, 2.678e-03 s/iter, (0.037, 0.000, 0.054) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.663 Tflops/s, hfu: 23.663 Tflops/s, 688.686 iter/s, 1.452e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 11.025 Tflops/s, hfu: 11.025 Tflops/s, 320.863 iter/s, 3.117e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 32.249 Tflops/s, hfu: 32.249 Tflops/s, 469.279 iter/s, 2.131e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 68.127 Tflops/s, hfu: 68.127 Tflops/s, 991.371 iter/s, 1.009e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 95.596 Tflops/s, hfu: 95.596 Tflops/s, 1391.099 iter/s, 7.189e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 137.301 Tflops/s, hfu: 137.301 Tflops/s, 1997.986 iter/s, 5.005e-04 s/iter, (0.072, 0.000, 0.002) sec
# orchestrated_attn_func fused
mfu: 41.614 Tflops/s, hfu: 41.614 Tflops/s, 605.561 iter/s, 1.651e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 68.47 Tflops/s, hfu: 68.47 Tflops/s, 996.365 iter/s, 1.004e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 102.398 Tflops/s, hfu: 102.398 Tflops/s, 1490.082 iter/s, 6.711e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 179.017 Tflops/s, hfu: 179.017 Tflops/s, 2605.035 iter/s, 3.839e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(524288,4096),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.819 Tflops/s, hfu: 25.819 Tflops/s, 375.712 iter/s, 2.662e-03 s/iter, (0.038, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 47.474 Tflops/s, hfu: 47.474 Tflops/s, 690.835 iter/s, 1.448e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 22.198 Tflops/s, hfu: 22.198 Tflops/s, 323.021 iter/s, 3.096e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 61.319 Tflops/s, hfu: 61.319 Tflops/s, 446.155 iter/s, 2.241e-03 s/iter, (0.088, 0.000, 0.009) sec
mfu: 107.124 Tflops/s, hfu: 107.124 Tflops/s, 779.433 iter/s, 1.283e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 123.236 Tflops/s, hfu: 123.236 Tflops/s, 896.662 iter/s, 1.115e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 171.147 Tflops/s, hfu: 171.147 Tflops/s, 1245.256 iter/s, 8.030e-04 s/iter, (0.073, 0.000, 0.003) sec
# orchestrated_attn_func fused
mfu: 70.807 Tflops/s, hfu: 70.807 Tflops/s, 515.188 iter/s, 1.941e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 105.593 Tflops/s, hfu: 105.593 Tflops/s, 768.290 iter/s, 1.302e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 139.881 Tflops/s, hfu: 139.881 Tflops/s, 1017.766 iter/s, 9.825e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 194.257 Tflops/s, hfu: 194.257 Tflops/s, 1413.404 iter/s, 7.075e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(524288,6144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.633 Tflops/s, hfu: 38.633 Tflops/s, 374.794 iter/s, 2.668e-03 s/iter, (0.038, 0.000, 0.053) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 70.743 Tflops/s, hfu: 70.743 Tflops/s, 686.297 iter/s, 1.457e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 33.146 Tflops/s, hfu: 33.146 Tflops/s, 321.560 iter/s, 3.110e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 84.693 Tflops/s, hfu: 84.693 Tflops/s, 410.815 iter/s, 2.434e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 126.96 Tflops/s, hfu: 126.96 Tflops/s, 615.836 iter/s, 1.624e-03 s/iter, (0.103, 0.000, 0.006) sec
mfu: 139.28 Tflops/s, hfu: 139.28 Tflops/s, 675.595 iter/s, 1.480e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 188.667 Tflops/s, hfu: 188.667 Tflops/s, 915.154 iter/s, 1.093e-03 s/iter, (0.074, 0.000, 0.004) sec
# orchestrated_attn_func fused
mfu: 92.486 Tflops/s, hfu: 92.486 Tflops/s, 448.614 iter/s, 2.229e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 128.98 Tflops/s, hfu: 128.98 Tflops/s, 625.635 iter/s, 1.598e-03 s/iter, (0.081, 0.000, 0.006) sec
mfu: 158.324 Tflops/s, hfu: 158.324 Tflops/s, 767.974 iter/s, 1.302e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 199.179 Tflops/s, hfu: 199.179 Tflops/s, 966.146 iter/s, 1.035e-03 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(524288,8192),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 49.055 Tflops/s, hfu: 49.055 Tflops/s, 356.926 iter/s, 2.802e-03 s/iter, (0.046, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.953 Tflops/s, hfu: 93.953 Tflops/s, 683.596 iter/s, 1.463e-03 s/iter, (0.020, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 44.024 Tflops/s, hfu: 44.024 Tflops/s, 320.318 iter/s, 3.122e-03 s/iter, (0.039, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 99.402 Tflops/s, hfu: 99.402 Tflops/s, 361.621 iter/s, 2.765e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 138.837 Tflops/s, hfu: 138.837 Tflops/s, 505.085 iter/s, 1.980e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 149.866 Tflops/s, hfu: 149.866 Tflops/s, 545.209 iter/s, 1.834e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 195.973 Tflops/s, hfu: 195.973 Tflops/s, 712.945 iter/s, 1.403e-03 s/iter, (0.075, 0.000, 0.006) sec
# orchestrated_attn_func fused
mfu: 109.1 Tflops/s, hfu: 109.1 Tflops/s, 396.903 iter/s, 2.520e-03 s/iter, (0.083, 0.000, 0.010) sec
mfu: 144.341 Tflops/s, hfu: 144.341 Tflops/s, 525.109 iter/s, 1.904e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 167.928 Tflops/s, hfu: 167.928 Tflops/s, 610.918 iter/s, 1.637e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 203.282 Tflops/s, hfu: 203.282 Tflops/s, 739.536 iter/s, 1.352e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(524288,10240),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.729 Tflops/s, hfu: 55.729 Tflops/s, 324.383 iter/s, 3.083e-03 s/iter, (0.043, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.676 Tflops/s, hfu: 93.676 Tflops/s, 545.267 iter/s, 1.834e-03 s/iter, (0.023, 0.000, 0.037) sec
# stripe_flash_attn_func, fwd
mfu: 54.378 Tflops/s, hfu: 54.378 Tflops/s, 316.519 iter/s, 3.159e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 117.318 Tflops/s, hfu: 117.318 Tflops/s, 341.441 iter/s, 2.929e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 148.211 Tflops/s, hfu: 148.211 Tflops/s, 431.351 iter/s, 2.318e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 150.41 Tflops/s, hfu: 150.41 Tflops/s, 437.752 iter/s, 2.284e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 196.455 Tflops/s, hfu: 196.455 Tflops/s, 571.761 iter/s, 1.749e-03 s/iter, (0.076, 0.000, 0.007) sec
# orchestrated_attn_func fused
mfu: 122.049 Tflops/s, hfu: 122.049 Tflops/s, 355.210 iter/s, 2.815e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 154.414 Tflops/s, hfu: 154.414 Tflops/s, 449.403 iter/s, 2.225e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 176.03 Tflops/s, hfu: 176.03 Tflops/s, 512.314 iter/s, 1.952e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 205.896 Tflops/s, hfu: 205.896 Tflops/s, 599.236 iter/s, 1.669e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(524288,12288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.357 Tflops/s, hfu: 61.357 Tflops/s, 297.618 iter/s, 3.360e-03 s/iter, (0.046, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.624 Tflops/s, hfu: 98.624 Tflops/s, 478.390 iter/s, 2.090e-03 s/iter, (0.026, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 65.282 Tflops/s, hfu: 65.282 Tflops/s, 316.660 iter/s, 3.158e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 119.5 Tflops/s, hfu: 119.5 Tflops/s, 289.825 iter/s, 3.450e-03 s/iter, (0.082, 0.000, 0.014) sec
mfu: 154.246 Tflops/s, hfu: 154.246 Tflops/s, 374.095 iter/s, 2.673e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 155.189 Tflops/s, hfu: 155.189 Tflops/s, 376.384 iter/s, 2.657e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 201.653 Tflops/s, hfu: 201.653 Tflops/s, 489.072 iter/s, 2.045e-03 s/iter, (0.078, 0.000, 0.008) sec
# orchestrated_attn_func fused
mfu: 132.521 Tflops/s, hfu: 132.521 Tflops/s, 321.405 iter/s, 3.111e-03 s/iter, (0.083, 0.000, 0.012) sec
mfu: 164.025 Tflops/s, hfu: 164.025 Tflops/s, 397.813 iter/s, 2.514e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 182.588 Tflops/s, hfu: 182.588 Tflops/s, 442.834 iter/s, 2.258e-03 s/iter, (0.083, 0.000, 0.009) sec
mfu: 206.476 Tflops/s, hfu: 206.476 Tflops/s, 500.771 iter/s, 1.997e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(524288,14336),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.045 Tflops/s, hfu: 66.045 Tflops/s, 274.593 iter/s, 3.642e-03 s/iter, (0.049, 0.000, 0.073) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.792 Tflops/s, hfu: 100.792 Tflops/s, 419.062 iter/s, 2.386e-03 s/iter, (0.030, 0.000, 0.048) sec
# stripe_flash_attn_func, fwd
mfu: 75.937 Tflops/s, hfu: 75.937 Tflops/s, 315.723 iter/s, 3.167e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 134.783 Tflops/s, hfu: 134.783 Tflops/s, 280.194 iter/s, 3.569e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 158.622 Tflops/s, hfu: 158.622 Tflops/s, 329.751 iter/s, 3.033e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 153.34 Tflops/s, hfu: 153.34 Tflops/s, 318.771 iter/s, 3.137e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 204.883 Tflops/s, hfu: 204.883 Tflops/s, 425.920 iter/s, 2.348e-03 s/iter, (0.080, 0.000, 0.009) sec
# orchestrated_attn_func fused
mfu: 141.461 Tflops/s, hfu: 141.461 Tflops/s, 294.075 iter/s, 3.400e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 172.931 Tflops/s, hfu: 172.931 Tflops/s, 359.496 iter/s, 2.782e-03 s/iter, (0.082, 0.000, 0.011) sec
mfu: 187.626 Tflops/s, hfu: 187.626 Tflops/s, 390.045 iter/s, 2.564e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 207.901 Tflops/s, hfu: 207.901 Tflops/s, 432.194 iter/s, 2.314e-03 s/iter, (0.080, 0.000, 0.009) sec
SP=(1,8),S=(524288,16384),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.082 Tflops/s, hfu: 70.082 Tflops/s, 254.956 iter/s, 3.922e-03 s/iter, (0.051, 0.000, 0.078) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.891 Tflops/s, hfu: 102.891 Tflops/s, 374.314 iter/s, 2.672e-03 s/iter, (0.032, 0.000, 0.053) sec
# stripe_flash_attn_func, fwd
mfu: 86.793 Tflops/s, hfu: 86.793 Tflops/s, 315.749 iter/s, 3.167e-03 s/iter, (0.041, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 143.958 Tflops/s, hfu: 143.958 Tflops/s, 261.859 iter/s, 3.819e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 163.153 Tflops/s, hfu: 163.153 Tflops/s, 296.773 iter/s, 3.370e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 152.742 Tflops/s, hfu: 152.742 Tflops/s, 277.836 iter/s, 3.599e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 203.669 Tflops/s, hfu: 203.669 Tflops/s, 370.472 iter/s, 2.699e-03 s/iter, (0.088, 0.000, 0.011) sec
# orchestrated_attn_func fused
mfu: 149.139 Tflops/s, hfu: 149.139 Tflops/s, 271.283 iter/s, 3.686e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 177.643 Tflops/s, hfu: 177.643 Tflops/s, 323.131 iter/s, 3.095e-03 s/iter, (0.084, 0.000, 0.012) sec
mfu: 190.361 Tflops/s, hfu: 190.361 Tflops/s, 346.264 iter/s, 2.888e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 208.435 Tflops/s, hfu: 208.435 Tflops/s, 379.142 iter/s, 2.638e-03 s/iter, (0.081, 0.000, 0.011) sec
SP=(1,8),S=(524288,20480),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.495 Tflops/s, hfu: 76.495 Tflops/s, 222.631 iter/s, 4.492e-03 s/iter, (0.058, 0.000, 0.090) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 106.924 Tflops/s, hfu: 106.924 Tflops/s, 311.189 iter/s, 3.213e-03 s/iter, (0.038, 0.000, 0.064) sec
# stripe_flash_attn_func, fwd
mfu: 105.011 Tflops/s, hfu: 105.011 Tflops/s, 305.622 iter/s, 3.272e-03 s/iter, (0.042, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 163.844 Tflops/s, hfu: 163.844 Tflops/s, 238.425 iter/s, 4.194e-03 s/iter, (0.086, 0.000, 0.017) sec
mfu: 166.243 Tflops/s, hfu: 166.243 Tflops/s, 241.915 iter/s, 4.134e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 157.471 Tflops/s, hfu: 157.471 Tflops/s, 229.151 iter/s, 4.364e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 208.858 Tflops/s, hfu: 208.858 Tflops/s, 303.928 iter/s, 3.290e-03 s/iter, (0.087, 0.000, 0.013) sec
# orchestrated_attn_func fused
mfu: 160.74 Tflops/s, hfu: 160.74 Tflops/s, 233.907 iter/s, 4.275e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 186.725 Tflops/s, hfu: 186.725 Tflops/s, 271.721 iter/s, 3.680e-03 s/iter, (0.086, 0.000, 0.015) sec
mfu: 196.034 Tflops/s, hfu: 196.034 Tflops/s, 285.268 iter/s, 3.505e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 209.542 Tflops/s, hfu: 209.542 Tflops/s, 304.924 iter/s, 3.280e-03 s/iter, (0.086, 0.000, 0.013) sec
SP=(1,8),S=(524288,24576),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.527 Tflops/s, hfu: 81.527 Tflops/s, 197.729 iter/s, 5.057e-03 s/iter, (0.064, 0.000, 0.101) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.034 Tflops/s, hfu: 108.034 Tflops/s, 262.017 iter/s, 3.817e-03 s/iter, (0.044, 0.000, 0.076) sec
# stripe_flash_attn_func, fwd
mfu: 120.34 Tflops/s, hfu: 120.34 Tflops/s, 291.864 iter/s, 3.426e-03 s/iter, (0.044, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 176.085 Tflops/s, hfu: 176.085 Tflops/s, 213.531 iter/s, 4.683e-03 s/iter, (0.088, 0.000, 0.019) sec
mfu: 170.174 Tflops/s, hfu: 170.174 Tflops/s, 206.363 iter/s, 4.846e-03 s/iter, (0.090, 0.000, 0.019) sec
mfu: 160.977 Tflops/s, hfu: 160.977 Tflops/s, 195.210 iter/s, 5.123e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 207.669 Tflops/s, hfu: 207.669 Tflops/s, 251.832 iter/s, 3.971e-03 s/iter, (0.086, 0.000, 0.016) sec
# orchestrated_attn_func fused
mfu: 169.423 Tflops/s, hfu: 169.423 Tflops/s, 205.453 iter/s, 4.867e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 193.356 Tflops/s, hfu: 193.356 Tflops/s, 234.475 iter/s, 4.265e-03 s/iter, (0.088, 0.000, 0.017) sec
mfu: 199.456 Tflops/s, hfu: 199.456 Tflops/s, 241.872 iter/s, 4.134e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 209.896 Tflops/s, hfu: 209.896 Tflops/s, 254.532 iter/s, 3.929e-03 s/iter, (0.086, 0.000, 0.016) sec
SP=(1,8),S=(524288,28672),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 85.73 Tflops/s, hfu: 85.73 Tflops/s, 178.219 iter/s, 5.611e-03 s/iter, (0.070, 0.000, 0.112) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 110.429 Tflops/s, hfu: 110.429 Tflops/s, 229.564 iter/s, 4.356e-03 s/iter, (0.050, 0.000, 0.087) sec
# stripe_flash_attn_func, fwd
mfu: 131.11 Tflops/s, hfu: 131.11 Tflops/s, 272.557 iter/s, 3.669e-03 s/iter, (0.046, 0.000, 0.073) sec
# orchestrated_attn_func
mfu: 180.898 Tflops/s, hfu: 180.898 Tflops/s, 188.030 iter/s, 5.318e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 167.56 Tflops/s, hfu: 167.56 Tflops/s, 174.166 iter/s, 5.742e-03 s/iter, (0.093, 0.000, 0.023) sec
mfu: 158.429 Tflops/s, hfu: 158.429 Tflops/s, 164.675 iter/s, 6.073e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 212.201 Tflops/s, hfu: 212.201 Tflops/s, 220.567 iter/s, 4.534e-03 s/iter, (0.092, 0.000, 0.018) sec
# orchestrated_attn_func fused
mfu: 176.558 Tflops/s, hfu: 176.558 Tflops/s, 183.518 iter/s, 5.449e-03 s/iter, (0.091, 0.000, 0.022) sec
mfu: 198.162 Tflops/s, hfu: 198.162 Tflops/s, 205.974 iter/s, 4.855e-03 s/iter, (0.091, 0.000, 0.019) sec
mfu: 201.785 Tflops/s, hfu: 201.785 Tflops/s, 209.740 iter/s, 4.768e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 210.297 Tflops/s, hfu: 210.297 Tflops/s, 218.587 iter/s, 4.575e-03 s/iter, (0.089, 0.000, 0.018) sec
SP=(1,8),S=(524288,32768),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 89.078 Tflops/s, hfu: 89.078 Tflops/s, 162.031 iter/s, 6.172e-03 s/iter, (0.076, 0.000, 0.123) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.482 Tflops/s, hfu: 111.482 Tflops/s, 202.784 iter/s, 4.931e-03 s/iter, (0.057, 0.000, 0.099) sec
# stripe_flash_attn_func, fwd
mfu: 140.429 Tflops/s, hfu: 140.429 Tflops/s, 255.438 iter/s, 3.915e-03 s/iter, (0.048, 0.000, 0.078) sec
# orchestrated_attn_func
mfu: 186.821 Tflops/s, hfu: 186.821 Tflops/s, 169.913 iter/s, 5.885e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 166.215 Tflops/s, hfu: 166.215 Tflops/s, 151.172 iter/s, 6.615e-03 s/iter, (0.100, 0.000, 0.026) sec
mfu: 161.489 Tflops/s, hfu: 161.489 Tflops/s, 146.874 iter/s, 6.809e-03 s/iter, (0.096, 0.000, 0.027) sec
mfu: 209.221 Tflops/s, hfu: 209.221 Tflops/s, 190.285 iter/s, 5.255e-03 s/iter, (0.090, 0.000, 0.021) sec
# orchestrated_attn_func fused
mfu: 181.954 Tflops/s, hfu: 181.954 Tflops/s, 165.486 iter/s, 6.043e-03 s/iter, (0.094, 0.000, 0.024) sec
mfu: 201.999 Tflops/s, hfu: 201.999 Tflops/s, 183.717 iter/s, 5.443e-03 s/iter, (0.093, 0.000, 0.022) sec
mfu: 204.08 Tflops/s, hfu: 204.08 Tflops/s, 185.609 iter/s, 5.388e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 209.479 Tflops/s, hfu: 209.479 Tflops/s, 190.520 iter/s, 5.249e-03 s/iter, (0.095, 0.000, 0.021) sec
SP=(1,8),S=(524288,40960),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 93.949 Tflops/s, hfu: 93.949 Tflops/s, 136.713 iter/s, 7.315e-03 s/iter, (0.090, 0.000, 0.146) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.816 Tflops/s, hfu: 113.816 Tflops/s, 165.624 iter/s, 6.038e-03 s/iter, (0.069, 0.000, 0.121) sec
# stripe_flash_attn_func, fwd
mfu: 156.989 Tflops/s, hfu: 156.989 Tflops/s, 228.449 iter/s, 4.377e-03 s/iter, (0.053, 0.000, 0.088) sec
# orchestrated_attn_func
mfu: 193.737 Tflops/s, hfu: 193.737 Tflops/s, 140.962 iter/s, 7.094e-03 s/iter, (0.099, 0.000, 0.028) sec
mfu: 170.078 Tflops/s, hfu: 170.078 Tflops/s, 123.748 iter/s, 8.081e-03 s/iter, (0.102, 0.000, 0.032) sec
mfu: 161.799 Tflops/s, hfu: 161.799 Tflops/s, 117.724 iter/s, 8.494e-03 s/iter, (0.105, 0.000, 0.034) sec
mfu: 213.753 Tflops/s, hfu: 213.753 Tflops/s, 155.526 iter/s, 6.430e-03 s/iter, (0.096, 0.000, 0.026) sec
# orchestrated_attn_func fused
mfu: 190.602 Tflops/s, hfu: 190.602 Tflops/s, 138.681 iter/s, 7.211e-03 s/iter, (0.099, 0.000, 0.029) sec
mfu: 207.498 Tflops/s, hfu: 207.498 Tflops/s, 150.975 iter/s, 6.624e-03 s/iter, (0.101, 0.000, 0.026) sec
mfu: 207.138 Tflops/s, hfu: 207.138 Tflops/s, 150.712 iter/s, 6.635e-03 s/iter, (0.097, 0.000, 0.027) sec
mfu: 210.383 Tflops/s, hfu: 210.383 Tflops/s, 153.074 iter/s, 6.533e-03 s/iter, (0.096, 0.000, 0.026) sec
SP=(1,8),S=(524288,49152),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 97.654 Tflops/s, hfu: 97.654 Tflops/s, 118.421 iter/s, 8.444e-03 s/iter, (0.098, 0.000, 0.169) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.207 Tflops/s, hfu: 114.207 Tflops/s, 138.494 iter/s, 7.221e-03 s/iter, (0.081, 0.000, 0.144) sec
# stripe_flash_attn_func, fwd
mfu: 169.728 Tflops/s, hfu: 169.728 Tflops/s, 205.823 iter/s, 4.859e-03 s/iter, (0.058, 0.000, 0.097) sec
# orchestrated_attn_func
mfu: 188.898 Tflops/s, hfu: 188.898 Tflops/s, 114.534 iter/s, 8.731e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 171.948 Tflops/s, hfu: 171.948 Tflops/s, 104.257 iter/s, 9.592e-03 s/iter, (0.109, 0.000, 0.038) sec
mfu: 165.45 Tflops/s, hfu: 165.45 Tflops/s, 100.317 iter/s, 9.968e-03 s/iter, (0.110, 0.000, 0.040) sec
mfu: 211.993 Tflops/s, hfu: 211.993 Tflops/s, 128.538 iter/s, 7.780e-03 s/iter, (0.106, 0.000, 0.031) sec
# orchestrated_attn_func fused
mfu: 196.76 Tflops/s, hfu: 196.76 Tflops/s, 119.302 iter/s, 8.382e-03 s/iter, (0.105, 0.000, 0.034) sec
mfu: 210.786 Tflops/s, hfu: 210.786 Tflops/s, 127.806 iter/s, 7.824e-03 s/iter, (0.103, 0.000, 0.031) sec
mfu: 209.093 Tflops/s, hfu: 209.093 Tflops/s, 126.779 iter/s, 7.888e-03 s/iter, (0.103, 0.000, 0.032) sec
mfu: 211.444 Tflops/s, hfu: 211.444 Tflops/s, 128.205 iter/s, 7.800e-03 s/iter, (0.102, 0.000, 0.031) sec
SP=(1,8),S=(524288,57344),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 100.08 Tflops/s, hfu: 100.08 Tflops/s, 104.025 iter/s, 9.613e-03 s/iter, (0.110, 0.000, 0.192) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.284 Tflops/s, hfu: 115.284 Tflops/s, 119.829 iter/s, 8.345e-03 s/iter, (0.096, 0.000, 0.167) sec
# stripe_flash_attn_func, fwd
mfu: 181.045 Tflops/s, hfu: 181.045 Tflops/s, 188.182 iter/s, 5.314e-03 s/iter, (0.063, 0.000, 0.106) sec
# orchestrated_attn_func
mfu: 188.321 Tflops/s, hfu: 188.321 Tflops/s, 97.873 iter/s, 1.022e-02 s/iter, (0.111, 0.000, 0.041) sec
mfu: 168.143 Tflops/s, hfu: 168.143 Tflops/s, 87.386 iter/s, 1.144e-02 s/iter, (0.115, 0.000, 0.046) sec
mfu: 165.757 Tflops/s, hfu: 165.757 Tflops/s, 86.146 iter/s, 1.161e-02 s/iter, (0.117, 0.000, 0.046) sec
mfu: 215.322 Tflops/s, hfu: 215.322 Tflops/s, 111.905 iter/s, 8.936e-03 s/iter, (0.110, 0.000, 0.036) sec
# orchestrated_attn_func fused
mfu: 201.199 Tflops/s, hfu: 201.199 Tflops/s, 104.565 iter/s, 9.563e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 214.355 Tflops/s, hfu: 214.355 Tflops/s, 111.403 iter/s, 8.976e-03 s/iter, (0.107, 0.000, 0.036) sec
mfu: 210.426 Tflops/s, hfu: 210.426 Tflops/s, 109.361 iter/s, 9.144e-03 s/iter, (0.106, 0.000, 0.037) sec
mfu: 211.532 Tflops/s, hfu: 211.532 Tflops/s, 109.935 iter/s, 9.096e-03 s/iter, (0.107, 0.000, 0.036) sec
SP=(1,8),S=(524288,65536),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 102.542 Tflops/s, hfu: 102.542 Tflops/s, 93.262 iter/s, 1.072e-02 s/iter, (0.124, 0.000, 0.214) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.475 Tflops/s, hfu: 116.475 Tflops/s, 105.934 iter/s, 9.440e-03 s/iter, (0.108, 0.000, 0.189) sec
# stripe_flash_attn_func, fwd
mfu: 187.073 Tflops/s, hfu: 187.073 Tflops/s, 170.142 iter/s, 5.877e-03 s/iter, (0.068, 0.000, 0.118) sec
# orchestrated_attn_func
mfu: 185.464 Tflops/s, hfu: 185.464 Tflops/s, 84.339 iter/s, 1.186e-02 s/iter, (0.120, 0.000, 0.047) sec
mfu: 171.454 Tflops/s, hfu: 171.454 Tflops/s, 77.968 iter/s, 1.283e-02 s/iter, (0.122, 0.000, 0.051) sec
mfu: 167.849 Tflops/s, hfu: 167.849 Tflops/s, 76.329 iter/s, 1.310e-02 s/iter, (0.126, 0.000, 0.052) sec
mfu: 215.829 Tflops/s, hfu: 215.829 Tflops/s, 98.147 iter/s, 1.019e-02 s/iter, (0.111, 0.000, 0.041) sec
# orchestrated_attn_func fused
mfu: 204.92 Tflops/s, hfu: 204.92 Tflops/s, 93.187 iter/s, 1.073e-02 s/iter, (0.113, 0.000, 0.043) sec
mfu: 216.092 Tflops/s, hfu: 216.092 Tflops/s, 98.267 iter/s, 1.018e-02 s/iter, (0.112, 0.000, 0.041) sec
mfu: 211.567 Tflops/s, hfu: 211.567 Tflops/s, 96.210 iter/s, 1.039e-02 s/iter, (0.112, 0.001, 0.042) sec
mfu: 211.889 Tflops/s, hfu: 211.889 Tflops/s, 96.356 iter/s, 1.038e-02 s/iter, (0.112, 0.000, 0.042) sec
SP=(1,8),S=(524288,81920),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 106.017 Tflops/s, hfu: 106.017 Tflops/s, 77.138 iter/s, 1.296e-02 s/iter, (0.148, 0.000, 0.259) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.45 Tflops/s, hfu: 117.45 Tflops/s, 85.456 iter/s, 1.170e-02 s/iter, (0.134, 0.000, 0.234) sec
# stripe_flash_attn_func, fwd
mfu: 202.778 Tflops/s, hfu: 202.778 Tflops/s, 147.541 iter/s, 6.778e-03 s/iter, (0.079, 0.000, 0.136) sec
# orchestrated_attn_func
mfu: 178.747 Tflops/s, hfu: 178.747 Tflops/s, 65.028 iter/s, 1.538e-02 s/iter, (0.129, 0.000, 0.062) sec
mfu: 170.377 Tflops/s, hfu: 170.377 Tflops/s, 61.983 iter/s, 1.613e-02 s/iter, (0.138, 0.000, 0.065) sec
mfu: 158.563 Tflops/s, hfu: 158.563 Tflops/s, 57.685 iter/s, 1.734e-02 s/iter, (0.139, 0.000, 0.069) sec
mfu: 216.391 Tflops/s, hfu: 216.391 Tflops/s, 78.723 iter/s, 1.270e-02 s/iter, (0.122, 0.000, 0.051) sec
# orchestrated_attn_func fused
mfu: 209.959 Tflops/s, hfu: 209.959 Tflops/s, 76.383 iter/s, 1.309e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 219.129 Tflops/s, hfu: 219.129 Tflops/s, 79.719 iter/s, 1.254e-02 s/iter, (0.126, 0.000, 0.050) sec
mfu: 213.23 Tflops/s, hfu: 213.23 Tflops/s, 77.573 iter/s, 1.289e-02 s/iter, (0.123, 0.000, 0.052) sec
mfu: 212.621 Tflops/s, hfu: 212.621 Tflops/s, 77.351 iter/s, 1.293e-02 s/iter, (0.132, 0.000, 0.052) sec
SP=(1,8),S=(524288,98304),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 106.22 Tflops/s, hfu: 106.22 Tflops/s, 64.404 iter/s, 1.553e-02 s/iter, (0.177, 0.000, 0.311) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.52 Tflops/s, hfu: 117.52 Tflops/s, 71.256 iter/s, 1.403e-02 s/iter, (0.161, 0.000, 0.281) sec
# stripe_flash_attn_func, fwd
mfu: 212.832 Tflops/s, hfu: 212.832 Tflops/s, 129.046 iter/s, 7.749e-03 s/iter, (0.090, 0.000, 0.155) sec
# orchestrated_attn_func
mfu: 185.001 Tflops/s, hfu: 185.001 Tflops/s, 56.086 iter/s, 1.783e-02 s/iter, (0.141, 0.000, 0.071) sec
mfu: 168.473 Tflops/s, hfu: 168.473 Tflops/s, 51.075 iter/s, 1.958e-02 s/iter, (0.151, 0.000, 0.078) sec
mfu: 159.43 Tflops/s, hfu: 159.43 Tflops/s, 48.334 iter/s, 2.069e-02 s/iter, (0.151, 0.000, 0.083) sec
mfu: 216.738 Tflops/s, hfu: 216.738 Tflops/s, 65.707 iter/s, 1.522e-02 s/iter, (0.133, 0.000, 0.061) sec
# orchestrated_attn_func fused
mfu: 213.771 Tflops/s, hfu: 213.771 Tflops/s, 64.808 iter/s, 1.543e-02 s/iter, (0.135, 0.000, 0.062) sec
mfu: 221.266 Tflops/s, hfu: 221.266 Tflops/s, 67.080 iter/s, 1.491e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 214.093 Tflops/s, hfu: 214.093 Tflops/s, 64.905 iter/s, 1.541e-02 s/iter, (0.135, 0.000, 0.062) sec
mfu: 212.973 Tflops/s, hfu: 212.973 Tflops/s, 64.566 iter/s, 1.549e-02 s/iter, (0.133, 0.000, 0.062) sec
SP=(1,8),S=(524288,114688),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 109.345 Tflops/s, hfu: 109.345 Tflops/s, 56.828 iter/s, 1.760e-02 s/iter, (0.199, 0.000, 0.352) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.574 Tflops/s, hfu: 117.574 Tflops/s, 61.104 iter/s, 1.637e-02 s/iter, (0.186, 0.000, 0.327) sec
# stripe_flash_attn_func, fwd
mfu: 218.81 Tflops/s, hfu: 218.81 Tflops/s, 113.718 iter/s, 8.794e-03 s/iter, (0.100, 0.000, 0.176) sec
# orchestrated_attn_func
mfu: 181.63 Tflops/s, hfu: 181.63 Tflops/s, 47.198 iter/s, 2.119e-02 s/iter, (0.155, 0.000, 0.085) sec
mfu: 167.003 Tflops/s, hfu: 167.003 Tflops/s, 43.397 iter/s, 2.304e-02 s/iter, (0.163, 0.000, 0.092) sec
mfu: 163.623 Tflops/s, hfu: 163.623 Tflops/s, 42.518 iter/s, 2.352e-02 s/iter, (0.164, 0.000, 0.094) sec
mfu: 217.091 Tflops/s, hfu: 217.091 Tflops/s, 56.412 iter/s, 1.773e-02 s/iter, (0.145, 0.000, 0.071) sec
# orchestrated_attn_func fused
mfu: 216.317 Tflops/s, hfu: 216.317 Tflops/s, 56.211 iter/s, 1.779e-02 s/iter, (0.144, 0.000, 0.071) sec
mfu: 222.681 Tflops/s, hfu: 222.681 Tflops/s, 57.865 iter/s, 1.728e-02 s/iter, (0.141, 0.000, 0.069) sec
mfu: 214.714 Tflops/s, hfu: 214.714 Tflops/s, 55.795 iter/s, 1.792e-02 s/iter, (0.142, 0.000, 0.072) sec
mfu: 213.142 Tflops/s, hfu: 213.142 Tflops/s, 55.386 iter/s, 1.806e-02 s/iter, (0.143, 0.000, 0.072) sec
SP=(1,8),S=(524288,131072),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 108.598 Tflops/s, hfu: 108.598 Tflops/s, 49.385 iter/s, 2.025e-02 s/iter, (0.228, 0.000, 0.405) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.478 Tflops/s, hfu: 117.478 Tflops/s, 53.423 iter/s, 1.872e-02 s/iter, (0.216, 0.000, 0.374) sec
# stripe_flash_attn_func, fwd
mfu: 223.326 Tflops/s, hfu: 223.326 Tflops/s, 101.557 iter/s, 9.847e-03 s/iter, (0.112, 0.000, 0.197) sec
# orchestrated_attn_func
mfu: 183.777 Tflops/s, hfu: 183.777 Tflops/s, 41.786 iter/s, 2.393e-02 s/iter, (0.166, 0.000, 0.096) sec
mfu: 170.328 Tflops/s, hfu: 170.328 Tflops/s, 38.728 iter/s, 2.582e-02 s/iter, (0.180, 0.000, 0.103) sec
mfu: 158.16 Tflops/s, hfu: 158.16 Tflops/s, 35.961 iter/s, 2.781e-02 s/iter, (0.180, 0.000, 0.111) sec
mfu: 217.085 Tflops/s, hfu: 217.085 Tflops/s, 49.360 iter/s, 2.026e-02 s/iter, (0.154, 0.000, 0.081) sec
# orchestrated_attn_func fused
mfu: 218.612 Tflops/s, hfu: 218.612 Tflops/s, 49.707 iter/s, 2.012e-02 s/iter, (0.151, 0.000, 0.080) sec
mfu: 224.124 Tflops/s, hfu: 224.124 Tflops/s, 50.960 iter/s, 1.962e-02 s/iter, (0.150, 0.000, 0.078) sec
mfu: 215.535 Tflops/s, hfu: 215.535 Tflops/s, 49.007 iter/s, 2.041e-02 s/iter, (0.156, 0.000, 0.082) sec
mfu: 213.509 Tflops/s, hfu: 213.509 Tflops/s, 48.546 iter/s, 2.060e-02 s/iter, (0.153, 0.000, 0.082) sec
SP=(1,8),S=(524288,163840),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 111.502 Tflops/s, hfu: 111.502 Tflops/s, 40.564 iter/s, 2.465e-02 s/iter, (0.276, 0.000, 0.493) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.772 Tflops/s, hfu: 116.772 Tflops/s, 42.482 iter/s, 2.354e-02 s/iter, (0.261, 0.000, 0.471) sec
# stripe_flash_attn_func, fwd
mfu: 231.554 Tflops/s, hfu: 231.554 Tflops/s, 84.239 iter/s, 1.187e-02 s/iter, (0.136, 0.000, 0.237) sec
# orchestrated_attn_func
mfu: 179.528 Tflops/s, hfu: 179.528 Tflops/s, 32.656 iter/s, 3.062e-02 s/iter, (0.198, 0.000, 0.122) sec
mfu: 169.986 Tflops/s, hfu: 169.986 Tflops/s, 30.920 iter/s, 3.234e-02 s/iter, (0.203, 0.000, 0.129) sec
mfu: 158.579 Tflops/s, hfu: 158.579 Tflops/s, 28.845 iter/s, 3.467e-02 s/iter, (0.211, 0.000, 0.139) sec
mfu: 217.378 Tflops/s, hfu: 217.378 Tflops/s, 39.541 iter/s, 2.529e-02 s/iter, (0.176, 0.000, 0.101) sec
# orchestrated_attn_func fused
mfu: 221.609 Tflops/s, hfu: 221.609 Tflops/s, 40.310 iter/s, 2.481e-02 s/iter, (0.173, 0.000, 0.099) sec
mfu: 225.772 Tflops/s, hfu: 225.772 Tflops/s, 41.068 iter/s, 2.435e-02 s/iter, (0.173, 0.000, 0.097) sec
mfu: 216.305 Tflops/s, hfu: 216.305 Tflops/s, 39.346 iter/s, 2.542e-02 s/iter, (0.172, 0.000, 0.102) sec
mfu: 213.64 Tflops/s, hfu: 213.64 Tflops/s, 38.861 iter/s, 2.573e-02 s/iter, (0.174, 0.000, 0.103) sec
SP=(1,8),S=(524288,196608),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 112.719 Tflops/s, hfu: 112.719 Tflops/s, 34.172 iter/s, 2.926e-02 s/iter, (0.327, 0.000, 0.585) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.197 Tflops/s, hfu: 116.197 Tflops/s, 35.227 iter/s, 2.839e-02 s/iter, (0.313, 0.000, 0.568) sec
# stripe_flash_attn_func, fwd
mfu: 235.632 Tflops/s, hfu: 235.632 Tflops/s, 71.435 iter/s, 1.400e-02 s/iter, (0.159, 0.000, 0.280) sec
# orchestrated_attn_func
mfu: 180.104 Tflops/s, hfu: 180.104 Tflops/s, 27.301 iter/s, 3.663e-02 s/iter, (0.226, 0.000, 0.147) sec
mfu: 168.046 Tflops/s, hfu: 168.046 Tflops/s, 25.473 iter/s, 3.926e-02 s/iter, (0.230, 0.000, 0.157) sec
mfu: 166.431 Tflops/s, hfu: 166.431 Tflops/s, 25.228 iter/s, 3.964e-02 s/iter, (0.232, 0.000, 0.159) sec
mfu: 217.895 Tflops/s, hfu: 217.895 Tflops/s, 33.029 iter/s, 3.028e-02 s/iter, (0.200, 0.000, 0.121) sec
# orchestrated_attn_func fused
mfu: 223.882 Tflops/s, hfu: 223.882 Tflops/s, 33.937 iter/s, 2.947e-02 s/iter, (0.188, 0.000, 0.118) sec
mfu: 226.82 Tflops/s, hfu: 226.82 Tflops/s, 34.382 iter/s, 2.909e-02 s/iter, (0.187, 0.000, 0.116) sec
mfu: 216.894 Tflops/s, hfu: 216.894 Tflops/s, 32.877 iter/s, 3.042e-02 s/iter, (0.193, 0.000, 0.122) sec
mfu: 214.109 Tflops/s, hfu: 214.109 Tflops/s, 32.455 iter/s, 3.081e-02 s/iter, (0.195, 0.000, 0.123) sec
SP=(1,8),S=(524288,229376),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 112.969 Tflops/s, hfu: 112.969 Tflops/s, 29.356 iter/s, 3.406e-02 s/iter, (0.378, 0.000, 0.681) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.725 Tflops/s, hfu: 115.725 Tflops/s, 30.072 iter/s, 3.325e-02 s/iter, (0.363, 0.000, 0.665) sec
# stripe_flash_attn_func, fwd
mfu: 236.749 Tflops/s, hfu: 236.749 Tflops/s, 61.521 iter/s, 1.625e-02 s/iter, (0.183, 0.000, 0.325) sec
# orchestrated_attn_func
mfu: 181.727 Tflops/s, hfu: 181.727 Tflops/s, 23.611 iter/s, 4.235e-02 s/iter, (0.240, 0.001, 0.169) sec
mfu: 170.775 Tflops/s, hfu: 170.775 Tflops/s, 22.188 iter/s, 4.507e-02 s/iter, (0.250, 0.000, 0.180) sec
mfu: 159.06 Tflops/s, hfu: 159.06 Tflops/s, 20.666 iter/s, 4.839e-02 s/iter, (0.259, 0.000, 0.194) sec
mfu: 216.835 Tflops/s, hfu: 216.835 Tflops/s, 28.173 iter/s, 3.550e-02 s/iter, (0.216, 0.000, 0.142) sec
# orchestrated_attn_func fused
mfu: 225.397 Tflops/s, hfu: 225.397 Tflops/s, 29.285 iter/s, 3.415e-02 s/iter, (0.210, 0.000, 0.137) sec
mfu: 228.007 Tflops/s, hfu: 228.007 Tflops/s, 29.624 iter/s, 3.376e-02 s/iter, (0.207, 0.000, 0.135) sec
mfu: 217.388 Tflops/s, hfu: 217.388 Tflops/s, 28.245 iter/s, 3.540e-02 s/iter, (0.216, 0.000, 0.142) sec
mfu: 214.183 Tflops/s, hfu: 214.183 Tflops/s, 27.828 iter/s, 3.593e-02 s/iter, (0.222, 0.000, 0.144) sec
SP=(1,8),S=(524288,262144),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 112.887 Tflops/s, hfu: 112.887 Tflops/s, 25.668 iter/s, 3.896e-02 s/iter, (0.436, 0.000, 0.779) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.034 Tflops/s, hfu: 116.034 Tflops/s, 26.383 iter/s, 3.790e-02 s/iter, (0.413, 0.000, 0.758) sec
# stripe_flash_attn_func, fwd
mfu: 223.051 Tflops/s, hfu: 223.051 Tflops/s, 50.716 iter/s, 1.972e-02 s/iter, (0.219, 0.000, 0.394) sec
# orchestrated_attn_func
mfu: 178.241 Tflops/s, hfu: 178.241 Tflops/s, 20.264 iter/s, 4.935e-02 s/iter, (0.264, 0.000, 0.197) sec
mfu: 169.128 Tflops/s, hfu: 169.128 Tflops/s, 19.228 iter/s, 5.201e-02 s/iter, (0.283, 0.000, 0.208) sec
mfu: 164.872 Tflops/s, hfu: 164.872 Tflops/s, 18.744 iter/s, 5.335e-02 s/iter, (0.288, 0.000, 0.213) sec
mfu: 218.237 Tflops/s, hfu: 218.237 Tflops/s, 24.811 iter/s, 4.031e-02 s/iter, (0.236, 0.000, 0.161) sec
# orchestrated_attn_func fused
mfu: 226.505 Tflops/s, hfu: 226.505 Tflops/s, 25.751 iter/s, 3.883e-02 s/iter, (0.227, 0.000, 0.155) sec
mfu: 228.719 Tflops/s, hfu: 228.719 Tflops/s, 26.002 iter/s, 3.846e-02 s/iter, (0.228, 0.000, 0.154) sec
mfu: 217.516 Tflops/s, hfu: 217.516 Tflops/s, 24.729 iter/s, 4.044e-02 s/iter, (0.232, 0.000, 0.162) sec
mfu: 214.02 Tflops/s, hfu: 214.02 Tflops/s, 24.331 iter/s, 4.110e-02 s/iter, (0.236, 0.000, 0.164) sec
SP=(1,8),S=(524288,327680),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 112.239 Tflops/s, hfu: 112.239 Tflops/s, 20.416 iter/s, 4.898e-02 s/iter, (0.535, 0.000, 0.980) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 140.548 Tflops/s, hfu: 140.548 Tflops/s, 25.566 iter/s, 3.912e-02 s/iter, (0.424, 0.000, 0.782) sec
# stripe_flash_attn_func, fwd
mfu: 201.988 Tflops/s, hfu: 201.988 Tflops/s, 36.741 iter/s, 2.722e-02 s/iter, (0.301, 0.000, 0.544) sec
# orchestrated_attn_func
mfu: 179.301 Tflops/s, hfu: 179.301 Tflops/s, 16.307 iter/s, 6.132e-02 s/iter, (0.309, 0.000, 0.245) sec
mfu: 168.634 Tflops/s, hfu: 168.634 Tflops/s, 15.337 iter/s, 6.520e-02 s/iter, (0.335, 0.000, 0.261) sec
mfu: 165.105 Tflops/s, hfu: 165.105 Tflops/s, 15.016 iter/s, 6.659e-02 s/iter, (0.337, 0.000, 0.266) sec
mfu: 218.362 Tflops/s, hfu: 218.362 Tflops/s, 19.860 iter/s, 5.035e-02 s/iter, (0.283, 0.000, 0.201) sec
# orchestrated_attn_func fused
mfu: 228.058 Tflops/s, hfu: 228.058 Tflops/s, 20.742 iter/s, 4.821e-02 s/iter, (0.263, 0.000, 0.193) sec
mfu: 229.624 Tflops/s, hfu: 229.624 Tflops/s, 20.884 iter/s, 4.788e-02 s/iter, (0.263, 0.000, 0.192) sec
mfu: 218.123 Tflops/s, hfu: 218.123 Tflops/s, 19.838 iter/s, 5.041e-02 s/iter, (0.277, 0.000, 0.202) sec
mfu: 214.342 Tflops/s, hfu: 214.342 Tflops/s, 19.494 iter/s, 5.130e-02 s/iter, (0.276, 0.000, 0.205) sec
SP=(1,8),S=(524288,393216),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 112.556 Tflops/s, hfu: 112.556 Tflops/s, 17.061 iter/s, 5.861e-02 s/iter, (0.643, 0.000, 1.172) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 164.4 Tflops/s, hfu: 164.4 Tflops/s, 24.920 iter/s, 4.013e-02 s/iter, (0.436, 0.000, 0.803) sec
# stripe_flash_attn_func, fwd
mfu: 191.165 Tflops/s, hfu: 191.165 Tflops/s, 28.977 iter/s, 3.451e-02 s/iter, (0.375, 0.000, 0.690) sec
# orchestrated_attn_func
mfu: 184.865 Tflops/s, hfu: 184.865 Tflops/s, 14.011 iter/s, 7.137e-02 s/iter, (0.363, 0.000, 0.285) sec
mfu: 169.44 Tflops/s, hfu: 169.44 Tflops/s, 12.842 iter/s, 7.787e-02 s/iter, (0.389, 0.000, 0.311) sec
mfu: 165.378 Tflops/s, hfu: 165.378 Tflops/s, 12.534 iter/s, 7.978e-02 s/iter, (0.398, 0.000, 0.319) sec
mfu: 218.554 Tflops/s, hfu: 218.554 Tflops/s, 16.564 iter/s, 6.037e-02 s/iter, (0.318, 0.000, 0.241) sec
# orchestrated_attn_func fused
mfu: 229.361 Tflops/s, hfu: 229.361 Tflops/s, 17.384 iter/s, 5.753e-02 s/iter, (0.301, 0.000, 0.230) sec
mfu: 230.265 Tflops/s, hfu: 230.265 Tflops/s, 17.452 iter/s, 5.730e-02 s/iter, (0.300, 0.000, 0.229) sec
mfu: 218.469 Tflops/s, hfu: 218.469 Tflops/s, 16.558 iter/s, 6.039e-02 s/iter, (0.312, 0.000, 0.242) sec
mfu: 214.621 Tflops/s, hfu: 214.621 Tflops/s, 16.266 iter/s, 6.148e-02 s/iter, (0.322, 0.000, 0.246) sec
SP=(1,8),S=(524288,458752),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 111.948 Tflops/s, hfu: 111.948 Tflops/s, 14.545 iter/s, 6.875e-02 s/iter, (0.751, 0.000, 1.375) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 177.39 Tflops/s, hfu: 177.39 Tflops/s, 23.048 iter/s, 4.339e-02 s/iter, (0.475, 0.000, 0.868) sec
# stripe_flash_attn_func, fwd
mfu: 176.836 Tflops/s, hfu: 176.836 Tflops/s, 22.976 iter/s, 4.352e-02 s/iter, (0.477, 0.000, 0.870) sec
# orchestrated_attn_func
mfu: 180.75 Tflops/s, hfu: 180.75 Tflops/s, 11.742 iter/s, 8.516e-02 s/iter, (0.406, 0.000, 0.341) sec
mfu: 166.156 Tflops/s, hfu: 166.156 Tflops/s, 10.794 iter/s, 9.264e-02 s/iter, (0.429, 0.000, 0.371) sec
mfu: 164.224 Tflops/s, hfu: 164.224 Tflops/s, 10.669 iter/s, 9.373e-02 s/iter, (0.445, 0.000, 0.375) sec
mfu: 218.577 Tflops/s, hfu: 218.577 Tflops/s, 14.200 iter/s, 7.042e-02 s/iter, (0.355, 0.000, 0.282) sec
# orchestrated_attn_func fused
mfu: 230.076 Tflops/s, hfu: 230.076 Tflops/s, 14.947 iter/s, 6.690e-02 s/iter, (0.338, 0.000, 0.268) sec
mfu: 230.674 Tflops/s, hfu: 230.674 Tflops/s, 14.986 iter/s, 6.673e-02 s/iter, (0.339, 0.000, 0.267) sec
mfu: 218.661 Tflops/s, hfu: 218.661 Tflops/s, 14.205 iter/s, 7.040e-02 s/iter, (0.352, 0.000, 0.282) sec
mfu: 214.47 Tflops/s, hfu: 214.47 Tflops/s, 13.933 iter/s, 7.177e-02 s/iter, (0.360, 0.000, 0.287) sec
SP=(1,8),S=(524288,524288),Nh=(1,1),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 110.996 Tflops/s, hfu: 110.996 Tflops/s, 12.619 iter/s, 7.925e-02 s/iter, (0.861, 0.000, 1.585) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 177.338 Tflops/s, hfu: 177.338 Tflops/s, 20.161 iter/s, 4.960e-02 s/iter, (0.547, 0.000, 0.992) sec
# stripe_flash_attn_func, fwd
mfu: 160.683 Tflops/s, hfu: 160.683 Tflops/s, 18.268 iter/s, 5.474e-02 s/iter, (0.593, 0.000, 1.095) sec
# orchestrated_attn_func
mfu: 182.485 Tflops/s, hfu: 182.485 Tflops/s, 10.373 iter/s, 9.640e-02 s/iter, (0.455, 0.000, 0.386) sec
mfu: 168.42 Tflops/s, hfu: 168.42 Tflops/s, 9.574 iter/s, 1.045e-01 s/iter, (0.498, 0.000, 0.418) sec
mfu: 163.357 Tflops/s, hfu: 163.357 Tflops/s, 9.286 iter/s, 1.077e-01 s/iter, (0.497, 0.000, 0.431) sec
mfu: 218.765 Tflops/s, hfu: 218.765 Tflops/s, 12.435 iter/s, 8.042e-02 s/iter, (0.402, 0.000, 0.322) sec
# orchestrated_attn_func fused
mfu: 230.331 Tflops/s, hfu: 230.331 Tflops/s, 13.093 iter/s, 7.638e-02 s/iter, (0.379, 0.000, 0.306) sec
mfu: 230.834 Tflops/s, hfu: 230.834 Tflops/s, 13.121 iter/s, 7.621e-02 s/iter, (0.378, 0.000, 0.305) sec
mfu: 218.851 Tflops/s, hfu: 218.851 Tflops/s, 12.440 iter/s, 8.038e-02 s/iter, (0.392, 0.000, 0.322) sec
mfu: 214.675 Tflops/s, hfu: 214.675 Tflops/s, 12.203 iter/s, 8.195e-02 s/iter, (0.400, 0.000, 0.328) sec
SP=(1,8),S=(2048,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 1.507 Tflops/s, hfu: 1.507 Tflops/s, 350.920 iter/s, 2.850e-03 s/iter, (0.040, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 2.73 Tflops/s, hfu: 2.73 Tflops/s, 635.582 iter/s, 1.573e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 1.317 Tflops/s, hfu: 1.317 Tflops/s, 306.585 iter/s, 3.262e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 19.638 Tflops/s, hfu: 19.638 Tflops/s, 2286.153 iter/s, 4.374e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 30.211 Tflops/s, hfu: 30.211 Tflops/s, 3517.065 iter/s, 2.843e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 33.677 Tflops/s, hfu: 33.677 Tflops/s, 3920.462 iter/s, 2.551e-04 s/iter, (0.070, 0.000, 0.001) sec
mfu: 26.674 Tflops/s, hfu: 26.674 Tflops/s, 3105.204 iter/s, 3.220e-04 s/iter, (0.075, 0.000, 0.001) sec
SP=(1,8),S=(2048,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.066 Tflops/s, hfu: 3.066 Tflops/s, 356.982 iter/s, 2.801e-03 s/iter, (0.034, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.445 Tflops/s, hfu: 5.445 Tflops/s, 633.921 iter/s, 1.577e-03 s/iter, (0.019, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 2.601 Tflops/s, hfu: 2.601 Tflops/s, 302.781 iter/s, 3.303e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 26.707 Tflops/s, hfu: 26.707 Tflops/s, 1554.552 iter/s, 6.433e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 31.931 Tflops/s, hfu: 31.931 Tflops/s, 1858.653 iter/s, 5.380e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 30.542 Tflops/s, hfu: 30.542 Tflops/s, 1777.790 iter/s, 5.625e-04 s/iter, (0.138, 0.000, 0.002) sec
mfu: 22.71 Tflops/s, hfu: 22.71 Tflops/s, 1321.912 iter/s, 7.565e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(2048,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.605 Tflops/s, hfu: 4.605 Tflops/s, 357.417 iter/s, 2.798e-03 s/iter, (0.037, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.265 Tflops/s, hfu: 8.265 Tflops/s, 641.453 iter/s, 1.559e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 3.92 Tflops/s, hfu: 3.92 Tflops/s, 304.256 iter/s, 3.287e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 39.076 Tflops/s, hfu: 39.076 Tflops/s, 1516.365 iter/s, 6.595e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 45.17 Tflops/s, hfu: 45.17 Tflops/s, 1752.836 iter/s, 5.705e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 41.93 Tflops/s, hfu: 41.93 Tflops/s, 1627.096 iter/s, 6.146e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 27.101 Tflops/s, hfu: 27.101 Tflops/s, 1051.649 iter/s, 9.509e-04 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(2048,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.104 Tflops/s, hfu: 6.104 Tflops/s, 355.276 iter/s, 2.815e-03 s/iter, (0.038, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.97 Tflops/s, hfu: 10.97 Tflops/s, 638.509 iter/s, 1.566e-03 s/iter, (0.019, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 5.225 Tflops/s, hfu: 5.225 Tflops/s, 304.132 iter/s, 3.288e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 51.632 Tflops/s, hfu: 51.632 Tflops/s, 1502.675 iter/s, 6.655e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 55.247 Tflops/s, hfu: 55.247 Tflops/s, 1607.903 iter/s, 6.219e-04 s/iter, (0.075, 0.000, 0.002) sec
mfu: 46.275 Tflops/s, hfu: 46.275 Tflops/s, 1346.794 iter/s, 7.425e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 29.785 Tflops/s, hfu: 29.785 Tflops/s, 866.852 iter/s, 1.154e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(2048,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.656 Tflops/s, hfu: 7.656 Tflops/s, 356.489 iter/s, 2.805e-03 s/iter, (0.039, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 13.741 Tflops/s, hfu: 13.741 Tflops/s, 639.854 iter/s, 1.563e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 6.555 Tflops/s, hfu: 6.555 Tflops/s, 305.222 iter/s, 3.276e-03 s/iter, (0.037, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 61.444 Tflops/s, hfu: 61.444 Tflops/s, 1430.599 iter/s, 6.990e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 61.231 Tflops/s, hfu: 61.231 Tflops/s, 1425.655 iter/s, 7.014e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 52.314 Tflops/s, hfu: 52.314 Tflops/s, 1218.027 iter/s, 8.210e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 33.062 Tflops/s, hfu: 33.062 Tflops/s, 769.780 iter/s, 1.299e-03 s/iter, (0.076, 0.000, 0.005) sec
SP=(1,8),S=(2048,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.15 Tflops/s, hfu: 9.15 Tflops/s, 355.066 iter/s, 2.816e-03 s/iter, (0.043, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 16.466 Tflops/s, hfu: 16.466 Tflops/s, 638.952 iter/s, 1.565e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 7.867 Tflops/s, hfu: 7.867 Tflops/s, 305.293 iter/s, 3.276e-03 s/iter, (0.037, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 68.457 Tflops/s, hfu: 68.457 Tflops/s, 1328.233 iter/s, 7.529e-04 s/iter, (0.079, 0.000, 0.003) sec
mfu: 64.844 Tflops/s, hfu: 64.844 Tflops/s, 1258.140 iter/s, 7.948e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 55.294 Tflops/s, hfu: 55.294 Tflops/s, 1072.842 iter/s, 9.321e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 34.756 Tflops/s, hfu: 34.756 Tflops/s, 674.349 iter/s, 1.483e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(2048,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.72 Tflops/s, hfu: 10.72 Tflops/s, 356.561 iter/s, 2.805e-03 s/iter, (0.044, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 19.188 Tflops/s, hfu: 19.188 Tflops/s, 638.228 iter/s, 1.567e-03 s/iter, (0.021, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 9.123 Tflops/s, hfu: 9.123 Tflops/s, 303.440 iter/s, 3.296e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 77.619 Tflops/s, hfu: 77.619 Tflops/s, 1290.856 iter/s, 7.747e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 69.057 Tflops/s, hfu: 69.057 Tflops/s, 1148.475 iter/s, 8.707e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 55.217 Tflops/s, hfu: 55.217 Tflops/s, 918.294 iter/s, 1.089e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 33.409 Tflops/s, hfu: 33.409 Tflops/s, 555.610 iter/s, 1.800e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(2048,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.151 Tflops/s, hfu: 12.151 Tflops/s, 353.654 iter/s, 2.828e-03 s/iter, (0.039, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.57 Tflops/s, hfu: 21.57 Tflops/s, 627.758 iter/s, 1.593e-03 s/iter, (0.021, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 10.381 Tflops/s, hfu: 10.381 Tflops/s, 302.118 iter/s, 3.310e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 81.885 Tflops/s, hfu: 81.885 Tflops/s, 1191.588 iter/s, 8.392e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 73.095 Tflops/s, hfu: 73.095 Tflops/s, 1063.676 iter/s, 9.401e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 59.576 Tflops/s, hfu: 59.576 Tflops/s, 866.942 iter/s, 1.153e-03 s/iter, (0.073, 0.000, 0.005) sec
mfu: 26.049 Tflops/s, hfu: 26.049 Tflops/s, 379.069 iter/s, 2.638e-03 s/iter, (0.079, 0.000, 0.011) sec
SP=(1,8),S=(2048,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.261 Tflops/s, hfu: 15.261 Tflops/s, 355.334 iter/s, 2.814e-03 s/iter, (0.045, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.607 Tflops/s, hfu: 23.607 Tflops/s, 549.644 iter/s, 1.819e-03 s/iter, (0.024, 0.000, 0.036) sec
# stripe_flash_attn_func, fwd
mfu: 13.335 Tflops/s, hfu: 13.335 Tflops/s, 310.468 iter/s, 3.221e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 91.325 Tflops/s, hfu: 91.325 Tflops/s, 1063.160 iter/s, 9.406e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 79.966 Tflops/s, hfu: 79.966 Tflops/s, 930.932 iter/s, 1.074e-03 s/iter, (0.078, 0.000, 0.004) sec
mfu: 58.81 Tflops/s, hfu: 58.81 Tflops/s, 684.643 iter/s, 1.461e-03 s/iter, (0.109, 0.000, 0.006) sec
mfu: 32.414 Tflops/s, hfu: 32.414 Tflops/s, 377.346 iter/s, 2.650e-03 s/iter, (0.079, 0.000, 0.011) sec
SP=(1,8),S=(2048,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.287 Tflops/s, hfu: 18.287 Tflops/s, 354.818 iter/s, 2.818e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.805 Tflops/s, hfu: 24.805 Tflops/s, 481.271 iter/s, 2.078e-03 s/iter, (0.028, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 15.789 Tflops/s, hfu: 15.789 Tflops/s, 306.339 iter/s, 3.264e-03 s/iter, (0.037, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 99.348 Tflops/s, hfu: 99.348 Tflops/s, 963.807 iter/s, 1.038e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 84.052 Tflops/s, hfu: 84.052 Tflops/s, 815.416 iter/s, 1.226e-03 s/iter, (0.075, 0.001, 0.005) sec
mfu: 62.69 Tflops/s, hfu: 62.69 Tflops/s, 608.169 iter/s, 1.644e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 29.646 Tflops/s, hfu: 29.646 Tflops/s, 287.602 iter/s, 3.477e-03 s/iter, (0.083, 0.000, 0.014) sec
SP=(1,8),S=(2048,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 20.766 Tflops/s, hfu: 20.766 Tflops/s, 345.359 iter/s, 2.896e-03 s/iter, (0.047, 0.000, 0.058) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.861 Tflops/s, hfu: 23.861 Tflops/s, 396.823 iter/s, 2.520e-03 s/iter, (0.038, 0.000, 0.050) sec
# stripe_flash_attn_func, fwd
mfu: 18.173 Tflops/s, hfu: 18.173 Tflops/s, 302.232 iter/s, 3.309e-03 s/iter, (0.038, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 104.073 Tflops/s, hfu: 104.073 Tflops/s, 865.405 iter/s, 1.156e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 86.609 Tflops/s, hfu: 86.609 Tflops/s, 720.183 iter/s, 1.389e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 63.711 Tflops/s, hfu: 63.711 Tflops/s, 529.780 iter/s, 1.888e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 35.414 Tflops/s, hfu: 35.414 Tflops/s, 294.477 iter/s, 3.396e-03 s/iter, (0.087, 0.000, 0.014) sec
SP=(1,8),S=(2048,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.419 Tflops/s, hfu: 22.419 Tflops/s, 326.237 iter/s, 3.065e-03 s/iter, (0.047, 0.000, 0.061) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 25.042 Tflops/s, hfu: 25.042 Tflops/s, 364.408 iter/s, 2.744e-03 s/iter, (0.035, 0.000, 0.055) sec
# stripe_flash_attn_func, fwd
mfu: 20.562 Tflops/s, hfu: 20.562 Tflops/s, 299.214 iter/s, 3.342e-03 s/iter, (0.040, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 105.335 Tflops/s, hfu: 105.335 Tflops/s, 766.410 iter/s, 1.305e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 92.765 Tflops/s, hfu: 92.765 Tflops/s, 674.953 iter/s, 1.482e-03 s/iter, (0.083, 0.000, 0.006) sec
mfu: 62.694 Tflops/s, hfu: 62.694 Tflops/s, 456.156 iter/s, 2.192e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 31.97 Tflops/s, hfu: 31.97 Tflops/s, 232.614 iter/s, 4.299e-03 s/iter, (0.089, 0.000, 0.017) sec
SP=(1,8),S=(2048,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.134 Tflops/s, hfu: 23.134 Tflops/s, 269.320 iter/s, 3.713e-03 s/iter, (0.057, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.158 Tflops/s, hfu: 26.158 Tflops/s, 304.514 iter/s, 3.284e-03 s/iter, (0.043, 0.000, 0.066) sec
# stripe_flash_attn_func, fwd
mfu: 23.233 Tflops/s, hfu: 23.233 Tflops/s, 270.469 iter/s, 3.697e-03 s/iter, (0.047, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 112.149 Tflops/s, hfu: 112.149 Tflops/s, 652.793 iter/s, 1.532e-03 s/iter, (0.079, 0.000, 0.006) sec
mfu: 97.132 Tflops/s, hfu: 97.132 Tflops/s, 565.383 iter/s, 1.769e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 69.994 Tflops/s, hfu: 69.994 Tflops/s, 407.417 iter/s, 2.454e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 33.133 Tflops/s, hfu: 33.133 Tflops/s, 192.861 iter/s, 5.185e-03 s/iter, (0.089, 0.000, 0.021) sec
SP=(1,8),S=(2048,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.078 Tflops/s, hfu: 23.078 Tflops/s, 223.890 iter/s, 4.466e-03 s/iter, (0.065, 0.000, 0.089) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.02 Tflops/s, hfu: 26.02 Tflops/s, 252.426 iter/s, 3.962e-03 s/iter, (0.049, 0.000, 0.079) sec
# stripe_flash_attn_func, fwd
mfu: 23.097 Tflops/s, hfu: 23.097 Tflops/s, 224.069 iter/s, 4.463e-03 s/iter, (0.055, 0.000, 0.089) sec
# orchestrated_attn_func
mfu: 119.895 Tflops/s, hfu: 119.895 Tflops/s, 581.566 iter/s, 1.719e-03 s/iter, (0.097, 0.000, 0.007) sec
mfu: 99.491 Tflops/s, hfu: 99.491 Tflops/s, 482.596 iter/s, 2.072e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 68.435 Tflops/s, hfu: 68.435 Tflops/s, 331.952 iter/s, 3.012e-03 s/iter, (0.083, 0.000, 0.012) sec
mfu: 36.617 Tflops/s, hfu: 36.617 Tflops/s, 177.617 iter/s, 5.630e-03 s/iter, (0.092, 0.000, 0.023) sec
SP=(1,8),S=(2048,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.87 Tflops/s, hfu: 23.87 Tflops/s, 198.492 iter/s, 5.038e-03 s/iter, (0.071, 0.000, 0.101) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.438 Tflops/s, hfu: 26.438 Tflops/s, 219.843 iter/s, 4.549e-03 s/iter, (0.056, 0.000, 0.091) sec
# stripe_flash_attn_func, fwd
mfu: 23.33 Tflops/s, hfu: 23.33 Tflops/s, 193.998 iter/s, 5.155e-03 s/iter, (0.064, 0.000, 0.103) sec
# orchestrated_attn_func
mfu: 119.765 Tflops/s, hfu: 119.765 Tflops/s, 497.944 iter/s, 2.008e-03 s/iter, (0.091, 0.000, 0.008) sec
mfu: 103.323 Tflops/s, hfu: 103.323 Tflops/s, 429.586 iter/s, 2.328e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 69.746 Tflops/s, hfu: 69.746 Tflops/s, 289.981 iter/s, 3.449e-03 s/iter, (0.226, 0.000, 0.014) sec
mfu: 39.644 Tflops/s, hfu: 39.644 Tflops/s, 164.826 iter/s, 6.067e-03 s/iter, (0.094, 0.000, 0.024) sec
SP=(1,8),S=(2048,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.526 Tflops/s, hfu: 23.526 Tflops/s, 171.173 iter/s, 5.842e-03 s/iter, (0.071, 0.000, 0.117) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.576 Tflops/s, hfu: 26.576 Tflops/s, 193.364 iter/s, 5.172e-03 s/iter, (0.063, 0.000, 0.103) sec
# stripe_flash_attn_func, fwd
mfu: 23.615 Tflops/s, hfu: 23.615 Tflops/s, 171.819 iter/s, 5.820e-03 s/iter, (0.071, 0.000, 0.116) sec
# orchestrated_attn_func
mfu: 118.558 Tflops/s, hfu: 118.558 Tflops/s, 431.313 iter/s, 2.319e-03 s/iter, (0.093, 0.000, 0.009) sec
mfu: 102.739 Tflops/s, hfu: 102.739 Tflops/s, 373.764 iter/s, 2.675e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 74.843 Tflops/s, hfu: 74.843 Tflops/s, 272.277 iter/s, 3.673e-03 s/iter, (0.087, 0.000, 0.015) sec
mfu: 39.446 Tflops/s, hfu: 39.446 Tflops/s, 143.504 iter/s, 6.968e-03 s/iter, (0.098, 0.000, 0.028) sec
SP=(1,8),S=(2048,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.252 Tflops/s, hfu: 24.252 Tflops/s, 141.165 iter/s, 7.084e-03 s/iter, (0.086, 0.000, 0.142) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.4 Tflops/s, hfu: 26.4 Tflops/s, 153.669 iter/s, 6.507e-03 s/iter, (0.076, 0.000, 0.130) sec
# stripe_flash_attn_func, fwd
mfu: 23.452 Tflops/s, hfu: 23.452 Tflops/s, 136.508 iter/s, 7.326e-03 s/iter, (0.085, 0.000, 0.147) sec
# orchestrated_attn_func
mfu: 122.319 Tflops/s, hfu: 122.319 Tflops/s, 355.996 iter/s, 2.809e-03 s/iter, (0.166, 0.000, 0.011) sec
mfu: 105.185 Tflops/s, hfu: 105.185 Tflops/s, 306.127 iter/s, 3.267e-03 s/iter, (0.085, 0.001, 0.013) sec
mfu: 76.618 Tflops/s, hfu: 76.618 Tflops/s, 222.987 iter/s, 4.485e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 40.687 Tflops/s, hfu: 40.687 Tflops/s, 118.416 iter/s, 8.445e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(2048,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.518 Tflops/s, hfu: 24.518 Tflops/s, 118.928 iter/s, 8.408e-03 s/iter, (0.104, 0.000, 0.168) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.155 Tflops/s, hfu: 27.155 Tflops/s, 131.720 iter/s, 7.592e-03 s/iter, (0.089, 0.000, 0.152) sec
# stripe_flash_attn_func, fwd
mfu: 24.318 Tflops/s, hfu: 24.318 Tflops/s, 117.960 iter/s, 8.477e-03 s/iter, (0.102, 0.000, 0.170) sec
# orchestrated_attn_func
mfu: 126.5 Tflops/s, hfu: 126.5 Tflops/s, 306.803 iter/s, 3.259e-03 s/iter, (0.087, 0.000, 0.013) sec
mfu: 110.274 Tflops/s, hfu: 110.274 Tflops/s, 267.451 iter/s, 3.739e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 76.898 Tflops/s, hfu: 76.898 Tflops/s, 186.502 iter/s, 5.362e-03 s/iter, (0.091, 0.000, 0.021) sec
mfu: 43.039 Tflops/s, hfu: 43.039 Tflops/s, 104.383 iter/s, 9.580e-03 s/iter, (0.109, 0.000, 0.038) sec
SP=(1,8),S=(2048,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.571 Tflops/s, hfu: 24.571 Tflops/s, 102.158 iter/s, 9.789e-03 s/iter, (0.119, 0.000, 0.196) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.426 Tflops/s, hfu: 27.426 Tflops/s, 114.028 iter/s, 8.770e-03 s/iter, (0.102, 0.000, 0.175) sec
# stripe_flash_attn_func, fwd
mfu: 24.49 Tflops/s, hfu: 24.49 Tflops/s, 101.821 iter/s, 9.821e-03 s/iter, (0.116, 0.000, 0.196) sec
# orchestrated_attn_func
mfu: 123.402 Tflops/s, hfu: 123.402 Tflops/s, 256.534 iter/s, 3.898e-03 s/iter, (0.164, 0.000, 0.016) sec
mfu: 112.224 Tflops/s, hfu: 112.224 Tflops/s, 233.296 iter/s, 4.286e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 77.214 Tflops/s, hfu: 77.214 Tflops/s, 160.517 iter/s, 6.230e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 41.469 Tflops/s, hfu: 41.469 Tflops/s, 86.207 iter/s, 1.160e-02 s/iter, (0.117, 0.000, 0.046) sec
SP=(1,8),S=(2048,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.735 Tflops/s, hfu: 24.735 Tflops/s, 89.987 iter/s, 1.111e-02 s/iter, (0.128, 0.000, 0.222) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.667 Tflops/s, hfu: 27.667 Tflops/s, 100.653 iter/s, 9.935e-03 s/iter, (0.116, 0.000, 0.199) sec
# stripe_flash_attn_func, fwd
mfu: 24.594 Tflops/s, hfu: 24.594 Tflops/s, 89.471 iter/s, 1.118e-02 s/iter, (0.133, 0.000, 0.224) sec
# orchestrated_attn_func
mfu: 126.472 Tflops/s, hfu: 126.472 Tflops/s, 230.051 iter/s, 4.347e-03 s/iter, (0.143, 0.000, 0.017) sec
mfu: 110.036 Tflops/s, hfu: 110.036 Tflops/s, 200.154 iter/s, 4.996e-03 s/iter, (0.096, 0.000, 0.020) sec
mfu: 79.853 Tflops/s, hfu: 79.853 Tflops/s, 145.252 iter/s, 6.885e-03 s/iter, (0.097, 0.000, 0.028) sec
mfu: 42.504 Tflops/s, hfu: 42.504 Tflops/s, 77.314 iter/s, 1.293e-02 s/iter, (0.120, 0.000, 0.052) sec
SP=(1,8),S=(2048,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.84 Tflops/s, hfu: 24.84 Tflops/s, 72.295 iter/s, 1.383e-02 s/iter, (0.162, 0.000, 0.277) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.663 Tflops/s, hfu: 27.663 Tflops/s, 80.511 iter/s, 1.242e-02 s/iter, (0.148, 0.000, 0.248) sec
# stripe_flash_attn_func, fwd
mfu: 24.632 Tflops/s, hfu: 24.632 Tflops/s, 71.688 iter/s, 1.395e-02 s/iter, (0.163, 0.000, 0.279) sec
# orchestrated_attn_func
mfu: 128.823 Tflops/s, hfu: 128.823 Tflops/s, 187.462 iter/s, 5.334e-03 s/iter, (0.108, 0.000, 0.021) sec
mfu: 103.678 Tflops/s, hfu: 103.678 Tflops/s, 150.871 iter/s, 6.628e-03 s/iter, (0.104, 0.000, 0.027) sec
mfu: 77.523 Tflops/s, hfu: 77.523 Tflops/s, 112.811 iter/s, 8.864e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 39.291 Tflops/s, hfu: 39.291 Tflops/s, 57.176 iter/s, 1.749e-02 s/iter, (0.136, 0.000, 0.070) sec
SP=(1,8),S=(2048,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.716 Tflops/s, hfu: 24.716 Tflops/s, 59.944 iter/s, 1.668e-02 s/iter, (0.192, 0.000, 0.334) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 27.986 Tflops/s, hfu: 27.986 Tflops/s, 67.874 iter/s, 1.473e-02 s/iter, (0.177, 0.000, 0.295) sec
# stripe_flash_attn_func, fwd
mfu: 24.874 Tflops/s, hfu: 24.874 Tflops/s, 60.327 iter/s, 1.658e-02 s/iter, (0.194, 0.000, 0.332) sec
# orchestrated_attn_func
mfu: 130.939 Tflops/s, hfu: 130.939 Tflops/s, 158.785 iter/s, 6.298e-03 s/iter, (0.100, 0.000, 0.025) sec
mfu: 103.813 Tflops/s, hfu: 103.813 Tflops/s, 125.890 iter/s, 7.943e-03 s/iter, (0.109, 0.000, 0.032) sec
mfu: 76.929 Tflops/s, hfu: 76.929 Tflops/s, 93.288 iter/s, 1.072e-02 s/iter, (0.112, 0.000, 0.043) sec
mfu: 42.274 Tflops/s, hfu: 42.274 Tflops/s, 51.264 iter/s, 1.951e-02 s/iter, (0.150, 0.000, 0.078) sec
SP=(1,8),S=(2048,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.689 Tflops/s, hfu: 25.689 Tflops/s, 53.403 iter/s, 1.873e-02 s/iter, (0.218, 0.000, 0.375) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.451 Tflops/s, hfu: 14.451 Tflops/s, 30.041 iter/s, 3.329e-02 s/iter, (0.205, 0.000, 0.666) sec
# stripe_flash_attn_func, fwd
mfu: 24.12 Tflops/s, hfu: 24.12 Tflops/s, 50.141 iter/s, 1.994e-02 s/iter, (0.227, 0.000, 0.399) sec
# orchestrated_attn_func
mfu: 130.397 Tflops/s, hfu: 130.397 Tflops/s, 135.537 iter/s, 7.378e-03 s/iter, (0.197, 0.000, 0.030) sec
mfu: 105.747 Tflops/s, hfu: 105.747 Tflops/s, 109.915 iter/s, 9.098e-03 s/iter, (0.113, 0.000, 0.036) sec
mfu: 79.67 Tflops/s, hfu: 79.67 Tflops/s, 82.811 iter/s, 1.208e-02 s/iter, (0.122, 0.000, 0.048) sec
mfu: 42.395 Tflops/s, hfu: 42.395 Tflops/s, 44.067 iter/s, 2.269e-02 s/iter, (0.161, 0.000, 0.091) sec
SP=(1,8),S=(2048,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.194 Tflops/s, hfu: 25.194 Tflops/s, 45.827 iter/s, 2.182e-02 s/iter, (0.248, 0.000, 0.436) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 10.756 Tflops/s, hfu: 10.756 Tflops/s, 19.566 iter/s, 5.111e-02 s/iter, (0.234, 0.000, 1.022) sec
# stripe_flash_attn_func, fwd
mfu: 24.384 Tflops/s, hfu: 24.384 Tflops/s, 44.354 iter/s, 2.255e-02 s/iter, (0.260, 0.000, 0.451) sec
# orchestrated_attn_func
mfu: 129.192 Tflops/s, hfu: 129.192 Tflops/s, 117.499 iter/s, 8.511e-03 s/iter, (0.171, 0.000, 0.034) sec
mfu: 102.505 Tflops/s, hfu: 102.505 Tflops/s, 93.228 iter/s, 1.073e-02 s/iter, (0.119, 0.000, 0.043) sec
mfu: 77.315 Tflops/s, hfu: 77.315 Tflops/s, 70.317 iter/s, 1.422e-02 s/iter, (0.126, 0.000, 0.057) sec
mfu: 44.135 Tflops/s, hfu: 44.135 Tflops/s, 40.141 iter/s, 2.491e-02 s/iter, (0.175, 0.000, 0.100) sec
SP=(1,8),S=(2048,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.076 Tflops/s, hfu: 12.076 Tflops/s, 17.574 iter/s, 5.690e-02 s/iter, (0.331, 0.000, 1.138) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 22.91 Tflops/s, hfu: 22.91 Tflops/s, 33.339 iter/s, 3.000e-02 s/iter, (0.303, 0.000, 0.600) sec
# stripe_flash_attn_func, fwd
mfu: 22.715 Tflops/s, hfu: 22.715 Tflops/s, 33.054 iter/s, 3.025e-02 s/iter, (0.350, 0.000, 0.605) sec
# orchestrated_attn_func
mfu: 131.019 Tflops/s, hfu: 131.019 Tflops/s, 95.329 iter/s, 1.049e-02 s/iter, (0.206, 0.000, 0.042) sec
mfu: 106.585 Tflops/s, hfu: 106.585 Tflops/s, 77.551 iter/s, 1.289e-02 s/iter, (0.128, 0.000, 0.052) sec
mfu: 79.258 Tflops/s, hfu: 79.258 Tflops/s, 57.667 iter/s, 1.734e-02 s/iter, (0.143, 0.000, 0.069) sec
mfu: 43.432 Tflops/s, hfu: 43.432 Tflops/s, 31.601 iter/s, 3.164e-02 s/iter, (0.201, 0.000, 0.127) sec
SP=(1,8),S=(2048,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.016 Tflops/s, hfu: 9.016 Tflops/s, 10.933 iter/s, 9.147e-02 s/iter, (0.393, 0.000, 1.829) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.219 Tflops/s, hfu: 20.219 Tflops/s, 24.518 iter/s, 4.079e-02 s/iter, (0.355, 0.000, 0.816) sec
# stripe_flash_attn_func, fwd
mfu: 13.444 Tflops/s, hfu: 13.444 Tflops/s, 16.304 iter/s, 6.134e-02 s/iter, (0.418, 0.000, 1.227) sec
# orchestrated_attn_func
mfu: 130.338 Tflops/s, hfu: 130.338 Tflops/s, 79.028 iter/s, 1.265e-02 s/iter, (0.127, 0.000, 0.051) sec
mfu: 104.248 Tflops/s, hfu: 104.248 Tflops/s, 63.208 iter/s, 1.582e-02 s/iter, (0.147, 0.000, 0.063) sec
mfu: 77.876 Tflops/s, hfu: 77.876 Tflops/s, 47.218 iter/s, 2.118e-02 s/iter, (0.161, 0.000, 0.085) sec
mfu: 42.566 Tflops/s, hfu: 42.566 Tflops/s, 25.809 iter/s, 3.875e-02 s/iter, (0.225, 0.000, 0.155) sec
SP=(1,8),S=(2048,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.98 Tflops/s, hfu: 8.98 Tflops/s, 9.334 iter/s, 1.071e-01 s/iter, (0.453, 0.000, 2.143) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 18.808 Tflops/s, hfu: 18.808 Tflops/s, 19.549 iter/s, 5.115e-02 s/iter, (0.468, 0.000, 1.023) sec
# stripe_flash_attn_func, fwd
mfu: 12.787 Tflops/s, hfu: 12.787 Tflops/s, 13.292 iter/s, 7.524e-02 s/iter, (0.497, 0.000, 1.505) sec
# orchestrated_attn_func
mfu: 133.48 Tflops/s, hfu: 133.48 Tflops/s, 69.371 iter/s, 1.442e-02 s/iter, (0.136, 0.000, 0.058) sec
mfu: 109.471 Tflops/s, hfu: 109.471 Tflops/s, 56.893 iter/s, 1.758e-02 s/iter, (0.146, 0.000, 0.070) sec
mfu: 78.751 Tflops/s, hfu: 78.751 Tflops/s, 40.928 iter/s, 2.443e-02 s/iter, (0.170, 0.000, 0.098) sec
mfu: 43.841 Tflops/s, hfu: 43.841 Tflops/s, 22.785 iter/s, 4.389e-02 s/iter, (0.250, 0.000, 0.176) sec
SP=(1,8),S=(2048,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 8.615 Tflops/s, hfu: 8.615 Tflops/s, 7.836 iter/s, 1.276e-01 s/iter, (0.536, 0.000, 2.552) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.738 Tflops/s, hfu: 14.738 Tflops/s, 13.404 iter/s, 7.460e-02 s/iter, (0.582, 0.000, 1.492) sec
# stripe_flash_attn_func, fwd
mfu: 10.229 Tflops/s, hfu: 10.229 Tflops/s, 9.304 iter/s, 1.075e-01 s/iter, (0.565, 0.000, 2.150) sec
# orchestrated_attn_func
mfu: 131.176 Tflops/s, hfu: 131.176 Tflops/s, 59.652 iter/s, 1.676e-02 s/iter, (0.270, 0.000, 0.067) sec
mfu: 107.385 Tflops/s, hfu: 107.385 Tflops/s, 48.833 iter/s, 2.048e-02 s/iter, (0.163, 0.000, 0.082) sec
mfu: 78.322 Tflops/s, hfu: 78.322 Tflops/s, 35.617 iter/s, 2.808e-02 s/iter, (0.181, 0.000, 0.112) sec
mfu: 43.792 Tflops/s, hfu: 43.792 Tflops/s, 19.914 iter/s, 5.022e-02 s/iter, (0.280, 0.000, 0.201) sec
SP=(1,8),S=(4096,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 3.128 Tflops/s, hfu: 3.128 Tflops/s, 364.090 iter/s, 2.747e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 5.884 Tflops/s, hfu: 5.884 Tflops/s, 684.997 iter/s, 1.460e-03 s/iter, (0.019, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 2.759 Tflops/s, hfu: 2.759 Tflops/s, 321.198 iter/s, 3.113e-03 s/iter, (0.036, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 27.565 Tflops/s, hfu: 27.565 Tflops/s, 1604.518 iter/s, 6.232e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 42.942 Tflops/s, hfu: 42.942 Tflops/s, 2499.550 iter/s, 4.001e-04 s/iter, (0.074, 0.000, 0.002) sec
mfu: 51.106 Tflops/s, hfu: 51.106 Tflops/s, 2974.774 iter/s, 3.362e-04 s/iter, (0.071, 0.000, 0.001) sec
mfu: 48.59 Tflops/s, hfu: 48.59 Tflops/s, 2828.310 iter/s, 3.536e-04 s/iter, (0.075, 0.000, 0.001) sec
SP=(1,8),S=(4096,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.245 Tflops/s, hfu: 6.245 Tflops/s, 363.502 iter/s, 2.751e-03 s/iter, (0.035, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.467 Tflops/s, hfu: 11.467 Tflops/s, 667.447 iter/s, 1.498e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.487 Tflops/s, hfu: 5.487 Tflops/s, 319.391 iter/s, 3.131e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 50.499 Tflops/s, hfu: 50.499 Tflops/s, 1469.706 iter/s, 6.804e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 64.514 Tflops/s, hfu: 64.514 Tflops/s, 1877.610 iter/s, 5.326e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 69.645 Tflops/s, hfu: 69.645 Tflops/s, 2026.950 iter/s, 4.934e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 63.117 Tflops/s, hfu: 63.117 Tflops/s, 1836.939 iter/s, 5.444e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(4096,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.381 Tflops/s, hfu: 9.381 Tflops/s, 364.024 iter/s, 2.747e-03 s/iter, (0.034, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.045 Tflops/s, hfu: 17.045 Tflops/s, 661.427 iter/s, 1.512e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.18 Tflops/s, hfu: 8.18 Tflops/s, 317.426 iter/s, 3.150e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 73.494 Tflops/s, hfu: 73.494 Tflops/s, 1425.980 iter/s, 7.013e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 84.04 Tflops/s, hfu: 84.04 Tflops/s, 1630.598 iter/s, 6.133e-04 s/iter, (0.076, 0.000, 0.002) sec
mfu: 82.729 Tflops/s, hfu: 82.729 Tflops/s, 1605.157 iter/s, 6.230e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 54.393 Tflops/s, hfu: 54.393 Tflops/s, 1055.360 iter/s, 9.475e-04 s/iter, (0.073, 0.000, 0.004) sec
SP=(1,8),S=(4096,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.461 Tflops/s, hfu: 12.461 Tflops/s, 362.677 iter/s, 2.757e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.675 Tflops/s, hfu: 21.675 Tflops/s, 630.836 iter/s, 1.585e-03 s/iter, (0.018, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 10.921 Tflops/s, hfu: 10.921 Tflops/s, 317.854 iter/s, 3.146e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 83.97 Tflops/s, hfu: 83.97 Tflops/s, 1221.920 iter/s, 8.184e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 96.112 Tflops/s, hfu: 96.112 Tflops/s, 1398.617 iter/s, 7.150e-04 s/iter, (0.075, 0.000, 0.003) sec
mfu: 93.4 Tflops/s, hfu: 93.4 Tflops/s, 1359.154 iter/s, 7.358e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 64.969 Tflops/s, hfu: 64.969 Tflops/s, 945.423 iter/s, 1.058e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(4096,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.563 Tflops/s, hfu: 15.563 Tflops/s, 362.343 iter/s, 2.760e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.547 Tflops/s, hfu: 28.547 Tflops/s, 664.655 iter/s, 1.505e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 13.7 Tflops/s, hfu: 13.7 Tflops/s, 318.979 iter/s, 3.135e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 98.661 Tflops/s, hfu: 98.661 Tflops/s, 1148.570 iter/s, 8.706e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 103.511 Tflops/s, hfu: 103.511 Tflops/s, 1205.028 iter/s, 8.299e-04 s/iter, (0.074, 0.000, 0.003) sec
mfu: 97.407 Tflops/s, hfu: 97.407 Tflops/s, 1133.972 iter/s, 8.819e-04 s/iter, (0.100, 0.001, 0.004) sec
mfu: 62.669 Tflops/s, hfu: 62.669 Tflops/s, 729.565 iter/s, 1.371e-03 s/iter, (0.074, 0.000, 0.005) sec
SP=(1,8),S=(4096,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.496 Tflops/s, hfu: 18.496 Tflops/s, 358.860 iter/s, 2.787e-03 s/iter, (0.043, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 33.837 Tflops/s, hfu: 33.837 Tflops/s, 656.519 iter/s, 1.523e-03 s/iter, (0.021, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.483 Tflops/s, hfu: 16.483 Tflops/s, 319.810 iter/s, 3.127e-03 s/iter, (0.036, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 108.351 Tflops/s, hfu: 108.351 Tflops/s, 1051.144 iter/s, 9.513e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 109.539 Tflops/s, hfu: 109.539 Tflops/s, 1062.672 iter/s, 9.410e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 101.968 Tflops/s, hfu: 101.968 Tflops/s, 989.222 iter/s, 1.011e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 72.412 Tflops/s, hfu: 72.412 Tflops/s, 702.488 iter/s, 1.424e-03 s/iter, (0.079, 0.000, 0.006) sec
SP=(1,8),S=(4096,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.576 Tflops/s, hfu: 21.576 Tflops/s, 358.833 iter/s, 2.787e-03 s/iter, (0.047, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 39.602 Tflops/s, hfu: 39.602 Tflops/s, 658.607 iter/s, 1.518e-03 s/iter, (0.029, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 19.119 Tflops/s, hfu: 19.119 Tflops/s, 317.962 iter/s, 3.145e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 111.906 Tflops/s, hfu: 111.906 Tflops/s, 930.537 iter/s, 1.075e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 112.991 Tflops/s, hfu: 112.991 Tflops/s, 939.560 iter/s, 1.064e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 104.75 Tflops/s, hfu: 104.75 Tflops/s, 871.038 iter/s, 1.148e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 67.633 Tflops/s, hfu: 67.633 Tflops/s, 562.397 iter/s, 1.778e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(4096,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.681 Tflops/s, hfu: 24.681 Tflops/s, 359.151 iter/s, 2.784e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.975 Tflops/s, hfu: 43.975 Tflops/s, 639.927 iter/s, 1.563e-03 s/iter, (0.022, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 21.848 Tflops/s, hfu: 21.848 Tflops/s, 317.926 iter/s, 3.145e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 114.071 Tflops/s, hfu: 114.071 Tflops/s, 829.975 iter/s, 1.205e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 112.858 Tflops/s, hfu: 112.858 Tflops/s, 821.148 iter/s, 1.218e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 108.069 Tflops/s, hfu: 108.069 Tflops/s, 786.307 iter/s, 1.272e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 58.324 Tflops/s, hfu: 58.324 Tflops/s, 424.360 iter/s, 2.356e-03 s/iter, (0.078, 0.000, 0.009) sec
SP=(1,8),S=(4096,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.793 Tflops/s, hfu: 30.793 Tflops/s, 358.474 iter/s, 2.790e-03 s/iter, (0.044, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 44.737 Tflops/s, hfu: 44.737 Tflops/s, 520.802 iter/s, 1.920e-03 s/iter, (0.034, 0.000, 0.038) sec
# stripe_flash_attn_func, fwd
mfu: 27.28 Tflops/s, hfu: 27.28 Tflops/s, 317.585 iter/s, 3.149e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 118.447 Tflops/s, hfu: 118.447 Tflops/s, 689.454 iter/s, 1.450e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 118.858 Tflops/s, hfu: 118.858 Tflops/s, 691.842 iter/s, 1.445e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 112.576 Tflops/s, hfu: 112.576 Tflops/s, 655.281 iter/s, 1.526e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 80.184 Tflops/s, hfu: 80.184 Tflops/s, 466.735 iter/s, 2.143e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(4096,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 35.73 Tflops/s, hfu: 35.73 Tflops/s, 346.624 iter/s, 2.885e-03 s/iter, (0.042, 0.000, 0.058) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.921 Tflops/s, hfu: 46.921 Tflops/s, 455.198 iter/s, 2.197e-03 s/iter, (0.029, 0.000, 0.044) sec
# stripe_flash_attn_func, fwd
mfu: 32.439 Tflops/s, hfu: 32.439 Tflops/s, 314.702 iter/s, 3.178e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 120.278 Tflops/s, hfu: 120.278 Tflops/s, 583.425 iter/s, 1.714e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 120.984 Tflops/s, hfu: 120.984 Tflops/s, 586.849 iter/s, 1.704e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 112.533 Tflops/s, hfu: 112.533 Tflops/s, 545.859 iter/s, 1.832e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 77.111 Tflops/s, hfu: 77.111 Tflops/s, 374.035 iter/s, 2.674e-03 s/iter, (0.091, 0.000, 0.011) sec
SP=(1,8),S=(4096,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.782 Tflops/s, hfu: 37.782 Tflops/s, 314.174 iter/s, 3.183e-03 s/iter, (0.049, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.312 Tflops/s, hfu: 43.312 Tflops/s, 360.157 iter/s, 2.777e-03 s/iter, (0.040, 0.000, 0.056) sec
# stripe_flash_attn_func, fwd
mfu: 35.1 Tflops/s, hfu: 35.1 Tflops/s, 291.868 iter/s, 3.426e-03 s/iter, (0.041, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 121.348 Tflops/s, hfu: 121.348 Tflops/s, 504.529 iter/s, 1.982e-03 s/iter, (0.079, 0.000, 0.008) sec
mfu: 121.541 Tflops/s, hfu: 121.541 Tflops/s, 505.330 iter/s, 1.979e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 111.816 Tflops/s, hfu: 111.816 Tflops/s, 464.898 iter/s, 2.151e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 64.826 Tflops/s, hfu: 64.826 Tflops/s, 269.527 iter/s, 3.710e-03 s/iter, (0.084, 0.000, 0.015) sec
SP=(1,8),S=(4096,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 39.546 Tflops/s, hfu: 39.546 Tflops/s, 287.738 iter/s, 3.475e-03 s/iter, (0.052, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 47.012 Tflops/s, hfu: 47.012 Tflops/s, 342.054 iter/s, 2.924e-03 s/iter, (0.037, 0.000, 0.058) sec
# stripe_flash_attn_func, fwd
mfu: 36.768 Tflops/s, hfu: 36.768 Tflops/s, 267.525 iter/s, 3.738e-03 s/iter, (0.044, 0.000, 0.075) sec
# orchestrated_attn_func
mfu: 124.803 Tflops/s, hfu: 124.803 Tflops/s, 454.032 iter/s, 2.202e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 122.683 Tflops/s, hfu: 122.683 Tflops/s, 446.319 iter/s, 2.241e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 108.222 Tflops/s, hfu: 108.222 Tflops/s, 393.709 iter/s, 2.540e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 76.128 Tflops/s, hfu: 76.128 Tflops/s, 276.952 iter/s, 3.611e-03 s/iter, (0.086, 0.000, 0.014) sec
SP=(1,8),S=(4096,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 40.876 Tflops/s, hfu: 40.876 Tflops/s, 237.929 iter/s, 4.203e-03 s/iter, (0.057, 0.000, 0.084) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 47.973 Tflops/s, hfu: 47.973 Tflops/s, 279.239 iter/s, 3.581e-03 s/iter, (0.045, 0.000, 0.072) sec
# stripe_flash_attn_func, fwd
mfu: 39.204 Tflops/s, hfu: 39.204 Tflops/s, 228.195 iter/s, 4.382e-03 s/iter, (0.051, 0.000, 0.088) sec
# orchestrated_attn_func
mfu: 126.098 Tflops/s, hfu: 126.098 Tflops/s, 366.993 iter/s, 2.725e-03 s/iter, (0.092, 0.000, 0.011) sec
mfu: 124.713 Tflops/s, hfu: 124.713 Tflops/s, 362.962 iter/s, 2.755e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 115.625 Tflops/s, hfu: 115.625 Tflops/s, 336.514 iter/s, 2.972e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 86.16 Tflops/s, hfu: 86.16 Tflops/s, 250.758 iter/s, 3.988e-03 s/iter, (0.086, 0.000, 0.016) sec
SP=(1,8),S=(4096,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.496 Tflops/s, hfu: 42.496 Tflops/s, 206.133 iter/s, 4.851e-03 s/iter, (0.063, 0.000, 0.097) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.262 Tflops/s, hfu: 50.262 Tflops/s, 243.802 iter/s, 4.102e-03 s/iter, (0.054, 0.000, 0.082) sec
# stripe_flash_attn_func, fwd
mfu: 40.289 Tflops/s, hfu: 40.289 Tflops/s, 195.428 iter/s, 5.117e-03 s/iter, (0.059, 0.000, 0.102) sec
# orchestrated_attn_func
mfu: 127.306 Tflops/s, hfu: 127.306 Tflops/s, 308.759 iter/s, 3.239e-03 s/iter, (0.136, 0.000, 0.013) sec
mfu: 125.709 Tflops/s, hfu: 125.709 Tflops/s, 304.883 iter/s, 3.280e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 120.531 Tflops/s, hfu: 120.531 Tflops/s, 292.327 iter/s, 3.421e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 91.595 Tflops/s, hfu: 91.595 Tflops/s, 222.146 iter/s, 4.502e-03 s/iter, (0.088, 0.000, 0.018) sec
SP=(1,8),S=(4096,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 43.879 Tflops/s, hfu: 43.879 Tflops/s, 182.435 iter/s, 5.481e-03 s/iter, (0.067, 0.000, 0.110) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 49.41 Tflops/s, hfu: 49.41 Tflops/s, 205.429 iter/s, 4.868e-03 s/iter, (0.061, 0.000, 0.097) sec
# stripe_flash_attn_func, fwd
mfu: 41.977 Tflops/s, hfu: 41.977 Tflops/s, 174.529 iter/s, 5.730e-03 s/iter, (0.067, 0.000, 0.115) sec
# orchestrated_attn_func
mfu: 128.224 Tflops/s, hfu: 128.224 Tflops/s, 266.559 iter/s, 3.752e-03 s/iter, (0.091, 0.000, 0.015) sec
mfu: 125.047 Tflops/s, hfu: 125.047 Tflops/s, 259.953 iter/s, 3.847e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 124.281 Tflops/s, hfu: 124.281 Tflops/s, 258.361 iter/s, 3.871e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 94.432 Tflops/s, hfu: 94.432 Tflops/s, 196.309 iter/s, 5.094e-03 s/iter, (0.090, 0.000, 0.020) sec
SP=(1,8),S=(4096,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.187 Tflops/s, hfu: 45.187 Tflops/s, 164.390 iter/s, 6.083e-03 s/iter, (0.073, 0.000, 0.122) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.845 Tflops/s, hfu: 50.845 Tflops/s, 184.975 iter/s, 5.406e-03 s/iter, (0.069, 0.000, 0.108) sec
# stripe_flash_attn_func, fwd
mfu: 42.788 Tflops/s, hfu: 42.788 Tflops/s, 155.663 iter/s, 6.424e-03 s/iter, (0.075, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 129.158 Tflops/s, hfu: 129.158 Tflops/s, 234.936 iter/s, 4.256e-03 s/iter, (0.116, 0.000, 0.017) sec
mfu: 125.48 Tflops/s, hfu: 125.48 Tflops/s, 228.246 iter/s, 4.381e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 124.542 Tflops/s, hfu: 124.542 Tflops/s, 226.540 iter/s, 4.414e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 95.225 Tflops/s, hfu: 95.225 Tflops/s, 173.213 iter/s, 5.773e-03 s/iter, (0.093, 0.000, 0.023) sec
SP=(1,8),S=(4096,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.908 Tflops/s, hfu: 47.908 Tflops/s, 139.429 iter/s, 7.172e-03 s/iter, (0.085, 0.000, 0.143) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 50.895 Tflops/s, hfu: 50.895 Tflops/s, 148.125 iter/s, 6.751e-03 s/iter, (0.084, 0.000, 0.135) sec
# stripe_flash_attn_func, fwd
mfu: 44.781 Tflops/s, hfu: 44.781 Tflops/s, 130.330 iter/s, 7.673e-03 s/iter, (0.087, 0.000, 0.153) sec
# orchestrated_attn_func
mfu: 130.266 Tflops/s, hfu: 130.266 Tflops/s, 189.563 iter/s, 5.275e-03 s/iter, (0.106, 0.000, 0.021) sec
mfu: 128.997 Tflops/s, hfu: 128.997 Tflops/s, 187.715 iter/s, 5.327e-03 s/iter, (0.094, 0.000, 0.021) sec
mfu: 125.398 Tflops/s, hfu: 125.398 Tflops/s, 182.477 iter/s, 5.480e-03 s/iter, (0.094, 0.000, 0.022) sec
mfu: 99.897 Tflops/s, hfu: 99.897 Tflops/s, 145.370 iter/s, 6.879e-03 s/iter, (0.097, 0.000, 0.028) sec
SP=(1,8),S=(4096,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 50.598 Tflops/s, hfu: 50.598 Tflops/s, 122.716 iter/s, 8.149e-03 s/iter, (0.097, 0.000, 0.163) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.829 Tflops/s, hfu: 51.829 Tflops/s, 125.702 iter/s, 7.955e-03 s/iter, (0.097, 0.000, 0.159) sec
# stripe_flash_attn_func, fwd
mfu: 47.566 Tflops/s, hfu: 47.566 Tflops/s, 115.362 iter/s, 8.668e-03 s/iter, (0.098, 0.000, 0.173) sec
# orchestrated_attn_func
mfu: 132.154 Tflops/s, hfu: 132.154 Tflops/s, 160.258 iter/s, 6.240e-03 s/iter, (0.183, 0.000, 0.025) sec
mfu: 127.076 Tflops/s, hfu: 127.076 Tflops/s, 154.100 iter/s, 6.489e-03 s/iter, (0.096, 0.000, 0.026) sec
mfu: 124.254 Tflops/s, hfu: 124.254 Tflops/s, 150.678 iter/s, 6.637e-03 s/iter, (0.095, 0.000, 0.027) sec
mfu: 99.556 Tflops/s, hfu: 99.556 Tflops/s, 120.727 iter/s, 8.283e-03 s/iter, (0.103, 0.000, 0.033) sec
SP=(1,8),S=(4096,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.582 Tflops/s, hfu: 52.582 Tflops/s, 109.309 iter/s, 9.148e-03 s/iter, (0.109, 0.000, 0.183) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.484 Tflops/s, hfu: 51.484 Tflops/s, 107.028 iter/s, 9.343e-03 s/iter, (0.112, 0.000, 0.187) sec
# stripe_flash_attn_func, fwd
mfu: 49.843 Tflops/s, hfu: 49.843 Tflops/s, 103.617 iter/s, 9.651e-03 s/iter, (0.110, 0.000, 0.193) sec
# orchestrated_attn_func
mfu: 132.176 Tflops/s, hfu: 132.176 Tflops/s, 137.386 iter/s, 7.279e-03 s/iter, (0.162, 0.000, 0.029) sec
mfu: 127.55 Tflops/s, hfu: 127.55 Tflops/s, 132.578 iter/s, 7.543e-03 s/iter, (0.104, 0.000, 0.030) sec
mfu: 127.195 Tflops/s, hfu: 127.195 Tflops/s, 132.209 iter/s, 7.564e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 101.002 Tflops/s, hfu: 101.002 Tflops/s, 104.983 iter/s, 9.525e-03 s/iter, (0.108, 0.000, 0.038) sec
SP=(1,8),S=(4096,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.766 Tflops/s, hfu: 53.766 Tflops/s, 97.800 iter/s, 1.022e-02 s/iter, (0.121, 0.000, 0.204) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.154 Tflops/s, hfu: 51.154 Tflops/s, 93.048 iter/s, 1.075e-02 s/iter, (0.127, 0.000, 0.215) sec
# stripe_flash_attn_func, fwd
mfu: 52.05 Tflops/s, hfu: 52.05 Tflops/s, 94.678 iter/s, 1.056e-02 s/iter, (0.123, 0.000, 0.211) sec
# orchestrated_attn_func
mfu: 132.75 Tflops/s, hfu: 132.75 Tflops/s, 120.735 iter/s, 8.283e-03 s/iter, (0.108, 0.000, 0.033) sec
mfu: 127.31 Tflops/s, hfu: 127.31 Tflops/s, 115.788 iter/s, 8.636e-03 s/iter, (0.106, 0.000, 0.035) sec
mfu: 128.661 Tflops/s, hfu: 128.661 Tflops/s, 117.016 iter/s, 8.546e-03 s/iter, (0.103, 0.000, 0.034) sec
mfu: 103.354 Tflops/s, hfu: 103.354 Tflops/s, 94.000 iter/s, 1.064e-02 s/iter, (0.112, 0.000, 0.043) sec
SP=(1,8),S=(4096,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.073 Tflops/s, hfu: 55.073 Tflops/s, 80.141 iter/s, 1.248e-02 s/iter, (0.148, 0.000, 0.250) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.93 Tflops/s, hfu: 51.93 Tflops/s, 75.568 iter/s, 1.323e-02 s/iter, (0.158, 0.000, 0.265) sec
# stripe_flash_attn_func, fwd
mfu: 53.777 Tflops/s, hfu: 53.777 Tflops/s, 78.255 iter/s, 1.278e-02 s/iter, (0.149, 0.000, 0.256) sec
# orchestrated_attn_func
mfu: 133.386 Tflops/s, hfu: 133.386 Tflops/s, 97.051 iter/s, 1.030e-02 s/iter, (0.131, 0.000, 0.041) sec
mfu: 124.89 Tflops/s, hfu: 124.89 Tflops/s, 90.870 iter/s, 1.100e-02 s/iter, (0.119, 0.000, 0.044) sec
mfu: 113.726 Tflops/s, hfu: 113.726 Tflops/s, 82.746 iter/s, 1.209e-02 s/iter, (0.116, 0.000, 0.048) sec
mfu: 96.594 Tflops/s, hfu: 96.594 Tflops/s, 70.282 iter/s, 1.423e-02 s/iter, (0.131, 0.000, 0.057) sec
SP=(1,8),S=(4096,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.911 Tflops/s, hfu: 55.911 Tflops/s, 67.800 iter/s, 1.475e-02 s/iter, (0.175, 0.000, 0.295) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 51.939 Tflops/s, hfu: 51.939 Tflops/s, 62.984 iter/s, 1.588e-02 s/iter, (0.190, 0.000, 0.318) sec
# stripe_flash_attn_func, fwd
mfu: 54.393 Tflops/s, hfu: 54.393 Tflops/s, 65.960 iter/s, 1.516e-02 s/iter, (0.178, 0.000, 0.303) sec
# orchestrated_attn_func
mfu: 133.783 Tflops/s, hfu: 133.783 Tflops/s, 81.117 iter/s, 1.233e-02 s/iter, (0.124, 0.000, 0.049) sec
mfu: 127.287 Tflops/s, hfu: 127.287 Tflops/s, 77.178 iter/s, 1.296e-02 s/iter, (0.135, 0.000, 0.052) sec
mfu: 118.104 Tflops/s, hfu: 118.104 Tflops/s, 71.610 iter/s, 1.396e-02 s/iter, (0.127, 0.000, 0.056) sec
mfu: 94.674 Tflops/s, hfu: 94.674 Tflops/s, 57.404 iter/s, 1.742e-02 s/iter, (0.136, 0.000, 0.070) sec
SP=(1,8),S=(4096,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.331 Tflops/s, hfu: 57.331 Tflops/s, 59.591 iter/s, 1.678e-02 s/iter, (0.200, 0.000, 0.336) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 30.943 Tflops/s, hfu: 30.943 Tflops/s, 32.163 iter/s, 3.109e-02 s/iter, (0.224, 0.000, 0.622) sec
# stripe_flash_attn_func, fwd
mfu: 53.314 Tflops/s, hfu: 53.314 Tflops/s, 55.416 iter/s, 1.805e-02 s/iter, (0.212, 0.000, 0.361) sec
# orchestrated_attn_func
mfu: 133.904 Tflops/s, hfu: 133.904 Tflops/s, 69.592 iter/s, 1.437e-02 s/iter, (0.159, 0.000, 0.057) sec
mfu: 125.788 Tflops/s, hfu: 125.788 Tflops/s, 65.373 iter/s, 1.530e-02 s/iter, (0.139, 0.000, 0.061) sec
mfu: 118.722 Tflops/s, hfu: 118.722 Tflops/s, 61.701 iter/s, 1.621e-02 s/iter, (0.137, 0.000, 0.065) sec
mfu: 95.696 Tflops/s, hfu: 95.696 Tflops/s, 49.734 iter/s, 2.011e-02 s/iter, (0.147, 0.000, 0.080) sec
SP=(1,8),S=(4096,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.989 Tflops/s, hfu: 57.989 Tflops/s, 52.740 iter/s, 1.896e-02 s/iter, (0.227, 0.000, 0.379) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 21.343 Tflops/s, hfu: 21.343 Tflops/s, 19.411 iter/s, 5.152e-02 s/iter, (0.250, 0.000, 1.030) sec
# stripe_flash_attn_func, fwd
mfu: 55.579 Tflops/s, hfu: 55.579 Tflops/s, 50.549 iter/s, 1.978e-02 s/iter, (0.242, 0.000, 0.396) sec
# orchestrated_attn_func
mfu: 134.133 Tflops/s, hfu: 134.133 Tflops/s, 60.997 iter/s, 1.639e-02 s/iter, (0.191, 0.000, 0.066) sec
mfu: 125.64 Tflops/s, hfu: 125.64 Tflops/s, 57.135 iter/s, 1.750e-02 s/iter, (0.148, 0.000, 0.070) sec
mfu: 119.559 Tflops/s, hfu: 119.559 Tflops/s, 54.369 iter/s, 1.839e-02 s/iter, (0.143, 0.000, 0.074) sec
mfu: 93.328 Tflops/s, hfu: 93.328 Tflops/s, 42.441 iter/s, 2.356e-02 s/iter, (0.160, 0.000, 0.094) sec
SP=(1,8),S=(4096,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.847 Tflops/s, hfu: 24.847 Tflops/s, 18.079 iter/s, 5.531e-02 s/iter, (0.308, 0.000, 1.106) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.91 Tflops/s, hfu: 43.91 Tflops/s, 31.949 iter/s, 3.130e-02 s/iter, (0.334, 0.000, 0.626) sec
# stripe_flash_attn_func, fwd
mfu: 50.74 Tflops/s, hfu: 50.74 Tflops/s, 36.918 iter/s, 2.709e-02 s/iter, (0.327, 0.000, 0.542) sec
# orchestrated_attn_func
mfu: 134.653 Tflops/s, hfu: 134.653 Tflops/s, 48.986 iter/s, 2.041e-02 s/iter, (0.183, 0.000, 0.082) sec
mfu: 126.479 Tflops/s, hfu: 126.479 Tflops/s, 46.013 iter/s, 2.173e-02 s/iter, (0.169, 0.000, 0.087) sec
mfu: 119.023 Tflops/s, hfu: 119.023 Tflops/s, 43.300 iter/s, 2.309e-02 s/iter, (0.166, 0.000, 0.092) sec
mfu: 95.425 Tflops/s, hfu: 95.425 Tflops/s, 34.715 iter/s, 2.881e-02 s/iter, (0.187, 0.000, 0.115) sec
SP=(1,8),S=(4096,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.659 Tflops/s, hfu: 22.659 Tflops/s, 13.739 iter/s, 7.279e-02 s/iter, (0.360, 0.000, 1.456) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.231 Tflops/s, hfu: 38.231 Tflops/s, 23.181 iter/s, 4.314e-02 s/iter, (0.395, 0.000, 0.863) sec
# stripe_flash_attn_func, fwd
mfu: 28.122 Tflops/s, hfu: 28.122 Tflops/s, 17.051 iter/s, 5.865e-02 s/iter, (0.412, 0.000, 1.173) sec
# orchestrated_attn_func
mfu: 134.846 Tflops/s, hfu: 134.846 Tflops/s, 40.881 iter/s, 2.446e-02 s/iter, (0.180, 0.000, 0.098) sec
mfu: 127.529 Tflops/s, hfu: 127.529 Tflops/s, 38.662 iter/s, 2.587e-02 s/iter, (0.182, 0.000, 0.103) sec
mfu: 120.547 Tflops/s, hfu: 120.547 Tflops/s, 36.546 iter/s, 2.736e-02 s/iter, (0.180, 0.000, 0.109) sec
mfu: 98.854 Tflops/s, hfu: 98.854 Tflops/s, 29.969 iter/s, 3.337e-02 s/iter, (0.221, 0.000, 0.133) sec
SP=(1,8),S=(4096,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.524 Tflops/s, hfu: 18.524 Tflops/s, 9.627 iter/s, 1.039e-01 s/iter, (0.414, 0.000, 2.077) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.79 Tflops/s, hfu: 28.79 Tflops/s, 14.963 iter/s, 6.683e-02 s/iter, (0.501, 0.000, 1.337) sec
# stripe_flash_attn_func, fwd
mfu: 18.042 Tflops/s, hfu: 18.042 Tflops/s, 9.377 iter/s, 1.066e-01 s/iter, (0.454, 0.000, 2.133) sec
# orchestrated_attn_func
mfu: 134.68 Tflops/s, hfu: 134.68 Tflops/s, 34.997 iter/s, 2.857e-02 s/iter, (0.220, 0.000, 0.114) sec
mfu: 126.663 Tflops/s, hfu: 126.663 Tflops/s, 32.914 iter/s, 3.038e-02 s/iter, (0.198, 0.000, 0.122) sec
mfu: 119.107 Tflops/s, hfu: 119.107 Tflops/s, 30.951 iter/s, 3.231e-02 s/iter, (0.199, 0.000, 0.129) sec
mfu: 100.742 Tflops/s, hfu: 100.742 Tflops/s, 26.178 iter/s, 3.820e-02 s/iter, (0.224, 0.000, 0.153) sec
SP=(1,8),S=(4096,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 19.669 Tflops/s, hfu: 19.669 Tflops/s, 8.945 iter/s, 1.118e-01 s/iter, (0.464, 0.000, 2.236) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 24.007 Tflops/s, hfu: 24.007 Tflops/s, 10.917 iter/s, 9.160e-02 s/iter, (0.547, 0.000, 1.832) sec
# stripe_flash_attn_func, fwd
mfu: 20.772 Tflops/s, hfu: 20.772 Tflops/s, 9.446 iter/s, 1.059e-01 s/iter, (0.512, 0.000, 2.117) sec
# orchestrated_attn_func
mfu: 134.938 Tflops/s, hfu: 134.938 Tflops/s, 30.681 iter/s, 3.259e-02 s/iter, (0.267, 0.000, 0.130) sec
mfu: 127.591 Tflops/s, hfu: 127.591 Tflops/s, 29.011 iter/s, 3.447e-02 s/iter, (0.220, 0.000, 0.138) sec
mfu: 120.319 Tflops/s, hfu: 120.319 Tflops/s, 27.357 iter/s, 3.655e-02 s/iter, (0.224, 0.000, 0.146) sec
mfu: 92.614 Tflops/s, hfu: 92.614 Tflops/s, 21.058 iter/s, 4.749e-02 s/iter, (0.243, 0.000, 0.190) sec
SP=(1,8),S=(6144,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 4.681 Tflops/s, hfu: 4.681 Tflops/s, 363.267 iter/s, 2.753e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 8.685 Tflops/s, hfu: 8.685 Tflops/s, 674.054 iter/s, 1.484e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 4.062 Tflops/s, hfu: 4.062 Tflops/s, 315.287 iter/s, 3.172e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 27.326 Tflops/s, hfu: 27.326 Tflops/s, 1060.400 iter/s, 9.430e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 52.646 Tflops/s, hfu: 52.646 Tflops/s, 2042.918 iter/s, 4.895e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 61.395 Tflops/s, hfu: 61.395 Tflops/s, 2382.450 iter/s, 4.197e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 71.813 Tflops/s, hfu: 71.813 Tflops/s, 2786.695 iter/s, 3.588e-04 s/iter, (0.072, 0.000, 0.001) sec
SP=(1,8),S=(6144,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.272 Tflops/s, hfu: 9.272 Tflops/s, 359.819 iter/s, 2.779e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.37 Tflops/s, hfu: 17.37 Tflops/s, 674.060 iter/s, 1.484e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 8.138 Tflops/s, hfu: 8.138 Tflops/s, 315.800 iter/s, 3.167e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 51.552 Tflops/s, hfu: 51.552 Tflops/s, 1000.240 iter/s, 9.998e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 82.46 Tflops/s, hfu: 82.46 Tflops/s, 1599.938 iter/s, 6.250e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 82.219 Tflops/s, hfu: 82.219 Tflops/s, 1595.263 iter/s, 6.269e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 77.001 Tflops/s, hfu: 77.001 Tflops/s, 1494.018 iter/s, 6.693e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(6144,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 14.017 Tflops/s, hfu: 14.017 Tflops/s, 362.628 iter/s, 2.758e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 26.112 Tflops/s, hfu: 26.112 Tflops/s, 675.525 iter/s, 1.480e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 12.202 Tflops/s, hfu: 12.202 Tflops/s, 315.675 iter/s, 3.168e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 79.622 Tflops/s, hfu: 79.622 Tflops/s, 1029.909 iter/s, 9.710e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 96.145 Tflops/s, hfu: 96.145 Tflops/s, 1243.633 iter/s, 8.041e-04 s/iter, (0.080, 0.000, 0.003) sec
mfu: 91.822 Tflops/s, hfu: 91.822 Tflops/s, 1187.716 iter/s, 8.420e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 76.854 Tflops/s, hfu: 76.854 Tflops/s, 994.115 iter/s, 1.006e-03 s/iter, (0.073, 0.000, 0.004) sec
SP=(1,8),S=(6144,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.579 Tflops/s, hfu: 18.579 Tflops/s, 360.473 iter/s, 2.774e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.723 Tflops/s, hfu: 34.723 Tflops/s, 673.719 iter/s, 1.484e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.192 Tflops/s, hfu: 16.192 Tflops/s, 314.165 iter/s, 3.183e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 100.064 Tflops/s, hfu: 100.064 Tflops/s, 970.753 iter/s, 1.030e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 110.378 Tflops/s, hfu: 110.378 Tflops/s, 1070.811 iter/s, 9.339e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 101.11 Tflops/s, hfu: 101.11 Tflops/s, 980.892 iter/s, 1.019e-03 s/iter, (0.076, 0.000, 0.004) sec
mfu: 86.011 Tflops/s, hfu: 86.011 Tflops/s, 834.418 iter/s, 1.198e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(6144,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.51 Tflops/s, hfu: 22.51 Tflops/s, 349.404 iter/s, 2.862e-03 s/iter, (0.047, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.772 Tflops/s, hfu: 41.772 Tflops/s, 648.380 iter/s, 1.542e-03 s/iter, (0.018, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 20.326 Tflops/s, hfu: 20.326 Tflops/s, 315.502 iter/s, 3.170e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 118.298 Tflops/s, hfu: 118.298 Tflops/s, 918.112 iter/s, 1.089e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 115.624 Tflops/s, hfu: 115.624 Tflops/s, 897.357 iter/s, 1.114e-03 s/iter, (0.075, 0.000, 0.004) sec
mfu: 107.334 Tflops/s, hfu: 107.334 Tflops/s, 833.022 iter/s, 1.200e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 79.114 Tflops/s, hfu: 79.114 Tflops/s, 614.009 iter/s, 1.629e-03 s/iter, (0.076, 0.000, 0.007) sec
SP=(1,8),S=(6144,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 28.103 Tflops/s, hfu: 28.103 Tflops/s, 363.508 iter/s, 2.751e-03 s/iter, (0.047, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 52.283 Tflops/s, hfu: 52.283 Tflops/s, 676.277 iter/s, 1.479e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.359 Tflops/s, hfu: 24.359 Tflops/s, 315.089 iter/s, 3.174e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 132.172 Tflops/s, hfu: 132.172 Tflops/s, 854.824 iter/s, 1.170e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 116.435 Tflops/s, hfu: 116.435 Tflops/s, 753.044 iter/s, 1.328e-03 s/iter, (0.077, 0.000, 0.005) sec
mfu: 110.681 Tflops/s, hfu: 110.681 Tflops/s, 715.832 iter/s, 1.397e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 79.237 Tflops/s, hfu: 79.237 Tflops/s, 512.469 iter/s, 1.951e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(6144,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.72 Tflops/s, hfu: 32.72 Tflops/s, 362.777 iter/s, 2.757e-03 s/iter, (0.046, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 60.144 Tflops/s, hfu: 60.144 Tflops/s, 666.826 iter/s, 1.500e-03 s/iter, (0.020, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 28.101 Tflops/s, hfu: 28.101 Tflops/s, 311.556 iter/s, 3.210e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 138.696 Tflops/s, hfu: 138.696 Tflops/s, 768.871 iter/s, 1.301e-03 s/iter, (0.076, 0.000, 0.005) sec
mfu: 125.675 Tflops/s, hfu: 125.675 Tflops/s, 696.689 iter/s, 1.435e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 113.365 Tflops/s, hfu: 113.365 Tflops/s, 628.447 iter/s, 1.591e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 95.922 Tflops/s, hfu: 95.922 Tflops/s, 531.752 iter/s, 1.881e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(6144,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 37.303 Tflops/s, hfu: 37.303 Tflops/s, 361.888 iter/s, 2.763e-03 s/iter, (0.050, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 67.131 Tflops/s, hfu: 67.131 Tflops/s, 651.259 iter/s, 1.535e-03 s/iter, (0.024, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 32.181 Tflops/s, hfu: 32.181 Tflops/s, 312.199 iter/s, 3.203e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 134.917 Tflops/s, hfu: 134.917 Tflops/s, 654.433 iter/s, 1.528e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 122.779 Tflops/s, hfu: 122.779 Tflops/s, 595.556 iter/s, 1.679e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 115.278 Tflops/s, hfu: 115.278 Tflops/s, 559.172 iter/s, 1.788e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 94.759 Tflops/s, hfu: 94.759 Tflops/s, 459.643 iter/s, 2.176e-03 s/iter, (0.082, 0.000, 0.009) sec
SP=(1,8),S=(6144,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.687 Tflops/s, hfu: 44.687 Tflops/s, 346.813 iter/s, 2.883e-03 s/iter, (0.050, 0.000, 0.058) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 71.092 Tflops/s, hfu: 71.092 Tflops/s, 551.744 iter/s, 1.812e-03 s/iter, (0.025, 0.000, 0.036) sec
# stripe_flash_attn_func, fwd
mfu: 38.326 Tflops/s, hfu: 38.326 Tflops/s, 297.447 iter/s, 3.362e-03 s/iter, (0.040, 0.000, 0.067) sec
# orchestrated_attn_func
mfu: 142.094 Tflops/s, hfu: 142.094 Tflops/s, 551.397 iter/s, 1.814e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 124.911 Tflops/s, hfu: 124.911 Tflops/s, 484.720 iter/s, 2.063e-03 s/iter, (0.081, 0.000, 0.008) sec
mfu: 118.406 Tflops/s, hfu: 118.406 Tflops/s, 459.476 iter/s, 2.176e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 91.343 Tflops/s, hfu: 91.343 Tflops/s, 354.458 iter/s, 2.821e-03 s/iter, (0.085, 0.000, 0.011) sec
SP=(1,8),S=(6144,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.341 Tflops/s, hfu: 47.341 Tflops/s, 306.177 iter/s, 3.266e-03 s/iter, (0.054, 0.000, 0.065) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 73.724 Tflops/s, hfu: 73.724 Tflops/s, 476.812 iter/s, 2.097e-03 s/iter, (0.035, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 42.306 Tflops/s, hfu: 42.306 Tflops/s, 273.614 iter/s, 3.655e-03 s/iter, (0.043, 0.000, 0.073) sec
# orchestrated_attn_func
mfu: 136.693 Tflops/s, hfu: 136.693 Tflops/s, 442.034 iter/s, 2.262e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 126.156 Tflops/s, hfu: 126.156 Tflops/s, 407.958 iter/s, 2.451e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 120.617 Tflops/s, hfu: 120.617 Tflops/s, 390.047 iter/s, 2.564e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 96.663 Tflops/s, hfu: 96.663 Tflops/s, 312.584 iter/s, 3.199e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(6144,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.558 Tflops/s, hfu: 48.558 Tflops/s, 269.187 iter/s, 3.715e-03 s/iter, (0.050, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 74.545 Tflops/s, hfu: 74.545 Tflops/s, 413.246 iter/s, 2.420e-03 s/iter, (0.037, 0.000, 0.048) sec
# stripe_flash_attn_func, fwd
mfu: 45.875 Tflops/s, hfu: 45.875 Tflops/s, 254.310 iter/s, 3.932e-03 s/iter, (0.047, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 140.025 Tflops/s, hfu: 140.025 Tflops/s, 388.122 iter/s, 2.577e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 130.549 Tflops/s, hfu: 130.549 Tflops/s, 361.855 iter/s, 2.764e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 123.73 Tflops/s, hfu: 123.73 Tflops/s, 342.954 iter/s, 2.916e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 88.488 Tflops/s, hfu: 88.488 Tflops/s, 245.272 iter/s, 4.077e-03 s/iter, (0.086, 0.000, 0.016) sec
SP=(1,8),S=(6144,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 50.31 Tflops/s, hfu: 50.31 Tflops/s, 244.034 iter/s, 4.098e-03 s/iter, (0.060, 0.000, 0.082) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 75.852 Tflops/s, hfu: 75.852 Tflops/s, 367.929 iter/s, 2.718e-03 s/iter, (0.035, 0.000, 0.054) sec
# stripe_flash_attn_func, fwd
mfu: 48.023 Tflops/s, hfu: 48.023 Tflops/s, 232.942 iter/s, 4.293e-03 s/iter, (0.050, 0.000, 0.086) sec
# orchestrated_attn_func
mfu: 141.117 Tflops/s, hfu: 141.117 Tflops/s, 342.254 iter/s, 2.922e-03 s/iter, (0.096, 0.000, 0.012) sec
mfu: 132.193 Tflops/s, hfu: 132.193 Tflops/s, 320.611 iter/s, 3.119e-03 s/iter, (0.086, 0.000, 0.012) sec
mfu: 124.159 Tflops/s, hfu: 124.159 Tflops/s, 301.124 iter/s, 3.321e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 106.135 Tflops/s, hfu: 106.135 Tflops/s, 257.410 iter/s, 3.885e-03 s/iter, (0.089, 0.000, 0.016) sec
SP=(1,8),S=(6144,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.467 Tflops/s, hfu: 52.467 Tflops/s, 203.597 iter/s, 4.912e-03 s/iter, (0.062, 0.000, 0.098) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 77.637 Tflops/s, hfu: 77.637 Tflops/s, 301.271 iter/s, 3.319e-03 s/iter, (0.042, 0.000, 0.066) sec
# stripe_flash_attn_func, fwd
mfu: 49.404 Tflops/s, hfu: 49.404 Tflops/s, 191.713 iter/s, 5.216e-03 s/iter, (0.061, 0.000, 0.104) sec
# orchestrated_attn_func
mfu: 141.879 Tflops/s, hfu: 141.879 Tflops/s, 275.281 iter/s, 3.633e-03 s/iter, (0.088, 0.000, 0.015) sec
mfu: 127.686 Tflops/s, hfu: 127.686 Tflops/s, 247.743 iter/s, 4.036e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 126.948 Tflops/s, hfu: 126.948 Tflops/s, 246.312 iter/s, 4.060e-03 s/iter, (0.086, 0.000, 0.016) sec
mfu: 117.801 Tflops/s, hfu: 117.801 Tflops/s, 228.563 iter/s, 4.375e-03 s/iter, (0.091, 0.000, 0.018) sec
SP=(1,8),S=(6144,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.775 Tflops/s, hfu: 54.775 Tflops/s, 177.129 iter/s, 5.646e-03 s/iter, (0.073, 0.000, 0.113) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.284 Tflops/s, hfu: 78.284 Tflops/s, 253.150 iter/s, 3.950e-03 s/iter, (0.049, 0.000, 0.079) sec
# stripe_flash_attn_func, fwd
mfu: 51.111 Tflops/s, hfu: 51.111 Tflops/s, 165.280 iter/s, 6.050e-03 s/iter, (0.069, 0.000, 0.121) sec
# orchestrated_attn_func
mfu: 139.933 Tflops/s, hfu: 139.933 Tflops/s, 226.255 iter/s, 4.420e-03 s/iter, (0.121, 0.000, 0.018) sec
mfu: 128.721 Tflops/s, hfu: 128.721 Tflops/s, 208.127 iter/s, 4.805e-03 s/iter, (0.092, 0.000, 0.019) sec
mfu: 128.186 Tflops/s, hfu: 128.186 Tflops/s, 207.261 iter/s, 4.825e-03 s/iter, (0.089, 0.000, 0.019) sec
mfu: 119.317 Tflops/s, hfu: 119.317 Tflops/s, 192.921 iter/s, 5.183e-03 s/iter, (0.090, 0.000, 0.021) sec
SP=(1,8),S=(6144,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.55 Tflops/s, hfu: 57.55 Tflops/s, 159.517 iter/s, 6.269e-03 s/iter, (0.078, 0.000, 0.125) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 79.45 Tflops/s, hfu: 79.45 Tflops/s, 220.220 iter/s, 4.541e-03 s/iter, (0.056, 0.000, 0.091) sec
# stripe_flash_attn_func, fwd
mfu: 53.0 Tflops/s, hfu: 53.0 Tflops/s, 146.906 iter/s, 6.807e-03 s/iter, (0.079, 0.000, 0.136) sec
# orchestrated_attn_func
mfu: 139.063 Tflops/s, hfu: 139.063 Tflops/s, 192.727 iter/s, 5.189e-03 s/iter, (0.095, 0.000, 0.021) sec
mfu: 131.873 Tflops/s, hfu: 131.873 Tflops/s, 182.762 iter/s, 5.472e-03 s/iter, (0.172, 0.000, 0.022) sec
mfu: 128.209 Tflops/s, hfu: 128.209 Tflops/s, 177.685 iter/s, 5.628e-03 s/iter, (0.092, 0.000, 0.023) sec
mfu: 119.119 Tflops/s, hfu: 119.119 Tflops/s, 165.087 iter/s, 6.057e-03 s/iter, (0.094, 0.000, 0.024) sec
SP=(1,8),S=(6144,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.081 Tflops/s, hfu: 59.081 Tflops/s, 143.290 iter/s, 6.979e-03 s/iter, (0.087, 0.000, 0.140) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.032 Tflops/s, hfu: 80.032 Tflops/s, 194.104 iter/s, 5.152e-03 s/iter, (0.063, 0.000, 0.103) sec
# stripe_flash_attn_func, fwd
mfu: 54.353 Tflops/s, hfu: 54.353 Tflops/s, 131.824 iter/s, 7.586e-03 s/iter, (0.086, 0.000, 0.152) sec
# orchestrated_attn_func
mfu: 140.753 Tflops/s, hfu: 140.753 Tflops/s, 170.685 iter/s, 5.859e-03 s/iter, (0.098, 0.000, 0.023) sec
mfu: 131.977 Tflops/s, hfu: 131.977 Tflops/s, 160.043 iter/s, 6.248e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 129.09 Tflops/s, hfu: 129.09 Tflops/s, 156.543 iter/s, 6.388e-03 s/iter, (0.095, 0.000, 0.026) sec
mfu: 123.231 Tflops/s, hfu: 123.231 Tflops/s, 149.437 iter/s, 6.692e-03 s/iter, (0.097, 0.000, 0.027) sec
SP=(1,8),S=(6144,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.07 Tflops/s, hfu: 60.07 Tflops/s, 116.552 iter/s, 8.580e-03 s/iter, (0.105, 0.000, 0.172) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.817 Tflops/s, hfu: 81.817 Tflops/s, 158.745 iter/s, 6.299e-03 s/iter, (0.077, 0.000, 0.126) sec
# stripe_flash_attn_func, fwd
mfu: 56.674 Tflops/s, hfu: 56.674 Tflops/s, 109.963 iter/s, 9.094e-03 s/iter, (0.108, 0.000, 0.182) sec
# orchestrated_attn_func
mfu: 139.768 Tflops/s, hfu: 139.768 Tflops/s, 135.593 iter/s, 7.375e-03 s/iter, (0.105, 0.000, 0.030) sec
mfu: 131.274 Tflops/s, hfu: 131.274 Tflops/s, 127.353 iter/s, 7.852e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 129.549 Tflops/s, hfu: 129.549 Tflops/s, 125.679 iter/s, 7.957e-03 s/iter, (0.101, 0.000, 0.032) sec
mfu: 117.271 Tflops/s, hfu: 117.271 Tflops/s, 113.768 iter/s, 8.790e-03 s/iter, (0.105, 0.000, 0.035) sec
SP=(1,8),S=(6144,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.651 Tflops/s, hfu: 61.651 Tflops/s, 99.682 iter/s, 1.003e-02 s/iter, (0.121, 0.000, 0.201) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.217 Tflops/s, hfu: 81.217 Tflops/s, 131.318 iter/s, 7.615e-03 s/iter, (0.092, 0.000, 0.152) sec
# stripe_flash_attn_func, fwd
mfu: 58.541 Tflops/s, hfu: 58.541 Tflops/s, 94.653 iter/s, 1.056e-02 s/iter, (0.126, 0.000, 0.211) sec
# orchestrated_attn_func
mfu: 141.311 Tflops/s, hfu: 141.311 Tflops/s, 114.241 iter/s, 8.753e-03 s/iter, (0.132, 0.000, 0.035) sec
mfu: 133.067 Tflops/s, hfu: 133.067 Tflops/s, 107.577 iter/s, 9.296e-03 s/iter, (0.111, 0.000, 0.037) sec
mfu: 130.361 Tflops/s, hfu: 130.361 Tflops/s, 105.389 iter/s, 9.489e-03 s/iter, (0.108, 0.000, 0.038) sec
mfu: 123.497 Tflops/s, hfu: 123.497 Tflops/s, 99.840 iter/s, 1.002e-02 s/iter, (0.113, 0.000, 0.040) sec
SP=(1,8),S=(6144,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.689 Tflops/s, hfu: 62.689 Tflops/s, 86.880 iter/s, 1.151e-02 s/iter, (0.138, 0.000, 0.230) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.538 Tflops/s, hfu: 81.538 Tflops/s, 113.003 iter/s, 8.849e-03 s/iter, (0.106, 0.000, 0.177) sec
# stripe_flash_attn_func, fwd
mfu: 59.463 Tflops/s, hfu: 59.463 Tflops/s, 82.410 iter/s, 1.213e-02 s/iter, (0.143, 0.000, 0.243) sec
# orchestrated_attn_func
mfu: 141.514 Tflops/s, hfu: 141.514 Tflops/s, 98.062 iter/s, 1.020e-02 s/iter, (0.116, 0.000, 0.041) sec
mfu: 132.063 Tflops/s, hfu: 132.063 Tflops/s, 91.513 iter/s, 1.093e-02 s/iter, (0.116, 0.000, 0.044) sec
mfu: 130.411 Tflops/s, hfu: 130.411 Tflops/s, 90.368 iter/s, 1.107e-02 s/iter, (0.114, 0.000, 0.044) sec
mfu: 123.048 Tflops/s, hfu: 123.048 Tflops/s, 85.266 iter/s, 1.173e-02 s/iter, (0.116, 0.000, 0.047) sec
SP=(1,8),S=(6144,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.204 Tflops/s, hfu: 63.204 Tflops/s, 76.645 iter/s, 1.305e-02 s/iter, (0.155, 0.000, 0.261) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 81.777 Tflops/s, hfu: 81.777 Tflops/s, 99.167 iter/s, 1.008e-02 s/iter, (0.120, 0.000, 0.202) sec
# stripe_flash_attn_func, fwd
mfu: 59.889 Tflops/s, hfu: 59.889 Tflops/s, 72.625 iter/s, 1.377e-02 s/iter, (0.160, 0.000, 0.275) sec
# orchestrated_attn_func
mfu: 138.457 Tflops/s, hfu: 138.457 Tflops/s, 83.951 iter/s, 1.191e-02 s/iter, (0.123, 0.000, 0.048) sec
mfu: 132.023 Tflops/s, hfu: 132.023 Tflops/s, 80.050 iter/s, 1.249e-02 s/iter, (0.121, 0.000, 0.050) sec
mfu: 130.674 Tflops/s, hfu: 130.674 Tflops/s, 79.232 iter/s, 1.262e-02 s/iter, (0.120, 0.000, 0.050) sec
mfu: 123.461 Tflops/s, hfu: 123.461 Tflops/s, 74.858 iter/s, 1.336e-02 s/iter, (0.123, 0.000, 0.053) sec
SP=(1,8),S=(6144,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.49 Tflops/s, hfu: 64.49 Tflops/s, 62.563 iter/s, 1.598e-02 s/iter, (0.190, 0.000, 0.320) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.712 Tflops/s, hfu: 76.712 Tflops/s, 74.420 iter/s, 1.344e-02 s/iter, (0.156, 0.000, 0.269) sec
# stripe_flash_attn_func, fwd
mfu: 60.529 Tflops/s, hfu: 60.529 Tflops/s, 58.721 iter/s, 1.703e-02 s/iter, (0.196, 0.000, 0.341) sec
# orchestrated_attn_func
mfu: 138.413 Tflops/s, hfu: 138.413 Tflops/s, 67.139 iter/s, 1.489e-02 s/iter, (0.164, 0.000, 0.060) sec
mfu: 132.341 Tflops/s, hfu: 132.341 Tflops/s, 64.194 iter/s, 1.558e-02 s/iter, (0.144, 0.000, 0.062) sec
mfu: 130.634 Tflops/s, hfu: 130.634 Tflops/s, 63.366 iter/s, 1.578e-02 s/iter, (0.133, 0.000, 0.063) sec
mfu: 119.204 Tflops/s, hfu: 119.204 Tflops/s, 57.821 iter/s, 1.729e-02 s/iter, (0.138, 0.000, 0.069) sec
SP=(1,8),S=(6144,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.559 Tflops/s, hfu: 64.559 Tflops/s, 52.192 iter/s, 1.916e-02 s/iter, (0.228, 0.000, 0.383) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.558 Tflops/s, hfu: 78.558 Tflops/s, 63.510 iter/s, 1.575e-02 s/iter, (0.191, 0.000, 0.315) sec
# stripe_flash_attn_func, fwd
mfu: 61.22 Tflops/s, hfu: 61.22 Tflops/s, 49.493 iter/s, 2.020e-02 s/iter, (0.231, 0.000, 0.404) sec
# orchestrated_attn_func
mfu: 139.083 Tflops/s, hfu: 139.083 Tflops/s, 56.220 iter/s, 1.779e-02 s/iter, (0.181, 0.000, 0.071) sec
mfu: 131.832 Tflops/s, hfu: 131.832 Tflops/s, 53.289 iter/s, 1.877e-02 s/iter, (0.154, 0.000, 0.075) sec
mfu: 130.996 Tflops/s, hfu: 130.996 Tflops/s, 52.951 iter/s, 1.889e-02 s/iter, (0.145, 0.000, 0.076) sec
mfu: 121.852 Tflops/s, hfu: 121.852 Tflops/s, 49.255 iter/s, 2.030e-02 s/iter, (0.150, 0.000, 0.081) sec
SP=(1,8),S=(6144,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.255 Tflops/s, hfu: 64.255 Tflops/s, 44.525 iter/s, 2.246e-02 s/iter, (0.261, 0.000, 0.449) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 38.896 Tflops/s, hfu: 38.896 Tflops/s, 26.953 iter/s, 3.710e-02 s/iter, (0.220, 0.000, 0.742) sec
# stripe_flash_attn_func, fwd
mfu: 60.972 Tflops/s, hfu: 60.972 Tflops/s, 42.251 iter/s, 2.367e-02 s/iter, (0.272, 0.000, 0.473) sec
# orchestrated_attn_func
mfu: 137.787 Tflops/s, hfu: 137.787 Tflops/s, 47.740 iter/s, 2.095e-02 s/iter, (0.171, 0.000, 0.084) sec
mfu: 132.792 Tflops/s, hfu: 132.792 Tflops/s, 46.009 iter/s, 2.173e-02 s/iter, (0.165, 0.000, 0.087) sec
mfu: 131.103 Tflops/s, hfu: 131.103 Tflops/s, 45.424 iter/s, 2.201e-02 s/iter, (0.160, 0.000, 0.088) sec
mfu: 120.836 Tflops/s, hfu: 120.836 Tflops/s, 41.866 iter/s, 2.389e-02 s/iter, (0.163, 0.000, 0.096) sec
SP=(1,8),S=(6144,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.086 Tflops/s, hfu: 61.086 Tflops/s, 37.038 iter/s, 2.700e-02 s/iter, (0.295, 0.000, 0.540) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 36.148 Tflops/s, hfu: 36.148 Tflops/s, 21.918 iter/s, 4.563e-02 s/iter, (0.342, 0.000, 0.913) sec
# stripe_flash_attn_func, fwd
mfu: 61.252 Tflops/s, hfu: 61.252 Tflops/s, 37.139 iter/s, 2.693e-02 s/iter, (0.307, 0.000, 0.539) sec
# orchestrated_attn_func
mfu: 139.746 Tflops/s, hfu: 139.746 Tflops/s, 42.366 iter/s, 2.360e-02 s/iter, (0.187, 0.000, 0.094) sec
mfu: 132.223 Tflops/s, hfu: 132.223 Tflops/s, 40.085 iter/s, 2.495e-02 s/iter, (0.178, 0.000, 0.100) sec
mfu: 130.923 Tflops/s, hfu: 130.923 Tflops/s, 39.691 iter/s, 2.519e-02 s/iter, (0.172, 0.000, 0.101) sec
mfu: 122.165 Tflops/s, hfu: 122.165 Tflops/s, 37.036 iter/s, 2.700e-02 s/iter, (0.171, 0.000, 0.108) sec
SP=(1,8),S=(6144,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.895 Tflops/s, hfu: 25.895 Tflops/s, 12.561 iter/s, 7.961e-02 s/iter, (0.383, 0.000, 1.592) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.571 Tflops/s, hfu: 76.571 Tflops/s, 37.142 iter/s, 2.692e-02 s/iter, (0.338, 0.000, 0.538) sec
# stripe_flash_attn_func, fwd
mfu: 57.262 Tflops/s, hfu: 57.262 Tflops/s, 27.776 iter/s, 3.600e-02 s/iter, (0.416, 0.000, 0.720) sec
# orchestrated_attn_func
mfu: 140.909 Tflops/s, hfu: 140.909 Tflops/s, 34.175 iter/s, 2.926e-02 s/iter, (0.203, 0.000, 0.117) sec
mfu: 132.403 Tflops/s, hfu: 132.403 Tflops/s, 32.112 iter/s, 3.114e-02 s/iter, (0.202, 0.000, 0.125) sec
mfu: 130.567 Tflops/s, hfu: 130.567 Tflops/s, 31.667 iter/s, 3.158e-02 s/iter, (0.197, 0.000, 0.126) sec
mfu: 123.326 Tflops/s, hfu: 123.326 Tflops/s, 29.910 iter/s, 3.343e-02 s/iter, (0.208, 0.000, 0.134) sec
SP=(1,8),S=(6144,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 25.136 Tflops/s, hfu: 25.136 Tflops/s, 10.160 iter/s, 9.842e-02 s/iter, (0.459, 0.000, 1.968) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 52.118 Tflops/s, hfu: 52.118 Tflops/s, 21.067 iter/s, 4.747e-02 s/iter, (0.388, 0.000, 0.949) sec
# stripe_flash_attn_func, fwd
mfu: 33.675 Tflops/s, hfu: 33.675 Tflops/s, 13.612 iter/s, 7.346e-02 s/iter, (0.506, 0.000, 1.469) sec
# orchestrated_attn_func
mfu: 143.387 Tflops/s, hfu: 143.387 Tflops/s, 28.980 iter/s, 3.451e-02 s/iter, (0.253, 0.000, 0.138) sec
mfu: 131.103 Tflops/s, hfu: 131.103 Tflops/s, 26.497 iter/s, 3.774e-02 s/iter, (0.226, 0.000, 0.151) sec
mfu: 130.168 Tflops/s, hfu: 130.168 Tflops/s, 26.308 iter/s, 3.801e-02 s/iter, (0.222, 0.000, 0.152) sec
mfu: 125.361 Tflops/s, hfu: 125.361 Tflops/s, 25.337 iter/s, 3.947e-02 s/iter, (0.235, 0.000, 0.158) sec
SP=(1,8),S=(6144,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.098 Tflops/s, hfu: 24.098 Tflops/s, 8.349 iter/s, 1.198e-01 s/iter, (0.547, 0.000, 2.395) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 45.833 Tflops/s, hfu: 45.833 Tflops/s, 15.880 iter/s, 6.297e-02 s/iter, (0.492, 0.000, 1.259) sec
# stripe_flash_attn_func, fwd
mfu: 33.486 Tflops/s, hfu: 33.486 Tflops/s, 11.602 iter/s, 8.619e-02 s/iter, (0.581, 0.000, 1.724) sec
# orchestrated_attn_func
mfu: 144.268 Tflops/s, hfu: 144.268 Tflops/s, 24.993 iter/s, 4.001e-02 s/iter, (0.280, 0.000, 0.160) sec
mfu: 131.793 Tflops/s, hfu: 131.793 Tflops/s, 22.831 iter/s, 4.380e-02 s/iter, (0.254, 0.000, 0.175) sec
mfu: 130.661 Tflops/s, hfu: 130.661 Tflops/s, 22.635 iter/s, 4.418e-02 s/iter, (0.247, 0.000, 0.177) sec
mfu: 122.699 Tflops/s, hfu: 122.699 Tflops/s, 21.256 iter/s, 4.705e-02 s/iter, (0.247, 0.000, 0.188) sec
SP=(1,8),S=(6144,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 29.78 Tflops/s, hfu: 29.78 Tflops/s, 9.028 iter/s, 1.108e-01 s/iter, (0.608, 0.000, 2.215) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 41.035 Tflops/s, hfu: 41.035 Tflops/s, 12.440 iter/s, 8.038e-02 s/iter, (0.547, 0.000, 1.608) sec
# stripe_flash_attn_func, fwd
mfu: 27.276 Tflops/s, hfu: 27.276 Tflops/s, 8.269 iter/s, 1.209e-01 s/iter, (0.673, 0.000, 2.419) sec
# orchestrated_attn_func
mfu: 139.88 Tflops/s, hfu: 139.88 Tflops/s, 21.203 iter/s, 4.716e-02 s/iter, (0.265, 0.000, 0.189) sec
mfu: 131.849 Tflops/s, hfu: 131.849 Tflops/s, 19.986 iter/s, 5.004e-02 s/iter, (0.272, 0.000, 0.200) sec
mfu: 129.555 Tflops/s, hfu: 129.555 Tflops/s, 19.638 iter/s, 5.092e-02 s/iter, (0.275, 0.000, 0.204) sec
mfu: 124.183 Tflops/s, hfu: 124.183 Tflops/s, 18.824 iter/s, 5.312e-02 s/iter, (0.293, 0.000, 0.212) sec
SP=(1,8),S=(8192,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 6.142 Tflops/s, hfu: 6.142 Tflops/s, 357.537 iter/s, 2.797e-03 s/iter, (0.044, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 11.6 Tflops/s, hfu: 11.6 Tflops/s, 675.221 iter/s, 1.481e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 5.421 Tflops/s, hfu: 5.421 Tflops/s, 315.544 iter/s, 3.169e-03 s/iter, (0.047, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 28.875 Tflops/s, hfu: 28.875 Tflops/s, 840.381 iter/s, 1.190e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 57.333 Tflops/s, hfu: 57.333 Tflops/s, 1668.602 iter/s, 5.993e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 72.433 Tflops/s, hfu: 72.433 Tflops/s, 2108.068 iter/s, 4.744e-04 s/iter, (0.071, 0.000, 0.002) sec
mfu: 86.116 Tflops/s, hfu: 86.116 Tflops/s, 2506.316 iter/s, 3.990e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(8192,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.336 Tflops/s, hfu: 12.336 Tflops/s, 359.020 iter/s, 2.785e-03 s/iter, (0.036, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.347 Tflops/s, hfu: 23.347 Tflops/s, 679.482 iter/s, 1.472e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 10.841 Tflops/s, hfu: 10.841 Tflops/s, 315.514 iter/s, 3.169e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 55.835 Tflops/s, hfu: 55.835 Tflops/s, 812.501 iter/s, 1.231e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 89.169 Tflops/s, hfu: 89.169 Tflops/s, 1297.582 iter/s, 7.707e-04 s/iter, (0.076, 0.000, 0.003) sec
mfu: 98.764 Tflops/s, hfu: 98.764 Tflops/s, 1437.211 iter/s, 6.958e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 89.248 Tflops/s, hfu: 89.248 Tflops/s, 1298.728 iter/s, 7.700e-04 s/iter, (0.072, 0.000, 0.003) sec
SP=(1,8),S=(8192,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.382 Tflops/s, hfu: 18.382 Tflops/s, 356.666 iter/s, 2.804e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 34.808 Tflops/s, hfu: 34.808 Tflops/s, 675.362 iter/s, 1.481e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 16.23 Tflops/s, hfu: 16.23 Tflops/s, 314.909 iter/s, 3.176e-03 s/iter, (0.037, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 71.586 Tflops/s, hfu: 71.586 Tflops/s, 694.475 iter/s, 1.440e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 107.014 Tflops/s, hfu: 107.014 Tflops/s, 1038.172 iter/s, 9.632e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 113.414 Tflops/s, hfu: 113.414 Tflops/s, 1100.265 iter/s, 9.089e-04 s/iter, (0.073, 0.000, 0.004) sec
mfu: 110.765 Tflops/s, hfu: 110.765 Tflops/s, 1074.566 iter/s, 9.306e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(8192,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.56 Tflops/s, hfu: 24.56 Tflops/s, 357.395 iter/s, 2.798e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.465 Tflops/s, hfu: 46.465 Tflops/s, 676.152 iter/s, 1.479e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 21.636 Tflops/s, hfu: 21.636 Tflops/s, 314.840 iter/s, 3.176e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 92.349 Tflops/s, hfu: 92.349 Tflops/s, 671.924 iter/s, 1.488e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 122.033 Tflops/s, hfu: 122.033 Tflops/s, 887.910 iter/s, 1.126e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 125.456 Tflops/s, hfu: 125.456 Tflops/s, 912.815 iter/s, 1.096e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 108.949 Tflops/s, hfu: 108.949 Tflops/s, 792.710 iter/s, 1.261e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(8192,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.789 Tflops/s, hfu: 30.789 Tflops/s, 358.431 iter/s, 2.790e-03 s/iter, (0.050, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.565 Tflops/s, hfu: 57.565 Tflops/s, 670.150 iter/s, 1.492e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 26.26 Tflops/s, hfu: 26.26 Tflops/s, 305.706 iter/s, 3.271e-03 s/iter, (0.038, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 106.943 Tflops/s, hfu: 106.943 Tflops/s, 622.491 iter/s, 1.606e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 128.61 Tflops/s, hfu: 128.61 Tflops/s, 748.606 iter/s, 1.336e-03 s/iter, (0.078, 0.000, 0.005) sec
mfu: 129.472 Tflops/s, hfu: 129.472 Tflops/s, 753.625 iter/s, 1.327e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 110.67 Tflops/s, hfu: 110.67 Tflops/s, 644.184 iter/s, 1.552e-03 s/iter, (0.076, 0.000, 0.006) sec
SP=(1,8),S=(8192,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.881 Tflops/s, hfu: 36.881 Tflops/s, 357.795 iter/s, 2.795e-03 s/iter, (0.046, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.72 Tflops/s, hfu: 68.72 Tflops/s, 666.673 iter/s, 1.500e-03 s/iter, (0.021, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 32.148 Tflops/s, hfu: 32.148 Tflops/s, 311.877 iter/s, 3.206e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 129.183 Tflops/s, hfu: 129.183 Tflops/s, 626.620 iter/s, 1.596e-03 s/iter, (0.077, 0.000, 0.006) sec
mfu: 134.063 Tflops/s, hfu: 134.063 Tflops/s, 650.290 iter/s, 1.538e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 134.346 Tflops/s, hfu: 134.346 Tflops/s, 651.663 iter/s, 1.535e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 116.733 Tflops/s, hfu: 116.733 Tflops/s, 566.231 iter/s, 1.766e-03 s/iter, (0.078, 0.000, 0.007) sec
SP=(1,8),S=(8192,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.97 Tflops/s, hfu: 42.97 Tflops/s, 357.310 iter/s, 2.799e-03 s/iter, (0.044, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.842 Tflops/s, hfu: 78.842 Tflops/s, 655.601 iter/s, 1.525e-03 s/iter, (0.021, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 37.393 Tflops/s, hfu: 37.393 Tflops/s, 310.936 iter/s, 3.216e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 125.112 Tflops/s, hfu: 125.112 Tflops/s, 520.177 iter/s, 1.922e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 137.886 Tflops/s, hfu: 137.886 Tflops/s, 573.287 iter/s, 1.744e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 131.863 Tflops/s, hfu: 131.863 Tflops/s, 548.246 iter/s, 1.824e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 113.366 Tflops/s, hfu: 113.366 Tflops/s, 471.342 iter/s, 2.122e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(8192,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 45.787 Tflops/s, hfu: 45.787 Tflops/s, 333.146 iter/s, 3.002e-03 s/iter, (0.051, 0.000, 0.060) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 86.953 Tflops/s, hfu: 86.953 Tflops/s, 632.663 iter/s, 1.581e-03 s/iter, (0.023, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 40.553 Tflops/s, hfu: 40.553 Tflops/s, 295.065 iter/s, 3.389e-03 s/iter, (0.041, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 147.379 Tflops/s, hfu: 147.379 Tflops/s, 536.161 iter/s, 1.865e-03 s/iter, (0.078, 0.000, 0.007) sec
mfu: 137.194 Tflops/s, hfu: 137.194 Tflops/s, 499.110 iter/s, 2.004e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 135.905 Tflops/s, hfu: 135.905 Tflops/s, 494.419 iter/s, 2.023e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 116.516 Tflops/s, hfu: 116.516 Tflops/s, 423.884 iter/s, 2.359e-03 s/iter, (0.081, 0.000, 0.009) sec
SP=(1,8),S=(8192,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.908 Tflops/s, hfu: 48.908 Tflops/s, 284.680 iter/s, 3.513e-03 s/iter, (0.049, 0.000, 0.070) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 89.149 Tflops/s, hfu: 89.149 Tflops/s, 518.917 iter/s, 1.927e-03 s/iter, (0.026, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 45.154 Tflops/s, hfu: 45.154 Tflops/s, 262.831 iter/s, 3.805e-03 s/iter, (0.045, 0.000, 0.076) sec
# orchestrated_attn_func
mfu: 151.937 Tflops/s, hfu: 151.937 Tflops/s, 442.195 iter/s, 2.261e-03 s/iter, (0.085, 0.000, 0.009) sec
mfu: 141.225 Tflops/s, hfu: 141.225 Tflops/s, 411.018 iter/s, 2.433e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 144.022 Tflops/s, hfu: 144.022 Tflops/s, 419.158 iter/s, 2.386e-03 s/iter, (0.082, 0.000, 0.010) sec
mfu: 110.647 Tflops/s, hfu: 110.647 Tflops/s, 322.025 iter/s, 3.105e-03 s/iter, (0.085, 0.000, 0.012) sec
SP=(1,8),S=(8192,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 51.837 Tflops/s, hfu: 51.837 Tflops/s, 251.444 iter/s, 3.977e-03 s/iter, (0.058, 0.000, 0.080) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.777 Tflops/s, hfu: 92.777 Tflops/s, 450.028 iter/s, 2.222e-03 s/iter, (0.030, 0.000, 0.044) sec
# stripe_flash_attn_func, fwd
mfu: 49.136 Tflops/s, hfu: 49.136 Tflops/s, 238.340 iter/s, 4.196e-03 s/iter, (0.049, 0.000, 0.084) sec
# orchestrated_attn_func
mfu: 153.768 Tflops/s, hfu: 153.768 Tflops/s, 372.936 iter/s, 2.681e-03 s/iter, (0.084, 0.000, 0.011) sec
mfu: 144.529 Tflops/s, hfu: 144.529 Tflops/s, 350.529 iter/s, 2.853e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 144.751 Tflops/s, hfu: 144.751 Tflops/s, 351.067 iter/s, 2.848e-03 s/iter, (0.081, 0.000, 0.011) sec
mfu: 117.633 Tflops/s, hfu: 117.633 Tflops/s, 285.298 iter/s, 3.505e-03 s/iter, (0.084, 0.000, 0.014) sec
SP=(1,8),S=(8192,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.25 Tflops/s, hfu: 54.25 Tflops/s, 225.555 iter/s, 4.434e-03 s/iter, (0.058, 0.000, 0.089) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 93.95 Tflops/s, hfu: 93.95 Tflops/s, 390.615 iter/s, 2.560e-03 s/iter, (0.033, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 52.152 Tflops/s, hfu: 52.152 Tflops/s, 216.830 iter/s, 4.612e-03 s/iter, (0.054, 0.000, 0.092) sec
# orchestrated_attn_func
mfu: 151.384 Tflops/s, hfu: 151.384 Tflops/s, 314.705 iter/s, 3.178e-03 s/iter, (0.092, 0.000, 0.013) sec
mfu: 151.005 Tflops/s, hfu: 151.005 Tflops/s, 313.917 iter/s, 3.186e-03 s/iter, (0.086, 0.000, 0.013) sec
mfu: 147.999 Tflops/s, hfu: 147.999 Tflops/s, 307.667 iter/s, 3.250e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 111.482 Tflops/s, hfu: 111.482 Tflops/s, 231.754 iter/s, 4.315e-03 s/iter, (0.090, 0.000, 0.017) sec
SP=(1,8),S=(8192,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 56.189 Tflops/s, hfu: 56.189 Tflops/s, 204.414 iter/s, 4.892e-03 s/iter, (0.063, 0.000, 0.098) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 96.778 Tflops/s, hfu: 96.778 Tflops/s, 352.075 iter/s, 2.840e-03 s/iter, (0.043, 0.000, 0.057) sec
# stripe_flash_attn_func, fwd
mfu: 53.096 Tflops/s, hfu: 53.096 Tflops/s, 193.161 iter/s, 5.177e-03 s/iter, (0.060, 0.000, 0.104) sec
# orchestrated_attn_func
mfu: 150.796 Tflops/s, hfu: 150.796 Tflops/s, 274.296 iter/s, 3.646e-03 s/iter, (0.090, 0.000, 0.015) sec
mfu: 155.62 Tflops/s, hfu: 155.62 Tflops/s, 283.071 iter/s, 3.533e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 153.022 Tflops/s, hfu: 153.022 Tflops/s, 278.345 iter/s, 3.593e-03 s/iter, (0.084, 0.000, 0.014) sec
mfu: 114.196 Tflops/s, hfu: 114.196 Tflops/s, 207.722 iter/s, 4.814e-03 s/iter, (0.088, 0.000, 0.019) sec
SP=(1,8),S=(8192,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.609 Tflops/s, hfu: 58.609 Tflops/s, 170.575 iter/s, 5.863e-03 s/iter, (0.074, 0.000, 0.117) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.51 Tflops/s, hfu: 98.51 Tflops/s, 286.703 iter/s, 3.488e-03 s/iter, (0.044, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 56.473 Tflops/s, hfu: 56.473 Tflops/s, 164.357 iter/s, 6.084e-03 s/iter, (0.072, 0.000, 0.122) sec
# orchestrated_attn_func
mfu: 154.116 Tflops/s, hfu: 154.116 Tflops/s, 224.268 iter/s, 4.459e-03 s/iter, (0.092, 0.000, 0.018) sec
mfu: 155.288 Tflops/s, hfu: 155.288 Tflops/s, 225.974 iter/s, 4.425e-03 s/iter, (0.089, 0.000, 0.018) sec
mfu: 155.425 Tflops/s, hfu: 155.425 Tflops/s, 226.174 iter/s, 4.421e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 137.4 Tflops/s, hfu: 137.4 Tflops/s, 199.943 iter/s, 5.001e-03 s/iter, (0.090, 0.000, 0.020) sec
SP=(1,8),S=(8192,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.118 Tflops/s, hfu: 61.118 Tflops/s, 148.230 iter/s, 6.746e-03 s/iter, (0.083, 0.000, 0.135) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.663 Tflops/s, hfu: 99.663 Tflops/s, 241.714 iter/s, 4.137e-03 s/iter, (0.051, 0.000, 0.083) sec
# stripe_flash_attn_func, fwd
mfu: 58.947 Tflops/s, hfu: 58.947 Tflops/s, 142.964 iter/s, 6.995e-03 s/iter, (0.082, 0.000, 0.140) sec
# orchestrated_attn_func
mfu: 151.855 Tflops/s, hfu: 151.855 Tflops/s, 184.149 iter/s, 5.430e-03 s/iter, (0.116, 0.000, 0.022) sec
mfu: 147.09 Tflops/s, hfu: 147.09 Tflops/s, 178.371 iter/s, 5.606e-03 s/iter, (0.095, 0.000, 0.022) sec
mfu: 155.54 Tflops/s, hfu: 155.54 Tflops/s, 188.617 iter/s, 5.302e-03 s/iter, (0.090, 0.000, 0.021) sec
mfu: 145.73 Tflops/s, hfu: 145.73 Tflops/s, 176.721 iter/s, 5.659e-03 s/iter, (0.094, 0.000, 0.023) sec
SP=(1,8),S=(8192,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.449 Tflops/s, hfu: 63.449 Tflops/s, 131.900 iter/s, 7.582e-03 s/iter, (0.096, 0.000, 0.152) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 101.454 Tflops/s, hfu: 101.454 Tflops/s, 210.907 iter/s, 4.741e-03 s/iter, (0.059, 0.000, 0.095) sec
# stripe_flash_attn_func, fwd
mfu: 60.753 Tflops/s, hfu: 60.753 Tflops/s, 126.296 iter/s, 7.918e-03 s/iter, (0.092, 0.000, 0.158) sec
# orchestrated_attn_func
mfu: 154.563 Tflops/s, hfu: 154.563 Tflops/s, 160.656 iter/s, 6.224e-03 s/iter, (0.142, 0.000, 0.025) sec
mfu: 151.294 Tflops/s, hfu: 151.294 Tflops/s, 157.258 iter/s, 6.359e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 158.203 Tflops/s, hfu: 158.203 Tflops/s, 164.439 iter/s, 6.081e-03 s/iter, (0.093, 0.000, 0.024) sec
mfu: 141.532 Tflops/s, hfu: 141.532 Tflops/s, 147.111 iter/s, 6.798e-03 s/iter, (0.097, 0.000, 0.027) sec
SP=(1,8),S=(8192,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 65.82 Tflops/s, hfu: 65.82 Tflops/s, 119.726 iter/s, 8.352e-03 s/iter, (0.102, 0.000, 0.167) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.649 Tflops/s, hfu: 102.649 Tflops/s, 186.718 iter/s, 5.356e-03 s/iter, (0.068, 0.000, 0.107) sec
# stripe_flash_attn_func, fwd
mfu: 62.519 Tflops/s, hfu: 62.519 Tflops/s, 113.721 iter/s, 8.793e-03 s/iter, (0.102, 0.000, 0.176) sec
# orchestrated_attn_func
mfu: 157.879 Tflops/s, hfu: 157.879 Tflops/s, 143.591 iter/s, 6.964e-03 s/iter, (0.107, 0.000, 0.028) sec
mfu: 154.611 Tflops/s, hfu: 154.611 Tflops/s, 140.618 iter/s, 7.111e-03 s/iter, (0.100, 0.000, 0.028) sec
mfu: 162.119 Tflops/s, hfu: 162.119 Tflops/s, 147.447 iter/s, 6.782e-03 s/iter, (0.100, 0.000, 0.027) sec
mfu: 143.503 Tflops/s, hfu: 143.503 Tflops/s, 130.515 iter/s, 7.662e-03 s/iter, (0.101, 0.000, 0.031) sec
SP=(1,8),S=(8192,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 67.659 Tflops/s, hfu: 67.659 Tflops/s, 98.456 iter/s, 1.016e-02 s/iter, (0.124, 0.000, 0.203) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.715 Tflops/s, hfu: 103.715 Tflops/s, 150.926 iter/s, 6.626e-03 s/iter, (0.082, 0.000, 0.133) sec
# stripe_flash_attn_func, fwd
mfu: 65.435 Tflops/s, hfu: 65.435 Tflops/s, 95.220 iter/s, 1.050e-02 s/iter, (0.126, 0.000, 0.210) sec
# orchestrated_attn_func
mfu: 160.398 Tflops/s, hfu: 160.398 Tflops/s, 116.705 iter/s, 8.569e-03 s/iter, (0.110, 0.000, 0.034) sec
mfu: 157.396 Tflops/s, hfu: 157.396 Tflops/s, 114.520 iter/s, 8.732e-03 s/iter, (0.108, 0.000, 0.035) sec
mfu: 165.31 Tflops/s, hfu: 165.31 Tflops/s, 120.279 iter/s, 8.314e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 143.031 Tflops/s, hfu: 143.031 Tflops/s, 104.069 iter/s, 9.609e-03 s/iter, (0.112, 0.000, 0.038) sec
SP=(1,8),S=(8192,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.722 Tflops/s, hfu: 68.722 Tflops/s, 83.336 iter/s, 1.200e-02 s/iter, (0.141, 0.000, 0.240) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.326 Tflops/s, hfu: 103.326 Tflops/s, 125.300 iter/s, 7.981e-03 s/iter, (0.097, 0.000, 0.160) sec
# stripe_flash_attn_func, fwd
mfu: 67.593 Tflops/s, hfu: 67.593 Tflops/s, 81.968 iter/s, 1.220e-02 s/iter, (0.149, 0.000, 0.244) sec
# orchestrated_attn_func
mfu: 156.737 Tflops/s, hfu: 156.737 Tflops/s, 95.035 iter/s, 1.052e-02 s/iter, (0.155, 0.000, 0.042) sec
mfu: 162.699 Tflops/s, hfu: 162.699 Tflops/s, 98.649 iter/s, 1.014e-02 s/iter, (0.114, 0.000, 0.041) sec
mfu: 168.067 Tflops/s, hfu: 168.067 Tflops/s, 101.904 iter/s, 9.813e-03 s/iter, (0.109, 0.000, 0.039) sec
mfu: 145.77 Tflops/s, hfu: 145.77 Tflops/s, 88.385 iter/s, 1.131e-02 s/iter, (0.117, 0.000, 0.045) sec
SP=(1,8),S=(8192,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.508 Tflops/s, hfu: 69.508 Tflops/s, 72.248 iter/s, 1.384e-02 s/iter, (0.162, 0.000, 0.277) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.934 Tflops/s, hfu: 103.934 Tflops/s, 108.032 iter/s, 9.257e-03 s/iter, (0.112, 0.000, 0.185) sec
# stripe_flash_attn_func, fwd
mfu: 67.806 Tflops/s, hfu: 67.806 Tflops/s, 70.479 iter/s, 1.419e-02 s/iter, (0.172, 0.000, 0.284) sec
# orchestrated_attn_func
mfu: 156.57 Tflops/s, hfu: 156.57 Tflops/s, 81.371 iter/s, 1.229e-02 s/iter, (0.162, 0.000, 0.049) sec
mfu: 159.912 Tflops/s, hfu: 159.912 Tflops/s, 83.108 iter/s, 1.203e-02 s/iter, (0.121, 0.000, 0.048) sec
mfu: 168.081 Tflops/s, hfu: 168.081 Tflops/s, 87.354 iter/s, 1.145e-02 s/iter, (0.116, 0.000, 0.046) sec
mfu: 145.819 Tflops/s, hfu: 145.819 Tflops/s, 75.784 iter/s, 1.320e-02 s/iter, (0.123, 0.000, 0.053) sec
SP=(1,8),S=(8192,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.602 Tflops/s, hfu: 70.602 Tflops/s, 64.212 iter/s, 1.557e-02 s/iter, (0.184, 0.000, 0.311) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 104.621 Tflops/s, hfu: 104.621 Tflops/s, 95.152 iter/s, 1.051e-02 s/iter, (0.128, 0.000, 0.210) sec
# stripe_flash_attn_func, fwd
mfu: 68.483 Tflops/s, hfu: 68.483 Tflops/s, 62.285 iter/s, 1.606e-02 s/iter, (0.193, 0.000, 0.321) sec
# orchestrated_attn_func
mfu: 159.362 Tflops/s, hfu: 159.362 Tflops/s, 72.469 iter/s, 1.380e-02 s/iter, (0.216, 0.000, 0.055) sec
mfu: 164.254 Tflops/s, hfu: 164.254 Tflops/s, 74.694 iter/s, 1.339e-02 s/iter, (0.129, 0.000, 0.054) sec
mfu: 168.157 Tflops/s, hfu: 168.157 Tflops/s, 76.469 iter/s, 1.308e-02 s/iter, (0.122, 0.000, 0.052) sec
mfu: 147.641 Tflops/s, hfu: 147.641 Tflops/s, 67.140 iter/s, 1.489e-02 s/iter, (0.131, 0.000, 0.060) sec
SP=(1,8),S=(8192,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.713 Tflops/s, hfu: 70.713 Tflops/s, 51.451 iter/s, 1.944e-02 s/iter, (0.233, 0.000, 0.389) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.161 Tflops/s, hfu: 92.161 Tflops/s, 67.056 iter/s, 1.491e-02 s/iter, (0.173, 0.000, 0.298) sec
# stripe_flash_attn_func, fwd
mfu: 68.669 Tflops/s, hfu: 68.669 Tflops/s, 49.963 iter/s, 2.001e-02 s/iter, (0.240, 0.000, 0.400) sec
# orchestrated_attn_func
mfu: 150.336 Tflops/s, hfu: 150.336 Tflops/s, 54.692 iter/s, 1.828e-02 s/iter, (0.250, 0.000, 0.073) sec
mfu: 157.531 Tflops/s, hfu: 157.531 Tflops/s, 57.309 iter/s, 1.745e-02 s/iter, (0.142, 0.000, 0.070) sec
mfu: 163.819 Tflops/s, hfu: 163.819 Tflops/s, 59.597 iter/s, 1.678e-02 s/iter, (0.143, 0.000, 0.067) sec
mfu: 135.021 Tflops/s, hfu: 135.021 Tflops/s, 49.120 iter/s, 2.036e-02 s/iter, (0.146, 0.000, 0.081) sec
SP=(1,8),S=(8192,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.622 Tflops/s, hfu: 70.622 Tflops/s, 42.820 iter/s, 2.335e-02 s/iter, (0.282, 0.000, 0.467) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.178 Tflops/s, hfu: 68.178 Tflops/s, 41.339 iter/s, 2.419e-02 s/iter, (0.211, 0.000, 0.484) sec
# stripe_flash_attn_func, fwd
mfu: 68.832 Tflops/s, hfu: 68.832 Tflops/s, 41.735 iter/s, 2.396e-02 s/iter, (0.289, 0.000, 0.479) sec
# orchestrated_attn_func
mfu: 153.43 Tflops/s, hfu: 153.43 Tflops/s, 46.515 iter/s, 2.150e-02 s/iter, (0.212, 0.000, 0.086) sec
mfu: 167.446 Tflops/s, hfu: 167.446 Tflops/s, 50.764 iter/s, 1.970e-02 s/iter, (0.156, 0.000, 0.079) sec
mfu: 160.094 Tflops/s, hfu: 160.094 Tflops/s, 48.535 iter/s, 2.060e-02 s/iter, (0.156, 0.000, 0.082) sec
mfu: 137.8 Tflops/s, hfu: 137.8 Tflops/s, 41.776 iter/s, 2.394e-02 s/iter, (0.167, 0.000, 0.096) sec
SP=(1,8),S=(8192,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.541 Tflops/s, hfu: 70.541 Tflops/s, 36.661 iter/s, 2.728e-02 s/iter, (0.319, 0.000, 0.546) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.921 Tflops/s, hfu: 46.921 Tflops/s, 24.386 iter/s, 4.101e-02 s/iter, (0.248, 0.000, 0.820) sec
# stripe_flash_attn_func, fwd
mfu: 67.261 Tflops/s, hfu: 67.261 Tflops/s, 34.957 iter/s, 2.861e-02 s/iter, (0.339, 0.000, 0.572) sec
# orchestrated_attn_func
mfu: 155.46 Tflops/s, hfu: 155.46 Tflops/s, 40.397 iter/s, 2.475e-02 s/iter, (0.175, 0.000, 0.099) sec
mfu: 161.447 Tflops/s, hfu: 161.447 Tflops/s, 41.953 iter/s, 2.384e-02 s/iter, (0.174, 0.000, 0.095) sec
mfu: 164.064 Tflops/s, hfu: 164.064 Tflops/s, 42.633 iter/s, 2.346e-02 s/iter, (0.163, 0.000, 0.094) sec
mfu: 136.459 Tflops/s, hfu: 136.459 Tflops/s, 35.460 iter/s, 2.820e-02 s/iter, (0.183, 0.000, 0.113) sec
SP=(1,8),S=(8192,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 55.058 Tflops/s, hfu: 55.058 Tflops/s, 25.038 iter/s, 3.994e-02 s/iter, (0.373, 0.000, 0.799) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 80.753 Tflops/s, hfu: 80.753 Tflops/s, 36.722 iter/s, 2.723e-02 s/iter, (0.316, 0.000, 0.545) sec
# stripe_flash_attn_func, fwd
mfu: 69.451 Tflops/s, hfu: 69.451 Tflops/s, 31.583 iter/s, 3.166e-02 s/iter, (0.384, 0.000, 0.633) sec
# orchestrated_attn_func
mfu: 155.936 Tflops/s, hfu: 155.936 Tflops/s, 35.456 iter/s, 2.820e-02 s/iter, (0.299, 0.000, 0.113) sec
mfu: 163.588 Tflops/s, hfu: 163.588 Tflops/s, 37.196 iter/s, 2.688e-02 s/iter, (0.181, 0.000, 0.108) sec
mfu: 164.077 Tflops/s, hfu: 164.077 Tflops/s, 37.307 iter/s, 2.680e-02 s/iter, (0.182, 0.000, 0.107) sec
mfu: 139.9 Tflops/s, hfu: 139.9 Tflops/s, 31.809 iter/s, 3.144e-02 s/iter, (0.204, 0.000, 0.126) sec
SP=(1,8),S=(8192,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 29.126 Tflops/s, hfu: 29.126 Tflops/s, 10.596 iter/s, 9.437e-02 s/iter, (0.517, 0.000, 1.887) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 90.975 Tflops/s, hfu: 90.975 Tflops/s, 33.096 iter/s, 3.021e-02 s/iter, (0.373, 0.000, 0.604) sec
# stripe_flash_attn_func, fwd
mfu: 49.101 Tflops/s, hfu: 49.101 Tflops/s, 17.863 iter/s, 5.598e-02 s/iter, (0.537, 0.000, 1.120) sec
# orchestrated_attn_func
mfu: 157.553 Tflops/s, hfu: 157.553 Tflops/s, 28.659 iter/s, 3.489e-02 s/iter, (0.235, 0.000, 0.140) sec
mfu: 169.014 Tflops/s, hfu: 169.014 Tflops/s, 30.743 iter/s, 3.253e-02 s/iter, (0.217, 0.000, 0.130) sec
mfu: 164.835 Tflops/s, hfu: 164.835 Tflops/s, 29.983 iter/s, 3.335e-02 s/iter, (0.205, 0.000, 0.133) sec
mfu: 136.207 Tflops/s, hfu: 136.207 Tflops/s, 24.776 iter/s, 4.036e-02 s/iter, (0.228, 0.000, 0.161) sec
SP=(1,8),S=(8192,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.269 Tflops/s, hfu: 31.269 Tflops/s, 9.480 iter/s, 1.055e-01 s/iter, (0.616, 0.000, 2.110) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.733 Tflops/s, hfu: 55.733 Tflops/s, 16.896 iter/s, 5.918e-02 s/iter, (0.434, 0.000, 1.184) sec
# stripe_flash_attn_func, fwd
mfu: 31.391 Tflops/s, hfu: 31.391 Tflops/s, 9.517 iter/s, 1.051e-01 s/iter, (0.667, 0.000, 2.102) sec
# orchestrated_attn_func
mfu: 159.195 Tflops/s, hfu: 159.195 Tflops/s, 24.131 iter/s, 4.144e-02 s/iter, (0.254, 0.000, 0.166) sec
mfu: 154.519 Tflops/s, hfu: 154.519 Tflops/s, 23.422 iter/s, 4.269e-02 s/iter, (0.240, 0.000, 0.171) sec
mfu: 164.612 Tflops/s, hfu: 164.612 Tflops/s, 24.952 iter/s, 4.008e-02 s/iter, (0.232, 0.000, 0.160) sec
mfu: 144.884 Tflops/s, hfu: 144.884 Tflops/s, 21.962 iter/s, 4.553e-02 s/iter, (0.266, 0.000, 0.182) sec
SP=(1,8),S=(8192,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.616 Tflops/s, hfu: 31.616 Tflops/s, 8.216 iter/s, 1.217e-01 s/iter, (0.712, 0.000, 2.434) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.797 Tflops/s, hfu: 46.797 Tflops/s, 12.160 iter/s, 8.223e-02 s/iter, (0.501, 0.000, 1.645) sec
# stripe_flash_attn_func, fwd
mfu: 32.01 Tflops/s, hfu: 32.01 Tflops/s, 8.318 iter/s, 1.202e-01 s/iter, (0.766, 0.000, 2.404) sec
# orchestrated_attn_func
mfu: 157.042 Tflops/s, hfu: 157.042 Tflops/s, 20.404 iter/s, 4.901e-02 s/iter, (0.273, 0.000, 0.196) sec
mfu: 162.127 Tflops/s, hfu: 162.127 Tflops/s, 21.065 iter/s, 4.747e-02 s/iter, (0.258, 0.000, 0.190) sec
mfu: 164.815 Tflops/s, hfu: 164.815 Tflops/s, 21.414 iter/s, 4.670e-02 s/iter, (0.257, 0.000, 0.187) sec
mfu: 138.377 Tflops/s, hfu: 138.377 Tflops/s, 17.979 iter/s, 5.562e-02 s/iter, (0.296, 0.000, 0.222) sec
SP=(1,8),S=(8192,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 31.93 Tflops/s, hfu: 31.93 Tflops/s, 7.260 iter/s, 1.377e-01 s/iter, (0.822, 0.000, 2.755) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.584 Tflops/s, hfu: 55.584 Tflops/s, 12.638 iter/s, 7.912e-02 s/iter, (0.581, 0.000, 1.582) sec
# stripe_flash_attn_func, fwd
mfu: 35.456 Tflops/s, hfu: 35.456 Tflops/s, 8.062 iter/s, 1.240e-01 s/iter, (0.889, 0.000, 2.481) sec
# orchestrated_attn_func
mfu: 152.141 Tflops/s, hfu: 152.141 Tflops/s, 17.296 iter/s, 5.782e-02 s/iter, (0.342, 0.000, 0.231) sec
mfu: 166.302 Tflops/s, hfu: 166.302 Tflops/s, 18.906 iter/s, 5.289e-02 s/iter, (0.287, 0.000, 0.212) sec
mfu: 165.017 Tflops/s, hfu: 165.017 Tflops/s, 18.760 iter/s, 5.330e-02 s/iter, (0.283, 0.000, 0.213) sec
mfu: 130.838 Tflops/s, hfu: 130.838 Tflops/s, 14.875 iter/s, 6.723e-02 s/iter, (0.327, 0.000, 0.269) sec
SP=(1,8),S=(10240,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 7.83 Tflops/s, hfu: 7.83 Tflops/s, 364.624 iter/s, 2.743e-03 s/iter, (0.041, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 14.416 Tflops/s, hfu: 14.416 Tflops/s, 671.277 iter/s, 1.490e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 6.766 Tflops/s, hfu: 6.766 Tflops/s, 315.070 iter/s, 3.174e-03 s/iter, (0.037, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 29.454 Tflops/s, hfu: 29.454 Tflops/s, 685.773 iter/s, 1.458e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 60.092 Tflops/s, hfu: 60.092 Tflops/s, 1399.118 iter/s, 7.147e-04 s/iter, (0.083, 0.000, 0.003) sec
mfu: 76.237 Tflops/s, hfu: 76.237 Tflops/s, 1775.039 iter/s, 5.634e-04 s/iter, (0.072, 0.000, 0.002) sec
mfu: 95.154 Tflops/s, hfu: 95.154 Tflops/s, 2215.487 iter/s, 4.514e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(10240,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 15.375 Tflops/s, hfu: 15.375 Tflops/s, 357.970 iter/s, 2.794e-03 s/iter, (0.042, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 28.783 Tflops/s, hfu: 28.783 Tflops/s, 670.145 iter/s, 1.492e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 13.423 Tflops/s, hfu: 13.423 Tflops/s, 312.539 iter/s, 3.200e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 53.139 Tflops/s, hfu: 53.139 Tflops/s, 618.625 iter/s, 1.616e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 90.972 Tflops/s, hfu: 90.972 Tflops/s, 1059.053 iter/s, 9.442e-04 s/iter, (0.074, 0.000, 0.004) sec
mfu: 101.939 Tflops/s, hfu: 101.939 Tflops/s, 1186.724 iter/s, 8.427e-04 s/iter, (0.073, 0.000, 0.003) sec
mfu: 107.629 Tflops/s, hfu: 107.629 Tflops/s, 1252.970 iter/s, 7.981e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(10240,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 23.149 Tflops/s, hfu: 23.149 Tflops/s, 359.326 iter/s, 2.783e-03 s/iter, (0.040, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 43.073 Tflops/s, hfu: 43.073 Tflops/s, 668.580 iter/s, 1.496e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 20.191 Tflops/s, hfu: 20.191 Tflops/s, 313.405 iter/s, 3.191e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 75.422 Tflops/s, hfu: 75.422 Tflops/s, 585.354 iter/s, 1.708e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 110.736 Tflops/s, hfu: 110.736 Tflops/s, 859.425 iter/s, 1.164e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 115.763 Tflops/s, hfu: 115.763 Tflops/s, 898.440 iter/s, 1.113e-03 s/iter, (0.073, 0.000, 0.004) sec
mfu: 117.428 Tflops/s, hfu: 117.428 Tflops/s, 911.358 iter/s, 1.097e-03 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(10240,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 30.732 Tflops/s, hfu: 30.732 Tflops/s, 357.767 iter/s, 2.795e-03 s/iter, (0.041, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 57.362 Tflops/s, hfu: 57.362 Tflops/s, 667.776 iter/s, 1.498e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 26.9 Tflops/s, hfu: 26.9 Tflops/s, 313.154 iter/s, 3.193e-03 s/iter, (0.038, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 92.058 Tflops/s, hfu: 92.058 Tflops/s, 535.851 iter/s, 1.866e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 118.947 Tflops/s, hfu: 118.947 Tflops/s, 692.364 iter/s, 1.444e-03 s/iter, (0.078, 0.000, 0.006) sec
mfu: 125.163 Tflops/s, hfu: 125.163 Tflops/s, 728.544 iter/s, 1.373e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 130.615 Tflops/s, hfu: 130.615 Tflops/s, 760.280 iter/s, 1.315e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(10240,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.472 Tflops/s, hfu: 38.472 Tflops/s, 358.298 iter/s, 2.791e-03 s/iter, (0.045, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 72.189 Tflops/s, hfu: 72.189 Tflops/s, 672.315 iter/s, 1.487e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 33.61 Tflops/s, hfu: 33.61 Tflops/s, 313.016 iter/s, 3.195e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 102.289 Tflops/s, hfu: 102.289 Tflops/s, 476.321 iter/s, 2.099e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 135.099 Tflops/s, hfu: 135.099 Tflops/s, 629.105 iter/s, 1.590e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 131.396 Tflops/s, hfu: 131.396 Tflops/s, 611.860 iter/s, 1.634e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 129.251 Tflops/s, hfu: 129.251 Tflops/s, 601.873 iter/s, 1.661e-03 s/iter, (0.077, 0.000, 0.007) sec
SP=(1,8),S=(10240,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.987 Tflops/s, hfu: 44.987 Tflops/s, 349.146 iter/s, 2.864e-03 s/iter, (0.044, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 85.682 Tflops/s, hfu: 85.682 Tflops/s, 664.981 iter/s, 1.504e-03 s/iter, (0.021, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 40.166 Tflops/s, hfu: 40.166 Tflops/s, 311.726 iter/s, 3.208e-03 s/iter, (0.040, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 119.825 Tflops/s, hfu: 119.825 Tflops/s, 464.983 iter/s, 2.151e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 141.455 Tflops/s, hfu: 141.455 Tflops/s, 548.917 iter/s, 1.822e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 134.72 Tflops/s, hfu: 134.72 Tflops/s, 522.781 iter/s, 1.913e-03 s/iter, (0.091, 0.000, 0.008) sec
mfu: 135.048 Tflops/s, hfu: 135.048 Tflops/s, 524.056 iter/s, 1.908e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(10240,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.173 Tflops/s, hfu: 48.173 Tflops/s, 320.461 iter/s, 3.121e-03 s/iter, (0.049, 0.000, 0.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 94.325 Tflops/s, hfu: 94.325 Tflops/s, 627.481 iter/s, 1.594e-03 s/iter, (0.022, 0.000, 0.032) sec
# stripe_flash_attn_func, fwd
mfu: 43.399 Tflops/s, hfu: 43.399 Tflops/s, 288.701 iter/s, 3.464e-03 s/iter, (0.042, 0.000, 0.069) sec
# orchestrated_attn_func
mfu: 130.08 Tflops/s, hfu: 130.08 Tflops/s, 432.667 iter/s, 2.311e-03 s/iter, (0.080, 0.000, 0.009) sec
mfu: 144.485 Tflops/s, hfu: 144.485 Tflops/s, 480.579 iter/s, 2.081e-03 s/iter, (0.080, 0.000, 0.008) sec
mfu: 138.705 Tflops/s, hfu: 138.705 Tflops/s, 461.353 iter/s, 2.168e-03 s/iter, (0.081, 0.000, 0.009) sec
mfu: 127.289 Tflops/s, hfu: 127.289 Tflops/s, 423.381 iter/s, 2.362e-03 s/iter, (0.078, 0.000, 0.009) sec
SP=(1,8),S=(10240,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 49.574 Tflops/s, hfu: 49.574 Tflops/s, 288.558 iter/s, 3.466e-03 s/iter, (0.049, 0.000, 0.069) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 99.572 Tflops/s, hfu: 99.572 Tflops/s, 579.584 iter/s, 1.725e-03 s/iter, (0.025, 0.000, 0.035) sec
# stripe_flash_attn_func, fwd
mfu: 46.305 Tflops/s, hfu: 46.305 Tflops/s, 269.531 iter/s, 3.710e-03 s/iter, (0.045, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 131.712 Tflops/s, hfu: 131.712 Tflops/s, 383.332 iter/s, 2.609e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 144.537 Tflops/s, hfu: 144.537 Tflops/s, 420.659 iter/s, 2.377e-03 s/iter, (0.078, 0.000, 0.010) sec
mfu: 143.892 Tflops/s, hfu: 143.892 Tflops/s, 418.780 iter/s, 2.388e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 119.433 Tflops/s, hfu: 119.433 Tflops/s, 347.595 iter/s, 2.877e-03 s/iter, (0.080, 0.000, 0.012) sec
SP=(1,8),S=(10240,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.072 Tflops/s, hfu: 54.072 Tflops/s, 251.792 iter/s, 3.972e-03 s/iter, (0.054, 0.000, 0.079) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 100.085 Tflops/s, hfu: 100.085 Tflops/s, 466.057 iter/s, 2.146e-03 s/iter, (0.028, 0.000, 0.043) sec
# stripe_flash_attn_func, fwd
mfu: 50.911 Tflops/s, hfu: 50.911 Tflops/s, 237.072 iter/s, 4.218e-03 s/iter, (0.050, 0.000, 0.084) sec
# orchestrated_attn_func
mfu: 147.519 Tflops/s, hfu: 147.519 Tflops/s, 343.469 iter/s, 2.911e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 144.716 Tflops/s, hfu: 144.716 Tflops/s, 336.943 iter/s, 2.968e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 144.984 Tflops/s, hfu: 144.984 Tflops/s, 337.567 iter/s, 2.962e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 129.746 Tflops/s, hfu: 129.746 Tflops/s, 302.088 iter/s, 3.310e-03 s/iter, (0.083, 0.000, 0.013) sec
SP=(1,8),S=(10240,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.022 Tflops/s, hfu: 57.022 Tflops/s, 221.275 iter/s, 4.519e-03 s/iter, (0.061, 0.000, 0.090) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 103.518 Tflops/s, hfu: 103.518 Tflops/s, 401.703 iter/s, 2.489e-03 s/iter, (0.032, 0.000, 0.050) sec
# stripe_flash_attn_func, fwd
mfu: 54.005 Tflops/s, hfu: 54.005 Tflops/s, 209.567 iter/s, 4.772e-03 s/iter, (0.055, 0.000, 0.095) sec
# orchestrated_attn_func
mfu: 157.663 Tflops/s, hfu: 157.663 Tflops/s, 305.907 iter/s, 3.269e-03 s/iter, (0.089, 0.000, 0.013) sec
mfu: 147.315 Tflops/s, hfu: 147.315 Tflops/s, 285.829 iter/s, 3.499e-03 s/iter, (0.086, 0.000, 0.014) sec
mfu: 149.588 Tflops/s, hfu: 149.588 Tflops/s, 290.238 iter/s, 3.445e-03 s/iter, (0.083, 0.000, 0.014) sec
mfu: 143.804 Tflops/s, hfu: 143.804 Tflops/s, 279.017 iter/s, 3.584e-03 s/iter, (0.085, 0.000, 0.014) sec
SP=(1,8),S=(10240,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 59.132 Tflops/s, hfu: 59.132 Tflops/s, 196.682 iter/s, 5.084e-03 s/iter, (0.068, 0.000, 0.102) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 104.717 Tflops/s, hfu: 104.717 Tflops/s, 348.303 iter/s, 2.871e-03 s/iter, (0.036, 0.000, 0.057) sec
# stripe_flash_attn_func, fwd
mfu: 55.656 Tflops/s, hfu: 55.656 Tflops/s, 185.119 iter/s, 5.402e-03 s/iter, (0.062, 0.000, 0.108) sec
# orchestrated_attn_func
mfu: 162.642 Tflops/s, hfu: 162.642 Tflops/s, 270.487 iter/s, 3.697e-03 s/iter, (0.087, 0.000, 0.015) sec
mfu: 160.101 Tflops/s, hfu: 160.101 Tflops/s, 266.259 iter/s, 3.756e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 149.042 Tflops/s, hfu: 149.042 Tflops/s, 247.869 iter/s, 4.034e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 136.322 Tflops/s, hfu: 136.322 Tflops/s, 226.714 iter/s, 4.411e-03 s/iter, (0.086, 0.000, 0.018) sec
SP=(1,8),S=(10240,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 61.748 Tflops/s, hfu: 61.748 Tflops/s, 179.710 iter/s, 5.565e-03 s/iter, (0.073, 0.000, 0.111) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 106.352 Tflops/s, hfu: 106.352 Tflops/s, 309.526 iter/s, 3.231e-03 s/iter, (0.040, 0.000, 0.065) sec
# stripe_flash_attn_func, fwd
mfu: 57.01 Tflops/s, hfu: 57.01 Tflops/s, 165.922 iter/s, 6.027e-03 s/iter, (0.069, 0.000, 0.121) sec
# orchestrated_attn_func
mfu: 171.824 Tflops/s, hfu: 171.824 Tflops/s, 250.038 iter/s, 3.999e-03 s/iter, (0.088, 0.000, 0.016) sec
mfu: 162.232 Tflops/s, hfu: 162.232 Tflops/s, 236.078 iter/s, 4.236e-03 s/iter, (0.090, 0.000, 0.017) sec
mfu: 154.738 Tflops/s, hfu: 154.738 Tflops/s, 225.173 iter/s, 4.441e-03 s/iter, (0.090, 0.000, 0.018) sec
mfu: 141.068 Tflops/s, hfu: 141.068 Tflops/s, 205.281 iter/s, 4.871e-03 s/iter, (0.091, 0.000, 0.019) sec
SP=(1,8),S=(10240,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.904 Tflops/s, hfu: 64.904 Tflops/s, 151.117 iter/s, 6.617e-03 s/iter, (0.085, 0.000, 0.132) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 107.814 Tflops/s, hfu: 107.814 Tflops/s, 251.024 iter/s, 3.984e-03 s/iter, (0.051, 0.000, 0.080) sec
# stripe_flash_attn_func, fwd
mfu: 60.146 Tflops/s, hfu: 60.146 Tflops/s, 140.039 iter/s, 7.141e-03 s/iter, (0.082, 0.000, 0.143) sec
# orchestrated_attn_func
mfu: 186.2 Tflops/s, hfu: 186.2 Tflops/s, 216.766 iter/s, 4.613e-03 s/iter, (0.101, 0.000, 0.018) sec
mfu: 160.605 Tflops/s, hfu: 160.605 Tflops/s, 186.968 iter/s, 5.348e-03 s/iter, (0.101, 0.000, 0.021) sec
mfu: 153.497 Tflops/s, hfu: 153.497 Tflops/s, 178.694 iter/s, 5.596e-03 s/iter, (0.091, 0.000, 0.022) sec
mfu: 157.742 Tflops/s, hfu: 157.742 Tflops/s, 183.636 iter/s, 5.446e-03 s/iter, (0.092, 0.000, 0.022) sec
SP=(1,8),S=(10240,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.992 Tflops/s, hfu: 66.992 Tflops/s, 129.981 iter/s, 7.693e-03 s/iter, (0.094, 0.000, 0.154) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 110.101 Tflops/s, hfu: 110.101 Tflops/s, 213.624 iter/s, 4.681e-03 s/iter, (0.056, 0.000, 0.094) sec
# stripe_flash_attn_func, fwd
mfu: 65.344 Tflops/s, hfu: 65.344 Tflops/s, 126.784 iter/s, 7.887e-03 s/iter, (0.092, 0.000, 0.158) sec
# orchestrated_attn_func
mfu: 183.326 Tflops/s, hfu: 183.326 Tflops/s, 177.849 iter/s, 5.623e-03 s/iter, (0.131, 0.000, 0.022) sec
mfu: 159.315 Tflops/s, hfu: 159.315 Tflops/s, 154.556 iter/s, 6.470e-03 s/iter, (0.099, 0.000, 0.026) sec
mfu: 154.415 Tflops/s, hfu: 154.415 Tflops/s, 149.802 iter/s, 6.675e-03 s/iter, (0.099, 0.000, 0.027) sec
mfu: 150.614 Tflops/s, hfu: 150.614 Tflops/s, 146.115 iter/s, 6.844e-03 s/iter, (0.098, 0.000, 0.027) sec
SP=(1,8),S=(10240,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 68.942 Tflops/s, hfu: 68.942 Tflops/s, 114.655 iter/s, 8.722e-03 s/iter, (0.106, 0.000, 0.174) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.605 Tflops/s, hfu: 109.605 Tflops/s, 182.282 iter/s, 5.486e-03 s/iter, (0.064, 0.000, 0.110) sec
# stripe_flash_attn_func, fwd
mfu: 66.825 Tflops/s, hfu: 66.825 Tflops/s, 111.135 iter/s, 8.998e-03 s/iter, (0.104, 0.000, 0.180) sec
# orchestrated_attn_func
mfu: 190.681 Tflops/s, hfu: 190.681 Tflops/s, 158.559 iter/s, 6.307e-03 s/iter, (0.103, 0.000, 0.025) sec
mfu: 159.205 Tflops/s, hfu: 159.205 Tflops/s, 132.385 iter/s, 7.554e-03 s/iter, (0.100, 0.000, 0.030) sec
mfu: 155.746 Tflops/s, hfu: 155.746 Tflops/s, 129.509 iter/s, 7.721e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 153.858 Tflops/s, hfu: 153.858 Tflops/s, 127.938 iter/s, 7.816e-03 s/iter, (0.105, 0.000, 0.031) sec
SP=(1,8),S=(10240,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 70.382 Tflops/s, hfu: 70.382 Tflops/s, 102.420 iter/s, 9.764e-03 s/iter, (0.118, 0.000, 0.195) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 109.601 Tflops/s, hfu: 109.601 Tflops/s, 159.491 iter/s, 6.270e-03 s/iter, (0.073, 0.000, 0.125) sec
# stripe_flash_attn_func, fwd
mfu: 68.153 Tflops/s, hfu: 68.153 Tflops/s, 99.176 iter/s, 1.008e-02 s/iter, (0.117, 0.000, 0.202) sec
# orchestrated_attn_func
mfu: 189.811 Tflops/s, hfu: 189.811 Tflops/s, 138.105 iter/s, 7.241e-03 s/iter, (0.157, 0.000, 0.029) sec
mfu: 160.186 Tflops/s, hfu: 160.186 Tflops/s, 116.550 iter/s, 8.580e-03 s/iter, (0.107, 0.000, 0.034) sec
mfu: 155.464 Tflops/s, hfu: 155.464 Tflops/s, 113.115 iter/s, 8.841e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 157.175 Tflops/s, hfu: 157.175 Tflops/s, 114.360 iter/s, 8.744e-03 s/iter, (0.107, 0.000, 0.035) sec
SP=(1,8),S=(10240,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.566 Tflops/s, hfu: 71.566 Tflops/s, 83.313 iter/s, 1.200e-02 s/iter, (0.141, 0.000, 0.240) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.17 Tflops/s, hfu: 112.17 Tflops/s, 130.583 iter/s, 7.658e-03 s/iter, (0.089, 0.000, 0.153) sec
# stripe_flash_attn_func, fwd
mfu: 69.074 Tflops/s, hfu: 69.074 Tflops/s, 80.413 iter/s, 1.244e-02 s/iter, (0.145, 0.000, 0.249) sec
# orchestrated_attn_func
mfu: 172.695 Tflops/s, hfu: 172.695 Tflops/s, 100.522 iter/s, 9.948e-03 s/iter, (0.175, 0.000, 0.040) sec
mfu: 161.957 Tflops/s, hfu: 161.957 Tflops/s, 94.271 iter/s, 1.061e-02 s/iter, (0.116, 0.000, 0.042) sec
mfu: 162.828 Tflops/s, hfu: 162.828 Tflops/s, 94.778 iter/s, 1.055e-02 s/iter, (0.112, 0.000, 0.042) sec
mfu: 151.769 Tflops/s, hfu: 151.769 Tflops/s, 88.341 iter/s, 1.132e-02 s/iter, (0.114, 0.000, 0.045) sec
SP=(1,8),S=(10240,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 72.512 Tflops/s, hfu: 72.512 Tflops/s, 70.346 iter/s, 1.422e-02 s/iter, (0.167, 0.000, 0.284) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.589 Tflops/s, hfu: 111.589 Tflops/s, 108.255 iter/s, 9.237e-03 s/iter, (0.107, 0.000, 0.185) sec
# stripe_flash_attn_func, fwd
mfu: 70.866 Tflops/s, hfu: 70.866 Tflops/s, 68.749 iter/s, 1.455e-02 s/iter, (0.171, 0.000, 0.291) sec
# orchestrated_attn_func
mfu: 175.546 Tflops/s, hfu: 175.546 Tflops/s, 85.151 iter/s, 1.174e-02 s/iter, (0.126, 0.000, 0.047) sec
mfu: 162.418 Tflops/s, hfu: 162.418 Tflops/s, 78.783 iter/s, 1.269e-02 s/iter, (0.122, 0.000, 0.051) sec
mfu: 169.039 Tflops/s, hfu: 169.039 Tflops/s, 81.995 iter/s, 1.220e-02 s/iter, (0.120, 0.000, 0.049) sec
mfu: 153.685 Tflops/s, hfu: 153.685 Tflops/s, 74.547 iter/s, 1.341e-02 s/iter, (0.125, 0.000, 0.054) sec
SP=(1,8),S=(10240,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.591 Tflops/s, hfu: 73.591 Tflops/s, 61.193 iter/s, 1.634e-02 s/iter, (0.192, 0.000, 0.327) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.134 Tflops/s, hfu: 111.134 Tflops/s, 92.412 iter/s, 1.082e-02 s/iter, (0.123, 0.000, 0.216) sec
# stripe_flash_attn_func, fwd
mfu: 72.258 Tflops/s, hfu: 72.258 Tflops/s, 60.085 iter/s, 1.664e-02 s/iter, (0.197, 0.000, 0.333) sec
# orchestrated_attn_func
mfu: 171.848 Tflops/s, hfu: 171.848 Tflops/s, 71.449 iter/s, 1.400e-02 s/iter, (0.136, 0.000, 0.056) sec
mfu: 163.18 Tflops/s, hfu: 163.18 Tflops/s, 67.845 iter/s, 1.474e-02 s/iter, (0.139, 0.000, 0.059) sec
mfu: 169.585 Tflops/s, hfu: 169.585 Tflops/s, 70.508 iter/s, 1.418e-02 s/iter, (0.131, 0.000, 0.057) sec
mfu: 155.269 Tflops/s, hfu: 155.269 Tflops/s, 64.556 iter/s, 1.549e-02 s/iter, (0.131, 0.000, 0.062) sec
SP=(1,8),S=(10240,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.945 Tflops/s, hfu: 73.945 Tflops/s, 53.802 iter/s, 1.859e-02 s/iter, (0.218, 0.000, 0.372) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.536 Tflops/s, hfu: 112.536 Tflops/s, 81.881 iter/s, 1.221e-02 s/iter, (0.145, 0.000, 0.244) sec
# stripe_flash_attn_func, fwd
mfu: 73.257 Tflops/s, hfu: 73.257 Tflops/s, 53.301 iter/s, 1.876e-02 s/iter, (0.225, 0.000, 0.375) sec
# orchestrated_attn_func
mfu: 171.172 Tflops/s, hfu: 171.172 Tflops/s, 62.272 iter/s, 1.606e-02 s/iter, (0.166, 0.000, 0.064) sec
mfu: 166.577 Tflops/s, hfu: 166.577 Tflops/s, 60.600 iter/s, 1.650e-02 s/iter, (0.140, 0.000, 0.066) sec
mfu: 169.648 Tflops/s, hfu: 169.648 Tflops/s, 61.718 iter/s, 1.620e-02 s/iter, (0.140, 0.000, 0.065) sec
mfu: 156.655 Tflops/s, hfu: 156.655 Tflops/s, 56.991 iter/s, 1.755e-02 s/iter, (0.141, 0.000, 0.070) sec
SP=(1,8),S=(10240,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.826 Tflops/s, hfu: 73.826 Tflops/s, 42.972 iter/s, 2.327e-02 s/iter, (0.263, 0.000, 0.465) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 102.033 Tflops/s, hfu: 102.033 Tflops/s, 59.391 iter/s, 1.684e-02 s/iter, (0.190, 0.000, 0.337) sec
# stripe_flash_attn_func, fwd
mfu: 73.353 Tflops/s, hfu: 73.353 Tflops/s, 42.697 iter/s, 2.342e-02 s/iter, (0.279, 0.000, 0.468) sec
# orchestrated_attn_func
mfu: 167.317 Tflops/s, hfu: 167.317 Tflops/s, 48.696 iter/s, 2.054e-02 s/iter, (0.172, 0.000, 0.082) sec
mfu: 165.556 Tflops/s, hfu: 165.556 Tflops/s, 48.183 iter/s, 2.075e-02 s/iter, (0.158, 0.000, 0.083) sec
mfu: 167.06 Tflops/s, hfu: 167.06 Tflops/s, 48.621 iter/s, 2.057e-02 s/iter, (0.159, 0.000, 0.082) sec
mfu: 148.203 Tflops/s, hfu: 148.203 Tflops/s, 43.133 iter/s, 2.318e-02 s/iter, (0.163, 0.000, 0.093) sec
SP=(1,8),S=(10240,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.654 Tflops/s, hfu: 73.654 Tflops/s, 35.727 iter/s, 2.799e-02 s/iter, (0.313, 0.000, 0.560) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 74.998 Tflops/s, hfu: 74.998 Tflops/s, 36.379 iter/s, 2.749e-02 s/iter, (0.227, 0.000, 0.550) sec
# stripe_flash_attn_func, fwd
mfu: 73.412 Tflops/s, hfu: 73.412 Tflops/s, 35.610 iter/s, 2.808e-02 s/iter, (0.337, 0.000, 0.562) sec
# orchestrated_attn_func
mfu: 169.206 Tflops/s, hfu: 169.206 Tflops/s, 41.038 iter/s, 2.437e-02 s/iter, (0.204, 0.000, 0.097) sec
mfu: 161.843 Tflops/s, hfu: 161.843 Tflops/s, 39.252 iter/s, 2.548e-02 s/iter, (0.186, 0.000, 0.102) sec
mfu: 166.944 Tflops/s, hfu: 166.944 Tflops/s, 40.489 iter/s, 2.470e-02 s/iter, (0.180, 0.000, 0.099) sec
mfu: 151.701 Tflops/s, hfu: 151.701 Tflops/s, 36.792 iter/s, 2.718e-02 s/iter, (0.184, 0.000, 0.109) sec
SP=(1,8),S=(10240,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.636 Tflops/s, hfu: 74.636 Tflops/s, 31.031 iter/s, 3.223e-02 s/iter, (0.378, 0.000, 0.645) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.596 Tflops/s, hfu: 55.596 Tflops/s, 23.115 iter/s, 4.326e-02 s/iter, (0.265, 0.000, 0.865) sec
# stripe_flash_attn_func, fwd
mfu: 71.455 Tflops/s, hfu: 71.455 Tflops/s, 29.709 iter/s, 3.366e-02 s/iter, (0.397, 0.000, 0.673) sec
# orchestrated_attn_func
mfu: 166.915 Tflops/s, hfu: 166.915 Tflops/s, 34.699 iter/s, 2.882e-02 s/iter, (0.272, 0.000, 0.115) sec
mfu: 160.73 Tflops/s, hfu: 160.73 Tflops/s, 33.413 iter/s, 2.993e-02 s/iter, (0.194, 0.000, 0.120) sec
mfu: 152.276 Tflops/s, hfu: 152.276 Tflops/s, 31.656 iter/s, 3.159e-02 s/iter, (0.187, 0.000, 0.126) sec
mfu: 150.055 Tflops/s, hfu: 150.055 Tflops/s, 31.194 iter/s, 3.206e-02 s/iter, (0.204, 0.000, 0.128) sec
SP=(1,8),S=(10240,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.085 Tflops/s, hfu: 52.085 Tflops/s, 18.948 iter/s, 5.277e-02 s/iter, (0.417, 0.000, 1.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 90.36 Tflops/s, hfu: 90.36 Tflops/s, 32.873 iter/s, 3.042e-02 s/iter, (0.314, 0.000, 0.608) sec
# stripe_flash_attn_func, fwd
mfu: 72.764 Tflops/s, hfu: 72.764 Tflops/s, 26.471 iter/s, 3.778e-02 s/iter, (0.449, 0.000, 0.756) sec
# orchestrated_attn_func
mfu: 170.135 Tflops/s, hfu: 170.135 Tflops/s, 30.947 iter/s, 3.231e-02 s/iter, (0.228, 0.000, 0.129) sec
mfu: 158.538 Tflops/s, hfu: 158.538 Tflops/s, 28.838 iter/s, 3.468e-02 s/iter, (0.208, 0.000, 0.139) sec
mfu: 167.102 Tflops/s, hfu: 167.102 Tflops/s, 30.396 iter/s, 3.290e-02 s/iter, (0.201, 0.000, 0.132) sec
mfu: 144.631 Tflops/s, hfu: 144.631 Tflops/s, 26.308 iter/s, 3.801e-02 s/iter, (0.221, 0.000, 0.152) sec
SP=(1,8),S=(10240,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.231 Tflops/s, hfu: 32.231 Tflops/s, 9.381 iter/s, 1.066e-01 s/iter, (0.601, 0.000, 2.132) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 95.23 Tflops/s, hfu: 95.23 Tflops/s, 27.716 iter/s, 3.608e-02 s/iter, (0.466, 0.000, 0.722) sec
# stripe_flash_attn_func, fwd
mfu: 51.013 Tflops/s, hfu: 51.013 Tflops/s, 14.847 iter/s, 6.736e-02 s/iter, (0.643, 0.000, 1.347) sec
# orchestrated_attn_func
mfu: 167.777 Tflops/s, hfu: 167.777 Tflops/s, 24.415 iter/s, 4.096e-02 s/iter, (0.273, 0.000, 0.164) sec
mfu: 164.136 Tflops/s, hfu: 164.136 Tflops/s, 23.885 iter/s, 4.187e-02 s/iter, (0.248, 0.000, 0.167) sec
mfu: 167.104 Tflops/s, hfu: 167.104 Tflops/s, 24.317 iter/s, 4.112e-02 s/iter, (0.234, 0.000, 0.164) sec
mfu: 152.072 Tflops/s, hfu: 152.072 Tflops/s, 22.129 iter/s, 4.519e-02 s/iter, (0.256, 0.000, 0.181) sec
SP=(1,8),S=(10240,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 33.189 Tflops/s, hfu: 33.189 Tflops/s, 8.050 iter/s, 1.242e-01 s/iter, (0.707, 0.000, 2.485) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 74.551 Tflops/s, hfu: 74.551 Tflops/s, 18.081 iter/s, 5.531e-02 s/iter, (0.501, 0.000, 1.106) sec
# stripe_flash_attn_func, fwd
mfu: 35.809 Tflops/s, hfu: 35.809 Tflops/s, 8.685 iter/s, 1.151e-01 s/iter, (0.785, 0.000, 2.303) sec
# orchestrated_attn_func
mfu: 167.143 Tflops/s, hfu: 167.143 Tflops/s, 20.269 iter/s, 4.934e-02 s/iter, (0.386, 0.000, 0.197) sec
mfu: 164.58 Tflops/s, hfu: 164.58 Tflops/s, 19.958 iter/s, 5.011e-02 s/iter, (0.276, 0.000, 0.200) sec
mfu: 166.729 Tflops/s, hfu: 166.729 Tflops/s, 20.219 iter/s, 4.946e-02 s/iter, (0.266, 0.000, 0.198) sec
mfu: 148.603 Tflops/s, hfu: 148.603 Tflops/s, 18.020 iter/s, 5.549e-02 s/iter, (0.283, 0.000, 0.222) sec
SP=(1,8),S=(10240,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.805 Tflops/s, hfu: 38.805 Tflops/s, 8.067 iter/s, 1.240e-01 s/iter, (0.816, 0.000, 2.479) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 74.857 Tflops/s, hfu: 74.857 Tflops/s, 15.562 iter/s, 6.426e-02 s/iter, (0.610, 0.000, 1.285) sec
# stripe_flash_attn_func, fwd
mfu: 36.383 Tflops/s, hfu: 36.383 Tflops/s, 7.564 iter/s, 1.322e-01 s/iter, (0.903, 0.000, 2.644) sec
# orchestrated_attn_func
mfu: 169.721 Tflops/s, hfu: 169.721 Tflops/s, 17.641 iter/s, 5.669e-02 s/iter, (0.319, 0.000, 0.227) sec
mfu: 160.961 Tflops/s, hfu: 160.961 Tflops/s, 16.731 iter/s, 5.977e-02 s/iter, (0.310, 0.000, 0.239) sec
mfu: 166.335 Tflops/s, hfu: 166.335 Tflops/s, 17.289 iter/s, 5.784e-02 s/iter, (0.303, 0.000, 0.231) sec
mfu: 139.329 Tflops/s, hfu: 139.329 Tflops/s, 14.482 iter/s, 6.905e-02 s/iter, (0.329, 0.000, 0.276) sec
SP=(1,8),S=(10240,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.252 Tflops/s, hfu: 36.252 Tflops/s, 6.594 iter/s, 1.516e-01 s/iter, (0.951, 0.000, 3.033) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 52.017 Tflops/s, hfu: 52.017 Tflops/s, 9.462 iter/s, 1.057e-01 s/iter, (0.638, 0.000, 2.114) sec
# stripe_flash_attn_func, fwd
mfu: 36.631 Tflops/s, hfu: 36.631 Tflops/s, 6.663 iter/s, 1.501e-01 s/iter, (1.038, 0.000, 3.002) sec
# orchestrated_attn_func
mfu: 165.183 Tflops/s, hfu: 165.183 Tflops/s, 15.023 iter/s, 6.656e-02 s/iter, (0.458, 0.000, 0.266) sec
mfu: 163.817 Tflops/s, hfu: 163.817 Tflops/s, 14.899 iter/s, 6.712e-02 s/iter, (0.359, 0.000, 0.268) sec
mfu: 162.517 Tflops/s, hfu: 162.517 Tflops/s, 14.781 iter/s, 6.766e-02 s/iter, (0.461, 0.000, 0.271) sec
mfu: 147.158 Tflops/s, hfu: 147.158 Tflops/s, 13.384 iter/s, 7.472e-02 s/iter, (0.371, 0.000, 0.299) sec
SP=(1,8),S=(12288,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 9.439 Tflops/s, hfu: 9.439 Tflops/s, 366.296 iter/s, 2.730e-03 s/iter, (0.046, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 17.546 Tflops/s, hfu: 17.546 Tflops/s, 680.877 iter/s, 1.469e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 8.255 Tflops/s, hfu: 8.255 Tflops/s, 320.318 iter/s, 3.122e-03 s/iter, (0.038, 0.000, 0.062) sec
# orchestrated_attn_func
mfu: 29.672 Tflops/s, hfu: 29.672 Tflops/s, 575.718 iter/s, 1.737e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 61.767 Tflops/s, hfu: 61.767 Tflops/s, 1198.443 iter/s, 8.344e-04 s/iter, (0.077, 0.000, 0.003) sec
mfu: 80.139 Tflops/s, hfu: 80.139 Tflops/s, 1554.900 iter/s, 6.431e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 102.157 Tflops/s, hfu: 102.157 Tflops/s, 1982.113 iter/s, 5.045e-04 s/iter, (0.071, 0.000, 0.002) sec
SP=(1,8),S=(12288,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 18.815 Tflops/s, hfu: 18.815 Tflops/s, 365.060 iter/s, 2.739e-03 s/iter, (0.038, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 35.062 Tflops/s, hfu: 35.062 Tflops/s, 680.292 iter/s, 1.470e-03 s/iter, (0.018, 0.000, 0.029) sec
# stripe_flash_attn_func, fwd
mfu: 16.478 Tflops/s, hfu: 16.478 Tflops/s, 319.722 iter/s, 3.128e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 55.957 Tflops/s, hfu: 55.957 Tflops/s, 542.858 iter/s, 1.842e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 96.939 Tflops/s, hfu: 96.939 Tflops/s, 940.429 iter/s, 1.063e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 109.09 Tflops/s, hfu: 109.09 Tflops/s, 1058.309 iter/s, 9.449e-04 s/iter, (0.075, 0.000, 0.004) sec
mfu: 129.365 Tflops/s, hfu: 129.365 Tflops/s, 1255.007 iter/s, 7.968e-04 s/iter, (0.073, 0.000, 0.003) sec
SP=(1,8),S=(12288,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 22.926 Tflops/s, hfu: 22.926 Tflops/s, 296.549 iter/s, 3.372e-03 s/iter, (0.038, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 52.338 Tflops/s, hfu: 52.338 Tflops/s, 676.992 iter/s, 1.477e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 24.645 Tflops/s, hfu: 24.645 Tflops/s, 318.784 iter/s, 3.137e-03 s/iter, (0.038, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 82.07 Tflops/s, hfu: 82.07 Tflops/s, 530.790 iter/s, 1.884e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 118.222 Tflops/s, hfu: 118.222 Tflops/s, 764.601 iter/s, 1.308e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 124.716 Tflops/s, hfu: 124.716 Tflops/s, 806.603 iter/s, 1.240e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 136.759 Tflops/s, hfu: 136.759 Tflops/s, 884.492 iter/s, 1.131e-03 s/iter, (0.074, 0.000, 0.005) sec
SP=(1,8),S=(12288,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.945 Tflops/s, hfu: 36.945 Tflops/s, 358.409 iter/s, 2.790e-03 s/iter, (0.045, 0.000, 0.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 68.771 Tflops/s, hfu: 68.771 Tflops/s, 667.171 iter/s, 1.499e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 32.782 Tflops/s, hfu: 32.782 Tflops/s, 318.027 iter/s, 3.144e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 94.531 Tflops/s, hfu: 94.531 Tflops/s, 458.537 iter/s, 2.181e-03 s/iter, (0.079, 0.000, 0.009) sec
mfu: 131.023 Tflops/s, hfu: 131.023 Tflops/s, 635.547 iter/s, 1.573e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 131.545 Tflops/s, hfu: 131.545 Tflops/s, 638.077 iter/s, 1.567e-03 s/iter, (0.075, 0.000, 0.006) sec
mfu: 138.94 Tflops/s, hfu: 138.94 Tflops/s, 673.949 iter/s, 1.484e-03 s/iter, (0.075, 0.000, 0.006) sec
SP=(1,8),S=(12288,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.043 Tflops/s, hfu: 44.043 Tflops/s, 341.822 iter/s, 2.926e-03 s/iter, (0.045, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 87.082 Tflops/s, hfu: 87.082 Tflops/s, 675.847 iter/s, 1.480e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 41.056 Tflops/s, hfu: 41.056 Tflops/s, 318.637 iter/s, 3.138e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 109.554 Tflops/s, hfu: 109.554 Tflops/s, 425.127 iter/s, 2.352e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 140.089 Tflops/s, hfu: 140.089 Tflops/s, 543.618 iter/s, 1.840e-03 s/iter, (0.079, 0.000, 0.007) sec
mfu: 138.726 Tflops/s, hfu: 138.726 Tflops/s, 538.327 iter/s, 1.858e-03 s/iter, (0.077, 0.000, 0.007) sec
mfu: 148.145 Tflops/s, hfu: 148.145 Tflops/s, 574.877 iter/s, 1.740e-03 s/iter, (0.076, 0.000, 0.007) sec
SP=(1,8),S=(12288,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 47.992 Tflops/s, hfu: 47.992 Tflops/s, 310.389 iter/s, 3.222e-03 s/iter, (0.049, 0.000, 0.064) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 98.626 Tflops/s, hfu: 98.626 Tflops/s, 637.868 iter/s, 1.568e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 45.496 Tflops/s, hfu: 45.496 Tflops/s, 294.246 iter/s, 3.399e-03 s/iter, (0.041, 0.000, 0.068) sec
# orchestrated_attn_func
mfu: 122.594 Tflops/s, hfu: 122.594 Tflops/s, 396.439 iter/s, 2.522e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 148.218 Tflops/s, hfu: 148.218 Tflops/s, 479.300 iter/s, 2.086e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 144.464 Tflops/s, hfu: 144.464 Tflops/s, 467.162 iter/s, 2.141e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 148.583 Tflops/s, hfu: 148.583 Tflops/s, 480.481 iter/s, 2.081e-03 s/iter, (0.077, 0.000, 0.008) sec
SP=(1,8),S=(12288,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 50.803 Tflops/s, hfu: 50.803 Tflops/s, 281.631 iter/s, 3.551e-03 s/iter, (0.054, 0.000, 0.071) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 105.475 Tflops/s, hfu: 105.475 Tflops/s, 584.711 iter/s, 1.710e-03 s/iter, (0.031, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 48.85 Tflops/s, hfu: 48.85 Tflops/s, 270.803 iter/s, 3.693e-03 s/iter, (0.045, 0.000, 0.074) sec
# orchestrated_attn_func
mfu: 140.51 Tflops/s, hfu: 140.51 Tflops/s, 389.464 iter/s, 2.568e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 147.247 Tflops/s, hfu: 147.247 Tflops/s, 408.138 iter/s, 2.450e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 145.904 Tflops/s, hfu: 145.904 Tflops/s, 404.417 iter/s, 2.473e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 149.997 Tflops/s, hfu: 149.997 Tflops/s, 415.762 iter/s, 2.405e-03 s/iter, (0.082, 0.000, 0.010) sec
SP=(1,8),S=(12288,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 53.77 Tflops/s, hfu: 53.77 Tflops/s, 260.818 iter/s, 3.834e-03 s/iter, (0.053, 0.000, 0.077) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 105.857 Tflops/s, hfu: 105.857 Tflops/s, 513.473 iter/s, 1.948e-03 s/iter, (0.025, 0.000, 0.039) sec
# stripe_flash_attn_func, fwd
mfu: 51.553 Tflops/s, hfu: 51.553 Tflops/s, 250.067 iter/s, 3.999e-03 s/iter, (0.047, 0.000, 0.080) sec
# orchestrated_attn_func
mfu: 149.759 Tflops/s, hfu: 149.759 Tflops/s, 363.213 iter/s, 2.753e-03 s/iter, (0.086, 0.000, 0.011) sec
mfu: 155.772 Tflops/s, hfu: 155.772 Tflops/s, 377.796 iter/s, 2.647e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 148.394 Tflops/s, hfu: 148.394 Tflops/s, 359.904 iter/s, 2.779e-03 s/iter, (0.079, 0.000, 0.011) sec
mfu: 157.646 Tflops/s, hfu: 157.646 Tflops/s, 382.343 iter/s, 2.615e-03 s/iter, (0.080, 0.000, 0.010) sec
SP=(1,8),S=(12288,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 57.379 Tflops/s, hfu: 57.379 Tflops/s, 222.660 iter/s, 4.491e-03 s/iter, (0.064, 0.000, 0.090) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 110.444 Tflops/s, hfu: 110.444 Tflops/s, 428.578 iter/s, 2.333e-03 s/iter, (0.029, 0.000, 0.047) sec
# stripe_flash_attn_func, fwd
mfu: 56.131 Tflops/s, hfu: 56.131 Tflops/s, 217.815 iter/s, 4.591e-03 s/iter, (0.054, 0.000, 0.092) sec
# orchestrated_attn_func
mfu: 162.8 Tflops/s, hfu: 162.8 Tflops/s, 315.874 iter/s, 3.166e-03 s/iter, (0.084, 0.000, 0.013) sec
mfu: 160.217 Tflops/s, hfu: 160.217 Tflops/s, 310.863 iter/s, 3.217e-03 s/iter, (0.082, 0.000, 0.013) sec
mfu: 153.721 Tflops/s, hfu: 153.721 Tflops/s, 298.257 iter/s, 3.353e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 162.141 Tflops/s, hfu: 162.141 Tflops/s, 314.594 iter/s, 3.179e-03 s/iter, (0.084, 0.000, 0.013) sec
SP=(1,8),S=(12288,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.649 Tflops/s, hfu: 60.649 Tflops/s, 196.125 iter/s, 5.099e-03 s/iter, (0.067, 0.000, 0.102) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 111.953 Tflops/s, hfu: 111.953 Tflops/s, 362.030 iter/s, 2.762e-03 s/iter, (0.034, 0.000, 0.055) sec
# stripe_flash_attn_func, fwd
mfu: 59.622 Tflops/s, hfu: 59.622 Tflops/s, 192.803 iter/s, 5.187e-03 s/iter, (0.060, 0.000, 0.104) sec
# orchestrated_attn_func
mfu: 176.695 Tflops/s, hfu: 176.695 Tflops/s, 285.694 iter/s, 3.500e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 162.848 Tflops/s, hfu: 162.848 Tflops/s, 263.306 iter/s, 3.798e-03 s/iter, (0.085, 0.000, 0.015) sec
mfu: 155.32 Tflops/s, hfu: 155.32 Tflops/s, 251.133 iter/s, 3.982e-03 s/iter, (0.085, 0.000, 0.016) sec
mfu: 161.144 Tflops/s, hfu: 161.144 Tflops/s, 260.551 iter/s, 3.838e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(12288,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 63.416 Tflops/s, hfu: 63.416 Tflops/s, 175.775 iter/s, 5.689e-03 s/iter, (0.075, 0.000, 0.114) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.58 Tflops/s, hfu: 113.58 Tflops/s, 314.820 iter/s, 3.176e-03 s/iter, (0.038, 0.000, 0.064) sec
# stripe_flash_attn_func, fwd
mfu: 61.043 Tflops/s, hfu: 61.043 Tflops/s, 169.198 iter/s, 5.910e-03 s/iter, (0.068, 0.000, 0.118) sec
# orchestrated_attn_func
mfu: 179.035 Tflops/s, hfu: 179.035 Tflops/s, 248.124 iter/s, 4.030e-03 s/iter, (0.097, 0.000, 0.016) sec
mfu: 163.949 Tflops/s, hfu: 163.949 Tflops/s, 227.217 iter/s, 4.401e-03 s/iter, (0.090, 0.000, 0.018) sec
mfu: 159.451 Tflops/s, hfu: 159.451 Tflops/s, 220.982 iter/s, 4.525e-03 s/iter, (0.087, 0.000, 0.018) sec
mfu: 162.6 Tflops/s, hfu: 162.6 Tflops/s, 225.347 iter/s, 4.438e-03 s/iter, (0.088, 0.000, 0.018) sec
SP=(1,8),S=(12288,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.124 Tflops/s, hfu: 66.124 Tflops/s, 160.371 iter/s, 6.236e-03 s/iter, (0.078, 0.000, 0.125) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 114.477 Tflops/s, hfu: 114.477 Tflops/s, 277.643 iter/s, 3.602e-03 s/iter, (0.042, 0.000, 0.072) sec
# stripe_flash_attn_func, fwd
mfu: 63.136 Tflops/s, hfu: 63.136 Tflops/s, 153.125 iter/s, 6.531e-03 s/iter, (0.075, 0.000, 0.131) sec
# orchestrated_attn_func
mfu: 180.88 Tflops/s, hfu: 180.88 Tflops/s, 219.346 iter/s, 4.559e-03 s/iter, (0.093, 0.000, 0.018) sec
mfu: 161.471 Tflops/s, hfu: 161.471 Tflops/s, 195.810 iter/s, 5.107e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 161.07 Tflops/s, hfu: 161.07 Tflops/s, 195.323 iter/s, 5.120e-03 s/iter, (0.091, 0.000, 0.020) sec
mfu: 162.318 Tflops/s, hfu: 162.318 Tflops/s, 196.836 iter/s, 5.080e-03 s/iter, (0.091, 0.000, 0.020) sec
SP=(1,8),S=(12288,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.023 Tflops/s, hfu: 69.023 Tflops/s, 133.922 iter/s, 7.467e-03 s/iter, (0.090, 0.000, 0.149) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.852 Tflops/s, hfu: 115.852 Tflops/s, 224.782 iter/s, 4.449e-03 s/iter, (0.052, 0.000, 0.089) sec
# stripe_flash_attn_func, fwd
mfu: 66.557 Tflops/s, hfu: 66.557 Tflops/s, 129.138 iter/s, 7.744e-03 s/iter, (0.090, 0.000, 0.155) sec
# orchestrated_attn_func
mfu: 176.331 Tflops/s, hfu: 176.331 Tflops/s, 171.064 iter/s, 5.846e-03 s/iter, (0.102, 0.000, 0.023) sec
mfu: 161.411 Tflops/s, hfu: 161.411 Tflops/s, 156.589 iter/s, 6.386e-03 s/iter, (0.098, 0.000, 0.026) sec
mfu: 162.537 Tflops/s, hfu: 162.537 Tflops/s, 157.682 iter/s, 6.342e-03 s/iter, (0.095, 0.000, 0.025) sec
mfu: 165.519 Tflops/s, hfu: 165.519 Tflops/s, 160.574 iter/s, 6.228e-03 s/iter, (0.097, 0.000, 0.025) sec
SP=(1,8),S=(12288,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.655 Tflops/s, hfu: 71.655 Tflops/s, 115.858 iter/s, 8.631e-03 s/iter, (0.106, 0.000, 0.173) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.352 Tflops/s, hfu: 116.352 Tflops/s, 188.127 iter/s, 5.316e-03 s/iter, (0.062, 0.000, 0.106) sec
# stripe_flash_attn_func, fwd
mfu: 68.934 Tflops/s, hfu: 68.934 Tflops/s, 111.457 iter/s, 8.972e-03 s/iter, (0.104, 0.000, 0.179) sec
# orchestrated_attn_func
mfu: 171.024 Tflops/s, hfu: 171.024 Tflops/s, 138.263 iter/s, 7.233e-03 s/iter, (0.105, 0.000, 0.029) sec
mfu: 164.482 Tflops/s, hfu: 164.482 Tflops/s, 132.973 iter/s, 7.520e-03 s/iter, (0.108, 0.000, 0.030) sec
mfu: 162.217 Tflops/s, hfu: 162.217 Tflops/s, 131.142 iter/s, 7.625e-03 s/iter, (0.101, 0.000, 0.031) sec
mfu: 167.816 Tflops/s, hfu: 167.816 Tflops/s, 135.669 iter/s, 7.371e-03 s/iter, (0.099, 0.000, 0.029) sec
SP=(1,8),S=(12288,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 74.704 Tflops/s, hfu: 74.704 Tflops/s, 103.532 iter/s, 9.659e-03 s/iter, (0.115, 0.000, 0.193) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 116.765 Tflops/s, hfu: 116.765 Tflops/s, 161.824 iter/s, 6.180e-03 s/iter, (0.072, 0.000, 0.124) sec
# stripe_flash_attn_func, fwd
mfu: 71.24 Tflops/s, hfu: 71.24 Tflops/s, 98.732 iter/s, 1.013e-02 s/iter, (0.117, 0.000, 0.203) sec
# orchestrated_attn_func
mfu: 169.47 Tflops/s, hfu: 169.47 Tflops/s, 117.434 iter/s, 8.515e-03 s/iter, (0.124, 0.000, 0.034) sec
mfu: 164.642 Tflops/s, hfu: 164.642 Tflops/s, 114.088 iter/s, 8.765e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 163.664 Tflops/s, hfu: 163.664 Tflops/s, 113.411 iter/s, 8.818e-03 s/iter, (0.105, 0.000, 0.035) sec
mfu: 165.435 Tflops/s, hfu: 165.435 Tflops/s, 114.638 iter/s, 8.723e-03 s/iter, (0.102, 0.000, 0.035) sec
SP=(1,8),S=(12288,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.072 Tflops/s, hfu: 77.072 Tflops/s, 93.463 iter/s, 1.070e-02 s/iter, (0.129, 0.000, 0.214) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.386 Tflops/s, hfu: 117.386 Tflops/s, 142.350 iter/s, 7.025e-03 s/iter, (0.081, 0.000, 0.140) sec
# stripe_flash_attn_func, fwd
mfu: 71.972 Tflops/s, hfu: 71.972 Tflops/s, 87.278 iter/s, 1.146e-02 s/iter, (0.131, 0.000, 0.229) sec
# orchestrated_attn_func
mfu: 171.699 Tflops/s, hfu: 171.699 Tflops/s, 104.106 iter/s, 9.606e-03 s/iter, (0.173, 0.000, 0.038) sec
mfu: 163.787 Tflops/s, hfu: 163.787 Tflops/s, 99.309 iter/s, 1.007e-02 s/iter, (0.113, 0.000, 0.040) sec
mfu: 166.464 Tflops/s, hfu: 166.464 Tflops/s, 100.932 iter/s, 9.908e-03 s/iter, (0.110, 0.000, 0.040) sec
mfu: 164.403 Tflops/s, hfu: 164.403 Tflops/s, 99.682 iter/s, 1.003e-02 s/iter, (0.111, 0.000, 0.040) sec
SP=(1,8),S=(12288,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.159 Tflops/s, hfu: 76.159 Tflops/s, 73.884 iter/s, 1.353e-02 s/iter, (0.160, 0.000, 0.271) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.828 Tflops/s, hfu: 117.828 Tflops/s, 114.308 iter/s, 8.748e-03 s/iter, (0.099, 0.000, 0.175) sec
# stripe_flash_attn_func, fwd
mfu: 71.82 Tflops/s, hfu: 71.82 Tflops/s, 69.674 iter/s, 1.435e-02 s/iter, (0.167, 0.000, 0.287) sec
# orchestrated_attn_func
mfu: 174.475 Tflops/s, hfu: 174.475 Tflops/s, 84.631 iter/s, 1.182e-02 s/iter, (0.148, 0.000, 0.047) sec
mfu: 163.569 Tflops/s, hfu: 163.569 Tflops/s, 79.341 iter/s, 1.260e-02 s/iter, (0.124, 0.000, 0.050) sec
mfu: 166.389 Tflops/s, hfu: 166.389 Tflops/s, 80.709 iter/s, 1.239e-02 s/iter, (0.118, 0.000, 0.050) sec
mfu: 161.52 Tflops/s, hfu: 161.52 Tflops/s, 78.347 iter/s, 1.276e-02 s/iter, (0.121, 0.000, 0.051) sec
SP=(1,8),S=(12288,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 76.689 Tflops/s, hfu: 76.689 Tflops/s, 61.999 iter/s, 1.613e-02 s/iter, (0.192, 0.000, 0.323) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.384 Tflops/s, hfu: 118.384 Tflops/s, 95.707 iter/s, 1.045e-02 s/iter, (0.118, 0.000, 0.209) sec
# stripe_flash_attn_func, fwd
mfu: 73.253 Tflops/s, hfu: 73.253 Tflops/s, 59.221 iter/s, 1.689e-02 s/iter, (0.197, 0.000, 0.338) sec
# orchestrated_attn_func
mfu: 174.908 Tflops/s, hfu: 174.908 Tflops/s, 70.701 iter/s, 1.414e-02 s/iter, (0.162, 0.000, 0.057) sec
mfu: 165.974 Tflops/s, hfu: 165.974 Tflops/s, 67.090 iter/s, 1.491e-02 s/iter, (0.131, 0.000, 0.060) sec
mfu: 168.049 Tflops/s, hfu: 168.049 Tflops/s, 67.929 iter/s, 1.472e-02 s/iter, (0.131, 0.000, 0.059) sec
mfu: 164.579 Tflops/s, hfu: 164.579 Tflops/s, 66.526 iter/s, 1.503e-02 s/iter, (0.129, 0.000, 0.060) sec
SP=(1,8),S=(12288,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.095 Tflops/s, hfu: 78.095 Tflops/s, 54.116 iter/s, 1.848e-02 s/iter, (0.216, 0.000, 0.370) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.708 Tflops/s, hfu: 118.708 Tflops/s, 82.259 iter/s, 1.216e-02 s/iter, (0.138, 0.000, 0.243) sec
# stripe_flash_attn_func, fwd
mfu: 74.11 Tflops/s, hfu: 74.11 Tflops/s, 51.354 iter/s, 1.947e-02 s/iter, (0.226, 0.000, 0.389) sec
# orchestrated_attn_func
mfu: 171.238 Tflops/s, hfu: 171.238 Tflops/s, 59.330 iter/s, 1.686e-02 s/iter, (0.209, 0.000, 0.067) sec
mfu: 163.444 Tflops/s, hfu: 163.444 Tflops/s, 56.629 iter/s, 1.766e-02 s/iter, (0.139, 0.000, 0.071) sec
mfu: 168.306 Tflops/s, hfu: 168.306 Tflops/s, 58.314 iter/s, 1.715e-02 s/iter, (0.141, 0.000, 0.069) sec
mfu: 165.548 Tflops/s, hfu: 165.548 Tflops/s, 57.358 iter/s, 1.743e-02 s/iter, (0.140, 0.000, 0.070) sec
SP=(1,8),S=(12288,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.194 Tflops/s, hfu: 78.194 Tflops/s, 47.412 iter/s, 2.109e-02 s/iter, (0.245, 0.000, 0.422) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.757 Tflops/s, hfu: 118.757 Tflops/s, 72.006 iter/s, 1.389e-02 s/iter, (0.156, 0.000, 0.278) sec
# stripe_flash_attn_func, fwd
mfu: 74.709 Tflops/s, hfu: 74.709 Tflops/s, 45.298 iter/s, 2.208e-02 s/iter, (0.256, 0.000, 0.442) sec
# orchestrated_attn_func
mfu: 173.083 Tflops/s, hfu: 173.083 Tflops/s, 52.473 iter/s, 1.906e-02 s/iter, (0.224, 0.000, 0.076) sec
mfu: 165.088 Tflops/s, hfu: 165.088 Tflops/s, 50.049 iter/s, 1.998e-02 s/iter, (0.159, 0.000, 0.080) sec
mfu: 168.286 Tflops/s, hfu: 168.286 Tflops/s, 51.018 iter/s, 1.960e-02 s/iter, (0.148, 0.000, 0.078) sec
mfu: 162.187 Tflops/s, hfu: 162.187 Tflops/s, 49.170 iter/s, 2.034e-02 s/iter, (0.154, 0.000, 0.081) sec
SP=(1,8),S=(12288,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.479 Tflops/s, hfu: 77.479 Tflops/s, 37.582 iter/s, 2.661e-02 s/iter, (0.304, 0.000, 0.532) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 115.716 Tflops/s, hfu: 115.716 Tflops/s, 56.130 iter/s, 1.782e-02 s/iter, (0.197, 0.000, 0.356) sec
# stripe_flash_attn_func, fwd
mfu: 75.084 Tflops/s, hfu: 75.084 Tflops/s, 36.420 iter/s, 2.746e-02 s/iter, (0.312, 0.000, 0.549) sec
# orchestrated_attn_func
mfu: 170.28 Tflops/s, hfu: 170.28 Tflops/s, 41.298 iter/s, 2.421e-02 s/iter, (0.223, 0.000, 0.097) sec
mfu: 161.705 Tflops/s, hfu: 161.705 Tflops/s, 39.219 iter/s, 2.550e-02 s/iter, (0.176, 0.000, 0.102) sec
mfu: 164.847 Tflops/s, hfu: 164.847 Tflops/s, 39.981 iter/s, 2.501e-02 s/iter, (0.172, 0.000, 0.100) sec
mfu: 143.042 Tflops/s, hfu: 143.042 Tflops/s, 34.692 iter/s, 2.882e-02 s/iter, (0.176, 0.000, 0.115) sec
SP=(1,8),S=(12288,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.903 Tflops/s, hfu: 77.903 Tflops/s, 31.490 iter/s, 3.176e-02 s/iter, (0.366, 0.000, 0.635) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 73.822 Tflops/s, hfu: 73.822 Tflops/s, 29.840 iter/s, 3.351e-02 s/iter, (0.236, 0.000, 0.670) sec
# stripe_flash_attn_func, fwd
mfu: 74.968 Tflops/s, hfu: 74.968 Tflops/s, 30.304 iter/s, 3.300e-02 s/iter, (0.384, 0.000, 0.660) sec
# orchestrated_attn_func
mfu: 171.532 Tflops/s, hfu: 171.532 Tflops/s, 34.668 iter/s, 2.884e-02 s/iter, (0.249, 0.000, 0.115) sec
mfu: 162.556 Tflops/s, hfu: 162.556 Tflops/s, 32.854 iter/s, 3.044e-02 s/iter, (0.243, 0.000, 0.122) sec
mfu: 164.212 Tflops/s, hfu: 164.212 Tflops/s, 33.189 iter/s, 3.013e-02 s/iter, (0.190, 0.000, 0.121) sec
mfu: 146.009 Tflops/s, hfu: 146.009 Tflops/s, 29.510 iter/s, 3.389e-02 s/iter, (0.202, 0.000, 0.136) sec
SP=(1,8),S=(12288,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 78.433 Tflops/s, hfu: 78.433 Tflops/s, 27.175 iter/s, 3.680e-02 s/iter, (0.423, 0.000, 0.736) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 55.644 Tflops/s, hfu: 55.644 Tflops/s, 19.279 iter/s, 5.187e-02 s/iter, (0.309, 0.000, 1.037) sec
# stripe_flash_attn_func, fwd
mfu: 74.431 Tflops/s, hfu: 74.431 Tflops/s, 25.788 iter/s, 3.878e-02 s/iter, (0.450, 0.000, 0.776) sec
# orchestrated_attn_func
mfu: 176.207 Tflops/s, hfu: 176.207 Tflops/s, 30.526 iter/s, 3.276e-02 s/iter, (0.216, 0.000, 0.131) sec
mfu: 162.896 Tflops/s, hfu: 162.896 Tflops/s, 28.220 iter/s, 3.544e-02 s/iter, (0.219, 0.000, 0.142) sec
mfu: 164.433 Tflops/s, hfu: 164.433 Tflops/s, 28.486 iter/s, 3.511e-02 s/iter, (0.213, 0.000, 0.140) sec
mfu: 152.51 Tflops/s, hfu: 152.51 Tflops/s, 26.420 iter/s, 3.785e-02 s/iter, (0.226, 0.000, 0.151) sec
SP=(1,8),S=(12288,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 62.483 Tflops/s, hfu: 62.483 Tflops/s, 18.943 iter/s, 5.279e-02 s/iter, (0.488, 0.000, 1.056) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 95.829 Tflops/s, hfu: 95.829 Tflops/s, 29.052 iter/s, 3.442e-02 s/iter, (0.327, 0.000, 0.688) sec
# stripe_flash_attn_func, fwd
mfu: 75.936 Tflops/s, hfu: 75.936 Tflops/s, 23.021 iter/s, 4.344e-02 s/iter, (0.514, 0.000, 0.869) sec
# orchestrated_attn_func
mfu: 171.974 Tflops/s, hfu: 171.974 Tflops/s, 26.068 iter/s, 3.836e-02 s/iter, (0.318, 0.000, 0.153) sec
mfu: 164.474 Tflops/s, hfu: 164.474 Tflops/s, 24.931 iter/s, 4.011e-02 s/iter, (0.240, 0.000, 0.160) sec
mfu: 164.569 Tflops/s, hfu: 164.569 Tflops/s, 24.946 iter/s, 4.009e-02 s/iter, (0.233, 0.000, 0.160) sec
mfu: 150.963 Tflops/s, hfu: 150.963 Tflops/s, 22.883 iter/s, 4.370e-02 s/iter, (0.255, 0.000, 0.175) sec
SP=(1,8),S=(12288,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 42.965 Tflops/s, hfu: 42.965 Tflops/s, 10.420 iter/s, 9.597e-02 s/iter, (0.685, 0.000, 1.919) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 108.468 Tflops/s, hfu: 108.468 Tflops/s, 26.307 iter/s, 3.801e-02 s/iter, (0.417, 0.000, 0.760) sec
# stripe_flash_attn_func, fwd
mfu: 61.311 Tflops/s, hfu: 61.311 Tflops/s, 14.870 iter/s, 6.725e-02 s/iter, (0.747, 0.000, 1.345) sec
# orchestrated_attn_func
mfu: 168.347 Tflops/s, hfu: 168.347 Tflops/s, 20.415 iter/s, 4.898e-02 s/iter, (0.298, 0.000, 0.196) sec
mfu: 163.391 Tflops/s, hfu: 163.391 Tflops/s, 19.814 iter/s, 5.047e-02 s/iter, (0.273, 0.000, 0.202) sec
mfu: 164.501 Tflops/s, hfu: 164.501 Tflops/s, 19.948 iter/s, 5.013e-02 s/iter, (0.271, 0.000, 0.201) sec
mfu: 148.78 Tflops/s, hfu: 148.78 Tflops/s, 18.042 iter/s, 5.543e-02 s/iter, (0.287, 0.000, 0.222) sec
SP=(1,8),S=(12288,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 38.601 Tflops/s, hfu: 38.601 Tflops/s, 7.802 iter/s, 1.282e-01 s/iter, (0.837, 0.000, 2.564) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 76.6 Tflops/s, hfu: 76.6 Tflops/s, 15.482 iter/s, 6.459e-02 s/iter, (0.529, 0.000, 1.292) sec
# stripe_flash_attn_func, fwd
mfu: 38.523 Tflops/s, hfu: 38.523 Tflops/s, 7.786 iter/s, 1.284e-01 s/iter, (0.895, 0.000, 2.569) sec
# orchestrated_attn_func
mfu: 170.292 Tflops/s, hfu: 170.292 Tflops/s, 17.209 iter/s, 5.811e-02 s/iter, (0.387, 0.000, 0.232) sec
mfu: 164.845 Tflops/s, hfu: 164.845 Tflops/s, 16.658 iter/s, 6.003e-02 s/iter, (0.320, 0.000, 0.240) sec
mfu: 164.764 Tflops/s, hfu: 164.764 Tflops/s, 16.650 iter/s, 6.006e-02 s/iter, (0.312, 0.000, 0.240) sec
mfu: 153.404 Tflops/s, hfu: 153.404 Tflops/s, 15.502 iter/s, 6.451e-02 s/iter, (0.337, 0.000, 0.258) sec
SP=(1,8),S=(12288,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.256 Tflops/s, hfu: 44.256 Tflops/s, 7.667 iter/s, 1.304e-01 s/iter, (0.950, 0.000, 2.609) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.706 Tflops/s, hfu: 59.706 Tflops/s, 10.343 iter/s, 9.668e-02 s/iter, (0.567, 0.000, 1.934) sec
# stripe_flash_attn_func, fwd
mfu: 41.502 Tflops/s, hfu: 41.502 Tflops/s, 7.190 iter/s, 1.391e-01 s/iter, (1.059, 0.000, 2.782) sec
# orchestrated_attn_func
mfu: 170.123 Tflops/s, hfu: 170.123 Tflops/s, 14.736 iter/s, 6.786e-02 s/iter, (0.347, 0.000, 0.271) sec
mfu: 163.771 Tflops/s, hfu: 163.771 Tflops/s, 14.186 iter/s, 7.049e-02 s/iter, (0.355, 0.000, 0.282) sec
mfu: 164.453 Tflops/s, hfu: 164.453 Tflops/s, 14.245 iter/s, 7.020e-02 s/iter, (0.368, 0.000, 0.281) sec
mfu: 149.94 Tflops/s, hfu: 149.94 Tflops/s, 12.988 iter/s, 7.700e-02 s/iter, (0.382, 0.000, 0.308) sec
SP=(1,8),S=(12288,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 40.24 Tflops/s, hfu: 40.24 Tflops/s, 6.100 iter/s, 1.639e-01 s/iter, (1.110, 0.000, 3.279) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 73.967 Tflops/s, hfu: 73.967 Tflops/s, 11.212 iter/s, 8.919e-02 s/iter, (0.741, 0.000, 1.784) sec
# stripe_flash_attn_func, fwd
mfu: 39.88 Tflops/s, hfu: 39.88 Tflops/s, 6.045 iter/s, 1.654e-01 s/iter, (1.211, 0.000, 3.308) sec
# orchestrated_attn_func
mfu: 173.065 Tflops/s, hfu: 173.065 Tflops/s, 13.117 iter/s, 7.624e-02 s/iter, (0.386, 0.000, 0.305) sec
mfu: 163.615 Tflops/s, hfu: 163.615 Tflops/s, 12.401 iter/s, 8.064e-02 s/iter, (0.390, 0.000, 0.323) sec
mfu: 164.347 Tflops/s, hfu: 164.347 Tflops/s, 12.456 iter/s, 8.028e-02 s/iter, (0.394, 0.000, 0.321) sec
mfu: 156.195 Tflops/s, hfu: 156.195 Tflops/s, 11.838 iter/s, 8.447e-02 s/iter, (0.420, 0.000, 0.338) sec
SP=(1,8),S=(14336,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 10.945 Tflops/s, hfu: 10.945 Tflops/s, 364.045 iter/s, 2.747e-03 s/iter, (0.043, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 20.187 Tflops/s, hfu: 20.187 Tflops/s, 671.438 iter/s, 1.489e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 9.411 Tflops/s, hfu: 9.411 Tflops/s, 313.032 iter/s, 3.195e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 29.934 Tflops/s, hfu: 29.934 Tflops/s, 497.818 iter/s, 2.009e-03 s/iter, (0.077, 0.000, 0.008) sec
mfu: 65.15 Tflops/s, hfu: 65.15 Tflops/s, 1083.499 iter/s, 9.229e-04 s/iter, (0.076, 0.000, 0.004) sec
mfu: 86.282 Tflops/s, hfu: 86.282 Tflops/s, 1434.934 iter/s, 6.969e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 107.216 Tflops/s, hfu: 107.216 Tflops/s, 1783.091 iter/s, 5.608e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(14336,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 21.771 Tflops/s, hfu: 21.771 Tflops/s, 362.074 iter/s, 2.762e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 40.404 Tflops/s, hfu: 40.404 Tflops/s, 671.949 iter/s, 1.488e-03 s/iter, (0.021, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 18.674 Tflops/s, hfu: 18.674 Tflops/s, 310.566 iter/s, 3.220e-03 s/iter, (0.039, 0.000, 0.064) sec
# orchestrated_attn_func
mfu: 56.778 Tflops/s, hfu: 56.778 Tflops/s, 472.131 iter/s, 2.118e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 99.693 Tflops/s, hfu: 99.693 Tflops/s, 828.984 iter/s, 1.206e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 116.934 Tflops/s, hfu: 116.934 Tflops/s, 972.347 iter/s, 1.028e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 127.771 Tflops/s, hfu: 127.771 Tflops/s, 1062.464 iter/s, 9.412e-04 s/iter, (0.077, 0.000, 0.004) sec
SP=(1,8),S=(14336,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 32.583 Tflops/s, hfu: 32.583 Tflops/s, 361.259 iter/s, 2.768e-03 s/iter, (0.046, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 59.592 Tflops/s, hfu: 59.592 Tflops/s, 660.702 iter/s, 1.514e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 27.909 Tflops/s, hfu: 27.909 Tflops/s, 309.427 iter/s, 3.232e-03 s/iter, (0.040, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 78.46 Tflops/s, hfu: 78.46 Tflops/s, 434.952 iter/s, 2.299e-03 s/iter, (0.082, 0.000, 0.009) sec
mfu: 121.215 Tflops/s, hfu: 121.215 Tflops/s, 671.967 iter/s, 1.488e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 133.23 Tflops/s, hfu: 133.23 Tflops/s, 738.570 iter/s, 1.354e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 138.584 Tflops/s, hfu: 138.584 Tflops/s, 768.252 iter/s, 1.302e-03 s/iter, (0.075, 0.000, 0.005) sec
SP=(1,8),S=(14336,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 40.439 Tflops/s, hfu: 40.439 Tflops/s, 336.269 iter/s, 2.974e-03 s/iter, (0.046, 0.000, 0.059) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 78.625 Tflops/s, hfu: 78.625 Tflops/s, 653.797 iter/s, 1.530e-03 s/iter, (0.020, 0.000, 0.031) sec
# stripe_flash_attn_func, fwd
mfu: 37.275 Tflops/s, hfu: 37.275 Tflops/s, 309.953 iter/s, 3.226e-03 s/iter, (0.040, 0.000, 0.065) sec
# orchestrated_attn_func
mfu: 97.891 Tflops/s, hfu: 97.891 Tflops/s, 407.002 iter/s, 2.457e-03 s/iter, (0.080, 0.000, 0.010) sec
mfu: 134.189 Tflops/s, hfu: 134.189 Tflops/s, 557.916 iter/s, 1.792e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 142.592 Tflops/s, hfu: 142.592 Tflops/s, 592.855 iter/s, 1.687e-03 s/iter, (0.076, 0.000, 0.007) sec
mfu: 148.032 Tflops/s, hfu: 148.032 Tflops/s, 615.472 iter/s, 1.625e-03 s/iter, (0.079, 0.000, 0.006) sec
SP=(1,8),S=(14336,10240),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 44.855 Tflops/s, hfu: 44.855 Tflops/s, 298.391 iter/s, 3.351e-03 s/iter, (0.048, 0.000, 0.067) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 92.463 Tflops/s, hfu: 92.463 Tflops/s, 615.095 iter/s, 1.626e-03 s/iter, (0.020, 0.000, 0.033) sec
# stripe_flash_attn_func, fwd
mfu: 45.77 Tflops/s, hfu: 45.77 Tflops/s, 304.479 iter/s, 3.284e-03 s/iter, (0.041, 0.000, 0.066) sec
# orchestrated_attn_func
mfu: 104.137 Tflops/s, hfu: 104.137 Tflops/s, 346.375 iter/s, 2.887e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 145.752 Tflops/s, hfu: 145.752 Tflops/s, 484.793 iter/s, 2.063e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 147.102 Tflops/s, hfu: 147.102 Tflops/s, 489.283 iter/s, 2.044e-03 s/iter, (0.078, 0.000, 0.008) sec
mfu: 150.424 Tflops/s, hfu: 150.424 Tflops/s, 500.332 iter/s, 1.999e-03 s/iter, (0.078, 0.000, 0.008) sec
SP=(1,8),S=(14336,12288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.624 Tflops/s, hfu: 48.624 Tflops/s, 269.553 iter/s, 3.710e-03 s/iter, (0.055, 0.000, 0.074) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 107.68 Tflops/s, hfu: 107.68 Tflops/s, 596.935 iter/s, 1.675e-03 s/iter, (0.022, 0.000, 0.034) sec
# stripe_flash_attn_func, fwd
mfu: 50.135 Tflops/s, hfu: 50.135 Tflops/s, 277.930 iter/s, 3.598e-03 s/iter, (0.044, 0.000, 0.072) sec
# orchestrated_attn_func
mfu: 117.402 Tflops/s, hfu: 117.402 Tflops/s, 325.413 iter/s, 3.073e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 148.275 Tflops/s, hfu: 148.275 Tflops/s, 410.988 iter/s, 2.433e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 154.046 Tflops/s, hfu: 154.046 Tflops/s, 426.984 iter/s, 2.342e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 154.947 Tflops/s, hfu: 154.947 Tflops/s, 429.482 iter/s, 2.328e-03 s/iter, (0.079, 0.000, 0.009) sec
SP=(1,8),S=(14336,14336),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 51.758 Tflops/s, hfu: 51.758 Tflops/s, 245.935 iter/s, 4.066e-03 s/iter, (0.055, 0.000, 0.081) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 112.103 Tflops/s, hfu: 112.103 Tflops/s, 532.674 iter/s, 1.877e-03 s/iter, (0.024, 0.000, 0.038) sec
# stripe_flash_attn_func, fwd
mfu: 53.463 Tflops/s, hfu: 53.463 Tflops/s, 254.038 iter/s, 3.936e-03 s/iter, (0.047, 0.000, 0.079) sec
# orchestrated_attn_func
mfu: 129.312 Tflops/s, hfu: 129.312 Tflops/s, 307.223 iter/s, 3.255e-03 s/iter, (0.083, 0.000, 0.013) sec
mfu: 155.167 Tflops/s, hfu: 155.167 Tflops/s, 368.649 iter/s, 2.713e-03 s/iter, (0.083, 0.000, 0.011) sec
mfu: 157.988 Tflops/s, hfu: 157.988 Tflops/s, 375.352 iter/s, 2.664e-03 s/iter, (0.080, 0.000, 0.011) sec
mfu: 156.904 Tflops/s, hfu: 156.904 Tflops/s, 372.776 iter/s, 2.683e-03 s/iter, (0.080, 0.000, 0.011) sec
SP=(1,8),S=(14336,16384),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 54.422 Tflops/s, hfu: 54.422 Tflops/s, 226.270 iter/s, 4.420e-03 s/iter, (0.058, 0.000, 0.088) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 113.431 Tflops/s, hfu: 113.431 Tflops/s, 471.612 iter/s, 2.120e-03 s/iter, (0.027, 0.000, 0.042) sec
# stripe_flash_attn_func, fwd
mfu: 56.221 Tflops/s, hfu: 56.221 Tflops/s, 233.749 iter/s, 4.278e-03 s/iter, (0.050, 0.000, 0.086) sec
# orchestrated_attn_func
mfu: 136.136 Tflops/s, hfu: 136.136 Tflops/s, 283.005 iter/s, 3.534e-03 s/iter, (0.085, 0.000, 0.014) sec
mfu: 160.983 Tflops/s, hfu: 160.983 Tflops/s, 334.659 iter/s, 2.988e-03 s/iter, (0.082, 0.000, 0.012) sec
mfu: 157.48 Tflops/s, hfu: 157.48 Tflops/s, 327.376 iter/s, 3.055e-03 s/iter, (0.081, 0.000, 0.012) sec
mfu: 159.905 Tflops/s, hfu: 159.905 Tflops/s, 332.417 iter/s, 3.008e-03 s/iter, (0.082, 0.000, 0.012) sec
SP=(1,8),S=(14336,20480),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 58.487 Tflops/s, hfu: 58.487 Tflops/s, 194.535 iter/s, 5.140e-03 s/iter, (0.065, 0.000, 0.103) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.117 Tflops/s, hfu: 117.117 Tflops/s, 389.550 iter/s, 2.567e-03 s/iter, (0.032, 0.000, 0.051) sec
# stripe_flash_attn_func, fwd
mfu: 60.549 Tflops/s, hfu: 60.549 Tflops/s, 201.395 iter/s, 4.965e-03 s/iter, (0.058, 0.000, 0.099) sec
# orchestrated_attn_func
mfu: 155.194 Tflops/s, hfu: 155.194 Tflops/s, 258.099 iter/s, 3.874e-03 s/iter, (0.087, 0.000, 0.015) sec
mfu: 166.111 Tflops/s, hfu: 166.111 Tflops/s, 276.256 iter/s, 3.620e-03 s/iter, (0.087, 0.000, 0.014) sec
mfu: 163.644 Tflops/s, hfu: 163.644 Tflops/s, 272.152 iter/s, 3.674e-03 s/iter, (0.084, 0.000, 0.015) sec
mfu: 160.357 Tflops/s, hfu: 160.357 Tflops/s, 266.687 iter/s, 3.750e-03 s/iter, (0.085, 0.000, 0.015) sec
SP=(1,8),S=(14336,24576),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 60.923 Tflops/s, hfu: 60.923 Tflops/s, 168.865 iter/s, 5.922e-03 s/iter, (0.080, 0.000, 0.118) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 117.782 Tflops/s, hfu: 117.782 Tflops/s, 326.467 iter/s, 3.063e-03 s/iter, (0.037, 0.000, 0.061) sec
# stripe_flash_attn_func, fwd
mfu: 64.035 Tflops/s, hfu: 64.035 Tflops/s, 177.493 iter/s, 5.634e-03 s/iter, (0.065, 0.000, 0.113) sec
# orchestrated_attn_func
mfu: 161.726 Tflops/s, hfu: 161.726 Tflops/s, 224.135 iter/s, 4.462e-03 s/iter, (0.088, 0.000, 0.018) sec
mfu: 168.237 Tflops/s, hfu: 168.237 Tflops/s, 233.159 iter/s, 4.289e-03 s/iter, (0.089, 0.000, 0.017) sec
mfu: 167.503 Tflops/s, hfu: 167.503 Tflops/s, 232.142 iter/s, 4.308e-03 s/iter, (0.087, 0.000, 0.017) sec
mfu: 159.358 Tflops/s, hfu: 159.358 Tflops/s, 220.854 iter/s, 4.528e-03 s/iter, (0.087, 0.000, 0.018) sec
SP=(1,8),S=(14336,28672),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 64.327 Tflops/s, hfu: 64.327 Tflops/s, 152.830 iter/s, 6.543e-03 s/iter, (0.084, 0.000, 0.131) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.463 Tflops/s, hfu: 119.463 Tflops/s, 283.822 iter/s, 3.523e-03 s/iter, (0.042, 0.000, 0.070) sec
# stripe_flash_attn_func, fwd
mfu: 65.711 Tflops/s, hfu: 65.711 Tflops/s, 156.117 iter/s, 6.405e-03 s/iter, (0.074, 0.000, 0.128) sec
# orchestrated_attn_func
mfu: 172.033 Tflops/s, hfu: 172.033 Tflops/s, 204.360 iter/s, 4.893e-03 s/iter, (0.119, 0.000, 0.020) sec
mfu: 172.273 Tflops/s, hfu: 172.273 Tflops/s, 204.645 iter/s, 4.887e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 168.788 Tflops/s, hfu: 168.788 Tflops/s, 200.506 iter/s, 4.987e-03 s/iter, (0.090, 0.000, 0.020) sec
mfu: 159.868 Tflops/s, hfu: 159.868 Tflops/s, 189.909 iter/s, 5.266e-03 s/iter, (0.106, 0.000, 0.021) sec
SP=(1,8),S=(14336,32768),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 66.417 Tflops/s, hfu: 66.417 Tflops/s, 138.070 iter/s, 7.243e-03 s/iter, (0.090, 0.000, 0.145) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 120.469 Tflops/s, hfu: 120.469 Tflops/s, 250.437 iter/s, 3.993e-03 s/iter, (0.049, 0.000, 0.080) sec
# stripe_flash_attn_func, fwd
mfu: 67.751 Tflops/s, hfu: 67.751 Tflops/s, 140.843 iter/s, 7.100e-03 s/iter, (0.082, 0.000, 0.142) sec
# orchestrated_attn_func
mfu: 174.82 Tflops/s, hfu: 174.82 Tflops/s, 181.711 iter/s, 5.503e-03 s/iter, (0.120, 0.000, 0.022) sec
mfu: 176.213 Tflops/s, hfu: 176.213 Tflops/s, 183.160 iter/s, 5.460e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 171.451 Tflops/s, hfu: 171.451 Tflops/s, 178.210 iter/s, 5.611e-03 s/iter, (0.092, 0.000, 0.022) sec
mfu: 163.294 Tflops/s, hfu: 163.294 Tflops/s, 169.732 iter/s, 5.892e-03 s/iter, (0.094, 0.000, 0.024) sec
SP=(1,8),S=(14336,40960),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 69.913 Tflops/s, hfu: 69.913 Tflops/s, 116.271 iter/s, 8.601e-03 s/iter, (0.104, 0.000, 0.172) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 122.083 Tflops/s, hfu: 122.083 Tflops/s, 203.033 iter/s, 4.925e-03 s/iter, (0.058, 0.000, 0.099) sec
# stripe_flash_attn_func, fwd
mfu: 70.7 Tflops/s, hfu: 70.7 Tflops/s, 117.580 iter/s, 8.505e-03 s/iter, (0.099, 0.000, 0.170) sec
# orchestrated_attn_func
mfu: 178.136 Tflops/s, hfu: 178.136 Tflops/s, 148.127 iter/s, 6.751e-03 s/iter, (0.107, 0.000, 0.027) sec
mfu: 172.703 Tflops/s, hfu: 172.703 Tflops/s, 143.609 iter/s, 6.963e-03 s/iter, (0.100, 0.000, 0.028) sec
mfu: 171.337 Tflops/s, hfu: 171.337 Tflops/s, 142.473 iter/s, 7.019e-03 s/iter, (0.096, 0.000, 0.028) sec
mfu: 166.391 Tflops/s, hfu: 166.391 Tflops/s, 138.360 iter/s, 7.228e-03 s/iter, (0.099, 0.000, 0.029) sec
SP=(1,8),S=(14336,49152),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 71.459 Tflops/s, hfu: 71.459 Tflops/s, 99.035 iter/s, 1.010e-02 s/iter, (0.120, 0.000, 0.202) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.286 Tflops/s, hfu: 123.286 Tflops/s, 170.861 iter/s, 5.853e-03 s/iter, (0.068, 0.000, 0.117) sec
# stripe_flash_attn_func, fwd
mfu: 73.282 Tflops/s, hfu: 73.282 Tflops/s, 101.561 iter/s, 9.846e-03 s/iter, (0.115, 0.000, 0.197) sec
# orchestrated_attn_func
mfu: 176.115 Tflops/s, hfu: 176.115 Tflops/s, 122.038 iter/s, 8.194e-03 s/iter, (0.159, 0.000, 0.033) sec
mfu: 174.518 Tflops/s, hfu: 174.518 Tflops/s, 120.932 iter/s, 8.269e-03 s/iter, (0.103, 0.000, 0.033) sec
mfu: 173.455 Tflops/s, hfu: 173.455 Tflops/s, 120.196 iter/s, 8.320e-03 s/iter, (0.105, 0.000, 0.033) sec
mfu: 168.568 Tflops/s, hfu: 168.568 Tflops/s, 116.809 iter/s, 8.561e-03 s/iter, (0.104, 0.000, 0.034) sec
SP=(1,8),S=(14336,57344),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 73.337 Tflops/s, hfu: 73.337 Tflops/s, 87.117 iter/s, 1.148e-02 s/iter, (0.133, 0.000, 0.230) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 123.691 Tflops/s, hfu: 123.691 Tflops/s, 146.934 iter/s, 6.806e-03 s/iter, (0.077, 0.000, 0.136) sec
# stripe_flash_attn_func, fwd
mfu: 73.989 Tflops/s, hfu: 73.989 Tflops/s, 87.893 iter/s, 1.138e-02 s/iter, (0.129, 0.000, 0.228) sec
# orchestrated_attn_func
mfu: 175.266 Tflops/s, hfu: 175.266 Tflops/s, 104.100 iter/s, 9.606e-03 s/iter, (0.147, 0.000, 0.038) sec
mfu: 172.999 Tflops/s, hfu: 172.999 Tflops/s, 102.754 iter/s, 9.732e-03 s/iter, (0.108, 0.000, 0.039) sec
mfu: 174.28 Tflops/s, hfu: 174.28 Tflops/s, 103.514 iter/s, 9.660e-03 s/iter, (0.108, 0.000, 0.039) sec
mfu: 168.697 Tflops/s, hfu: 168.697 Tflops/s, 100.199 iter/s, 9.980e-03 s/iter, (0.110, 0.000, 0.040) sec
SP=(1,8),S=(14336,65536),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 75.544 Tflops/s, hfu: 75.544 Tflops/s, 78.522 iter/s, 1.274e-02 s/iter, (0.148, 0.000, 0.255) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.09 Tflops/s, hfu: 124.09 Tflops/s, 128.982 iter/s, 7.753e-03 s/iter, (0.087, 0.000, 0.155) sec
# stripe_flash_attn_func, fwd
mfu: 75.54 Tflops/s, hfu: 75.54 Tflops/s, 78.518 iter/s, 1.274e-02 s/iter, (0.145, 0.000, 0.255) sec
# orchestrated_attn_func
mfu: 174.956 Tflops/s, hfu: 174.956 Tflops/s, 90.927 iter/s, 1.100e-02 s/iter, (0.178, 0.000, 0.044) sec
mfu: 173.907 Tflops/s, hfu: 173.907 Tflops/s, 90.381 iter/s, 1.106e-02 s/iter, (0.118, 0.000, 0.044) sec
mfu: 173.165 Tflops/s, hfu: 173.165 Tflops/s, 89.996 iter/s, 1.111e-02 s/iter, (0.114, 0.000, 0.044) sec
mfu: 168.817 Tflops/s, hfu: 168.817 Tflops/s, 87.736 iter/s, 1.140e-02 s/iter, (0.118, 0.000, 0.046) sec
SP=(1,8),S=(14336,81920),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.512 Tflops/s, hfu: 77.512 Tflops/s, 64.454 iter/s, 1.551e-02 s/iter, (0.174, 0.000, 0.310) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 124.585 Tflops/s, hfu: 124.585 Tflops/s, 103.597 iter/s, 9.653e-03 s/iter, (0.108, 0.000, 0.193) sec
# stripe_flash_attn_func, fwd
mfu: 75.142 Tflops/s, hfu: 75.142 Tflops/s, 62.483 iter/s, 1.600e-02 s/iter, (0.186, 0.000, 0.320) sec
# orchestrated_attn_func
mfu: 171.968 Tflops/s, hfu: 171.968 Tflops/s, 71.499 iter/s, 1.399e-02 s/iter, (0.130, 0.000, 0.056) sec
mfu: 174.295 Tflops/s, hfu: 174.295 Tflops/s, 72.466 iter/s, 1.380e-02 s/iter, (0.127, 0.000, 0.055) sec
mfu: 180.252 Tflops/s, hfu: 180.252 Tflops/s, 74.943 iter/s, 1.334e-02 s/iter, (0.124, 0.000, 0.053) sec
mfu: 170.199 Tflops/s, hfu: 170.199 Tflops/s, 70.763 iter/s, 1.413e-02 s/iter, (0.127, 0.000, 0.057) sec
SP=(1,8),S=(14336,98304),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 77.795 Tflops/s, hfu: 77.795 Tflops/s, 53.908 iter/s, 1.855e-02 s/iter, (0.209, 0.000, 0.371) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 126.304 Tflops/s, hfu: 126.304 Tflops/s, 87.522 iter/s, 1.143e-02 s/iter, (0.129, 0.000, 0.229) sec
# stripe_flash_attn_func, fwd
mfu: 75.922 Tflops/s, hfu: 75.922 Tflops/s, 52.610 iter/s, 1.901e-02 s/iter, (0.221, 0.000, 0.380) sec
# orchestrated_attn_func
mfu: 175.155 Tflops/s, hfu: 175.155 Tflops/s, 60.687 iter/s, 1.648e-02 s/iter, (0.211, 0.000, 0.066) sec
mfu: 176.864 Tflops/s, hfu: 176.864 Tflops/s, 61.279 iter/s, 1.632e-02 s/iter, (0.138, 0.000, 0.065) sec
mfu: 180.741 Tflops/s, hfu: 180.741 Tflops/s, 62.622 iter/s, 1.597e-02 s/iter, (0.133, 0.000, 0.064) sec
mfu: 171.887 Tflops/s, hfu: 171.887 Tflops/s, 59.554 iter/s, 1.679e-02 s/iter, (0.139, 0.000, 0.067) sec
SP=(1,8),S=(14336,114688),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.925 Tflops/s, hfu: 79.925 Tflops/s, 47.472 iter/s, 2.107e-02 s/iter, (0.240, 0.000, 0.421) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 126.506 Tflops/s, hfu: 126.506 Tflops/s, 75.139 iter/s, 1.331e-02 s/iter, (0.150, 0.000, 0.266) sec
# stripe_flash_attn_func, fwd
mfu: 77.074 Tflops/s, hfu: 77.074 Tflops/s, 45.779 iter/s, 2.184e-02 s/iter, (0.256, 0.000, 0.437) sec
# orchestrated_attn_func
mfu: 177.707 Tflops/s, hfu: 177.707 Tflops/s, 52.775 iter/s, 1.895e-02 s/iter, (0.179, 0.000, 0.076) sec
mfu: 175.543 Tflops/s, hfu: 175.543 Tflops/s, 52.132 iter/s, 1.918e-02 s/iter, (0.156, 0.000, 0.077) sec
mfu: 184.669 Tflops/s, hfu: 184.669 Tflops/s, 54.843 iter/s, 1.823e-02 s/iter, (0.144, 0.000, 0.073) sec
mfu: 170.758 Tflops/s, hfu: 170.758 Tflops/s, 50.711 iter/s, 1.972e-02 s/iter, (0.153, 0.000, 0.079) sec
SP=(1,8),S=(14336,131072),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.624 Tflops/s, hfu: 80.624 Tflops/s, 41.901 iter/s, 2.387e-02 s/iter, (0.275, 0.000, 0.477) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 126.531 Tflops/s, hfu: 126.531 Tflops/s, 65.760 iter/s, 1.521e-02 s/iter, (0.171, 0.000, 0.304) sec
# stripe_flash_attn_func, fwd
mfu: 77.221 Tflops/s, hfu: 77.221 Tflops/s, 40.132 iter/s, 2.492e-02 s/iter, (0.283, 0.000, 0.498) sec
# orchestrated_attn_func
mfu: 178.415 Tflops/s, hfu: 178.415 Tflops/s, 46.362 iter/s, 2.157e-02 s/iter, (0.193, 0.000, 0.086) sec
mfu: 177.631 Tflops/s, hfu: 177.631 Tflops/s, 46.158 iter/s, 2.166e-02 s/iter, (0.159, 0.000, 0.087) sec
mfu: 182.736 Tflops/s, hfu: 182.736 Tflops/s, 47.485 iter/s, 2.106e-02 s/iter, (0.156, 0.000, 0.084) sec
mfu: 171.944 Tflops/s, hfu: 171.944 Tflops/s, 44.681 iter/s, 2.238e-02 s/iter, (0.161, 0.000, 0.090) sec
SP=(1,8),S=(14336,163840),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 81.122 Tflops/s, hfu: 81.122 Tflops/s, 33.728 iter/s, 2.965e-02 s/iter, (0.345, 0.000, 0.593) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 119.019 Tflops/s, hfu: 119.019 Tflops/s, 49.484 iter/s, 2.021e-02 s/iter, (0.221, 0.000, 0.404) sec
# stripe_flash_attn_func, fwd
mfu: 77.804 Tflops/s, hfu: 77.804 Tflops/s, 32.348 iter/s, 3.091e-02 s/iter, (0.358, 0.000, 0.618) sec
# orchestrated_attn_func
mfu: 175.953 Tflops/s, hfu: 175.953 Tflops/s, 36.578 iter/s, 2.734e-02 s/iter, (0.186, 0.000, 0.109) sec
mfu: 179.658 Tflops/s, hfu: 179.658 Tflops/s, 37.348 iter/s, 2.678e-02 s/iter, (0.181, 0.000, 0.107) sec
mfu: 175.77 Tflops/s, hfu: 175.77 Tflops/s, 36.540 iter/s, 2.737e-02 s/iter, (0.182, 0.000, 0.109) sec
mfu: 162.184 Tflops/s, hfu: 162.184 Tflops/s, 33.716 iter/s, 2.966e-02 s/iter, (0.196, 0.000, 0.119) sec
SP=(1,8),S=(14336,196608),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 80.763 Tflops/s, hfu: 80.763 Tflops/s, 27.982 iter/s, 3.574e-02 s/iter, (0.414, 0.000, 0.715) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 70.677 Tflops/s, hfu: 70.677 Tflops/s, 24.488 iter/s, 4.084e-02 s/iter, (0.262, 0.000, 0.817) sec
# stripe_flash_attn_func, fwd
mfu: 77.83 Tflops/s, hfu: 77.83 Tflops/s, 26.966 iter/s, 3.708e-02 s/iter, (0.435, 0.000, 0.742) sec
# orchestrated_attn_func
mfu: 178.371 Tflops/s, hfu: 178.371 Tflops/s, 30.900 iter/s, 3.236e-02 s/iter, (0.319, 0.000, 0.129) sec
mfu: 176.259 Tflops/s, hfu: 176.259 Tflops/s, 30.535 iter/s, 3.275e-02 s/iter, (0.213, 0.000, 0.131) sec
mfu: 173.002 Tflops/s, hfu: 173.002 Tflops/s, 29.970 iter/s, 3.337e-02 s/iter, (0.202, 0.000, 0.133) sec
mfu: 160.996 Tflops/s, hfu: 160.996 Tflops/s, 27.890 iter/s, 3.585e-02 s/iter, (0.218, 0.000, 0.143) sec
SP=(1,8),S=(14336,229376),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 79.266 Tflops/s, hfu: 79.266 Tflops/s, 23.540 iter/s, 4.248e-02 s/iter, (0.480, 0.000, 0.850) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.97 Tflops/s, hfu: 69.97 Tflops/s, 20.780 iter/s, 4.812e-02 s/iter, (0.374, 0.000, 0.962) sec
# stripe_flash_attn_func, fwd
mfu: 78.171 Tflops/s, hfu: 78.171 Tflops/s, 23.215 iter/s, 4.308e-02 s/iter, (0.500, 0.000, 0.862) sec
# orchestrated_attn_func
mfu: 176.668 Tflops/s, hfu: 176.668 Tflops/s, 26.233 iter/s, 3.812e-02 s/iter, (0.230, 0.000, 0.152) sec
mfu: 177.934 Tflops/s, hfu: 177.934 Tflops/s, 26.421 iter/s, 3.785e-02 s/iter, (0.223, 0.000, 0.151) sec
mfu: 173.046 Tflops/s, hfu: 173.046 Tflops/s, 25.695 iter/s, 3.892e-02 s/iter, (0.232, 0.000, 0.156) sec
mfu: 154.328 Tflops/s, hfu: 154.328 Tflops/s, 22.916 iter/s, 4.364e-02 s/iter, (0.247, 0.000, 0.175) sec
SP=(1,8),S=(14336,262144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 52.453 Tflops/s, hfu: 52.453 Tflops/s, 13.630 iter/s, 7.337e-02 s/iter, (0.545, 0.000, 1.467) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 106.694 Tflops/s, hfu: 106.694 Tflops/s, 27.725 iter/s, 3.607e-02 s/iter, (0.361, 0.000, 0.721) sec
# stripe_flash_attn_func, fwd
mfu: 78.335 Tflops/s, hfu: 78.335 Tflops/s, 20.356 iter/s, 4.913e-02 s/iter, (0.569, 0.000, 0.983) sec
# orchestrated_attn_func
mfu: 178.476 Tflops/s, hfu: 178.476 Tflops/s, 23.189 iter/s, 4.312e-02 s/iter, (0.269, 0.000, 0.172) sec
mfu: 182.154 Tflops/s, hfu: 182.154 Tflops/s, 23.667 iter/s, 4.225e-02 s/iter, (0.244, 0.000, 0.169) sec
mfu: 173.125 Tflops/s, hfu: 173.125 Tflops/s, 22.494 iter/s, 4.446e-02 s/iter, (0.244, 0.000, 0.178) sec
mfu: 157.633 Tflops/s, hfu: 157.633 Tflops/s, 20.481 iter/s, 4.883e-02 s/iter, (0.263, 0.000, 0.195) sec
SP=(1,8),S=(14336,327680),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 46.662 Tflops/s, hfu: 46.662 Tflops/s, 9.700 iter/s, 1.031e-01 s/iter, (0.770, 0.000, 2.062) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 118.951 Tflops/s, hfu: 118.951 Tflops/s, 24.728 iter/s, 4.044e-02 s/iter, (0.461, 0.000, 0.809) sec
# stripe_flash_attn_func, fwd
mfu: 57.771 Tflops/s, hfu: 57.771 Tflops/s, 12.010 iter/s, 8.327e-02 s/iter, (0.852, 0.000, 1.665) sec
# orchestrated_attn_func
mfu: 176.7 Tflops/s, hfu: 176.7 Tflops/s, 18.367 iter/s, 5.445e-02 s/iter, (0.295, 0.000, 0.218) sec
mfu: 179.325 Tflops/s, hfu: 179.325 Tflops/s, 18.639 iter/s, 5.365e-02 s/iter, (0.295, 0.000, 0.215) sec
mfu: 169.585 Tflops/s, hfu: 169.585 Tflops/s, 17.627 iter/s, 5.673e-02 s/iter, (0.291, 0.000, 0.227) sec
mfu: 156.739 Tflops/s, hfu: 156.739 Tflops/s, 16.292 iter/s, 6.138e-02 s/iter, (0.300, 0.000, 0.246) sec
SP=(1,8),S=(14336,393216),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 41.036 Tflops/s, hfu: 41.036 Tflops/s, 7.109 iter/s, 1.407e-01 s/iter, (0.925, 0.000, 2.813) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 88.165 Tflops/s, hfu: 88.165 Tflops/s, 15.274 iter/s, 6.547e-02 s/iter, (0.614, 0.000, 1.309) sec
# stripe_flash_attn_func, fwd
mfu: 41.449 Tflops/s, hfu: 41.449 Tflops/s, 7.180 iter/s, 1.393e-01 s/iter, (1.021, 0.000, 2.785) sec
# orchestrated_attn_func
mfu: 180.515 Tflops/s, hfu: 180.515 Tflops/s, 15.636 iter/s, 6.396e-02 s/iter, (0.331, 0.000, 0.256) sec
mfu: 180.84 Tflops/s, hfu: 180.84 Tflops/s, 15.664 iter/s, 6.384e-02 s/iter, (0.331, 0.000, 0.255) sec
mfu: 174.213 Tflops/s, hfu: 174.213 Tflops/s, 15.090 iter/s, 6.627e-02 s/iter, (0.334, 0.000, 0.265) sec
mfu: 155.001 Tflops/s, hfu: 155.001 Tflops/s, 13.426 iter/s, 7.448e-02 s/iter, (0.368, 0.000, 0.298) sec
SP=(1,8),S=(14336,458752),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 48.514 Tflops/s, hfu: 48.514 Tflops/s, 7.204 iter/s, 1.388e-01 s/iter, (1.070, 0.000, 2.776) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 86.427 Tflops/s, hfu: 86.427 Tflops/s, 12.833 iter/s, 7.792e-02 s/iter, (0.699, 0.000, 1.558) sec
# stripe_flash_attn_func, fwd
mfu: 44.073 Tflops/s, hfu: 44.073 Tflops/s, 6.544 iter/s, 1.528e-01 s/iter, (1.214, 0.000, 3.056) sec
# orchestrated_attn_func
mfu: 178.717 Tflops/s, hfu: 178.717 Tflops/s, 13.269 iter/s, 7.537e-02 s/iter, (0.444, 0.000, 0.301) sec
mfu: 177.791 Tflops/s, hfu: 177.791 Tflops/s, 13.200 iter/s, 7.576e-02 s/iter, (0.374, 0.000, 0.303) sec
mfu: 173.407 Tflops/s, hfu: 173.407 Tflops/s, 12.874 iter/s, 7.767e-02 s/iter, (0.380, 0.001, 0.311) sec
mfu: 160.244 Tflops/s, hfu: 160.244 Tflops/s, 11.897 iter/s, 8.405e-02 s/iter, (0.415, 0.000, 0.336) sec
SP=(1,8),S=(14336,524288),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 39.788 Tflops/s, hfu: 39.788 Tflops/s, 5.170 iter/s, 1.934e-01 s/iter, (1.263, 0.000, 3.869) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.333 Tflops/s, hfu: 69.333 Tflops/s, 9.008 iter/s, 1.110e-01 s/iter, (0.720, 0.000, 2.220) sec
# stripe_flash_attn_func, fwd
mfu: 44.621 Tflops/s, hfu: 44.621 Tflops/s, 5.798 iter/s, 1.725e-01 s/iter, (1.385, 0.000, 3.450) sec
# orchestrated_attn_func
mfu: 174.666 Tflops/s, hfu: 174.666 Tflops/s, 11.347 iter/s, 8.813e-02 s/iter, (0.434, 0.000, 0.353) sec
mfu: 179.641 Tflops/s, hfu: 179.641 Tflops/s, 11.670 iter/s, 8.569e-02 s/iter, (0.429, 0.000, 0.343) sec
mfu: 175.769 Tflops/s, hfu: 175.769 Tflops/s, 11.419 iter/s, 8.758e-02 s/iter, (0.424, 0.000, 0.350) sec
mfu: 158.489 Tflops/s, hfu: 158.489 Tflops/s, 10.296 iter/s, 9.712e-02 s/iter, (0.469, 0.000, 0.388) sec
SP=(1,8),S=(16384,2048),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 12.42 Tflops/s, hfu: 12.42 Tflops/s, 361.461 iter/s, 2.767e-03 s/iter, (0.048, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 23.273 Tflops/s, hfu: 23.273 Tflops/s, 677.331 iter/s, 1.476e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 10.871 Tflops/s, hfu: 10.871 Tflops/s, 316.396 iter/s, 3.161e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 31.527 Tflops/s, hfu: 31.527 Tflops/s, 458.771 iter/s, 2.180e-03 s/iter, (0.078, 0.000, 0.009) sec
mfu: 66.876 Tflops/s, hfu: 66.876 Tflops/s, 973.179 iter/s, 1.028e-03 s/iter, (0.074, 0.000, 0.004) sec
mfu: 88.88 Tflops/s, hfu: 88.88 Tflops/s, 1293.380 iter/s, 7.732e-04 s/iter, (0.072, 0.000, 0.003) sec
mfu: 113.566 Tflops/s, hfu: 113.566 Tflops/s, 1652.608 iter/s, 6.051e-04 s/iter, (0.072, 0.000, 0.002) sec
SP=(1,8),S=(16384,4096),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 24.85 Tflops/s, hfu: 24.85 Tflops/s, 361.620 iter/s, 2.765e-03 s/iter, (0.039, 0.000, 0.055) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 46.378 Tflops/s, hfu: 46.378 Tflops/s, 674.895 iter/s, 1.482e-03 s/iter, (0.018, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 21.661 Tflops/s, hfu: 21.661 Tflops/s, 315.214 iter/s, 3.172e-03 s/iter, (0.039, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 56.973 Tflops/s, hfu: 56.973 Tflops/s, 414.530 iter/s, 2.412e-03 s/iter, (0.079, 0.000, 0.010) sec
mfu: 104.651 Tflops/s, hfu: 104.651 Tflops/s, 761.438 iter/s, 1.313e-03 s/iter, (0.075, 0.000, 0.005) sec
mfu: 120.396 Tflops/s, hfu: 120.396 Tflops/s, 875.994 iter/s, 1.142e-03 s/iter, (0.074, 0.000, 0.005) sec
mfu: 138.696 Tflops/s, hfu: 138.696 Tflops/s, 1009.147 iter/s, 9.909e-04 s/iter, (0.074, 0.000, 0.004) sec
SP=(1,8),S=(16384,6144),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
mfu: 36.443 Tflops/s, hfu: 36.443 Tflops/s, 353.542 iter/s, 2.829e-03 s/iter, (0.045, 0.000, 0.057) sec
# zigzag_ring_flash_attn_func, fwd
mfu: 69.755 Tflops/s, hfu: 69.755 Tflops/s, 676.708 iter/s, 1.478e-03 s/iter, (0.019, 0.000, 0.030) sec
# stripe_flash_attn_func, fwd
mfu: 32.525 Tflops/s, hfu: 32.525 Tflops/s, 315.534 iter/s, 3.169e-03 s/iter, (0.040, 0.000, 0.063) sec
# orchestrated_attn_func
mfu: 85.505 Tflops/s, hfu: 85.505 Tflops/s, 414.755 iter/s, 2.411e-03 s/iter, (0.081, 0.000, 0.010) sec
mfu: 124.087 Tflops/s, hfu: 124.087 Tflops/s, 601.899 iter/s, 1.661e-03 s/iter, (0.080, 0.000, 0.007) sec
mfu: 134.579 Tflops/s, hfu: 134.579 Tflops/s, 652.793 iter/s, 1.532e-03 s/iter, (0.076, 0.000, 0.006) sec
mfu: 149.46 Tflops/s, hfu: 149.46 Tflops/s, 724.978 iter/s, 1.379e-03 s/iter, (0.075, 0.000, 0.006) sec
SP=(1,8),S=(16384,8192),Nh=(32,32),bs=1,D=128,causal=False:
# ring_flash_attn_func, fwd
